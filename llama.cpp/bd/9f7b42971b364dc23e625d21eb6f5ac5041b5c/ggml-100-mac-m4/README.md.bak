### ctest_debug

Runs ctest in debug mode
- status: 0
```
+ ctest --output-on-failure -L main -E test-opt
Test project /Users/ggml/work/llama.cpp/build-ci-debug
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.39 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    1.74 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.22 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.67 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.42 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.32 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    1.43 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.07 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.33 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.07 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.96 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.32 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.32 sec
      Start 14: test-tokenizer-1-llama-spm
14/27 Test #14: test-tokenizer-1-llama-spm ........   Passed    1.05 sec
      Start 15: test-log
15/27 Test #15: test-log ..........................   Passed    0.22 sec
      Start 16: test-arg-parser
16/27 Test #16: test-arg-parser ...................   Passed    0.31 sec
      Start 17: test-sampling
17/27 Test #17: test-sampling .....................   Passed    2.22 sec
      Start 18: test-chat-template
18/27 Test #18: test-chat-template ................   Passed    0.19 sec
      Start 19: test-grammar-parser
19/27 Test #19: test-grammar-parser ...............   Passed    0.18 sec
      Start 20: test-grammar-integration
20/27 Test #20: test-grammar-integration ..........   Passed    0.23 sec
      Start 21: test-llama-grammar
21/27 Test #21: test-llama-grammar ................   Passed    0.19 sec
      Start 22: test-backend-ops
22/27 Test #22: test-backend-ops ..................   Passed  170.73 sec
      Start 25: test-barrier
23/27 Test #25: test-barrier ......................   Passed    1.09 sec
      Start 26: test-quantize-fns
24/27 Test #26: test-quantize-fns .................   Passed   25.51 sec
      Start 27: test-quantize-perf
25/27 Test #27: test-quantize-perf ................   Passed    0.33 sec
      Start 28: test-rope
26/27 Test #28: test-rope .........................   Passed    0.20 sec
      Start 29: test-json-schema-to-grammar
27/27 Test #29: test-json-schema-to-grammar .......   Passed    2.18 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    = 212.91 sec*proc (27 tests)

Total Test time (real) = 212.91 sec

real	3m32.947s
user	7m17.138s
sys	0m5.300s
```

### ctest_release

Runs ctest in release mode
- status: 0
```
+ ctest --output-on-failure -L main
Test project /Users/ggml/work/llama.cpp/build-ci-release
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.45 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    0.30 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.04 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.11 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.07 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.06 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    0.22 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.03 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.06 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.03 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.15 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.06 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.06 sec
      Start 14: test-tokenizer-1-llama-spm
14/27 Test #14: test-tokenizer-1-llama-spm ........   Passed    0.32 sec
      Start 15: test-log
15/27 Test #15: test-log ..........................   Passed    0.26 sec
      Start 16: test-arg-parser
16/27 Test #16: test-arg-parser ...................   Passed    0.17 sec
      Start 17: test-sampling
17/27 Test #17: test-sampling .....................   Passed    0.91 sec
      Start 18: test-chat-template
18/27 Test #18: test-chat-template ................   Passed    0.17 sec
      Start 19: test-grammar-parser
19/27 Test #19: test-grammar-parser ...............   Passed    0.28 sec
      Start 20: test-grammar-integration
20/27 Test #20: test-grammar-integration ..........   Passed    0.18 sec
      Start 21: test-llama-grammar
21/27 Test #21: test-llama-grammar ................   Passed    0.17 sec
      Start 22: test-backend-ops
22/27 Test #22: test-backend-ops ..................   Passed   28.26 sec
      Start 25: test-barrier
23/27 Test #25: test-barrier ......................   Passed    0.27 sec
      Start 26: test-quantize-fns
24/27 Test #26: test-quantize-fns .................   Passed   14.05 sec
      Start 27: test-quantize-perf
25/27 Test #27: test-quantize-perf ................   Passed    0.23 sec
      Start 28: test-rope
26/27 Test #28: test-rope .........................   Passed    0.27 sec
      Start 29: test-json-schema-to-grammar
27/27 Test #29: test-json-schema-to-grammar .......   Passed    2.09 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    =  50.23 sec*proc (27 tests)

Total Test time (real) =  50.25 sec

real	0m50.254s
user	1m10.732s
sys	0m4.585s
```
### embd_bge_small

BGE Small (BERT):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-f16.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.164 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.029.669 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.033.918 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.033.925 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.033.928 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.033.929 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.033.929 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.033.930 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.033.931 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.033.933 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.033.933 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.033.934 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.033.935 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.033.939 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.033.942 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.033.943 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.033.943 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.033.944 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.033.945 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.033.945 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.033.946 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.039.039 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.040.429 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.040.432 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.040.432 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.040.433 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.040.433 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.040.434 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.040.434 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.040.435 I llama_model_loader: - type  f32:  124 tensors
0.00.040.435 I llama_model_loader: - type  f16:   73 tensors
0.00.044.857 I llm_load_vocab: special tokens cache size = 5
0.00.047.287 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.047.291 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.047.292 I llm_load_print_meta: arch             = bert
0.00.047.292 I llm_load_print_meta: vocab type       = WPM
0.00.047.293 I llm_load_print_meta: n_vocab          = 30522
0.00.047.293 I llm_load_print_meta: n_merges         = 0
0.00.047.293 I llm_load_print_meta: vocab_only       = 0
0.00.047.293 I llm_load_print_meta: n_ctx_train      = 512
0.00.047.294 I llm_load_print_meta: n_embd           = 384
0.00.047.294 I llm_load_print_meta: n_layer          = 12
0.00.047.297 I llm_load_print_meta: n_head           = 12
0.00.047.298 I llm_load_print_meta: n_head_kv        = 12
0.00.047.298 I llm_load_print_meta: n_rot            = 32
0.00.047.299 I llm_load_print_meta: n_swa            = 0
0.00.047.299 I llm_load_print_meta: n_embd_head_k    = 32
0.00.047.299 I llm_load_print_meta: n_embd_head_v    = 32
0.00.047.300 I llm_load_print_meta: n_gqa            = 1
0.00.047.301 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.047.302 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.047.303 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.047.303 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.047.306 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.047.306 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.047.306 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.047.307 I llm_load_print_meta: n_ff             = 1536
0.00.047.308 I llm_load_print_meta: n_expert         = 0
0.00.047.308 I llm_load_print_meta: n_expert_used    = 0
0.00.047.317 I llm_load_print_meta: causal attn      = 0
0.00.047.321 I llm_load_print_meta: pooling type     = 2
0.00.047.321 I llm_load_print_meta: rope type        = 2
0.00.047.322 I llm_load_print_meta: rope scaling     = linear
0.00.047.325 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.047.325 I llm_load_print_meta: freq_scale_train = 1
0.00.047.327 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.047.328 I llm_load_print_meta: rope_finetuned   = unknown
0.00.047.328 I llm_load_print_meta: ssm_d_conv       = 0
0.00.047.328 I llm_load_print_meta: ssm_d_inner      = 0
0.00.047.328 I llm_load_print_meta: ssm_d_state      = 0
0.00.047.329 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.047.329 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.047.345 I llm_load_print_meta: model type       = 33M
0.00.047.347 I llm_load_print_meta: model ftype      = F16
0.00.047.347 I llm_load_print_meta: model params     = 33.21 M
0.00.047.349 I llm_load_print_meta: model size       = 63.84 MiB (16.12 BPW) 
0.00.047.349 I llm_load_print_meta: general.name     = Bge Small
0.00.047.349 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.047.350 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.047.350 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.047.350 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.047.351 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.047.351 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.047.352 I llm_load_print_meta: max token length = 21
0.00.049.548 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.049.554 I llm_load_tensors: offloading output layer to GPU
0.00.049.555 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.049.582 I llm_load_tensors: Metal_Mapped model buffer size =    40.73 MiB
0.00.049.583 I llm_load_tensors:   CPU_Mapped model buffer size =    23.11 MiB
................................................
0.00.050.195 I llama_new_context_with_model: n_seq_max     = 1
0.00.050.196 I llama_new_context_with_model: n_ctx         = 512
0.00.050.196 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.050.197 I llama_new_context_with_model: n_batch       = 2048
0.00.050.197 I llama_new_context_with_model: n_ubatch      = 2048
0.00.050.197 I llama_new_context_with_model: flash_attn    = 0
0.00.050.198 I llama_new_context_with_model: freq_base     = 10000.0
0.00.050.198 I llama_new_context_with_model: freq_scale    = 1
0.00.050.199 I ggml_metal_init: allocating
0.00.050.203 I ggml_metal_init: found device: Apple M4
0.00.050.206 I ggml_metal_init: picking default device: Apple M4
0.00.051.044 I ggml_metal_init: using embedded metal library
0.00.054.706 I ggml_metal_init: GPU name:   Apple M4
0.00.054.708 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.709 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.709 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.710 I ggml_metal_init: simdgroup reduction   = true
0.00.054.710 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.710 I ggml_metal_init: has bfloat            = true
0.00.054.710 I ggml_metal_init: use bfloat            = true
0.00.054.711 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.712 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.889 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.067.892 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.067.893 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.068.803 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.068.804 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.068.805 I llama_new_context_with_model: graph nodes  = 429
0.00.068.805 I llama_new_context_with_model: graph splits = 2
0.00.068.829 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.077.116 I 
0.00.077.136 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.077.988 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.043984 -0.019895  0.007670 -0.000838  0.001372 -0.037036  0.109436  0.042589  0.092046 -0.015918  0.006773 -0.035692 -0.017889  0.015040  0.018126  0.015860 -0.011308  0.010431 -0.085223 -0.008454  0.091368 -0.017067 -0.060328 -0.024484  0.027524  0.076059  0.027984 -0.014564  0.017645 -0.033268 -0.037874 -0.019012  0.068670 -0.009845 -0.025030  0.072346 -0.046570  0.011026 -0.050252  0.047693  0.032387 -0.011761  0.022055  0.049645  0.010465  0.005795 -0.028860  0.008933 -0.018507 -0.051466 -0.046036  0.030497 -0.035418  0.054204 -0.069650  0.044238  0.029786  0.046305  0.073410 -0.042580  0.076109  0.038851 -0.181182  0.082503  0.042250 -0.064549 -0.060097 -0.017853  0.006472  0.005873  0.017196 -0.026615  0.064578  0.112612  0.035159 -0.067416  0.027073 -0.067295 -0.033493 -0.033219  0.033252  0.013523 -0.003346 -0.037473 -0.052055  0.055155 -0.001982 -0.038276  0.064447  0.028824 -0.043334 -0.029236 -0.039462  0.036315  0.008379 -0.015481 -0.036573  0.018130  0.028600  0.342831 -0.044484  0.056114  0.017624 -0.020867 -0.066808  0.000146 -0.037885 -0.030063 -0.008541 -0.021595  0.000548 -0.003219  0.004020  0.018908 -0.008548  0.025835  0.049433  0.000091  0.050920 -0.042479 -0.031884  0.023606  0.030691 -0.023148 -0.046271 -0.079278  0.115198  0.046757  0.027829 -0.040710  0.067777 -0.022955  0.010332 -0.032937 -0.018305  0.043844  0.024268  0.052413  0.007469  0.008905  0.011244 -0.074655 -0.065561 -0.026750 -0.041192 -0.023884  0.026710  0.006912  0.027741  0.052873 -0.036673  0.057707 -0.000170  0.031764 -0.019760 -0.022083  0.041053 -0.058903  0.019619  0.043144  0.043582  0.041593 -0.022527  0.027037 -0.021833  0.005430 -0.041317 -0.001239  0.024452  0.002088  0.044333 -0.022745  0.043662  0.064763  0.055430  0.037060 -0.000919  0.046111  0.045790 -0.008487  0.063057 -0.073235 -0.011935  0.032107  0.023957  0.014725 -0.033688  0.001083 -0.015827 -0.019002  0.047872  0.110842  0.028428  0.031366 -0.013288 -0.057499  0.006644  0.005140 -0.012262 -0.051443 -0.000965 -0.017642 -0.019440 -0.040937  0.009209 -0.057957  0.050961  0.052340 -0.009617 -0.040259 -0.014075 -0.024877 -0.017251  0.006302  0.006588 -0.026919  0.015600  0.030760  0.002578  0.023206 -0.022199 -0.098557 -0.051105 -0.278031 -0.014994 -0.061553 -0.027218  0.017666 -0.010939 -0.017077  0.035055  0.046994 -0.015432  0.015232 -0.025477  0.047844 -0.005949 -0.000749 -0.061008 -0.068946 -0.060377 -0.035942  0.043319 -0.055047  0.015075  0.000537 -0.058175 -0.010439  0.012643  0.151495  0.127111 -0.013622  0.041993 -0.025672  0.014026 -0.001037 -0.150469  0.044857  0.005320 -0.036274 -0.029801 -0.020192 -0.034891  0.010235  0.033548 -0.048178 -0.051795 -0.017463 -0.023492  0.047349  0.052076 -0.016783 -0.055452  0.025836 -0.005707  0.010710  0.038705  0.008191 -0.009764 -0.105779 -0.027430 -0.096101  0.025068 -0.011260  0.092355  0.056101  0.003758  0.027791  0.002092 -0.051085 -0.039890 -0.013542 -0.044956 -0.015335  0.002910 -0.043498 -0.077951  0.065217 -0.006840 -0.001630 -0.014642  0.071560  0.023714 -0.037180  0.009175  0.001562 -0.032268  0.015468  0.037880  0.000337 -0.053207  0.021321 -0.039829  0.000031  0.013400  0.019798 -0.057879  0.006473 -0.049531 -0.267858  0.039156 -0.067972  0.038248 -0.012333  0.041485 -0.016117  0.052383 -0.071363  0.011369  0.024719 -0.007232  0.082087  0.028535 -0.021504  0.040494 -0.004570 -0.074594 -0.014749  0.020037  0.002304  0.023148  0.197212 -0.043222 -0.025983 -0.004959 -0.019278  0.074258  0.001716 -0.031979 -0.036599 -0.045082  0.000547 -0.011560  0.018126 -0.029461 -0.008463  0.006419  0.050799 -0.014959  0.006176  0.026096 -0.030809  0.048055  0.114093 -0.040826 -0.011457  0.005419 -0.003599  0.025154 -0.059142  0.013753 -0.010399  0.038709  0.051449  0.035413  0.035031 -0.017027  0.026360 -0.014490 -0.050032  0.003219  0.054121  0.039723 -0.039127 

0.00.083.277 I llama_perf_context_print:        load time =      47.44 ms
0.00.083.279 I llama_perf_context_print: prompt eval time =       5.12 ms /     9 tokens (    0.57 ms per token,  1757.81 tokens per second)
0.00.083.280 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.083.281 I llama_perf_context_print:       total time =       6.16 ms /    10 tokens
0.00.083.449 I ggml_metal_free: deallocating

real	0m0.260s
user	0m0.051s
sys	0m0.034s
```
- q8_0:
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-q8_0.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.040 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.374 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.013.460 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.013.463 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.013.464 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.013.465 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.013.465 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.013.465 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.013.466 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.013.466 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.013.467 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.013.467 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.013.467 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.013.468 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.013.469 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.013.469 I llama_model_loader: - kv  11:                          general.file_type u32              = 7
0.00.013.470 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.013.470 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.013.470 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.013.471 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.013.471 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.015.969 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.016.627 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.016.628 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.016.628 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.016.628 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.016.629 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.016.629 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.016.629 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.016.630 I llama_model_loader: - type  f32:  124 tensors
0.00.016.630 I llama_model_loader: - type q8_0:   73 tensors
0.00.019.071 I llm_load_vocab: special tokens cache size = 5
0.00.020.459 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.020.462 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.020.462 I llm_load_print_meta: arch             = bert
0.00.020.462 I llm_load_print_meta: vocab type       = WPM
0.00.020.462 I llm_load_print_meta: n_vocab          = 30522
0.00.020.463 I llm_load_print_meta: n_merges         = 0
0.00.020.463 I llm_load_print_meta: vocab_only       = 0
0.00.020.463 I llm_load_print_meta: n_ctx_train      = 512
0.00.020.463 I llm_load_print_meta: n_embd           = 384
0.00.020.463 I llm_load_print_meta: n_layer          = 12
0.00.020.465 I llm_load_print_meta: n_head           = 12
0.00.020.465 I llm_load_print_meta: n_head_kv        = 12
0.00.020.466 I llm_load_print_meta: n_rot            = 32
0.00.020.466 I llm_load_print_meta: n_swa            = 0
0.00.020.467 I llm_load_print_meta: n_embd_head_k    = 32
0.00.020.467 I llm_load_print_meta: n_embd_head_v    = 32
0.00.020.467 I llm_load_print_meta: n_gqa            = 1
0.00.020.468 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.020.469 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.020.470 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.020.470 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.020.471 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.020.472 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.020.472 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.020.472 I llm_load_print_meta: n_ff             = 1536
0.00.020.473 I llm_load_print_meta: n_expert         = 0
0.00.020.473 I llm_load_print_meta: n_expert_used    = 0
0.00.020.473 I llm_load_print_meta: causal attn      = 0
0.00.020.473 I llm_load_print_meta: pooling type     = 2
0.00.020.473 I llm_load_print_meta: rope type        = 2
0.00.020.473 I llm_load_print_meta: rope scaling     = linear
0.00.020.474 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.020.474 I llm_load_print_meta: freq_scale_train = 1
0.00.020.474 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.020.474 I llm_load_print_meta: rope_finetuned   = unknown
0.00.020.474 I llm_load_print_meta: ssm_d_conv       = 0
0.00.020.476 I llm_load_print_meta: ssm_d_inner      = 0
0.00.020.476 I llm_load_print_meta: ssm_d_state      = 0
0.00.020.476 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.020.476 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.020.482 I llm_load_print_meta: model type       = 33M
0.00.020.483 I llm_load_print_meta: model ftype      = Q8_0
0.00.020.483 I llm_load_print_meta: model params     = 33.21 M
0.00.020.484 I llm_load_print_meta: model size       = 34.38 MiB (8.68 BPW) 
0.00.020.484 I llm_load_print_meta: general.name     = Bge Small
0.00.020.484 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.020.484 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.020.485 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.020.485 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.020.485 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.020.485 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.020.485 I llm_load_print_meta: max token length = 21
0.00.021.825 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.021.825 I llm_load_tensors: offloading output layer to GPU
0.00.021.828 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.021.835 I llm_load_tensors: Metal_Mapped model buffer size =    21.75 MiB
0.00.021.836 I llm_load_tensors:   CPU_Mapped model buffer size =    12.63 MiB
................................................
0.00.022.196 I llama_new_context_with_model: n_seq_max     = 1
0.00.022.197 I llama_new_context_with_model: n_ctx         = 512
0.00.022.197 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.022.197 I llama_new_context_with_model: n_batch       = 2048
0.00.022.197 I llama_new_context_with_model: n_ubatch      = 2048
0.00.022.198 I llama_new_context_with_model: flash_attn    = 0
0.00.022.198 I llama_new_context_with_model: freq_base     = 10000.0
0.00.022.198 I llama_new_context_with_model: freq_scale    = 1
0.00.022.199 I ggml_metal_init: allocating
0.00.022.202 I ggml_metal_init: found device: Apple M4
0.00.022.205 I ggml_metal_init: picking default device: Apple M4
0.00.022.716 I ggml_metal_init: using embedded metal library
0.00.024.752 I ggml_metal_init: GPU name:   Apple M4
0.00.024.754 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.024.754 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.024.755 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.024.755 I ggml_metal_init: simdgroup reduction   = true
0.00.024.755 I ggml_metal_init: simdgroup matrix mul. = true
0.00.024.755 I ggml_metal_init: has bfloat            = true
0.00.024.755 I ggml_metal_init: use bfloat            = true
0.00.024.756 I ggml_metal_init: hasUnifiedMemory      = true
0.00.024.756 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.032.136 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.032.138 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.032.139 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.032.740 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.032.741 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.032.741 I llama_new_context_with_model: graph nodes  = 429
0.00.032.741 I llama_new_context_with_model: graph splits = 2
0.00.032.754 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.037.536 I 
0.00.037.549 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.038.054 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.044994 -0.019858  0.007986 -0.001410  0.001531 -0.036276  0.109404  0.043235  0.092836 -0.015201  0.005971 -0.036330 -0.018159  0.015015  0.017667  0.014510 -0.011792  0.011812 -0.084764 -0.008081  0.091650 -0.017638 -0.061084 -0.025066  0.026879  0.076180  0.028256 -0.014273  0.017420 -0.033553 -0.037520 -0.018280  0.068843 -0.010129 -0.024896  0.071968 -0.046406  0.011471 -0.050333  0.048931  0.032317 -0.012107  0.021812  0.049796  0.010366  0.005264 -0.028665  0.008581 -0.018508 -0.052358 -0.046410  0.029426 -0.034989  0.053289 -0.069849  0.043767  0.029291  0.046759  0.073664 -0.043090  0.075213  0.038641 -0.180496  0.081648  0.043389 -0.065615 -0.059878 -0.017387  0.006913  0.005155  0.017165 -0.026679  0.064347  0.112564  0.034871 -0.067783  0.027124 -0.066989 -0.034296 -0.033344  0.033189  0.014325 -0.004253 -0.036945 -0.052008  0.054151 -0.001715 -0.038112  0.063016  0.028668 -0.041665 -0.028879 -0.039263  0.036879  0.007718 -0.015657 -0.036270  0.018699  0.029792  0.344948 -0.043880  0.056487  0.018022 -0.021448 -0.065281  0.000253 -0.037910 -0.029663 -0.008828 -0.020643  0.001162 -0.003510  0.003091  0.018576 -0.009637  0.025316  0.049298 -0.000937  0.051568 -0.042363 -0.031550  0.023315  0.030044 -0.023267 -0.045483 -0.079644  0.114489  0.047503  0.027208 -0.041477  0.067717 -0.022845  0.010232 -0.033486 -0.017199  0.044319  0.022956  0.052194  0.008122  0.008112  0.009951 -0.074643 -0.065035 -0.025938 -0.040806 -0.024533  0.027409  0.006078  0.027693  0.052243 -0.036587  0.058682  0.001467  0.032191 -0.019964 -0.021840  0.041805 -0.058801  0.019348  0.042626  0.043999  0.040911 -0.021909  0.028025 -0.022801  0.005520 -0.041266 -0.000085  0.024325  0.001532  0.044802 -0.022888  0.043056  0.065030  0.056292  0.037666 -0.001004  0.047521  0.045624 -0.008614  0.062270 -0.073313 -0.011718  0.032708  0.023348  0.014650 -0.033924  0.001158 -0.015872 -0.018974  0.047982  0.110740  0.029177  0.030881 -0.012325 -0.057836  0.006939  0.004378 -0.011864 -0.051754 -0.003018 -0.017766 -0.020051 -0.041018  0.009118 -0.058568  0.050632  0.051795 -0.008968 -0.040668 -0.014765 -0.024320 -0.015980  0.005823  0.007147 -0.027335  0.016275  0.030734  0.002342  0.023167 -0.022169 -0.098059 -0.050901 -0.277240 -0.015100 -0.061566 -0.026219  0.017141 -0.010285 -0.017522  0.034725  0.047897 -0.016594  0.015489 -0.024132  0.048613 -0.004993 -0.000001 -0.060860 -0.068346 -0.059622 -0.036157  0.043605 -0.056353  0.014713  0.000292 -0.058627 -0.010995  0.012274  0.151597  0.127025 -0.012582  0.042765 -0.025227  0.013629 -0.000381 -0.150686  0.043974  0.004714 -0.036955 -0.029586 -0.019853 -0.034063  0.009522  0.034004 -0.048909 -0.051765 -0.017243 -0.025080  0.047588  0.050981 -0.017553 -0.056746  0.024054 -0.006285  0.011003  0.038719  0.008083 -0.008595 -0.106361 -0.027365 -0.096966  0.025294 -0.011096  0.091579  0.056180  0.004494  0.028066  0.001727 -0.051388 -0.039497 -0.013817 -0.045907 -0.015238  0.002920 -0.043938 -0.077716  0.066102 -0.006195 -0.000885 -0.013768  0.071562  0.023826 -0.036363  0.007848  0.001487 -0.032916  0.016336  0.037378  0.000625 -0.052389  0.021549 -0.039695 -0.000026  0.013496  0.020436 -0.057513  0.005900 -0.049906 -0.267546  0.038686 -0.067509  0.037450 -0.011471  0.041547 -0.015904  0.051347 -0.072313  0.012571  0.024808 -0.007420  0.082069  0.028175 -0.021956  0.040736 -0.003945 -0.074192 -0.014923  0.020417  0.002644  0.023207  0.197144 -0.043068 -0.025876 -0.004886 -0.018582  0.073936  0.001341 -0.031663 -0.037140 -0.044262  0.000049 -0.010741  0.018225 -0.028045 -0.008828  0.006047  0.050183 -0.015017  0.007037  0.025894 -0.030628  0.048075  0.112795 -0.039982 -0.011695  0.005039 -0.002800  0.025072 -0.059720  0.014182 -0.010019  0.038100  0.051088  0.034726  0.035947 -0.017035  0.027243 -0.015391 -0.051195  0.003744  0.053928  0.040014 -0.039140 

0.00.041.299 I llama_perf_context_print:        load time =      26.16 ms
0.00.041.300 I llama_perf_context_print: prompt eval time =       3.09 ms /     9 tokens (    0.34 ms per token,  2909.80 tokens per second)
0.00.041.300 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.041.300 I llama_perf_context_print:       total time =       3.76 ms /    10 tokens
0.00.041.430 I ggml_metal_free: deallocating

real	0m0.052s
user	0m0.028s
sys	0m0.014s
```
### rerank_tiny

Rerank Tiny (Jina):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/rerank-tiny/ggml-model-f16.gguf -p 'what is panda?</s></s>hi\nwhat is panda?</s></s>it'\''s a bear\nwhat is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.' -ngl 99 -c 0 --pooling rank --embd-normalize -1 --verbose-prompt
0.00.000.158 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.035.258 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.046.128 I llama_model_loader: loaded meta data with 29 key-value pairs and 70 tensors from ../models-mnt/rerank-tiny/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.046.136 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.046.139 I llama_model_loader: - kv   0:                       general.architecture str              = jina-bert-v2
0.00.046.140 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.046.144 I llama_model_loader: - kv   2:                               general.name str              = Jina Bert Implementation
0.00.046.145 I llama_model_loader: - kv   3:                       general.organization str              = Jinaai
0.00.046.146 I llama_model_loader: - kv   4:                         general.size_label str              = 33M
0.00.046.147 I llama_model_loader: - kv   5:                   jina-bert-v2.block_count u32              = 4
0.00.046.148 I llama_model_loader: - kv   6:                jina-bert-v2.context_length u32              = 8192
0.00.046.149 I llama_model_loader: - kv   7:              jina-bert-v2.embedding_length u32              = 384
0.00.046.150 I llama_model_loader: - kv   8:           jina-bert-v2.feed_forward_length u32              = 1536
0.00.046.151 I llama_model_loader: - kv   9:          jina-bert-v2.attention.head_count u32              = 12
0.00.046.155 I llama_model_loader: - kv  10:  jina-bert-v2.attention.layer_norm_epsilon f32              = 0.000000
0.00.046.155 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.046.156 I llama_model_loader: - kv  12:              jina-bert-v2.attention.causal bool             = false
0.00.046.159 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.046.159 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = jina-v1-en
0.00.055.527 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,61056]   = ["<s>", "<pad>", "</s>", "<unk>", "<m...
0.00.058.014 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,61056]   = [3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, ...
0.00.063.573 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,39382]   = ["t h", "i n", "a n", "e r", "th e", ...
0.00.063.575 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.063.575 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 2
0.00.063.576 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 3
0.00.063.576 I llama_model_loader: - kv  21:          tokenizer.ggml.seperator_token_id u32              = 2
0.00.063.577 I llama_model_loader: - kv  22:            tokenizer.ggml.padding_token_id u32              = 1
0.00.063.577 I llama_model_loader: - kv  23:                tokenizer.ggml.cls_token_id u32              = 0
0.00.063.577 I llama_model_loader: - kv  24:               tokenizer.ggml.mask_token_id u32              = 4
0.00.063.578 I llama_model_loader: - kv  25:            tokenizer.ggml.token_type_count u32              = 2
0.00.063.578 I llama_model_loader: - kv  26:               tokenizer.ggml.add_bos_token bool             = true
0.00.063.579 I llama_model_loader: - kv  27:               tokenizer.ggml.add_eos_token bool             = true
0.00.063.579 I llama_model_loader: - kv  28:               general.quantization_version u32              = 2
0.00.063.586 I llama_model_loader: - type  f32:   41 tensors
0.00.063.587 I llama_model_loader: - type  f16:   29 tensors
0.00.083.600 W llm_load_vocab: empty token at index 5
0.00.088.586 W llm_load_vocab: model vocab missing newline token, using special_pad_id instead
0.00.089.933 W llm_load_vocab: special_eos_id is not in special_eog_ids - the tokenizer config may be incorrect
0.00.089.960 I llm_load_vocab: special tokens cache size = 5
0.00.330.723 I llm_load_vocab: token to piece cache size = 1.5060 MB
0.00.330.730 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.330.730 I llm_load_print_meta: arch             = jina-bert-v2
0.00.330.731 I llm_load_print_meta: vocab type       = BPE
0.00.330.731 I llm_load_print_meta: n_vocab          = 61056
0.00.330.731 I llm_load_print_meta: n_merges         = 39382
0.00.330.731 I llm_load_print_meta: vocab_only       = 0
0.00.330.731 I llm_load_print_meta: n_ctx_train      = 8192
0.00.330.732 I llm_load_print_meta: n_embd           = 384
0.00.330.732 I llm_load_print_meta: n_layer          = 4
0.00.330.739 I llm_load_print_meta: n_head           = 12
0.00.330.739 I llm_load_print_meta: n_head_kv        = 12
0.00.330.739 I llm_load_print_meta: n_rot            = 32
0.00.330.740 I llm_load_print_meta: n_swa            = 0
0.00.330.740 I llm_load_print_meta: n_embd_head_k    = 32
0.00.330.740 I llm_load_print_meta: n_embd_head_v    = 32
0.00.330.741 I llm_load_print_meta: n_gqa            = 1
0.00.330.742 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.330.742 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.330.743 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.330.744 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.330.744 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.330.744 I llm_load_print_meta: f_max_alibi_bias = 8.0e+00
0.00.330.745 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.330.746 I llm_load_print_meta: n_ff             = 1536
0.00.330.746 I llm_load_print_meta: n_expert         = 0
0.00.330.746 I llm_load_print_meta: n_expert_used    = 0
0.00.330.748 I llm_load_print_meta: causal attn      = 0
0.00.330.748 I llm_load_print_meta: pooling type     = -1
0.00.330.748 I llm_load_print_meta: rope type        = -1
0.00.330.749 I llm_load_print_meta: rope scaling     = linear
0.00.330.749 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.330.749 I llm_load_print_meta: freq_scale_train = 1
0.00.330.750 I llm_load_print_meta: n_ctx_orig_yarn  = 8192
0.00.330.750 I llm_load_print_meta: rope_finetuned   = unknown
0.00.330.750 I llm_load_print_meta: ssm_d_conv       = 0
0.00.330.750 I llm_load_print_meta: ssm_d_inner      = 0
0.00.330.751 I llm_load_print_meta: ssm_d_state      = 0
0.00.330.751 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.330.751 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.330.773 I llm_load_print_meta: model type       = 33M
0.00.330.774 I llm_load_print_meta: model ftype      = F16
0.00.330.775 I llm_load_print_meta: model params     = 32.90 M
0.00.330.775 I llm_load_print_meta: model size       = 62.78 MiB (16.01 BPW) 
0.00.330.775 I llm_load_print_meta: general.name     = Jina Bert Implementation
0.00.330.775 I llm_load_print_meta: BOS token        = 0 '<s>'
0.00.330.776 I llm_load_print_meta: EOS token        = 2 '</s>'
0.00.330.776 I llm_load_print_meta: UNK token        = 3 '<unk>'
0.00.330.776 I llm_load_print_meta: SEP token        = 2 '</s>'
0.00.330.776 I llm_load_print_meta: PAD token        = 1 '<pad>'
0.00.330.777 I llm_load_print_meta: CLS token        = 0 '<s>'
0.00.330.777 I llm_load_print_meta: MASK token       = 4 '<mask>'
0.00.330.778 I llm_load_print_meta: EOG token        = 2 '</s>'
0.00.330.778 I llm_load_print_meta: max token length = 45
0.00.331.937 I llm_load_tensors: offloading 4 repeating layers to GPU
0.00.331.937 I llm_load_tensors: offloading output layer to GPU
0.00.331.938 I llm_load_tensors: offloaded 5/5 layers to GPU
0.00.331.958 I llm_load_tensors: Metal_Mapped model buffer size =    18.06 MiB
0.00.331.959 I llm_load_tensors:   CPU_Mapped model buffer size =    44.72 MiB
....................
0.00.332.692 I llama_new_context_with_model: n_seq_max     = 1
0.00.332.693 I llama_new_context_with_model: n_ctx         = 8192
0.00.332.693 I llama_new_context_with_model: n_ctx_per_seq = 8192
0.00.332.693 I llama_new_context_with_model: n_batch       = 2048
0.00.332.693 I llama_new_context_with_model: n_ubatch      = 2048
0.00.332.693 I llama_new_context_with_model: flash_attn    = 0
0.00.332.694 I llama_new_context_with_model: freq_base     = 10000.0
0.00.332.694 I llama_new_context_with_model: freq_scale    = 1
0.00.332.695 I ggml_metal_init: allocating
0.00.332.698 I ggml_metal_init: found device: Apple M4
0.00.332.700 I ggml_metal_init: picking default device: Apple M4
0.00.333.638 I ggml_metal_init: using embedded metal library
0.00.336.231 I ggml_metal_init: GPU name:   Apple M4
0.00.336.232 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.336.232 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.336.233 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.336.233 I ggml_metal_init: simdgroup reduction   = true
0.00.336.233 I ggml_metal_init: simdgroup matrix mul. = true
0.00.336.233 I ggml_metal_init: has bfloat            = true
0.00.336.233 I ggml_metal_init: use bfloat            = true
0.00.336.234 I ggml_metal_init: hasUnifiedMemory      = true
0.00.336.234 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.347.618 I llama_kv_cache_init:      Metal KV buffer size =    48.00 MiB
0.00.347.620 I llama_new_context_with_model: KV self size  =   48.00 MiB, K (f16):   24.00 MiB, V (f16):   24.00 MiB
0.00.347.624 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.348.086 I llama_new_context_with_model:      Metal compute buffer size =   220.01 MiB
0.00.348.087 I llama_new_context_with_model:        CPU compute buffer size =    22.02 MiB
0.00.348.087 I llama_new_context_with_model: graph nodes  = 154
0.00.348.088 I llama_new_context_with_model: graph splits = 2
0.00.348.105 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.359.079 I 
0.00.359.096 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.359.245 I main: prompt 0: 'what is panda?</s></s>hi'
0.00.359.245 I main: number of tokens in prompt = 9
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 23233 -> 'hi'
     2 -> '</s>'


0.00.359.248 I main: prompt 1: 'what is panda?</s></s>it's a bear'
0.00.359.248 I main: number of tokens in prompt = 13
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21153 -> 'it'
    37 -> '''
    87 -> 's'
    69 -> 'a'
 25706 -> 'bear'
     2 -> '</s>'


0.00.359.251 I main: prompt 2: 'what is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.'
0.00.359.251 I main: number of tokens in prompt = 40
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21215 -> 'he'
 28390 -> 'giant'
 49990 -> 'panda'
    38 -> '('
 21163 -> 'il'
 26237 -> 'uro'
 21223 -> 'po'
 23179 -> 'da'
 36906 -> 'melan'
 26791 -> 'ole'
    89 -> 'u'
 21402 -> 'ca'
 21686 -> '),'
 23314 -> 'sometimes'
 22517 -> 'called'
    69 -> 'a'
 49990 -> 'panda'
 25706 -> 'bear'
 21142 -> 'or'
 22810 -> 'simply'
 49990 -> 'panda'
    42 -> ','
 21152 -> 'is'
    69 -> 'a'
 25706 -> 'bear'
 25677 -> 'species'
 28930 -> 'ende'
 22024 -> 'mic'
 21148 -> 'to'
    76 -> 'h'
 22344 -> 'ina'
    44 -> '.'
     2 -> '</s>'


0.00.359.744 I batch_decode: n_tokens = 62, n_seq = 3

rerank score 0:    0.023
rerank score 1:    0.024
rerank score 2:    0.199

0.00.363.438 I llama_perf_context_print:        load time =     323.81 ms
0.00.363.439 I llama_perf_context_print: prompt eval time =       3.68 ms /    62 tokens (    0.06 ms per token, 16834.10 tokens per second)
0.00.363.442 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.363.442 I llama_perf_context_print:       total time =       4.36 ms /    63 tokens
0.00.363.641 I ggml_metal_free: deallocating

real	0m1.035s
user	0m0.325s
sys	0m0.042s
  - rerank score 0 @ 0.023 OK
  - rerank score 1 @ 0.024 OK
  - rerank score 2 @ 0.199 OK
```
### pythia_1_4b

Pythia 1.4B:
- status: 0
- perplexity:
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
- imatrix:
```
Final estimate: PPL = 10.1498 +/- 3.22650
```
- f16: 
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.130 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.004.929 I main: llama backend init
0.00.004.944 I main: load the model and apply lora adapter, if any
0.00.057.247 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.068.263 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.068.277 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.068.280 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.068.281 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.068.282 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.068.282 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.068.283 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.068.284 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.068.285 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.068.286 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.068.287 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.068.288 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.068.288 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.068.289 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.068.297 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.068.297 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.068.298 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.076.930 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.079.210 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.087.403 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.087.406 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.087.407 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.087.407 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.087.408 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.087.409 I llama_model_loader: - type  f32:  194 tensors
0.00.087.409 I llama_model_loader: - type  f16:   98 tensors
0.00.119.208 I llm_load_vocab: special tokens cache size = 25
0.00.126.431 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.126.434 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.126.434 I llm_load_print_meta: arch             = gptneox
0.00.126.434 I llm_load_print_meta: vocab type       = BPE
0.00.126.435 I llm_load_print_meta: n_vocab          = 50304
0.00.126.435 I llm_load_print_meta: n_merges         = 50009
0.00.126.435 I llm_load_print_meta: vocab_only       = 0
0.00.126.435 I llm_load_print_meta: n_ctx_train      = 2048
0.00.126.435 I llm_load_print_meta: n_embd           = 2048
0.00.126.435 I llm_load_print_meta: n_layer          = 24
0.00.126.438 I llm_load_print_meta: n_head           = 16
0.00.126.439 I llm_load_print_meta: n_head_kv        = 16
0.00.126.439 I llm_load_print_meta: n_rot            = 32
0.00.126.439 I llm_load_print_meta: n_swa            = 0
0.00.126.439 I llm_load_print_meta: n_embd_head_k    = 128
0.00.126.441 I llm_load_print_meta: n_embd_head_v    = 128
0.00.126.442 I llm_load_print_meta: n_gqa            = 1
0.00.126.443 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.126.445 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.126.445 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.126.446 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.126.446 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.126.446 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.126.446 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.126.447 I llm_load_print_meta: n_ff             = 8192
0.00.126.447 I llm_load_print_meta: n_expert         = 0
0.00.126.447 I llm_load_print_meta: n_expert_used    = 0
0.00.126.447 I llm_load_print_meta: causal attn      = 1
0.00.126.447 I llm_load_print_meta: pooling type     = 0
0.00.126.447 I llm_load_print_meta: rope type        = 2
0.00.126.447 I llm_load_print_meta: rope scaling     = linear
0.00.126.448 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.126.448 I llm_load_print_meta: freq_scale_train = 1
0.00.126.448 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.126.448 I llm_load_print_meta: rope_finetuned   = unknown
0.00.126.449 I llm_load_print_meta: ssm_d_conv       = 0
0.00.126.449 I llm_load_print_meta: ssm_d_inner      = 0
0.00.126.449 I llm_load_print_meta: ssm_d_state      = 0
0.00.126.458 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.126.460 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.126.473 I llm_load_print_meta: model type       = 1.4B
0.00.126.474 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.126.475 I llm_load_print_meta: model params     = 1.41 B
0.00.126.475 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.126.475 I llm_load_print_meta: general.name     = 1.4B
0.00.126.476 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.126.476 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.126.476 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.126.476 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.126.476 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.126.477 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.126.477 I llm_load_print_meta: max token length = 1024
0.00.129.173 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.129.173 I llm_load_tensors: offloading output layer to GPU
0.00.129.173 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.129.191 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.129.192 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.130.167 I llama_new_context_with_model: n_seq_max     = 1
0.00.130.168 I llama_new_context_with_model: n_ctx         = 2048
0.00.130.168 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.130.168 I llama_new_context_with_model: n_batch       = 2048
0.00.130.168 I llama_new_context_with_model: n_ubatch      = 512
0.00.130.168 I llama_new_context_with_model: flash_attn    = 0
0.00.130.169 I llama_new_context_with_model: freq_base     = 10000.0
0.00.130.169 I llama_new_context_with_model: freq_scale    = 1
0.00.130.169 I ggml_metal_init: allocating
0.00.130.172 I ggml_metal_init: found device: Apple M4
0.00.130.175 I ggml_metal_init: picking default device: Apple M4
0.00.130.818 I ggml_metal_init: using embedded metal library
0.00.143.090 I ggml_metal_init: GPU name:   Apple M4
0.00.143.093 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.143.093 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.143.093 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.143.094 I ggml_metal_init: simdgroup reduction   = true
0.00.143.094 I ggml_metal_init: simdgroup matrix mul. = true
0.00.143.094 I ggml_metal_init: has bfloat            = true
0.00.143.094 I ggml_metal_init: use bfloat            = true
0.00.143.094 I ggml_metal_init: hasUnifiedMemory      = true
0.00.143.095 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.179.108 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.179.114 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.179.133 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.180.059 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.180.060 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.180.060 I llama_new_context_with_model: graph nodes  = 967
0.00.180.060 I llama_new_context_with_model: graph splits = 2
0.00.180.099 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.304.735 I main: llama threadpool init, n_threads = 4
0.00.304.777 I 
0.00.304.800 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.304.800 I 
0.00.304.954 I sampler seed: 1234
0.00.304.959 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.304.981 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.304.983 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.304.983 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling depressed, and I've had a hard time getting out of bed. I think the only thing I

0.02.150.845 I llama_perf_sampler_print:    sampling time =       1.30 ms /    71 runs   (    0.02 ms per token, 54657.43 tokens per second)
0.02.150.846 I llama_perf_context_print:        load time =     247.47 ms
0.02.150.847 I llama_perf_context_print: prompt eval time =      37.80 ms /     7 tokens (    5.40 ms per token,   185.19 tokens per second)
0.02.150.847 I llama_perf_context_print:        eval time =    1805.02 ms /    63 runs   (   28.65 ms per token,    34.90 tokens per second)
0.02.150.848 I llama_perf_context_print:       total time =    1846.11 ms /    70 tokens
0.02.151.015 I ggml_metal_free: deallocating

real	0m2.464s
user	0m0.149s
sys	0m0.131s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.850 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.026.055 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.038.972 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.038.977 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.038.979 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.038.980 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.038.980 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.038.987 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.038.988 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.038.990 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.038.991 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.038.991 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.038.992 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.038.992 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.038.993 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.038.993 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.038.996 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.038.997 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.038.997 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.046.867 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.048.669 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.055.516 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.055.518 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.055.519 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.055.519 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.055.520 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.055.520 I llama_model_loader: - type  f32:  194 tensors
0.00.055.521 I llama_model_loader: - type  f16:   98 tensors
0.00.082.401 I llm_load_vocab: special tokens cache size = 25
0.00.088.995 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.088.999 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.088.999 I llm_load_print_meta: arch             = gptneox
0.00.088.999 I llm_load_print_meta: vocab type       = BPE
0.00.089.000 I llm_load_print_meta: n_vocab          = 50304
0.00.089.000 I llm_load_print_meta: n_merges         = 50009
0.00.089.000 I llm_load_print_meta: vocab_only       = 0
0.00.089.001 I llm_load_print_meta: n_ctx_train      = 2048
0.00.089.001 I llm_load_print_meta: n_embd           = 2048
0.00.089.001 I llm_load_print_meta: n_layer          = 24
0.00.089.004 I llm_load_print_meta: n_head           = 16
0.00.089.005 I llm_load_print_meta: n_head_kv        = 16
0.00.089.005 I llm_load_print_meta: n_rot            = 32
0.00.089.005 I llm_load_print_meta: n_swa            = 0
0.00.089.006 I llm_load_print_meta: n_embd_head_k    = 128
0.00.089.006 I llm_load_print_meta: n_embd_head_v    = 128
0.00.089.006 I llm_load_print_meta: n_gqa            = 1
0.00.089.007 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.089.008 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.089.009 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.089.009 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.089.009 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.089.009 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.089.010 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.089.010 I llm_load_print_meta: n_ff             = 8192
0.00.089.011 I llm_load_print_meta: n_expert         = 0
0.00.089.011 I llm_load_print_meta: n_expert_used    = 0
0.00.089.011 I llm_load_print_meta: causal attn      = 1
0.00.089.011 I llm_load_print_meta: pooling type     = 0
0.00.089.011 I llm_load_print_meta: rope type        = 2
0.00.089.011 I llm_load_print_meta: rope scaling     = linear
0.00.089.012 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.089.012 I llm_load_print_meta: freq_scale_train = 1
0.00.089.012 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.089.013 I llm_load_print_meta: rope_finetuned   = unknown
0.00.089.013 I llm_load_print_meta: ssm_d_conv       = 0
0.00.089.013 I llm_load_print_meta: ssm_d_inner      = 0
0.00.089.013 I llm_load_print_meta: ssm_d_state      = 0
0.00.089.013 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.089.013 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.089.026 I llm_load_print_meta: model type       = 1.4B
0.00.089.027 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.089.027 I llm_load_print_meta: model params     = 1.41 B
0.00.089.028 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.089.028 I llm_load_print_meta: general.name     = 1.4B
0.00.089.028 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.089.028 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.089.028 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.089.028 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.089.029 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.089.029 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.089.030 I llm_load_print_meta: max token length = 1024
0.00.091.487 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.091.487 I llm_load_tensors: offloading output layer to GPU
0.00.091.488 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.091.498 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.091.500 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.092.475 I llama_new_context_with_model: n_seq_max     = 1
0.00.092.476 I llama_new_context_with_model: n_ctx         = 128
0.00.092.476 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.092.476 I llama_new_context_with_model: n_batch       = 128
0.00.092.476 I llama_new_context_with_model: n_ubatch      = 128
0.00.092.476 I llama_new_context_with_model: flash_attn    = 0
0.00.092.477 I llama_new_context_with_model: freq_base     = 10000.0
0.00.092.477 I llama_new_context_with_model: freq_scale    = 1
0.00.092.477 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.092.478 I ggml_metal_init: allocating
0.00.092.484 I ggml_metal_init: found device: Apple M4
0.00.092.487 I ggml_metal_init: picking default device: Apple M4
0.00.093.073 I ggml_metal_init: using embedded metal library
0.00.095.131 I ggml_metal_init: GPU name:   Apple M4
0.00.095.132 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.095.133 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.095.133 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.095.133 I ggml_metal_init: simdgroup reduction   = true
0.00.095.133 I ggml_metal_init: simdgroup matrix mul. = true
0.00.095.134 I ggml_metal_init: has bfloat            = true
0.00.095.134 I ggml_metal_init: use bfloat            = true
0.00.095.134 I ggml_metal_init: hasUnifiedMemory      = true
0.00.095.135 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.103.689 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.103.694 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.103.709 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.104.628 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.104.629 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.104.629 I llama_new_context_with_model: graph nodes  = 967
0.00.104.630 I llama_new_context_with_model: graph splits = 2
0.00.104.642 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.494.777 I 
0.01.494.830 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.01.494.891 I perplexity: tokenizing the input ..
0.01.509.171 I perplexity: tokenization took 14.276 ms
0.01.509.180 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.630.383 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.632.051 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.632.069 I llama_perf_context_print:        load time =    1468.71 ms
0.01.632.071 I llama_perf_context_print: prompt eval time =     120.26 ms /   128 tokens (    0.94 ms per token,  1064.38 tokens per second)
0.01.632.072 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.632.073 I llama_perf_context_print:       total time =     137.30 ms /   129 tokens
0.01.632.721 I ggml_metal_free: deallocating

real	0m1.821s
user	0m0.121s
sys	0m0.260s
```
- q8_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.561 I main: llama backend init
0.00.001.564 I main: load the model and apply lora adapter, if any
0.00.011.010 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.029.041 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.029.047 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.029.049 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.029.049 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.029.050 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.029.050 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.029.050 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.029.051 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.029.052 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.029.052 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.029.052 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.029.053 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.029.053 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.029.053 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.029.057 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.029.057 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.029.057 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.032.934 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.034.065 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.038.120 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.038.122 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.038.122 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.038.122 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.038.122 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.038.123 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.038.123 I llama_model_loader: - type  f32:  194 tensors
0.00.038.123 I llama_model_loader: - type q8_0:   98 tensors
0.00.061.237 I llm_load_vocab: special tokens cache size = 25
0.00.067.336 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.067.340 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.067.340 I llm_load_print_meta: arch             = gptneox
0.00.067.341 I llm_load_print_meta: vocab type       = BPE
0.00.067.341 I llm_load_print_meta: n_vocab          = 50304
0.00.067.341 I llm_load_print_meta: n_merges         = 50009
0.00.067.341 I llm_load_print_meta: vocab_only       = 0
0.00.067.341 I llm_load_print_meta: n_ctx_train      = 2048
0.00.067.341 I llm_load_print_meta: n_embd           = 2048
0.00.067.342 I llm_load_print_meta: n_layer          = 24
0.00.067.348 I llm_load_print_meta: n_head           = 16
0.00.067.349 I llm_load_print_meta: n_head_kv        = 16
0.00.067.349 I llm_load_print_meta: n_rot            = 32
0.00.067.349 I llm_load_print_meta: n_swa            = 0
0.00.067.349 I llm_load_print_meta: n_embd_head_k    = 128
0.00.067.349 I llm_load_print_meta: n_embd_head_v    = 128
0.00.067.350 I llm_load_print_meta: n_gqa            = 1
0.00.067.351 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.067.351 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.067.352 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.067.353 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.067.353 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.067.353 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.067.353 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.067.354 I llm_load_print_meta: n_ff             = 8192
0.00.067.354 I llm_load_print_meta: n_expert         = 0
0.00.067.354 I llm_load_print_meta: n_expert_used    = 0
0.00.067.354 I llm_load_print_meta: causal attn      = 1
0.00.067.356 I llm_load_print_meta: pooling type     = 0
0.00.067.358 I llm_load_print_meta: rope type        = 2
0.00.067.358 I llm_load_print_meta: rope scaling     = linear
0.00.067.358 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.067.359 I llm_load_print_meta: freq_scale_train = 1
0.00.067.359 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.067.359 I llm_load_print_meta: rope_finetuned   = unknown
0.00.067.360 I llm_load_print_meta: ssm_d_conv       = 0
0.00.067.360 I llm_load_print_meta: ssm_d_inner      = 0
0.00.067.360 I llm_load_print_meta: ssm_d_state      = 0
0.00.067.360 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.067.360 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.067.373 I llm_load_print_meta: model type       = 1.4B
0.00.067.374 I llm_load_print_meta: model ftype      = Q8_0
0.00.067.374 I llm_load_print_meta: model params     = 1.41 B
0.00.067.374 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.067.375 I llm_load_print_meta: general.name     = 1.4B
0.00.067.375 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.067.375 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.067.376 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.067.377 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.067.377 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.067.377 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.067.377 I llm_load_print_meta: max token length = 1024
0.00.069.242 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.069.242 I llm_load_tensors: offloading output layer to GPU
0.00.069.242 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.069.252 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.069.253 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.070.178 I llama_new_context_with_model: n_seq_max     = 1
0.00.070.179 I llama_new_context_with_model: n_ctx         = 2048
0.00.070.179 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.070.179 I llama_new_context_with_model: n_batch       = 2048
0.00.070.179 I llama_new_context_with_model: n_ubatch      = 512
0.00.070.179 I llama_new_context_with_model: flash_attn    = 0
0.00.070.180 I llama_new_context_with_model: freq_base     = 10000.0
0.00.070.180 I llama_new_context_with_model: freq_scale    = 1
0.00.070.181 I ggml_metal_init: allocating
0.00.070.188 I ggml_metal_init: found device: Apple M4
0.00.070.190 I ggml_metal_init: picking default device: Apple M4
0.00.070.930 I ggml_metal_init: using embedded metal library
0.00.073.245 I ggml_metal_init: GPU name:   Apple M4
0.00.073.246 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.073.247 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.073.247 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.073.247 I ggml_metal_init: simdgroup reduction   = true
0.00.073.249 I ggml_metal_init: simdgroup matrix mul. = true
0.00.073.249 I ggml_metal_init: has bfloat            = true
0.00.073.250 I ggml_metal_init: use bfloat            = true
0.00.073.254 I ggml_metal_init: hasUnifiedMemory      = true
0.00.073.257 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.107.504 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.107.513 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.107.535 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.108.708 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.108.710 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.108.710 I llama_new_context_with_model: graph nodes  = 967
0.00.108.711 I llama_new_context_with_model: graph splits = 2
0.00.108.733 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.481.051 I main: llama threadpool init, n_threads = 4
0.01.481.119 I 
0.01.481.164 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.01.481.164 I 
0.01.481.503 I sampler seed: 1234
0.01.481.511 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.481.572 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.481.579 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.481.579 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.568.352 I llama_perf_sampler_print:    sampling time =       1.34 ms /    71 runs   (    0.02 ms per token, 53143.71 tokens per second)
0.02.568.353 I llama_perf_context_print:        load time =    1470.03 ms
0.02.568.353 I llama_perf_context_print: prompt eval time =      34.05 ms /     7 tokens (    4.86 ms per token,   205.58 tokens per second)
0.02.568.354 I llama_perf_context_print:        eval time =    1049.65 ms /    63 runs   (   16.66 ms per token,    60.02 tokens per second)
0.02.568.354 I llama_perf_context_print:       total time =    1087.31 ms /    70 tokens
0.02.568.530 I ggml_metal_free: deallocating

real	0m2.586s
user	0m0.124s
sys	0m0.266s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.285 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.015.009 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.024.211 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.024.216 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.024.218 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.024.218 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.024.219 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.024.219 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.024.220 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.024.221 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.024.221 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.024.222 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.024.222 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.024.223 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.024.223 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.024.223 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.024.225 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.024.226 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.024.226 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.030.220 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.031.817 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.037.826 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.037.827 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.037.828 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.037.828 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.037.828 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.037.829 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.037.829 I llama_model_loader: - type  f32:  194 tensors
0.00.037.830 I llama_model_loader: - type q8_0:   98 tensors
0.00.063.947 I llm_load_vocab: special tokens cache size = 25
0.00.070.803 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.070.806 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.070.806 I llm_load_print_meta: arch             = gptneox
0.00.070.807 I llm_load_print_meta: vocab type       = BPE
0.00.070.807 I llm_load_print_meta: n_vocab          = 50304
0.00.070.807 I llm_load_print_meta: n_merges         = 50009
0.00.070.807 I llm_load_print_meta: vocab_only       = 0
0.00.070.807 I llm_load_print_meta: n_ctx_train      = 2048
0.00.070.807 I llm_load_print_meta: n_embd           = 2048
0.00.070.808 I llm_load_print_meta: n_layer          = 24
0.00.070.810 I llm_load_print_meta: n_head           = 16
0.00.070.811 I llm_load_print_meta: n_head_kv        = 16
0.00.070.812 I llm_load_print_meta: n_rot            = 32
0.00.070.812 I llm_load_print_meta: n_swa            = 0
0.00.070.812 I llm_load_print_meta: n_embd_head_k    = 128
0.00.070.812 I llm_load_print_meta: n_embd_head_v    = 128
0.00.070.813 I llm_load_print_meta: n_gqa            = 1
0.00.070.813 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.070.814 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.070.814 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.070.815 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.070.815 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.070.817 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.070.817 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.070.818 I llm_load_print_meta: n_ff             = 8192
0.00.070.818 I llm_load_print_meta: n_expert         = 0
0.00.070.818 I llm_load_print_meta: n_expert_used    = 0
0.00.070.818 I llm_load_print_meta: causal attn      = 1
0.00.070.819 I llm_load_print_meta: pooling type     = 0
0.00.070.819 I llm_load_print_meta: rope type        = 2
0.00.070.819 I llm_load_print_meta: rope scaling     = linear
0.00.070.819 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.070.820 I llm_load_print_meta: freq_scale_train = 1
0.00.070.820 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.070.820 I llm_load_print_meta: rope_finetuned   = unknown
0.00.070.820 I llm_load_print_meta: ssm_d_conv       = 0
0.00.070.820 I llm_load_print_meta: ssm_d_inner      = 0
0.00.070.820 I llm_load_print_meta: ssm_d_state      = 0
0.00.070.820 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.070.823 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.070.834 I llm_load_print_meta: model type       = 1.4B
0.00.070.834 I llm_load_print_meta: model ftype      = Q8_0
0.00.070.835 I llm_load_print_meta: model params     = 1.41 B
0.00.070.835 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.070.835 I llm_load_print_meta: general.name     = 1.4B
0.00.070.836 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.070.837 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.070.837 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.070.837 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.070.838 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.070.838 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.070.838 I llm_load_print_meta: max token length = 1024
0.00.072.598 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.072.598 I llm_load_tensors: offloading output layer to GPU
0.00.072.598 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.072.607 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.072.608 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.073.481 I llama_new_context_with_model: n_seq_max     = 1
0.00.073.482 I llama_new_context_with_model: n_ctx         = 128
0.00.073.482 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.073.482 I llama_new_context_with_model: n_batch       = 128
0.00.073.482 I llama_new_context_with_model: n_ubatch      = 128
0.00.073.482 I llama_new_context_with_model: flash_attn    = 0
0.00.073.483 I llama_new_context_with_model: freq_base     = 10000.0
0.00.073.483 I llama_new_context_with_model: freq_scale    = 1
0.00.073.484 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.073.484 I ggml_metal_init: allocating
0.00.073.490 I ggml_metal_init: found device: Apple M4
0.00.073.493 I ggml_metal_init: picking default device: Apple M4
0.00.074.020 I ggml_metal_init: using embedded metal library
0.00.076.085 I ggml_metal_init: GPU name:   Apple M4
0.00.076.087 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.076.088 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.076.088 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.076.088 I ggml_metal_init: simdgroup reduction   = true
0.00.076.088 I ggml_metal_init: simdgroup matrix mul. = true
0.00.076.088 I ggml_metal_init: has bfloat            = true
0.00.076.089 I ggml_metal_init: use bfloat            = true
0.00.076.089 I ggml_metal_init: hasUnifiedMemory      = true
0.00.076.090 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.770 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.085.772 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.085.795 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.705 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.086.707 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.086.707 I llama_new_context_with_model: graph nodes  = 967
0.00.086.707 I llama_new_context_with_model: graph splits = 2
0.00.086.719 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.005.887 I 
0.01.005.926 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.01.005.955 I perplexity: tokenizing the input ..
0.01.013.859 I perplexity: tokenization took 7.903 ms
0.01.013.866 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.135.544 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.01.136.742 I Final estimate: PPL = 10.1362 +/- 3.22437

0.01.136.752 I llama_perf_context_print:        load time =     990.87 ms
0.01.136.753 I llama_perf_context_print: prompt eval time =     121.45 ms /   128 tokens (    0.95 ms per token,  1053.94 tokens per second)
0.01.136.754 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.136.754 I llama_perf_context_print:       total time =     130.87 ms /   129 tokens
0.01.137.102 I ggml_metal_free: deallocating

real	0m1.153s
user	0m0.095s
sys	0m0.159s
```
- q4_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.966 I main: llama backend init
0.00.001.968 I main: load the model and apply lora adapter, if any
0.00.022.798 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.046.643 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.046.648 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.046.650 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.046.650 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.046.650 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.046.651 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.046.651 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.046.652 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.046.652 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.046.653 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.046.653 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.046.653 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.046.654 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.046.654 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.046.657 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.046.658 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.046.659 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.051.247 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.052.669 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.057.737 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.057.739 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.057.739 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.057.739 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.057.740 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.057.740 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.057.741 I llama_model_loader: - type  f32:  194 tensors
0.00.057.741 I llama_model_loader: - type q4_0:   97 tensors
0.00.057.741 I llama_model_loader: - type q6_K:    1 tensors
0.00.092.076 I llm_load_vocab: special tokens cache size = 25
0.00.103.058 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.103.063 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.103.064 I llm_load_print_meta: arch             = gptneox
0.00.103.064 I llm_load_print_meta: vocab type       = BPE
0.00.103.064 I llm_load_print_meta: n_vocab          = 50304
0.00.103.065 I llm_load_print_meta: n_merges         = 50009
0.00.103.065 I llm_load_print_meta: vocab_only       = 0
0.00.103.065 I llm_load_print_meta: n_ctx_train      = 2048
0.00.103.065 I llm_load_print_meta: n_embd           = 2048
0.00.103.066 I llm_load_print_meta: n_layer          = 24
0.00.103.071 I llm_load_print_meta: n_head           = 16
0.00.103.072 I llm_load_print_meta: n_head_kv        = 16
0.00.103.075 I llm_load_print_meta: n_rot            = 32
0.00.103.075 I llm_load_print_meta: n_swa            = 0
0.00.103.075 I llm_load_print_meta: n_embd_head_k    = 128
0.00.103.075 I llm_load_print_meta: n_embd_head_v    = 128
0.00.103.077 I llm_load_print_meta: n_gqa            = 1
0.00.103.078 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.103.079 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.103.080 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.103.082 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.103.084 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.103.084 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.103.085 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.103.086 I llm_load_print_meta: n_ff             = 8192
0.00.103.086 I llm_load_print_meta: n_expert         = 0
0.00.103.086 I llm_load_print_meta: n_expert_used    = 0
0.00.103.086 I llm_load_print_meta: causal attn      = 1
0.00.103.086 I llm_load_print_meta: pooling type     = 0
0.00.103.087 I llm_load_print_meta: rope type        = 2
0.00.103.087 I llm_load_print_meta: rope scaling     = linear
0.00.103.087 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.103.093 I llm_load_print_meta: freq_scale_train = 1
0.00.103.093 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.103.094 I llm_load_print_meta: rope_finetuned   = unknown
0.00.103.094 I llm_load_print_meta: ssm_d_conv       = 0
0.00.103.094 I llm_load_print_meta: ssm_d_inner      = 0
0.00.103.096 I llm_load_print_meta: ssm_d_state      = 0
0.00.103.096 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.103.096 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.103.114 I llm_load_print_meta: model type       = 1.4B
0.00.103.119 I llm_load_print_meta: model ftype      = Q4_0
0.00.103.119 I llm_load_print_meta: model params     = 1.41 B
0.00.103.120 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.103.120 I llm_load_print_meta: general.name     = 1.4B
0.00.103.120 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.103.121 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.103.121 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.103.121 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.103.122 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.103.122 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.103.122 I llm_load_print_meta: max token length = 1024
0.00.106.152 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.106.152 I llm_load_tensors: offloading output layer to GPU
0.00.106.153 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.106.164 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.106.166 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.107.605 I llama_new_context_with_model: n_seq_max     = 1
0.00.107.606 I llama_new_context_with_model: n_ctx         = 2048
0.00.107.607 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.107.607 I llama_new_context_with_model: n_batch       = 2048
0.00.107.607 I llama_new_context_with_model: n_ubatch      = 512
0.00.107.608 I llama_new_context_with_model: flash_attn    = 0
0.00.107.608 I llama_new_context_with_model: freq_base     = 10000.0
0.00.107.608 I llama_new_context_with_model: freq_scale    = 1
0.00.107.609 I ggml_metal_init: allocating
0.00.107.613 I ggml_metal_init: found device: Apple M4
0.00.107.616 I ggml_metal_init: picking default device: Apple M4
0.00.108.519 I ggml_metal_init: using embedded metal library
0.00.111.633 I ggml_metal_init: GPU name:   Apple M4
0.00.111.635 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.111.636 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.111.636 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.111.637 I ggml_metal_init: simdgroup reduction   = true
0.00.111.637 I ggml_metal_init: simdgroup matrix mul. = true
0.00.111.637 I ggml_metal_init: has bfloat            = true
0.00.111.637 I ggml_metal_init: use bfloat            = true
0.00.111.638 I ggml_metal_init: hasUnifiedMemory      = true
0.00.111.638 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.146.304 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.146.314 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.146.340 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.147.402 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.147.403 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.147.403 I llama_new_context_with_model: graph nodes  = 967
0.00.147.403 I llama_new_context_with_model: graph splits = 2
0.00.147.428 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.839.566 I main: llama threadpool init, n_threads = 4
0.00.839.612 I 
0.00.839.632 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.839.633 I 
0.00.839.868 I sampler seed: 1234
0.00.839.873 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.839.894 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.839.895 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.839.895 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.510.001 I llama_perf_sampler_print:    sampling time =       1.26 ms /    71 runs   (    0.02 ms per token, 56259.90 tokens per second)
0.01.510.001 I llama_perf_context_print:        load time =     816.76 ms
0.01.510.002 I llama_perf_context_print: prompt eval time =      32.74 ms /     7 tokens (    4.68 ms per token,   213.83 tokens per second)
0.01.510.003 I llama_perf_context_print:        eval time =     634.30 ms /    63 runs   (   10.07 ms per token,    99.32 tokens per second)
0.01.510.003 I llama_perf_context_print:       total time =     670.44 ms /    70 tokens
0.01.510.175 I ggml_metal_free: deallocating

real	0m1.533s
user	0m0.139s
sys	0m0.219s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.248 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.356 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.185 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.017.189 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.195 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.195 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.195 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.196 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.196 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.198 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.199 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.199 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.199 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.200 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.200 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.203 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.205 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.205 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.206 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.982 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.000 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.720 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.721 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.722 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.722 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.722 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.723 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.025.723 I llama_model_loader: - type  f32:  194 tensors
0.00.025.723 I llama_model_loader: - type q4_0:   97 tensors
0.00.025.724 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.207 I llm_load_vocab: special tokens cache size = 25
0.00.052.289 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.291 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.292 I llm_load_print_meta: arch             = gptneox
0.00.052.292 I llm_load_print_meta: vocab type       = BPE
0.00.052.292 I llm_load_print_meta: n_vocab          = 50304
0.00.052.293 I llm_load_print_meta: n_merges         = 50009
0.00.052.293 I llm_load_print_meta: vocab_only       = 0
0.00.052.293 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.293 I llm_load_print_meta: n_embd           = 2048
0.00.052.293 I llm_load_print_meta: n_layer          = 24
0.00.052.296 I llm_load_print_meta: n_head           = 16
0.00.052.296 I llm_load_print_meta: n_head_kv        = 16
0.00.052.296 I llm_load_print_meta: n_rot            = 32
0.00.052.297 I llm_load_print_meta: n_swa            = 0
0.00.052.297 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.297 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.298 I llm_load_print_meta: n_gqa            = 1
0.00.052.300 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.301 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.301 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.302 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.302 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.302 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.302 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.303 I llm_load_print_meta: n_ff             = 8192
0.00.052.303 I llm_load_print_meta: n_expert         = 0
0.00.052.303 I llm_load_print_meta: n_expert_used    = 0
0.00.052.303 I llm_load_print_meta: causal attn      = 1
0.00.052.303 I llm_load_print_meta: pooling type     = 0
0.00.052.303 I llm_load_print_meta: rope type        = 2
0.00.052.304 I llm_load_print_meta: rope scaling     = linear
0.00.052.304 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.304 I llm_load_print_meta: freq_scale_train = 1
0.00.052.305 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.305 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.307 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.307 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.307 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.307 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.307 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.318 I llm_load_print_meta: model type       = 1.4B
0.00.052.319 I llm_load_print_meta: model ftype      = Q4_0
0.00.052.319 I llm_load_print_meta: model params     = 1.41 B
0.00.052.319 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.052.320 I llm_load_print_meta: general.name     = 1.4B
0.00.052.320 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.320 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.320 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.320 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.320 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.321 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.321 I llm_load_print_meta: max token length = 1024
0.00.053.873 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.873 I llm_load_tensors: offloading output layer to GPU
0.00.053.874 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.883 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.053.884 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.054.744 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.745 I llama_new_context_with_model: n_ctx         = 128
0.00.054.745 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.745 I llama_new_context_with_model: n_batch       = 128
0.00.054.746 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.746 I llama_new_context_with_model: flash_attn    = 0
0.00.054.746 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.746 I llama_new_context_with_model: freq_scale    = 1
0.00.054.747 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.747 I ggml_metal_init: allocating
0.00.054.750 I ggml_metal_init: found device: Apple M4
0.00.054.752 I ggml_metal_init: picking default device: Apple M4
0.00.055.290 I ggml_metal_init: using embedded metal library
0.00.057.230 I ggml_metal_init: GPU name:   Apple M4
0.00.057.232 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.232 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.232 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.233 I ggml_metal_init: simdgroup reduction   = true
0.00.057.233 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.233 I ggml_metal_init: has bfloat            = true
0.00.057.233 I ggml_metal_init: use bfloat            = true
0.00.057.233 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.234 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.468 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.470 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.483 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.067.397 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.067.398 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.067.398 I llama_new_context_with_model: graph nodes  = 967
0.00.067.398 I llama_new_context_with_model: graph splits = 2
0.00.067.410 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.656.919 I 
0.00.656.955 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.656.987 I perplexity: tokenizing the input ..
0.00.665.232 I perplexity: tokenization took 8.245 ms
0.00.665.235 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.787.360 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.788.554 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.788.569 I llama_perf_context_print:        load time =     645.56 ms
0.00.788.570 I llama_perf_context_print: prompt eval time =     121.90 ms /   128 tokens (    0.95 ms per token,  1050.02 tokens per second)
0.00.788.571 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.788.571 I llama_perf_context_print:       total time =     131.65 ms /   129 tokens
0.00.789.018 I ggml_metal_free: deallocating

real	0m0.803s
user	0m0.077s
sys	0m0.112s
```
- q4_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.667 I main: llama backend init
0.00.001.669 I main: load the model and apply lora adapter, if any
0.00.010.774 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.751 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.017.756 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.762 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.762 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.763 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.763 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.763 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.764 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.764 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.765 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.765 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.766 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.766 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.766 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.768 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.768 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.768 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.634 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.688 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.453 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.454 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.454 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.454 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.455 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.455 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.026.456 I llama_model_loader: - type  f32:  194 tensors
0.00.026.456 I llama_model_loader: - type q4_1:   97 tensors
0.00.026.456 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.416 I llm_load_vocab: special tokens cache size = 25
0.00.052.333 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.336 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.336 I llm_load_print_meta: arch             = gptneox
0.00.052.336 I llm_load_print_meta: vocab type       = BPE
0.00.052.337 I llm_load_print_meta: n_vocab          = 50304
0.00.052.337 I llm_load_print_meta: n_merges         = 50009
0.00.052.337 I llm_load_print_meta: vocab_only       = 0
0.00.052.337 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.337 I llm_load_print_meta: n_embd           = 2048
0.00.052.337 I llm_load_print_meta: n_layer          = 24
0.00.052.340 I llm_load_print_meta: n_head           = 16
0.00.052.341 I llm_load_print_meta: n_head_kv        = 16
0.00.052.341 I llm_load_print_meta: n_rot            = 32
0.00.052.341 I llm_load_print_meta: n_swa            = 0
0.00.052.341 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.341 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.342 I llm_load_print_meta: n_gqa            = 1
0.00.052.343 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.343 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.344 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.344 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.345 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.345 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.345 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.346 I llm_load_print_meta: n_ff             = 8192
0.00.052.346 I llm_load_print_meta: n_expert         = 0
0.00.052.346 I llm_load_print_meta: n_expert_used    = 0
0.00.052.346 I llm_load_print_meta: causal attn      = 1
0.00.052.346 I llm_load_print_meta: pooling type     = 0
0.00.052.346 I llm_load_print_meta: rope type        = 2
0.00.052.347 I llm_load_print_meta: rope scaling     = linear
0.00.052.347 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.347 I llm_load_print_meta: freq_scale_train = 1
0.00.052.348 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.348 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.348 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.348 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.348 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.349 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.349 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.361 I llm_load_print_meta: model type       = 1.4B
0.00.052.363 I llm_load_print_meta: model ftype      = Q4_1
0.00.052.363 I llm_load_print_meta: model params     = 1.41 B
0.00.052.364 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.052.364 I llm_load_print_meta: general.name     = 1.4B
0.00.052.364 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.364 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.364 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.364 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.365 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.365 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.365 I llm_load_print_meta: max token length = 1024
0.00.054.370 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.370 I llm_load_tensors: offloading output layer to GPU
0.00.054.370 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.380 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.054.381 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.055.289 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.290 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.290 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.290 I llama_new_context_with_model: n_batch       = 2048
0.00.055.290 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.290 I llama_new_context_with_model: flash_attn    = 0
0.00.055.291 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.291 I llama_new_context_with_model: freq_scale    = 1
0.00.055.292 I ggml_metal_init: allocating
0.00.055.297 I ggml_metal_init: found device: Apple M4
0.00.055.299 I ggml_metal_init: picking default device: Apple M4
0.00.055.840 I ggml_metal_init: using embedded metal library
0.00.057.796 I ggml_metal_init: GPU name:   Apple M4
0.00.057.797 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.798 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.798 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.798 I ggml_metal_init: simdgroup reduction   = true
0.00.057.798 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.799 I ggml_metal_init: has bfloat            = true
0.00.057.799 I ggml_metal_init: use bfloat            = true
0.00.057.799 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.800 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.030 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.042 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.062 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.005 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.006 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.007 I llama_new_context_with_model: graph nodes  = 967
0.00.086.007 I llama_new_context_with_model: graph splits = 2
0.00.086.030 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.723.680 I main: llama threadpool init, n_threads = 4
0.00.723.713 I 
0.00.723.758 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.723.760 I 
0.00.723.980 I sampler seed: 1234
0.00.723.986 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.724.044 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.724.046 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.724.046 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.440.908 I llama_perf_sampler_print:    sampling time =       1.08 ms /    71 runs   (    0.02 ms per token, 65619.22 tokens per second)
0.01.440.909 I llama_perf_context_print:        load time =     712.90 ms
0.01.440.909 I llama_perf_context_print: prompt eval time =      32.79 ms /     7 tokens (    4.68 ms per token,   213.51 tokens per second)
0.01.440.910 I llama_perf_context_print:        eval time =     681.25 ms /    63 runs   (   10.81 ms per token,    92.48 tokens per second)
0.01.440.914 I llama_perf_context_print:       total time =     717.23 ms /    70 tokens
0.01.441.100 I ggml_metal_free: deallocating

real	0m1.456s
user	0m0.106s
sys	0m0.179s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.539 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.361 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.016.364 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.365 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.366 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.366 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.366 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.367 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.367 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.368 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.368 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.368 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.371 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.371 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.371 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.373 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.373 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.374 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.079 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.129 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.917 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.918 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.918 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.919 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.919 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.919 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.024.920 I llama_model_loader: - type  f32:  194 tensors
0.00.024.920 I llama_model_loader: - type q4_1:   97 tensors
0.00.024.920 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.565 I llm_load_vocab: special tokens cache size = 25
0.00.050.624 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.627 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.627 I llm_load_print_meta: arch             = gptneox
0.00.050.627 I llm_load_print_meta: vocab type       = BPE
0.00.050.627 I llm_load_print_meta: n_vocab          = 50304
0.00.050.627 I llm_load_print_meta: n_merges         = 50009
0.00.050.628 I llm_load_print_meta: vocab_only       = 0
0.00.050.628 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.628 I llm_load_print_meta: n_embd           = 2048
0.00.050.628 I llm_load_print_meta: n_layer          = 24
0.00.050.631 I llm_load_print_meta: n_head           = 16
0.00.050.632 I llm_load_print_meta: n_head_kv        = 16
0.00.050.632 I llm_load_print_meta: n_rot            = 32
0.00.050.634 I llm_load_print_meta: n_swa            = 0
0.00.050.634 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.634 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.635 I llm_load_print_meta: n_gqa            = 1
0.00.050.636 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.636 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.637 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.637 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.637 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.637 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.638 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.638 I llm_load_print_meta: n_ff             = 8192
0.00.050.638 I llm_load_print_meta: n_expert         = 0
0.00.050.639 I llm_load_print_meta: n_expert_used    = 0
0.00.050.639 I llm_load_print_meta: causal attn      = 1
0.00.050.639 I llm_load_print_meta: pooling type     = 0
0.00.050.639 I llm_load_print_meta: rope type        = 2
0.00.050.639 I llm_load_print_meta: rope scaling     = linear
0.00.050.640 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.640 I llm_load_print_meta: freq_scale_train = 1
0.00.050.640 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.641 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.641 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.641 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.641 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.641 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.641 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.648 I llm_load_print_meta: model type       = 1.4B
0.00.050.648 I llm_load_print_meta: model ftype      = Q4_1
0.00.050.649 I llm_load_print_meta: model params     = 1.41 B
0.00.050.649 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.050.649 I llm_load_print_meta: general.name     = 1.4B
0.00.050.650 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.650 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.650 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.650 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.650 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.651 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.651 I llm_load_print_meta: max token length = 1024
0.00.052.423 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.423 I llm_load_tensors: offloading output layer to GPU
0.00.052.423 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.428 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.052.430 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.053.313 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.314 I llama_new_context_with_model: n_ctx         = 128
0.00.053.314 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.314 I llama_new_context_with_model: n_batch       = 128
0.00.053.314 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.314 I llama_new_context_with_model: flash_attn    = 0
0.00.053.315 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.315 I llama_new_context_with_model: freq_scale    = 1
0.00.053.315 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.315 I ggml_metal_init: allocating
0.00.053.318 I ggml_metal_init: found device: Apple M4
0.00.053.320 I ggml_metal_init: picking default device: Apple M4
0.00.053.854 I ggml_metal_init: using embedded metal library
0.00.055.733 I ggml_metal_init: GPU name:   Apple M4
0.00.055.735 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.735 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.736 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.736 I ggml_metal_init: simdgroup reduction   = true
0.00.055.736 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.736 I ggml_metal_init: has bfloat            = true
0.00.055.736 I ggml_metal_init: use bfloat            = true
0.00.055.737 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.737 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.645 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.650 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.664 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.575 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.576 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.576 I llama_new_context_with_model: graph nodes  = 967
0.00.065.577 I llama_new_context_with_model: graph splits = 2
0.00.065.584 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.632.882 I 
0.00.632.915 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.632.943 I perplexity: tokenizing the input ..
0.00.640.908 I perplexity: tokenization took 7.964 ms
0.00.640.916 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.763.599 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.765.038 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.765.054 I llama_perf_context_print:        load time =     622.34 ms
0.00.765.055 I llama_perf_context_print: prompt eval time =     122.45 ms /   128 tokens (    0.96 ms per token,  1045.30 tokens per second)
0.00.765.056 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.765.057 I llama_perf_context_print:       total time =     132.17 ms /   129 tokens
0.00.765.448 I ggml_metal_free: deallocating

real	0m0.778s
user	0m0.074s
sys	0m0.106s
```
- q5_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.660 I main: llama backend init
0.00.001.662 I main: load the model and apply lora adapter, if any
0.00.013.821 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.020.262 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.020.266 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.020.267 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.020.267 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.020.268 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.020.268 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.020.268 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.020.269 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.020.269 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.020.269 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.020.270 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.020.270 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.020.270 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.020.271 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.020.273 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.020.274 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.020.274 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.024.079 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.025.163 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.985 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.986 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.987 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.987 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.987 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.988 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.028.988 I llama_model_loader: - type  f32:  194 tensors
0.00.028.989 I llama_model_loader: - type q5_0:   97 tensors
0.00.028.989 I llama_model_loader: - type q6_K:    1 tensors
0.00.048.915 I llm_load_vocab: special tokens cache size = 25
0.00.054.993 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.054.996 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.054.996 I llm_load_print_meta: arch             = gptneox
0.00.054.997 I llm_load_print_meta: vocab type       = BPE
0.00.054.997 I llm_load_print_meta: n_vocab          = 50304
0.00.054.997 I llm_load_print_meta: n_merges         = 50009
0.00.054.997 I llm_load_print_meta: vocab_only       = 0
0.00.054.997 I llm_load_print_meta: n_ctx_train      = 2048
0.00.054.998 I llm_load_print_meta: n_embd           = 2048
0.00.054.998 I llm_load_print_meta: n_layer          = 24
0.00.055.001 I llm_load_print_meta: n_head           = 16
0.00.055.002 I llm_load_print_meta: n_head_kv        = 16
0.00.055.002 I llm_load_print_meta: n_rot            = 32
0.00.055.002 I llm_load_print_meta: n_swa            = 0
0.00.055.002 I llm_load_print_meta: n_embd_head_k    = 128
0.00.055.002 I llm_load_print_meta: n_embd_head_v    = 128
0.00.055.003 I llm_load_print_meta: n_gqa            = 1
0.00.055.004 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.055.005 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.055.005 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.055.007 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.055.008 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.055.009 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.055.009 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.055.009 I llm_load_print_meta: n_ff             = 8192
0.00.055.010 I llm_load_print_meta: n_expert         = 0
0.00.055.010 I llm_load_print_meta: n_expert_used    = 0
0.00.055.011 I llm_load_print_meta: causal attn      = 1
0.00.055.011 I llm_load_print_meta: pooling type     = 0
0.00.055.012 I llm_load_print_meta: rope type        = 2
0.00.055.012 I llm_load_print_meta: rope scaling     = linear
0.00.055.012 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.055.012 I llm_load_print_meta: freq_scale_train = 1
0.00.055.013 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.055.013 I llm_load_print_meta: rope_finetuned   = unknown
0.00.055.013 I llm_load_print_meta: ssm_d_conv       = 0
0.00.055.013 I llm_load_print_meta: ssm_d_inner      = 0
0.00.055.013 I llm_load_print_meta: ssm_d_state      = 0
0.00.055.013 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.055.013 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.055.025 I llm_load_print_meta: model type       = 1.4B
0.00.055.027 I llm_load_print_meta: model ftype      = Q5_0
0.00.055.028 I llm_load_print_meta: model params     = 1.41 B
0.00.055.028 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.055.028 I llm_load_print_meta: general.name     = 1.4B
0.00.055.029 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.055.029 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.055.029 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.055.029 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.055.029 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.055.030 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.055.030 I llm_load_print_meta: max token length = 1024
0.00.057.039 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.057.039 I llm_load_tensors: offloading output layer to GPU
0.00.057.039 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.057.049 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.057.050 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.057.987 I llama_new_context_with_model: n_seq_max     = 1
0.00.057.987 I llama_new_context_with_model: n_ctx         = 2048
0.00.057.988 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.057.988 I llama_new_context_with_model: n_batch       = 2048
0.00.057.988 I llama_new_context_with_model: n_ubatch      = 512
0.00.057.988 I llama_new_context_with_model: flash_attn    = 0
0.00.057.989 I llama_new_context_with_model: freq_base     = 10000.0
0.00.057.989 I llama_new_context_with_model: freq_scale    = 1
0.00.057.989 I ggml_metal_init: allocating
0.00.057.996 I ggml_metal_init: found device: Apple M4
0.00.057.998 I ggml_metal_init: picking default device: Apple M4
0.00.058.564 I ggml_metal_init: using embedded metal library
0.00.060.503 I ggml_metal_init: GPU name:   Apple M4
0.00.060.504 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.060.506 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.060.507 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.060.507 I ggml_metal_init: simdgroup reduction   = true
0.00.060.507 I ggml_metal_init: simdgroup matrix mul. = true
0.00.060.507 I ggml_metal_init: has bfloat            = true
0.00.060.507 I ggml_metal_init: use bfloat            = true
0.00.060.508 I ggml_metal_init: hasUnifiedMemory      = true
0.00.060.508 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.090.276 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.090.285 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.090.303 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.091.358 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.091.359 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.091.359 I llama_new_context_with_model: graph nodes  = 967
0.00.091.360 I llama_new_context_with_model: graph splits = 2
0.00.091.382 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.837.045 I main: llama threadpool init, n_threads = 4
0.00.837.091 I 
0.00.837.110 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.837.110 I 
0.00.837.296 I sampler seed: 1234
0.00.837.300 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.837.331 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.837.333 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.837.334 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.622.167 I llama_perf_sampler_print:    sampling time =       1.18 ms /    71 runs   (    0.02 ms per token, 60169.49 tokens per second)
0.01.622.168 I llama_perf_context_print:        load time =     823.22 ms
0.01.622.169 I llama_perf_context_print: prompt eval time =      36.61 ms /     7 tokens (    5.23 ms per token,   191.21 tokens per second)
0.01.622.170 I llama_perf_context_print:        eval time =     745.30 ms /    63 runs   (   11.83 ms per token,    84.53 tokens per second)
0.01.622.170 I llama_perf_context_print:       total time =     785.12 ms /    70 tokens
0.01.622.360 I ggml_metal_free: deallocating

real	0m1.638s
user	0m0.107s
sys	0m0.199s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.087 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.325 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.064 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.017.070 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.071 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.072 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.072 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.072 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.074 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.075 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.075 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.075 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.076 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.076 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.076 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.077 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.078 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.078 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.079 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.806 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.881 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.675 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.676 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.677 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.677 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.677 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.677 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.025.678 I llama_model_loader: - type  f32:  194 tensors
0.00.025.678 I llama_model_loader: - type q5_0:   97 tensors
0.00.025.678 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.290 I llm_load_vocab: special tokens cache size = 25
0.00.051.236 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.239 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.239 I llm_load_print_meta: arch             = gptneox
0.00.051.239 I llm_load_print_meta: vocab type       = BPE
0.00.051.240 I llm_load_print_meta: n_vocab          = 50304
0.00.051.240 I llm_load_print_meta: n_merges         = 50009
0.00.051.240 I llm_load_print_meta: vocab_only       = 0
0.00.051.240 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.240 I llm_load_print_meta: n_embd           = 2048
0.00.051.241 I llm_load_print_meta: n_layer          = 24
0.00.051.244 I llm_load_print_meta: n_head           = 16
0.00.051.245 I llm_load_print_meta: n_head_kv        = 16
0.00.051.245 I llm_load_print_meta: n_rot            = 32
0.00.051.246 I llm_load_print_meta: n_swa            = 0
0.00.051.246 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.246 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.247 I llm_load_print_meta: n_gqa            = 1
0.00.051.247 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.248 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.249 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.249 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.249 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.249 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.249 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.250 I llm_load_print_meta: n_ff             = 8192
0.00.051.250 I llm_load_print_meta: n_expert         = 0
0.00.051.250 I llm_load_print_meta: n_expert_used    = 0
0.00.051.250 I llm_load_print_meta: causal attn      = 1
0.00.051.251 I llm_load_print_meta: pooling type     = 0
0.00.051.251 I llm_load_print_meta: rope type        = 2
0.00.051.251 I llm_load_print_meta: rope scaling     = linear
0.00.051.251 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.252 I llm_load_print_meta: freq_scale_train = 1
0.00.051.252 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.252 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.252 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.252 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.253 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.253 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.253 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.259 I llm_load_print_meta: model type       = 1.4B
0.00.051.260 I llm_load_print_meta: model ftype      = Q5_0
0.00.051.260 I llm_load_print_meta: model params     = 1.41 B
0.00.051.261 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.051.261 I llm_load_print_meta: general.name     = 1.4B
0.00.051.261 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.261 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.261 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.263 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.263 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.263 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.264 I llm_load_print_meta: max token length = 1024
0.00.052.808 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.808 I llm_load_tensors: offloading output layer to GPU
0.00.052.808 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.813 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.052.814 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.053.616 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.616 I llama_new_context_with_model: n_ctx         = 128
0.00.053.617 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.617 I llama_new_context_with_model: n_batch       = 128
0.00.053.617 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.617 I llama_new_context_with_model: flash_attn    = 0
0.00.053.618 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.618 I llama_new_context_with_model: freq_scale    = 1
0.00.053.618 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.619 I ggml_metal_init: allocating
0.00.053.622 I ggml_metal_init: found device: Apple M4
0.00.053.624 I ggml_metal_init: picking default device: Apple M4
0.00.054.158 I ggml_metal_init: using embedded metal library
0.00.056.279 I ggml_metal_init: GPU name:   Apple M4
0.00.056.280 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.280 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.281 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.281 I ggml_metal_init: simdgroup reduction   = true
0.00.056.281 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.281 I ggml_metal_init: has bfloat            = true
0.00.056.281 I ggml_metal_init: use bfloat            = true
0.00.056.282 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.282 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.368 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.372 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.386 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.268 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.269 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.269 I llama_new_context_with_model: graph nodes  = 967
0.00.066.270 I llama_new_context_with_model: graph splits = 2
0.00.066.282 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.750.631 I 
0.00.750.663 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.750.697 I perplexity: tokenizing the input ..
0.00.758.298 I perplexity: tokenization took 7.6 ms
0.00.758.301 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.893.041 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.894.197 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.894.212 I llama_perf_context_print:        load time =     739.30 ms
0.00.894.213 I llama_perf_context_print: prompt eval time =     134.49 ms /   128 tokens (    1.05 ms per token,   951.77 tokens per second)
0.00.894.214 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.894.214 I llama_perf_context_print:       total time =     143.58 ms /   129 tokens
0.00.894.604 I ggml_metal_free: deallocating

real	0m0.909s
user	0m0.076s
sys	0m0.128s
```
- q5_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.661 I main: llama backend init
0.00.001.663 I main: load the model and apply lora adapter, if any
0.00.010.253 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.479 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.016.483 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.484 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.490 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.490 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.490 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.490 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.491 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.492 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.492 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.492 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.493 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.493 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.493 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.495 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.495 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.495 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.482 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.539 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.454 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.455 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.455 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.456 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.456 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.456 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.025.457 I llama_model_loader: - type  f32:  194 tensors
0.00.025.457 I llama_model_loader: - type q5_1:   97 tensors
0.00.025.457 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.182 I llm_load_vocab: special tokens cache size = 25
0.00.052.087 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.090 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.090 I llm_load_print_meta: arch             = gptneox
0.00.052.091 I llm_load_print_meta: vocab type       = BPE
0.00.052.091 I llm_load_print_meta: n_vocab          = 50304
0.00.052.091 I llm_load_print_meta: n_merges         = 50009
0.00.052.091 I llm_load_print_meta: vocab_only       = 0
0.00.052.091 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.091 I llm_load_print_meta: n_embd           = 2048
0.00.052.092 I llm_load_print_meta: n_layer          = 24
0.00.052.094 I llm_load_print_meta: n_head           = 16
0.00.052.095 I llm_load_print_meta: n_head_kv        = 16
0.00.052.095 I llm_load_print_meta: n_rot            = 32
0.00.052.095 I llm_load_print_meta: n_swa            = 0
0.00.052.095 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.096 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.098 I llm_load_print_meta: n_gqa            = 1
0.00.052.099 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.100 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.100 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.101 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.102 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.102 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.102 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.103 I llm_load_print_meta: n_ff             = 8192
0.00.052.103 I llm_load_print_meta: n_expert         = 0
0.00.052.104 I llm_load_print_meta: n_expert_used    = 0
0.00.052.104 I llm_load_print_meta: causal attn      = 1
0.00.052.104 I llm_load_print_meta: pooling type     = 0
0.00.052.104 I llm_load_print_meta: rope type        = 2
0.00.052.104 I llm_load_print_meta: rope scaling     = linear
0.00.052.106 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.106 I llm_load_print_meta: freq_scale_train = 1
0.00.052.106 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.106 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.107 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.107 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.107 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.107 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.107 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.119 I llm_load_print_meta: model type       = 1.4B
0.00.052.119 I llm_load_print_meta: model ftype      = Q5_1
0.00.052.119 I llm_load_print_meta: model params     = 1.41 B
0.00.052.120 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.052.120 I llm_load_print_meta: general.name     = 1.4B
0.00.052.120 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.120 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.122 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.122 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.122 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.123 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.123 I llm_load_print_meta: max token length = 1024
0.00.053.663 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.663 I llm_load_tensors: offloading output layer to GPU
0.00.053.663 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.673 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.053.674 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.054.525 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.526 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.526 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.526 I llama_new_context_with_model: n_batch       = 2048
0.00.054.527 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.527 I llama_new_context_with_model: flash_attn    = 0
0.00.054.527 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.527 I llama_new_context_with_model: freq_scale    = 1
0.00.054.528 I ggml_metal_init: allocating
0.00.054.531 I ggml_metal_init: found device: Apple M4
0.00.054.532 I ggml_metal_init: picking default device: Apple M4
0.00.055.108 I ggml_metal_init: using embedded metal library
0.00.057.011 I ggml_metal_init: GPU name:   Apple M4
0.00.057.013 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.013 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.013 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.013 I ggml_metal_init: simdgroup reduction   = true
0.00.057.014 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.014 I ggml_metal_init: has bfloat            = true
0.00.057.014 I ggml_metal_init: use bfloat            = true
0.00.057.014 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.015 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.083.653 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.083.659 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.083.678 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.084.523 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.084.524 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.084.525 I llama_new_context_with_model: graph nodes  = 967
0.00.084.525 I llama_new_context_with_model: graph splits = 2
0.00.084.536 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.760.128 I main: llama threadpool init, n_threads = 4
0.00.760.161 I 
0.00.760.203 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.760.204 I 
0.00.760.337 I sampler seed: 1234
0.00.760.342 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.760.352 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.760.354 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.760.354 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, literature and art.

If one's life is not happy, one can have no other way but

0.01.596.081 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59764.31 tokens per second)
0.01.596.081 I llama_perf_context_print:        load time =     749.87 ms
0.01.596.082 I llama_perf_context_print: prompt eval time =      36.55 ms /     7 tokens (    5.22 ms per token,   191.52 tokens per second)
0.01.596.083 I llama_perf_context_print:        eval time =     796.21 ms /    63 runs   (   12.64 ms per token,    79.12 tokens per second)
0.01.596.083 I llama_perf_context_print:       total time =     835.95 ms /    70 tokens
0.01.596.250 I ggml_metal_free: deallocating

real	0m1.609s
user	0m0.108s
sys	0m0.192s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.085 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.388 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.923 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.015.928 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.930 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.930 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.931 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.932 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.932 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.933 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.933 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.933 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.934 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.934 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.934 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.935 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.937 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.938 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.938 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.714 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.739 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.448 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.449 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.449 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.450 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.450 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.450 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.024.451 I llama_model_loader: - type  f32:  194 tensors
0.00.024.451 I llama_model_loader: - type q5_1:   97 tensors
0.00.024.451 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.946 I llm_load_vocab: special tokens cache size = 25
0.00.051.201 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.204 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.204 I llm_load_print_meta: arch             = gptneox
0.00.051.204 I llm_load_print_meta: vocab type       = BPE
0.00.051.205 I llm_load_print_meta: n_vocab          = 50304
0.00.051.205 I llm_load_print_meta: n_merges         = 50009
0.00.051.205 I llm_load_print_meta: vocab_only       = 0
0.00.051.205 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.205 I llm_load_print_meta: n_embd           = 2048
0.00.051.206 I llm_load_print_meta: n_layer          = 24
0.00.051.208 I llm_load_print_meta: n_head           = 16
0.00.051.209 I llm_load_print_meta: n_head_kv        = 16
0.00.051.211 I llm_load_print_meta: n_rot            = 32
0.00.051.211 I llm_load_print_meta: n_swa            = 0
0.00.051.212 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.212 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.212 I llm_load_print_meta: n_gqa            = 1
0.00.051.213 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.214 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.215 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.215 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.215 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.215 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.216 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.216 I llm_load_print_meta: n_ff             = 8192
0.00.051.216 I llm_load_print_meta: n_expert         = 0
0.00.051.217 I llm_load_print_meta: n_expert_used    = 0
0.00.051.217 I llm_load_print_meta: causal attn      = 1
0.00.051.218 I llm_load_print_meta: pooling type     = 0
0.00.051.219 I llm_load_print_meta: rope type        = 2
0.00.051.219 I llm_load_print_meta: rope scaling     = linear
0.00.051.220 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.220 I llm_load_print_meta: freq_scale_train = 1
0.00.051.220 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.220 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.221 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.222 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.222 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.222 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.222 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.234 I llm_load_print_meta: model type       = 1.4B
0.00.051.234 I llm_load_print_meta: model ftype      = Q5_1
0.00.051.235 I llm_load_print_meta: model params     = 1.41 B
0.00.051.235 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.051.235 I llm_load_print_meta: general.name     = 1.4B
0.00.051.236 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.236 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.236 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.236 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.236 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.237 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.237 I llm_load_print_meta: max token length = 1024
0.00.052.727 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.727 I llm_load_tensors: offloading output layer to GPU
0.00.052.727 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.737 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.052.738 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.053.554 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.555 I llama_new_context_with_model: n_ctx         = 128
0.00.053.555 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.555 I llama_new_context_with_model: n_batch       = 128
0.00.053.556 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.556 I llama_new_context_with_model: flash_attn    = 0
0.00.053.556 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.556 I llama_new_context_with_model: freq_scale    = 1
0.00.053.557 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.557 I ggml_metal_init: allocating
0.00.053.560 I ggml_metal_init: found device: Apple M4
0.00.053.562 I ggml_metal_init: picking default device: Apple M4
0.00.054.089 I ggml_metal_init: using embedded metal library
0.00.056.024 I ggml_metal_init: GPU name:   Apple M4
0.00.056.025 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.025 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.026 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.026 I ggml_metal_init: simdgroup reduction   = true
0.00.056.026 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.026 I ggml_metal_init: has bfloat            = true
0.00.056.027 I ggml_metal_init: use bfloat            = true
0.00.056.027 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.028 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.997 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.004 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.021 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.910 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.911 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.911 I llama_new_context_with_model: graph nodes  = 967
0.00.065.912 I llama_new_context_with_model: graph splits = 2
0.00.065.923 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.684.233 I 
0.00.684.255 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.684.267 I perplexity: tokenizing the input ..
0.00.691.916 I perplexity: tokenization took 7.648 ms
0.00.691.919 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.826.857 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.828.108 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.828.117 I llama_perf_context_print:        load time =     673.84 ms
0.00.828.117 I llama_perf_context_print: prompt eval time =     134.71 ms /   128 tokens (    1.05 ms per token,   950.18 tokens per second)
0.00.828.120 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.828.120 I llama_perf_context_print:       total time =     143.88 ms /   129 tokens
0.00.828.602 I ggml_metal_free: deallocating

real	0m0.841s
user	0m0.077s
sys	0m0.129s
```
- q2_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.908 I main: llama backend init
0.00.001.910 I main: load the model and apply lora adapter, if any
0.00.012.762 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.198 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.018.204 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.206 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.207 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.207 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.207 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.208 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.208 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.209 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.209 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.209 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.210 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.210 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.210 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.212 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.212 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.212 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.944 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.967 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.695 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.696 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.696 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.696 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.697 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.697 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.026.697 I llama_model_loader: - type  f32:  194 tensors
0.00.026.698 I llama_model_loader: - type q2_K:   49 tensors
0.00.026.698 I llama_model_loader: - type q3_K:   48 tensors
0.00.026.698 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.395 I llm_load_vocab: special tokens cache size = 25
0.00.052.449 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.451 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.452 I llm_load_print_meta: arch             = gptneox
0.00.052.452 I llm_load_print_meta: vocab type       = BPE
0.00.052.452 I llm_load_print_meta: n_vocab          = 50304
0.00.052.453 I llm_load_print_meta: n_merges         = 50009
0.00.052.453 I llm_load_print_meta: vocab_only       = 0
0.00.052.453 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.453 I llm_load_print_meta: n_embd           = 2048
0.00.052.453 I llm_load_print_meta: n_layer          = 24
0.00.052.456 I llm_load_print_meta: n_head           = 16
0.00.052.457 I llm_load_print_meta: n_head_kv        = 16
0.00.052.457 I llm_load_print_meta: n_rot            = 32
0.00.052.457 I llm_load_print_meta: n_swa            = 0
0.00.052.457 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.457 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.458 I llm_load_print_meta: n_gqa            = 1
0.00.052.459 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.459 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.460 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.460 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.460 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.461 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.463 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.464 I llm_load_print_meta: n_ff             = 8192
0.00.052.464 I llm_load_print_meta: n_expert         = 0
0.00.052.464 I llm_load_print_meta: n_expert_used    = 0
0.00.052.464 I llm_load_print_meta: causal attn      = 1
0.00.052.464 I llm_load_print_meta: pooling type     = 0
0.00.052.465 I llm_load_print_meta: rope type        = 2
0.00.052.465 I llm_load_print_meta: rope scaling     = linear
0.00.052.465 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.465 I llm_load_print_meta: freq_scale_train = 1
0.00.052.466 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.466 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.466 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.466 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.466 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.467 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.467 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.473 I llm_load_print_meta: model type       = 1.4B
0.00.052.473 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.052.474 I llm_load_print_meta: model params     = 1.41 B
0.00.052.474 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.052.474 I llm_load_print_meta: general.name     = 1.4B
0.00.052.475 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.475 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.475 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.475 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.475 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.476 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.476 I llm_load_print_meta: max token length = 1024
0.00.054.002 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.002 I llm_load_tensors: offloading output layer to GPU
0.00.054.002 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.006 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.054.007 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.054.846 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.847 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.847 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.848 I llama_new_context_with_model: n_batch       = 2048
0.00.054.848 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.848 I llama_new_context_with_model: flash_attn    = 0
0.00.054.848 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.849 I llama_new_context_with_model: freq_scale    = 1
0.00.054.849 I ggml_metal_init: allocating
0.00.054.852 I ggml_metal_init: found device: Apple M4
0.00.054.854 I ggml_metal_init: picking default device: Apple M4
0.00.055.394 I ggml_metal_init: using embedded metal library
0.00.057.507 I ggml_metal_init: GPU name:   Apple M4
0.00.057.508 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.509 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.509 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.509 I ggml_metal_init: simdgroup reduction   = true
0.00.057.509 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.509 I ggml_metal_init: has bfloat            = true
0.00.057.510 I ggml_metal_init: use bfloat            = true
0.00.057.510 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.511 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.086.459 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.466 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.086.485 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.470 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.472 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.472 I llama_new_context_with_model: graph nodes  = 967
0.00.087.472 I llama_new_context_with_model: graph splits = 2
0.00.087.493 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.505.250 I main: llama threadpool init, n_threads = 4
0.00.505.287 I 
0.00.505.309 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.505.310 I 
0.00.505.529 I sampler seed: 1234
0.00.505.533 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.505.574 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.505.577 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.505.577 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.184.618 I llama_perf_sampler_print:    sampling time =       1.18 ms /    71 runs   (    0.02 ms per token, 60118.54 tokens per second)
0.01.184.619 I llama_perf_context_print:        load time =     492.48 ms
0.01.184.620 I llama_perf_context_print: prompt eval time =      35.78 ms /     7 tokens (    5.11 ms per token,   195.63 tokens per second)
0.01.184.621 I llama_perf_context_print:        eval time =     640.27 ms /    63 runs   (   10.16 ms per token,    98.40 tokens per second)
0.01.184.621 I llama_perf_context_print:       total time =     679.37 ms /    70 tokens
0.01.184.797 I ggml_metal_free: deallocating

real	0m1.209s
user	0m0.107s
sys	0m0.151s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.088 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.237 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.642 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.016.647 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.648 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.649 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.649 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.650 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.650 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.651 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.651 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.651 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.652 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.652 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.652 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.653 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.654 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.654 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.655 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.418 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.512 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.283 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.284 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.284 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.284 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.285 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.285 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.025.285 I llama_model_loader: - type  f32:  194 tensors
0.00.025.286 I llama_model_loader: - type q2_K:   49 tensors
0.00.025.286 I llama_model_loader: - type q3_K:   48 tensors
0.00.025.286 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.811 I llm_load_vocab: special tokens cache size = 25
0.00.051.864 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.867 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.867 I llm_load_print_meta: arch             = gptneox
0.00.051.867 I llm_load_print_meta: vocab type       = BPE
0.00.051.868 I llm_load_print_meta: n_vocab          = 50304
0.00.051.868 I llm_load_print_meta: n_merges         = 50009
0.00.051.868 I llm_load_print_meta: vocab_only       = 0
0.00.051.868 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.868 I llm_load_print_meta: n_embd           = 2048
0.00.051.869 I llm_load_print_meta: n_layer          = 24
0.00.051.872 I llm_load_print_meta: n_head           = 16
0.00.051.874 I llm_load_print_meta: n_head_kv        = 16
0.00.051.874 I llm_load_print_meta: n_rot            = 32
0.00.051.875 I llm_load_print_meta: n_swa            = 0
0.00.051.875 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.875 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.876 I llm_load_print_meta: n_gqa            = 1
0.00.051.876 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.877 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.878 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.878 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.878 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.878 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.878 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.879 I llm_load_print_meta: n_ff             = 8192
0.00.051.880 I llm_load_print_meta: n_expert         = 0
0.00.051.880 I llm_load_print_meta: n_expert_used    = 0
0.00.051.880 I llm_load_print_meta: causal attn      = 1
0.00.051.880 I llm_load_print_meta: pooling type     = 0
0.00.051.880 I llm_load_print_meta: rope type        = 2
0.00.051.880 I llm_load_print_meta: rope scaling     = linear
0.00.051.882 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.882 I llm_load_print_meta: freq_scale_train = 1
0.00.051.882 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.882 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.882 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.882 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.883 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.883 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.883 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.895 I llm_load_print_meta: model type       = 1.4B
0.00.051.896 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.051.896 I llm_load_print_meta: model params     = 1.41 B
0.00.051.897 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.051.897 I llm_load_print_meta: general.name     = 1.4B
0.00.051.897 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.897 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.898 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.898 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.899 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.899 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.900 I llm_load_print_meta: max token length = 1024
0.00.053.799 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.799 I llm_load_tensors: offloading output layer to GPU
0.00.053.799 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.809 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.053.810 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.054.730 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.731 I llama_new_context_with_model: n_ctx         = 128
0.00.054.731 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.731 I llama_new_context_with_model: n_batch       = 128
0.00.054.731 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.731 I llama_new_context_with_model: flash_attn    = 0
0.00.054.732 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.732 I llama_new_context_with_model: freq_scale    = 1
0.00.054.733 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.733 I ggml_metal_init: allocating
0.00.054.738 I ggml_metal_init: found device: Apple M4
0.00.054.740 I ggml_metal_init: picking default device: Apple M4
0.00.055.257 I ggml_metal_init: using embedded metal library
0.00.058.430 I ggml_metal_init: GPU name:   Apple M4
0.00.058.431 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.432 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.432 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.432 I ggml_metal_init: simdgroup reduction   = true
0.00.058.433 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.433 I ggml_metal_init: has bfloat            = true
0.00.058.433 I ggml_metal_init: use bfloat            = true
0.00.058.433 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.434 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.294 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.297 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.314 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.235 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.236 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.236 I llama_new_context_with_model: graph nodes  = 967
0.00.068.237 I llama_new_context_with_model: graph splits = 2
0.00.068.249 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.424.122 I 
0.00.424.161 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.424.189 I perplexity: tokenizing the input ..
0.00.431.720 I perplexity: tokenization took 7.533 ms
0.00.431.727 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.564.367 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.565.623 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.565.639 I llama_perf_context_print:        load time =     412.88 ms
0.00.565.640 I llama_perf_context_print: prompt eval time =     132.41 ms /   128 tokens (    1.03 ms per token,   966.67 tokens per second)
0.00.565.641 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.565.641 I llama_perf_context_print:       total time =     141.52 ms /   129 tokens
0.00.566.001 I ggml_metal_free: deallocating

real	0m0.579s
user	0m0.076s
sys	0m0.082s
```
- q3_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.692 I main: llama backend init
0.00.001.694 I main: load the model and apply lora adapter, if any
0.00.010.935 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.105 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.017.110 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.116 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.116 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.117 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.118 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.119 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.120 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.120 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.120 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.121 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.124 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.125 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.125 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.126 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.127 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.127 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.036 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.091 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.971 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.972 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.972 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.973 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.973 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.973 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.025.974 I llama_model_loader: - type  f32:  194 tensors
0.00.025.974 I llama_model_loader: - type q3_K:   25 tensors
0.00.025.975 I llama_model_loader: - type q4_K:   71 tensors
0.00.025.975 I llama_model_loader: - type q5_K:    1 tensors
0.00.025.975 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.241 I llm_load_vocab: special tokens cache size = 25
0.00.052.225 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.228 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.228 I llm_load_print_meta: arch             = gptneox
0.00.052.228 I llm_load_print_meta: vocab type       = BPE
0.00.052.228 I llm_load_print_meta: n_vocab          = 50304
0.00.052.229 I llm_load_print_meta: n_merges         = 50009
0.00.052.229 I llm_load_print_meta: vocab_only       = 0
0.00.052.229 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.229 I llm_load_print_meta: n_embd           = 2048
0.00.052.229 I llm_load_print_meta: n_layer          = 24
0.00.052.232 I llm_load_print_meta: n_head           = 16
0.00.052.233 I llm_load_print_meta: n_head_kv        = 16
0.00.052.233 I llm_load_print_meta: n_rot            = 32
0.00.052.233 I llm_load_print_meta: n_swa            = 0
0.00.052.233 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.233 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.234 I llm_load_print_meta: n_gqa            = 1
0.00.052.235 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.236 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.237 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.238 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.238 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.238 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.239 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.239 I llm_load_print_meta: n_ff             = 8192
0.00.052.239 I llm_load_print_meta: n_expert         = 0
0.00.052.242 I llm_load_print_meta: n_expert_used    = 0
0.00.052.242 I llm_load_print_meta: causal attn      = 1
0.00.052.242 I llm_load_print_meta: pooling type     = 0
0.00.052.242 I llm_load_print_meta: rope type        = 2
0.00.052.242 I llm_load_print_meta: rope scaling     = linear
0.00.052.243 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.243 I llm_load_print_meta: freq_scale_train = 1
0.00.052.243 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.243 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.243 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.243 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.244 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.244 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.244 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.256 I llm_load_print_meta: model type       = 1.4B
0.00.052.256 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.052.257 I llm_load_print_meta: model params     = 1.41 B
0.00.052.258 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.052.258 I llm_load_print_meta: general.name     = 1.4B
0.00.052.258 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.259 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.259 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.259 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.259 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.260 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.260 I llm_load_print_meta: max token length = 1024
0.00.054.178 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.178 I llm_load_tensors: offloading output layer to GPU
0.00.054.178 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.188 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.054.190 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.055.097 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.098 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.098 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.098 I llama_new_context_with_model: n_batch       = 2048
0.00.055.099 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.099 I llama_new_context_with_model: flash_attn    = 0
0.00.055.099 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.099 I llama_new_context_with_model: freq_scale    = 1
0.00.055.100 I ggml_metal_init: allocating
0.00.055.106 I ggml_metal_init: found device: Apple M4
0.00.055.108 I ggml_metal_init: picking default device: Apple M4
0.00.055.640 I ggml_metal_init: using embedded metal library
0.00.057.593 I ggml_metal_init: GPU name:   Apple M4
0.00.057.594 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.595 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.595 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.595 I ggml_metal_init: simdgroup reduction   = true
0.00.057.595 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.595 I ggml_metal_init: has bfloat            = true
0.00.057.596 I ggml_metal_init: use bfloat            = true
0.00.057.596 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.597 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.084.475 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.084.483 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.084.500 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.085.552 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.085.553 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.085.554 I llama_new_context_with_model: graph nodes  = 967
0.00.085.554 I llama_new_context_with_model: graph splits = 2
0.00.085.577 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.590.966 I main: llama threadpool init, n_threads = 4
0.00.591.001 I 
0.00.591.020 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.591.021 I 
0.00.591.238 I sampler seed: 1234
0.00.591.243 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.591.265 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.591.265 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.591.265 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do that is most useful to my fellow men?'"

-Albert Einstein

"The way

0.01.331.021 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57489.88 tokens per second)
0.01.331.022 I llama_perf_context_print:        load time =     580.02 ms
0.01.331.023 I llama_perf_context_print: prompt eval time =      35.64 ms /     7 tokens (    5.09 ms per token,   196.42 tokens per second)
0.01.331.024 I llama_perf_context_print:        eval time =     701.10 ms /    63 runs   (   11.13 ms per token,    89.86 tokens per second)
0.01.331.024 I llama_perf_context_print:       total time =     740.06 ms /    70 tokens
0.01.331.194 I ggml_metal_free: deallocating

real	0m1.345s
user	0m0.107s
sys	0m0.157s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.084 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.319 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.032 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.016.037 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.038 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.039 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.039 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.039 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.040 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.041 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.041 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.041 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.041 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.042 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.042 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.042 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.045 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.045 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.046 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.854 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.917 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.656 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.658 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.658 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.658 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.658 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.659 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.024.659 I llama_model_loader: - type  f32:  194 tensors
0.00.024.659 I llama_model_loader: - type q3_K:   25 tensors
0.00.024.660 I llama_model_loader: - type q4_K:   71 tensors
0.00.024.660 I llama_model_loader: - type q5_K:    1 tensors
0.00.024.660 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.099 I llm_load_vocab: special tokens cache size = 25
0.00.051.036 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.038 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.039 I llm_load_print_meta: arch             = gptneox
0.00.051.039 I llm_load_print_meta: vocab type       = BPE
0.00.051.039 I llm_load_print_meta: n_vocab          = 50304
0.00.051.039 I llm_load_print_meta: n_merges         = 50009
0.00.051.040 I llm_load_print_meta: vocab_only       = 0
0.00.051.040 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.040 I llm_load_print_meta: n_embd           = 2048
0.00.051.040 I llm_load_print_meta: n_layer          = 24
0.00.051.042 I llm_load_print_meta: n_head           = 16
0.00.051.043 I llm_load_print_meta: n_head_kv        = 16
0.00.051.043 I llm_load_print_meta: n_rot            = 32
0.00.051.046 I llm_load_print_meta: n_swa            = 0
0.00.051.046 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.046 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.047 I llm_load_print_meta: n_gqa            = 1
0.00.051.047 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.048 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.049 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.049 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.049 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.049 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.049 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.050 I llm_load_print_meta: n_ff             = 8192
0.00.051.050 I llm_load_print_meta: n_expert         = 0
0.00.051.050 I llm_load_print_meta: n_expert_used    = 0
0.00.051.050 I llm_load_print_meta: causal attn      = 1
0.00.051.050 I llm_load_print_meta: pooling type     = 0
0.00.051.051 I llm_load_print_meta: rope type        = 2
0.00.051.051 I llm_load_print_meta: rope scaling     = linear
0.00.051.051 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.052 I llm_load_print_meta: freq_scale_train = 1
0.00.051.052 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.052 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.052 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.052 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.052 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.052 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.053 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.064 I llm_load_print_meta: model type       = 1.4B
0.00.051.064 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.051.065 I llm_load_print_meta: model params     = 1.41 B
0.00.051.065 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.051.066 I llm_load_print_meta: general.name     = 1.4B
0.00.051.066 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.066 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.066 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.066 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.067 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.068 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.069 I llm_load_print_meta: max token length = 1024
0.00.052.565 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.565 I llm_load_tensors: offloading output layer to GPU
0.00.052.565 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.575 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.052.576 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.053.372 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.372 I llama_new_context_with_model: n_ctx         = 128
0.00.053.372 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.373 I llama_new_context_with_model: n_batch       = 128
0.00.053.373 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.373 I llama_new_context_with_model: flash_attn    = 0
0.00.053.373 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.374 I llama_new_context_with_model: freq_scale    = 1
0.00.053.374 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.374 I ggml_metal_init: allocating
0.00.053.377 I ggml_metal_init: found device: Apple M4
0.00.053.379 I ggml_metal_init: picking default device: Apple M4
0.00.053.910 I ggml_metal_init: using embedded metal library
0.00.055.820 I ggml_metal_init: GPU name:   Apple M4
0.00.055.822 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.823 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.823 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.823 I ggml_metal_init: simdgroup reduction   = true
0.00.055.823 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.823 I ggml_metal_init: has bfloat            = true
0.00.055.824 I ggml_metal_init: use bfloat            = true
0.00.055.824 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.825 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.751 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.755 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.769 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.618 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.618 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.619 I llama_new_context_with_model: graph nodes  = 967
0.00.065.619 I llama_new_context_with_model: graph splits = 2
0.00.065.626 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.516.819 I 
0.00.516.858 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.516.896 I perplexity: tokenizing the input ..
0.00.524.452 I perplexity: tokenization took 7.555 ms
0.00.524.455 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.656.063 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.657.198 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.657.214 I llama_perf_context_print:        load time =     506.49 ms
0.00.657.215 I llama_perf_context_print: prompt eval time =     131.37 ms /   128 tokens (    1.03 ms per token,   974.35 tokens per second)
0.00.657.216 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.657.216 I llama_perf_context_print:       total time =     140.40 ms /   129 tokens
0.00.657.687 I ggml_metal_free: deallocating

real	0m0.668s
user	0m0.076s
sys	0m0.095s
```
- q4_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.618 I main: llama backend init
0.00.001.620 I main: load the model and apply lora adapter, if any
0.00.010.851 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.011 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.017.016 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.017 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.017 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.018 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.019 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.019 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.020 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.021 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.021 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.021 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.022 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.022 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.022 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.025 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.025 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.025 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.883 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.922 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.744 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.745 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.745 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.746 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.746 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.746 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.025.747 I llama_model_loader: - type  f32:  194 tensors
0.00.025.747 I llama_model_loader: - type q4_K:   61 tensors
0.00.025.747 I llama_model_loader: - type q5_K:   24 tensors
0.00.025.748 I llama_model_loader: - type q6_K:   13 tensors
0.00.045.920 I llm_load_vocab: special tokens cache size = 25
0.00.052.030 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.033 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.034 I llm_load_print_meta: arch             = gptneox
0.00.052.034 I llm_load_print_meta: vocab type       = BPE
0.00.052.034 I llm_load_print_meta: n_vocab          = 50304
0.00.052.034 I llm_load_print_meta: n_merges         = 50009
0.00.052.035 I llm_load_print_meta: vocab_only       = 0
0.00.052.035 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.035 I llm_load_print_meta: n_embd           = 2048
0.00.052.035 I llm_load_print_meta: n_layer          = 24
0.00.052.038 I llm_load_print_meta: n_head           = 16
0.00.052.040 I llm_load_print_meta: n_head_kv        = 16
0.00.052.041 I llm_load_print_meta: n_rot            = 32
0.00.052.041 I llm_load_print_meta: n_swa            = 0
0.00.052.041 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.041 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.042 I llm_load_print_meta: n_gqa            = 1
0.00.052.042 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.043 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.044 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.044 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.044 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.044 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.044 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.045 I llm_load_print_meta: n_ff             = 8192
0.00.052.045 I llm_load_print_meta: n_expert         = 0
0.00.052.047 I llm_load_print_meta: n_expert_used    = 0
0.00.052.048 I llm_load_print_meta: causal attn      = 1
0.00.052.048 I llm_load_print_meta: pooling type     = 0
0.00.052.048 I llm_load_print_meta: rope type        = 2
0.00.052.049 I llm_load_print_meta: rope scaling     = linear
0.00.052.049 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.049 I llm_load_print_meta: freq_scale_train = 1
0.00.052.049 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.050 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.050 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.050 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.050 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.050 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.050 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.061 I llm_load_print_meta: model type       = 1.4B
0.00.052.061 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.052.061 I llm_load_print_meta: model params     = 1.41 B
0.00.052.062 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.052.062 I llm_load_print_meta: general.name     = 1.4B
0.00.052.063 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.063 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.063 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.063 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.063 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.063 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.064 I llm_load_print_meta: max token length = 1024
0.00.054.049 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.049 I llm_load_tensors: offloading output layer to GPU
0.00.054.050 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.060 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.054.061 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.055.059 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.060 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.061 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.061 I llama_new_context_with_model: n_batch       = 2048
0.00.055.061 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.061 I llama_new_context_with_model: flash_attn    = 0
0.00.055.062 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.062 I llama_new_context_with_model: freq_scale    = 1
0.00.055.062 I ggml_metal_init: allocating
0.00.055.072 I ggml_metal_init: found device: Apple M4
0.00.055.075 I ggml_metal_init: picking default device: Apple M4
0.00.055.632 I ggml_metal_init: using embedded metal library
0.00.057.588 I ggml_metal_init: GPU name:   Apple M4
0.00.057.590 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.590 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.590 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.593 I ggml_metal_init: simdgroup reduction   = true
0.00.057.593 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.593 I ggml_metal_init: has bfloat            = true
0.00.057.593 I ggml_metal_init: use bfloat            = true
0.00.057.594 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.594 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.183 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.190 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.208 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.170 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.171 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.171 I llama_new_context_with_model: graph nodes  = 967
0.00.086.172 I llama_new_context_with_model: graph splits = 2
0.00.086.194 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.672.569 I main: llama threadpool init, n_threads = 4
0.00.672.601 I 
0.00.672.619 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.672.619 I 
0.00.672.855 I sampler seed: 1234
0.00.672.860 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.672.871 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.672.871 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.672.871 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the greatest power to create the future we want to see. I believe that we are in a wonderful time when people from all over the world are coming together to create a better world. I believe that we are going

0.01.421.327 I llama_perf_sampler_print:    sampling time =       1.30 ms /    71 runs   (    0.02 ms per token, 54657.43 tokens per second)
0.01.421.328 I llama_perf_context_print:        load time =     661.72 ms
0.01.421.330 I llama_perf_context_print: prompt eval time =      36.55 ms /     7 tokens (    5.22 ms per token,   191.49 tokens per second)
0.01.421.330 I llama_perf_context_print:        eval time =     708.75 ms /    63 runs   (   11.25 ms per token,    88.89 tokens per second)
0.01.421.331 I llama_perf_context_print:       total time =     748.76 ms /    70 tokens
0.01.421.508 I ggml_metal_free: deallocating

real	0m1.438s
user	0m0.109s
sys	0m0.174s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.082 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.096 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.879 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.015.883 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.885 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.885 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.886 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.886 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.886 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.887 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.888 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.888 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.888 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.889 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.889 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.889 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.892 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.892 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.892 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.679 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.750 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.526 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.527 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.527 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.528 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.528 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.528 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.529 I llama_model_loader: - type  f32:  194 tensors
0.00.024.529 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.529 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.530 I llama_model_loader: - type q6_K:   13 tensors
0.00.045.317 I llm_load_vocab: special tokens cache size = 25
0.00.051.368 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.371 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.371 I llm_load_print_meta: arch             = gptneox
0.00.051.371 I llm_load_print_meta: vocab type       = BPE
0.00.051.372 I llm_load_print_meta: n_vocab          = 50304
0.00.051.372 I llm_load_print_meta: n_merges         = 50009
0.00.051.372 I llm_load_print_meta: vocab_only       = 0
0.00.051.372 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.372 I llm_load_print_meta: n_embd           = 2048
0.00.051.372 I llm_load_print_meta: n_layer          = 24
0.00.051.375 I llm_load_print_meta: n_head           = 16
0.00.051.376 I llm_load_print_meta: n_head_kv        = 16
0.00.051.376 I llm_load_print_meta: n_rot            = 32
0.00.051.376 I llm_load_print_meta: n_swa            = 0
0.00.051.376 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.377 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.377 I llm_load_print_meta: n_gqa            = 1
0.00.051.378 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.379 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.380 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.380 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.380 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.380 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.380 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.381 I llm_load_print_meta: n_ff             = 8192
0.00.051.381 I llm_load_print_meta: n_expert         = 0
0.00.051.381 I llm_load_print_meta: n_expert_used    = 0
0.00.051.382 I llm_load_print_meta: causal attn      = 1
0.00.051.382 I llm_load_print_meta: pooling type     = 0
0.00.051.382 I llm_load_print_meta: rope type        = 2
0.00.051.383 I llm_load_print_meta: rope scaling     = linear
0.00.051.383 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.384 I llm_load_print_meta: freq_scale_train = 1
0.00.051.384 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.384 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.384 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.384 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.385 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.385 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.385 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.396 I llm_load_print_meta: model type       = 1.4B
0.00.051.396 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.051.397 I llm_load_print_meta: model params     = 1.41 B
0.00.051.397 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.051.397 I llm_load_print_meta: general.name     = 1.4B
0.00.051.398 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.399 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.399 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.399 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.399 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.399 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.400 I llm_load_print_meta: max token length = 1024
0.00.052.961 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.961 I llm_load_tensors: offloading output layer to GPU
0.00.052.961 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.971 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.052.972 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.053.879 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.880 I llama_new_context_with_model: n_ctx         = 128
0.00.053.880 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.881 I llama_new_context_with_model: n_batch       = 128
0.00.053.881 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.881 I llama_new_context_with_model: flash_attn    = 0
0.00.053.881 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.882 I llama_new_context_with_model: freq_scale    = 1
0.00.053.882 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.882 I ggml_metal_init: allocating
0.00.053.888 I ggml_metal_init: found device: Apple M4
0.00.053.890 I ggml_metal_init: picking default device: Apple M4
0.00.054.405 I ggml_metal_init: using embedded metal library
0.00.056.338 I ggml_metal_init: GPU name:   Apple M4
0.00.056.339 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.340 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.340 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.340 I ggml_metal_init: simdgroup reduction   = true
0.00.056.340 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.341 I ggml_metal_init: has bfloat            = true
0.00.056.342 I ggml_metal_init: use bfloat            = true
0.00.056.343 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.343 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.267 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.269 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.283 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.110 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.111 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.111 I llama_new_context_with_model: graph nodes  = 967
0.00.066.111 I llama_new_context_with_model: graph splits = 2
0.00.066.123 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.602.092 I 
0.00.602.111 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.602.125 I perplexity: tokenizing the input ..
0.00.609.805 I perplexity: tokenization took 7.678 ms
0.00.609.808 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.744.313 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.745.528 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.745.543 I llama_perf_context_print:        load time =     591.99 ms
0.00.745.544 I llama_perf_context_print: prompt eval time =     134.29 ms /   128 tokens (    1.05 ms per token,   953.19 tokens per second)
0.00.745.545 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.745.545 I llama_perf_context_print:       total time =     143.45 ms /   129 tokens
0.00.746.023 I ggml_metal_free: deallocating

real	0m0.759s
user	0m0.077s
sys	0m0.113s
```
- q5_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.713 I main: llama backend init
0.00.001.715 I main: load the model and apply lora adapter, if any
0.00.023.819 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.030.532 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.030.537 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.030.539 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.030.539 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.030.539 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.030.539 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.030.540 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.030.541 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.030.541 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.030.541 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.030.542 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.030.542 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.030.542 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.030.543 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.030.544 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.030.545 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.030.545 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.034.550 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.035.721 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.040.062 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.040.063 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.040.064 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.040.064 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.040.064 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.040.065 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.040.065 I llama_model_loader: - type  f32:  194 tensors
0.00.040.065 I llama_model_loader: - type q5_K:   61 tensors
0.00.040.066 I llama_model_loader: - type q6_K:   37 tensors
0.00.064.321 I llm_load_vocab: special tokens cache size = 25
0.00.071.179 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.071.182 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.071.182 I llm_load_print_meta: arch             = gptneox
0.00.071.183 I llm_load_print_meta: vocab type       = BPE
0.00.071.183 I llm_load_print_meta: n_vocab          = 50304
0.00.071.183 I llm_load_print_meta: n_merges         = 50009
0.00.071.183 I llm_load_print_meta: vocab_only       = 0
0.00.071.183 I llm_load_print_meta: n_ctx_train      = 2048
0.00.071.183 I llm_load_print_meta: n_embd           = 2048
0.00.071.184 I llm_load_print_meta: n_layer          = 24
0.00.071.187 I llm_load_print_meta: n_head           = 16
0.00.071.187 I llm_load_print_meta: n_head_kv        = 16
0.00.071.188 I llm_load_print_meta: n_rot            = 32
0.00.071.188 I llm_load_print_meta: n_swa            = 0
0.00.071.188 I llm_load_print_meta: n_embd_head_k    = 128
0.00.071.188 I llm_load_print_meta: n_embd_head_v    = 128
0.00.071.189 I llm_load_print_meta: n_gqa            = 1
0.00.071.191 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.071.191 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.071.192 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.071.192 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.071.192 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.071.192 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.071.192 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.071.193 I llm_load_print_meta: n_ff             = 8192
0.00.071.193 I llm_load_print_meta: n_expert         = 0
0.00.071.193 I llm_load_print_meta: n_expert_used    = 0
0.00.071.193 I llm_load_print_meta: causal attn      = 1
0.00.071.194 I llm_load_print_meta: pooling type     = 0
0.00.071.195 I llm_load_print_meta: rope type        = 2
0.00.071.196 I llm_load_print_meta: rope scaling     = linear
0.00.071.196 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.071.196 I llm_load_print_meta: freq_scale_train = 1
0.00.071.196 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.071.197 I llm_load_print_meta: rope_finetuned   = unknown
0.00.071.197 I llm_load_print_meta: ssm_d_conv       = 0
0.00.071.197 I llm_load_print_meta: ssm_d_inner      = 0
0.00.071.197 I llm_load_print_meta: ssm_d_state      = 0
0.00.071.197 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.071.197 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.071.209 I llm_load_print_meta: model type       = 1.4B
0.00.071.209 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.071.210 I llm_load_print_meta: model params     = 1.41 B
0.00.071.210 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.071.210 I llm_load_print_meta: general.name     = 1.4B
0.00.071.211 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.071.211 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.071.211 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.071.211 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.071.211 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.071.212 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.071.212 I llm_load_print_meta: max token length = 1024
0.00.073.428 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.073.428 I llm_load_tensors: offloading output layer to GPU
0.00.073.429 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.073.439 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.073.440 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.074.469 I llama_new_context_with_model: n_seq_max     = 1
0.00.074.470 I llama_new_context_with_model: n_ctx         = 2048
0.00.074.470 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.074.470 I llama_new_context_with_model: n_batch       = 2048
0.00.074.471 I llama_new_context_with_model: n_ubatch      = 512
0.00.074.471 I llama_new_context_with_model: flash_attn    = 0
0.00.074.471 I llama_new_context_with_model: freq_base     = 10000.0
0.00.074.472 I llama_new_context_with_model: freq_scale    = 1
0.00.074.472 I ggml_metal_init: allocating
0.00.074.478 I ggml_metal_init: found device: Apple M4
0.00.074.480 I ggml_metal_init: picking default device: Apple M4
0.00.075.272 I ggml_metal_init: using embedded metal library
0.00.077.522 I ggml_metal_init: GPU name:   Apple M4
0.00.077.523 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.077.524 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.077.524 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.077.524 I ggml_metal_init: simdgroup reduction   = true
0.00.077.525 I ggml_metal_init: simdgroup matrix mul. = true
0.00.077.525 I ggml_metal_init: has bfloat            = true
0.00.077.525 I ggml_metal_init: use bfloat            = true
0.00.077.525 I ggml_metal_init: hasUnifiedMemory      = true
0.00.077.526 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.108.441 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.108.445 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.108.461 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.109.431 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.109.432 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.109.432 I llama_new_context_with_model: graph nodes  = 967
0.00.109.433 I llama_new_context_with_model: graph splits = 2
0.00.109.455 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.772.053 I main: llama threadpool init, n_threads = 4
0.00.772.086 I 
0.00.772.102 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.772.102 I 
0.00.772.324 I sampler seed: 1234
0.00.772.329 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.772.357 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.772.358 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.772.359 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.610.965 I llama_perf_sampler_print:    sampling time =       1.16 ms /    71 runs   (    0.02 ms per token, 61154.18 tokens per second)
0.01.610.966 I llama_perf_context_print:        load time =     748.23 ms
0.01.610.967 I llama_perf_context_print: prompt eval time =      38.69 ms /     7 tokens (    5.53 ms per token,   180.92 tokens per second)
0.01.610.967 I llama_perf_context_print:        eval time =     796.99 ms /    63 runs   (   12.65 ms per token,    79.05 tokens per second)
0.01.610.968 I llama_perf_context_print:       total time =     838.92 ms /    70 tokens
0.01.611.141 I ggml_metal_free: deallocating

real	0m1.629s
user	0m0.116s
sys	0m0.186s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.095 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.480 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.317 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.017.322 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.324 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.326 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.327 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.327 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.331 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.332 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.332 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.332 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.333 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.333 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.333 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.334 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.335 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.336 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.336 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.106 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.183 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.001 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.002 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.002 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.002 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.003 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.003 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.026.003 I llama_model_loader: - type  f32:  194 tensors
0.00.026.004 I llama_model_loader: - type q5_K:   61 tensors
0.00.026.004 I llama_model_loader: - type q6_K:   37 tensors
0.00.046.429 I llm_load_vocab: special tokens cache size = 25
0.00.052.555 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.557 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.558 I llm_load_print_meta: arch             = gptneox
0.00.052.558 I llm_load_print_meta: vocab type       = BPE
0.00.052.558 I llm_load_print_meta: n_vocab          = 50304
0.00.052.559 I llm_load_print_meta: n_merges         = 50009
0.00.052.559 I llm_load_print_meta: vocab_only       = 0
0.00.052.559 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.559 I llm_load_print_meta: n_embd           = 2048
0.00.052.559 I llm_load_print_meta: n_layer          = 24
0.00.052.562 I llm_load_print_meta: n_head           = 16
0.00.052.563 I llm_load_print_meta: n_head_kv        = 16
0.00.052.563 I llm_load_print_meta: n_rot            = 32
0.00.052.563 I llm_load_print_meta: n_swa            = 0
0.00.052.564 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.564 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.565 I llm_load_print_meta: n_gqa            = 1
0.00.052.565 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.566 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.567 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.567 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.567 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.567 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.570 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.570 I llm_load_print_meta: n_ff             = 8192
0.00.052.570 I llm_load_print_meta: n_expert         = 0
0.00.052.572 I llm_load_print_meta: n_expert_used    = 0
0.00.052.572 I llm_load_print_meta: causal attn      = 1
0.00.052.572 I llm_load_print_meta: pooling type     = 0
0.00.052.573 I llm_load_print_meta: rope type        = 2
0.00.052.573 I llm_load_print_meta: rope scaling     = linear
0.00.052.573 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.574 I llm_load_print_meta: freq_scale_train = 1
0.00.052.574 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.574 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.574 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.574 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.574 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.574 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.575 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.586 I llm_load_print_meta: model type       = 1.4B
0.00.052.587 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.052.587 I llm_load_print_meta: model params     = 1.41 B
0.00.052.588 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.052.588 I llm_load_print_meta: general.name     = 1.4B
0.00.052.588 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.588 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.588 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.589 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.589 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.589 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.590 I llm_load_print_meta: max token length = 1024
0.00.054.523 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.523 I llm_load_tensors: offloading output layer to GPU
0.00.054.523 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.533 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.054.534 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.055.450 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.451 I llama_new_context_with_model: n_ctx         = 128
0.00.055.451 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.055.451 I llama_new_context_with_model: n_batch       = 128
0.00.055.451 I llama_new_context_with_model: n_ubatch      = 128
0.00.055.451 I llama_new_context_with_model: flash_attn    = 0
0.00.055.452 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.452 I llama_new_context_with_model: freq_scale    = 1
0.00.055.452 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.055.453 I ggml_metal_init: allocating
0.00.055.456 I ggml_metal_init: found device: Apple M4
0.00.055.457 I ggml_metal_init: picking default device: Apple M4
0.00.056.026 I ggml_metal_init: using embedded metal library
0.00.057.952 I ggml_metal_init: GPU name:   Apple M4
0.00.057.954 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.954 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.955 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.955 I ggml_metal_init: simdgroup reduction   = true
0.00.057.955 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.955 I ggml_metal_init: has bfloat            = true
0.00.057.955 I ggml_metal_init: use bfloat            = true
0.00.057.956 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.956 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.886 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.891 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.909 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.067.758 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.067.759 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.067.760 I llama_new_context_with_model: graph nodes  = 967
0.00.067.760 I llama_new_context_with_model: graph splits = 2
0.00.067.772 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.684.446 I 
0.00.684.490 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.684.515 I perplexity: tokenizing the input ..
0.00.692.476 I perplexity: tokenization took 7.96 ms
0.00.692.481 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.832.557 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.833.719 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.833.730 I llama_perf_context_print:        load time =     672.96 ms
0.00.833.731 I llama_perf_context_print: prompt eval time =     139.83 ms /   128 tokens (    1.09 ms per token,   915.37 tokens per second)
0.00.833.732 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.833.732 I llama_perf_context_print:       total time =     149.29 ms /   129 tokens
0.00.834.203 I ggml_metal_free: deallocating

real	0m0.847s
user	0m0.077s
sys	0m0.126s
```
- q6_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.001.709 I main: llama backend init
0.00.001.711 I main: load the model and apply lora adapter, if any
0.00.010.122 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.631 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.635 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.637 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.637 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.637 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.638 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.640 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.641 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.641 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.645 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.646 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.647 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.648 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.648 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.653 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.653 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.653 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.436 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.473 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.233 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.234 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.235 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.235 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.235 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.236 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.025.236 I llama_model_loader: - type  f32:  194 tensors
0.00.025.237 I llama_model_loader: - type q6_K:   98 tensors
0.00.045.053 I llm_load_vocab: special tokens cache size = 25
0.00.050.986 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.988 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.989 I llm_load_print_meta: arch             = gptneox
0.00.050.989 I llm_load_print_meta: vocab type       = BPE
0.00.050.989 I llm_load_print_meta: n_vocab          = 50304
0.00.050.990 I llm_load_print_meta: n_merges         = 50009
0.00.050.990 I llm_load_print_meta: vocab_only       = 0
0.00.050.990 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.990 I llm_load_print_meta: n_embd           = 2048
0.00.050.990 I llm_load_print_meta: n_layer          = 24
0.00.050.993 I llm_load_print_meta: n_head           = 16
0.00.050.994 I llm_load_print_meta: n_head_kv        = 16
0.00.050.994 I llm_load_print_meta: n_rot            = 32
0.00.050.994 I llm_load_print_meta: n_swa            = 0
0.00.050.994 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.994 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.995 I llm_load_print_meta: n_gqa            = 1
0.00.050.996 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.996 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.997 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.998 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.998 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.998 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.998 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.999 I llm_load_print_meta: n_ff             = 8192
0.00.050.999 I llm_load_print_meta: n_expert         = 0
0.00.050.999 I llm_load_print_meta: n_expert_used    = 0
0.00.050.999 I llm_load_print_meta: causal attn      = 1
0.00.051.000 I llm_load_print_meta: pooling type     = 0
0.00.051.002 I llm_load_print_meta: rope type        = 2
0.00.051.002 I llm_load_print_meta: rope scaling     = linear
0.00.051.003 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.003 I llm_load_print_meta: freq_scale_train = 1
0.00.051.003 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.004 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.004 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.004 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.004 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.005 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.005 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.017 I llm_load_print_meta: model type       = 1.4B
0.00.051.017 I llm_load_print_meta: model ftype      = Q6_K
0.00.051.017 I llm_load_print_meta: model params     = 1.41 B
0.00.051.018 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.051.018 I llm_load_print_meta: general.name     = 1.4B
0.00.051.018 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.018 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.019 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.020 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.021 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.021 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.021 I llm_load_print_meta: max token length = 1024
0.00.052.524 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.524 I llm_load_tensors: offloading output layer to GPU
0.00.052.525 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.534 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.052.535 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.053.369 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.370 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.370 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.370 I llama_new_context_with_model: n_batch       = 2048
0.00.053.371 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.371 I llama_new_context_with_model: flash_attn    = 0
0.00.053.371 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.372 I llama_new_context_with_model: freq_scale    = 1
0.00.053.372 I ggml_metal_init: allocating
0.00.053.379 I ggml_metal_init: found device: Apple M4
0.00.053.381 I ggml_metal_init: picking default device: Apple M4
0.00.053.915 I ggml_metal_init: using embedded metal library
0.00.055.824 I ggml_metal_init: GPU name:   Apple M4
0.00.055.826 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.826 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.827 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.827 I ggml_metal_init: simdgroup reduction   = true
0.00.055.828 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.828 I ggml_metal_init: has bfloat            = true
0.00.055.828 I ggml_metal_init: use bfloat            = true
0.00.055.828 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.829 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.083.344 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.083.350 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.083.369 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.084.240 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.084.241 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.084.241 I llama_new_context_with_model: graph nodes  = 967
0.00.084.241 I llama_new_context_with_model: graph splits = 2
0.00.084.252 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.796.904 I main: llama threadpool init, n_threads = 4
0.00.796.936 I 
0.00.796.956 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.796.957 I 
0.00.797.117 I sampler seed: 1234
0.00.797.121 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.797.141 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.797.141 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.797.141 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.01.666.593 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59613.77 tokens per second)
0.01.666.593 I llama_perf_context_print:        load time =     786.78 ms
0.01.666.594 I llama_perf_context_print: prompt eval time =      38.42 ms /     7 tokens (    5.49 ms per token,   182.20 tokens per second)
0.01.666.595 I llama_perf_context_print:        eval time =     828.02 ms /    63 runs   (   13.14 ms per token,    76.09 tokens per second)
0.01.666.595 I llama_perf_context_print:       total time =     869.69 ms /    70 tokens
0.01.666.755 I ggml_metal_free: deallocating

real	0m1.680s
user	0m0.107s
sys	0m0.191s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.080 I build: 4161 (bd9f7b42) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.991 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.565 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.015.569 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.576 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.576 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.577 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.577 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.577 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.578 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.579 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.579 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.579 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.580 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.580 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.580 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.582 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.582 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.583 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.326 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.358 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.129 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.130 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.130 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.130 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.131 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.131 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.132 I llama_model_loader: - type  f32:  194 tensors
0.00.024.132 I llama_model_loader: - type q6_K:   98 tensors
0.00.043.734 I llm_load_vocab: special tokens cache size = 25
0.00.049.531 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.534 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.534 I llm_load_print_meta: arch             = gptneox
0.00.049.535 I llm_load_print_meta: vocab type       = BPE
0.00.049.535 I llm_load_print_meta: n_vocab          = 50304
0.00.049.535 I llm_load_print_meta: n_merges         = 50009
0.00.049.535 I llm_load_print_meta: vocab_only       = 0
0.00.049.535 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.535 I llm_load_print_meta: n_embd           = 2048
0.00.049.536 I llm_load_print_meta: n_layer          = 24
0.00.049.538 I llm_load_print_meta: n_head           = 16
0.00.049.539 I llm_load_print_meta: n_head_kv        = 16
0.00.049.539 I llm_load_print_meta: n_rot            = 32
0.00.049.539 I llm_load_print_meta: n_swa            = 0
0.00.049.539 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.540 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.540 I llm_load_print_meta: n_gqa            = 1
0.00.049.541 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.542 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.542 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.543 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.543 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.543 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.543 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.544 I llm_load_print_meta: n_ff             = 8192
0.00.049.544 I llm_load_print_meta: n_expert         = 0
0.00.049.544 I llm_load_print_meta: n_expert_used    = 0
0.00.049.544 I llm_load_print_meta: causal attn      = 1
0.00.049.545 I llm_load_print_meta: pooling type     = 0
0.00.049.545 I llm_load_print_meta: rope type        = 2
0.00.049.545 I llm_load_print_meta: rope scaling     = linear
0.00.049.547 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.547 I llm_load_print_meta: freq_scale_train = 1
0.00.049.548 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.548 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.548 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.548 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.548 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.548 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.548 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.560 I llm_load_print_meta: model type       = 1.4B
0.00.049.561 I llm_load_print_meta: model ftype      = Q6_K
0.00.049.561 I llm_load_print_meta: model params     = 1.41 B
0.00.049.561 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.049.562 I llm_load_print_meta: general.name     = 1.4B
0.00.049.562 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.562 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.562 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.562 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.563 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.563 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.563 I llm_load_print_meta: max token length = 1024
0.00.051.553 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.553 I llm_load_tensors: offloading output layer to GPU
0.00.051.554 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.564 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.051.565 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.052.419 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.420 I llama_new_context_with_model: n_ctx         = 128
0.00.052.420 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.420 I llama_new_context_with_model: n_batch       = 128
0.00.052.420 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.420 I llama_new_context_with_model: flash_attn    = 0
0.00.052.421 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.421 I llama_new_context_with_model: freq_scale    = 1
0.00.052.421 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.422 I ggml_metal_init: allocating
0.00.052.425 I ggml_metal_init: found device: Apple M4
0.00.052.427 I ggml_metal_init: picking default device: Apple M4
0.00.052.947 I ggml_metal_init: using embedded metal library
0.00.054.813 I ggml_metal_init: GPU name:   Apple M4
0.00.054.814 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.815 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.815 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.815 I ggml_metal_init: simdgroup reduction   = true
0.00.054.815 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.816 I ggml_metal_init: has bfloat            = true
0.00.054.816 I ggml_metal_init: use bfloat            = true
0.00.054.816 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.817 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.603 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.604 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.619 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.535 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.536 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.537 I llama_new_context_with_model: graph nodes  = 967
0.00.064.537 I llama_new_context_with_model: graph splits = 2
0.00.064.542 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.684.122 I 
0.00.684.191 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.684.228 I perplexity: tokenizing the input ..
0.00.692.314 I perplexity: tokenization took 8.085 ms
0.00.692.320 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.832.794 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.834.067 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.834.079 I llama_perf_context_print:        load time =     674.12 ms
0.00.834.079 I llama_perf_context_print: prompt eval time =     140.22 ms /   128 tokens (    1.10 ms per token,   912.84 tokens per second)
0.00.834.080 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.834.081 I llama_perf_context_print:       total time =     149.97 ms /   129 tokens
0.00.834.366 I ggml_metal_free: deallocating

real	0m0.848s
user	0m0.075s
sys	0m0.127s
```
- save-load-state: 
```
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4161 (bd9f7b42)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13d60a170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13d60a870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13d60ae20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13d60b3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13d60b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13d60bf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13d60c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13d60ca90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13d60d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13d60d540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13d60da40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13d60df40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13d60ea60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13d60f210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13d60fa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13d610140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13d610860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13d610f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13d6116a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13d611e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13d612590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13d612cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13d6133d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13d613c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13d614390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13d614650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13d614c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13d6158d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13d615e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13d6160d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13d616570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13d616830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13d6170c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13d617600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13d6178c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13d617d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13d618200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13d6186a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13d618b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13d618fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13d619480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13d619920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13d619dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13d61a260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13d61a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13d61ab30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13d61b140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13d61ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13d61c070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13d61c680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13d61cc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13d61d2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13d61d8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13d61dec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13d61e6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13d61eb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13d61eff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13d61f2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13d61f8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13d6200b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13d620370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13d620810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13d620cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13d621150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13d6215f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13d621a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13d621f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13d6223d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13d622870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13d622d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13d6231b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13d623650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13d623af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13d623f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13d624430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13d6248d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13d624d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13d625210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13d6256b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13d625b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13d625ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13d626490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13d626930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13d626dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13d627270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13d627710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13d627bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13d628050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13d6284f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13d628990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13d628e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13d6292d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13d629770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13d629c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13d62a0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13d62a550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13d62a9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13d61b750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13d62b040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13d62b4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13d62b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13d62be20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13d62c2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13d62c760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13d62cc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13d62d0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13d62d540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13d62d9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13d62de80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13d62e320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13d62e7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13d62ec60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13d62f100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13d62f5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13d62fa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13d62fee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13d630380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13d630820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13d630cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13d631160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13d631600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13d631aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13d631f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13d6323e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13d632880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13d632d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13d6331c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13d633660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13d633b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13d633fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13d634440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13d6348e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13d634d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13d635220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13d6356c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13d635b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13d636000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13d6364a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13d636940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13d636de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13d637280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13d637720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13d637bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13d638060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13d638500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13d6389a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13d638e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13d6392e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13d639780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13d639c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13d63a0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13d63a560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13d63aa00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13d63af50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13d63b4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13d63b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13d63bf40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13d63c200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13d63c810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13d63ce20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13d63d430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13d63da40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13d63e050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13d63e840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13d63ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13d63f180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13d63f620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13d63fdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13d640320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13d640870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13d640dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13d641310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13d641860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13d641db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13d642300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13d642850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13d642da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13d6432f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13d643840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13d643d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13d6442e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13d644830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13d644d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13d6452d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13d645820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13d645d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13d6462c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13d646810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13d646d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13d6472b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13d647800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13d647d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13d6482a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13d6487f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13d648d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13d649290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13d6497e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13d649d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13d64a280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13d64a7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13d64ad20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13d64b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13d64b7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13d64bd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13d64c260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13d64c7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13d64cd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13d64d250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13d64d7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13d64dcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13d64e240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13d64e790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13d64ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13d64f230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13d64f780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13d64fcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13d650220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13d650770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13d650cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13d651210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13d651760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13d651cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13d652200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13d652750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13d652bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13d653090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13d653530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13d6539d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13d653e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13d654310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13d6547b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13d654c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13d6550f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13d655590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13d655a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13d655ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13d656370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13d6568c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13d656fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13d657700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13d657e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13d658540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13d658800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13d658e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13d659420 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.148.048 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13d649a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13d649ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13d64a340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13d64a7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13d64ac20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13d64b090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13d64b500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13d64b970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13d64bde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13d64c250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13d64c6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13d64cca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13d64d590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13d64dd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13d64e4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13d64ebe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13d64f2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13d64f9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13d6500b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13d650a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13d651120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13d651810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13d651f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13d6525f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13d652ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13d653150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13d6535c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13d653a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13d653ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13d654310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13d654780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13d654bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13d655060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13d655320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13d655790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13d655c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13d656070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13d6564e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13d656950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13d656dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13d657230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13d6576a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13d657b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13d657f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13d6583f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13d658860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13d658cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13d659140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13d6595b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13d60b3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13d60bf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13d60ae20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13d60b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13d60a170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13d6175f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13d6178b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13d617d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13d618190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13d618600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13d618a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13d618ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13d619350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13d6197c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13d619c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13d61a0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13d61a510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13d61a980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13d61adf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13d61b260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13d61b6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13d61bb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13d61bfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13d61c420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13d61c890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13d61cd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13d61d170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13d61d5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13d61da50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13d61dec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13d61e330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13d61e7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13d61ec10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13d61f080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13d61f4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13d61f960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13d61fdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13d620240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13d6206b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13d620b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13d620f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13d621400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13d621870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13d621ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13d622150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13d6225c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13d622a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13d622ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13d623310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13d623780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13d623bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13d624060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13d6244d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13d624940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13d624db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13d625220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13d625690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13d625b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13d625f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13d6263e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13d626850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13d626cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13d627130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13d6275a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13d627a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13d627e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13d6282f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13d628760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13d628bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13d629040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13d6294b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13d629920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13d629d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13d62a200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13d62a670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13d62aae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13d62af50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13d62b3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13d62b830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13d62bca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13d62c110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13d62c580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13d62c9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13d62ce60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13d62d2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13d62d740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13d62dbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13d62e020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13d62e490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13d62e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13d62ed70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13d62f1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13d62f650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13d62fac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13d62ff30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13d6303a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13d630810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13d630c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13d6310f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13d631560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13d6319d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13d631e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13d6322b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13d632720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13d632b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13d633000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13d633470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13d6338e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13d633d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13d6341c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13d634630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13d634aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13d634f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13d635380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13d6357f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13d635c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13d6360d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13d636540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13d636cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13d637130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13d6375a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13d637a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13d637e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13d6382f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13d638760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13d638bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13d639040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13d6394b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13d639920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13d639d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13d63a200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13d63a670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13d63aae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13d63af50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13d63b3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13d63b830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13d63bca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13d63c110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13d63c580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13d63c9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13d63ce60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13d63d2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13d63d740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13d63dbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13d63e020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13d63e490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13d63e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13d63ed70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13d63f1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13d63f650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13d63fac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13d63ff30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13d6403a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13d640810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13d640c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13d6410f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13d641560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13d6419d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13d641e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13d6422b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13d642720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13d642b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13d643000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13d643470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13d6438e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13d643d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13d6441c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13d644630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13d644aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13d644f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13d645380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13d6457f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13d645c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13d6460d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13d646540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13d6469b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13d646e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13d647290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13d647700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13d647b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13d647fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13d648450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13d6488c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13d648d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13d615fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13d616420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13d616890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13d616d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13d60d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13d60da40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13d60e130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13d60e820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13d60ef10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13d60f380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13d60f7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13d60fc60 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13d617a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13d617ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13d618330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13d6187a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13d618c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13d619080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13d6194f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13d619960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13d619dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13d61a240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13d61a6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13d61ac90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13d61b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13d61bd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13d61c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13d61cbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13d61d2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13d61d9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13d61e0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13d61ea20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13d61f110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13d61f800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13d61fef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13d6205e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13d620cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13d621140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13d6215b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13d621a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13d621e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13d622300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13d622770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13d622be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13d623050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13d623310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13d623780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13d623bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13d624060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13d6244d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13d624940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13d624db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13d625220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13d625690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13d625b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13d625f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13d6263e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13d626850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13d626cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13d627130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13d6275a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13d627a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13d627e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13d6282f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13d628760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13d628bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13d629040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13d6294b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13d629920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13d629d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13d62a200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13d62a670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13d62aae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13d62af50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13d62b3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13d62b830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13d62bca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13d62c110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13d62c580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13d62c9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13d62ce60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13d62d2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13d62d740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13d62dbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13d62e020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13d62e490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13d62e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13d62ed70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13d62f1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13d62f650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13d62fac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13d62ff30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13d6303a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13d630810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13d630c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13d6310f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13d631560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13d6319d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13d631e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13d6322b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13d632720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13d632b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13d633000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13d633470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13d6338e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13d633d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13d6341c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13d634630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13d634aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13d634f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13d635380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13d6357f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13d635c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13d6360d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13d636540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13d6369b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13d636e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13d637290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13d637700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13d637b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13d637fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13d638450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13d6388c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13d638d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13d6391a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13d639610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13d639a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13d639ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13d63a360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13d63a7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13d63ac40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13d63b0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13d63b520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13d63b990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13d63be00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13d63c270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13d63c6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13d63cb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13d63cfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13d63d430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13d63d8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13d63dd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13d63e180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13d63e5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13d63ea60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13d63eed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13d63f340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13d63f7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13d63fc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13d640090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13d640500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13d640970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13d640de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13d641250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13d6416c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13d641b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13d641fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13d642410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13d642880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13d642cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13d643160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13d6435d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13d643a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13d643eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13d644320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13d644790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13d644c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13d645070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13d6454e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13d645950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13d645dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13d646230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13d6466a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13d646b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13d646f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13d6473f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13d647860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13d647cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13d648140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13d6488c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13d648d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13d60a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13d615fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13d616420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13d616890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13d616d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13d60b7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13d60ac70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13d60bd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13d60b210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13d649600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13d6498c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13d649d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13d64a1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13d64a610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13d64aa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13d64aef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13d64b360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13d64b7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13d64bc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13d64c0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13d64c520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13d64c990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13d64ce00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13d64d270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13d64d6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13d64db50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13d64dfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13d64e430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13d64e8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13d64ed10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13d64f180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13d64f5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13d64fa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13d64fed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13d650340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13d6507b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13d650c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13d651090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13d651500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13d651970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13d651de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13d652250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13d6526c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13d652b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13d652fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13d653410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13d653880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13d653cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13d654160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13d6545d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13d654a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13d654eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13d655320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13d655790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13d655c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13d656070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13d6564e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13d656950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13d656dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13d657230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13d6576a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13d657b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13d657f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13d6583f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13d658860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13d658cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13d659140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13d6595b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13d60d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13d60da40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13d60e130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13d60e820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13d60ef10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13d60f380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13d60f7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13d60fc60 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.864s
user	0m0.286s
sys	0m0.318s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4161 (bd9f7b42)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13bf0ebe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13bf0f2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13bf0f8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13bf0fe50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13bf10400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13bf109b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13bf10f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13bf11510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13bf11ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13bf11fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13bf124c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13bf129c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13bf134e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13bf13c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13bf144a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13bf14bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13bf152e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13bf15a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13bf16120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13bf168f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13bf17010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13bf17730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13bf17e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13bf186f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13bf18e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13bf190d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13bf196e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13bf1a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13bf1a890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13bf1ab50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13bf1aff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13bf1b2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13bf1bb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13bf1c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13bf1c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13bf1c7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13bf1cc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13bf1d120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13bf1d5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13bf1da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13bf1df00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13bf1e3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13bf1e840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13bf1ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13bf1efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13bf1f5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13bf1fbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13bf204e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13bf20af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13bf21100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13bf21710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13bf21d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13bf22330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13bf22940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13bf23130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13bf235d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13bf23a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13bf23d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13bf24340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13bf24b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13bf24df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13bf25290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13bf25730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13bf25bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13bf26070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13bf26510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13bf269b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13bf26e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13bf272f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13bf27790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13bf27c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13bf280d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13bf28570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13bf28a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13bf28eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13bf29350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13bf297f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13bf29c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13bf2a130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13bf2a5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13bf2aa70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13bf2af10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13bf2b3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13bf2b850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13bf2bcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13bf2c190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13bf2c630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13bf2cad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13bf2cf70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13bf2d410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13bf2d8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13bf2dd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13bf2e1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13bf2e690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13bf2eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13bf2efd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13bf2f470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13bf201d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13bf2fac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13bf2ff60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13bf30400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13bf308a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13bf30d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13bf311e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13bf31680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13bf31b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13bf31fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13bf32460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13bf32900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13bf32da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13bf33240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13bf336e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13bf33b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13bf34020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13bf344c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13bf34960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13bf34e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13bf352a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13bf35740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13bf35be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13bf36080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13bf36520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13bf369c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13bf36e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13bf37300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13bf377a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13bf37c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13bf380e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13bf38580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13bf38a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13bf38ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13bf39360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13bf39800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13bf39ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13bf3a140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13bf3a5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13bf3aa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13bf3af20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13bf3b3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13bf3b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13bf3bd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13bf3c1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13bf3c640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13bf3cae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13bf3cf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13bf3d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13bf3d8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13bf3dd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13bf3e200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13bf3e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13bf3eb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13bf3efe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13bf3f480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13bf3f9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13bf3ff20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13bf40470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13bf409c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13bf40c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13bf41290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13bf418a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13bf41eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13bf424c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13bf42ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13bf432c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13bf43760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13bf43c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13bf440a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13bf44850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13bf44da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13bf452f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13bf45840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13bf45d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13bf462e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13bf46830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13bf46d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13bf472d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13bf47820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13bf47d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13bf482c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13bf48810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13bf48d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13bf492b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13bf49800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13bf49d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13bf4a2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13bf4a7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13bf4ad40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13bf4b290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13bf4b7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13bf4bd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13bf4c280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13bf4c7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13bf4cd20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13bf4d270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13bf4d7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13bf4dd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13bf4e260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13bf4e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13bf4ed00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13bf4f250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13bf4f7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13bf4fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13bf50240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13bf50790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13bf50ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13bf51230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13bf51780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13bf51cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13bf52220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13bf52770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13bf52cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13bf53210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13bf53760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13bf53cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13bf54200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13bf54750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13bf54ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13bf551f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13bf55740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13bf55c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13bf561e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13bf56730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13bf56c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13bf571d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13bf57670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13bf57b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13bf57fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13bf58450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13bf588f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13bf58d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13bf59230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13bf596d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13bf59b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13bf5a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13bf5a4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13bf5a950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13bf5adf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13bf5b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13bf5ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13bf5c180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13bf5c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13bf5cfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13bf5d280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13bf5d890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13bf5dea0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.093.361 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13be06770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13be06be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13be07050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13be074c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13be07930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13be07da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13be08210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13be08680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13be08af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13be09020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13be09490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13be09b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13be0a630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13be0ade0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13be0b5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13be0bd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13be0c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13be0cb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13be0d270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13be0da40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13be0e160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13be0e880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13be0efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13be0f6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13be0fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13be100a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13be10360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13be107d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13be10c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13be110b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13be11520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13be11a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13be11ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13be12180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13be125f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13be12a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13be12ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13be13340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13be137b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13be13c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13be14090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13be14500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13be14970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13be14de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13be15250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13be156c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13be15b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13be15fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13be16410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13be16880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13be16cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13be17160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13be175d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13be17a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13be17eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13be18320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13be18890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13be18d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13be19200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13be19670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13be19ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13be19f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13be1a3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13be1a830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13be1aca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13be1b110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13be1b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13be1b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13be1be60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13be1c2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13be1c740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13be1cbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13be1d020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13be1d490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13be1d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13be1dd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13be1e1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13be1e650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13be1eac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13be1ef30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13be1f3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13be1f810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13be1fc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13be200f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13be20560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13be209d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13be20e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13be212b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13be21720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13be21b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13be22000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13be22470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13be228e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13be22d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13be231c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13be23630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13be23aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13be23f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13be24380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13be247f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13be24c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13be250d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13be25540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13be259b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13be25e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13be26290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13be26700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13be26b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13be26fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13be27450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13be278c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13be27d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13be281a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13be28610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13be28a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13be28ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13be29360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13be297d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13be29c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13be2a0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13be2a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13be2a990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13be2ae00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13be2b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13be2b6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13be2bb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13be2bfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13be2c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13be2c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13be2cd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13be2d180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13be2d5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13be2da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13be2ded0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13be2e340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13be2e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13be2ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13be2f090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13be2f500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13be2f970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13be2fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13be30250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13be306c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13be30b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13be30fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13be31410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13be31880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13be31cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13be32160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13be325d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13be32a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13be32eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13be33320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13be33790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13be33c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13be34070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13be344e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13be34950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13be34dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13be35230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13be356a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13be35b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13be35f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13be363f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13be36860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13be36cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13be37140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13be37cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13be37f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13be38250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13be386c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13be38b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13be38fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13be39410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13be39880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13be39cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13be3a160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13be3a5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13be3aa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13be3aeb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13be3b320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13be3b790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13be3bc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13be3c070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13be3c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13be3c950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13be3cdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13be3d230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13be3d6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13be3db10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13be3df80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13be3e3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13be3e860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13be3ecd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13be3f140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13be3f5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13be3fa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13be3fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13be40300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13be40770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13be40be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13be41050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13be414c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13be41930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13be41da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13be42210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13be42680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13be42af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13be42f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13be433d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13be43840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13be43cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13be44120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13be44590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13be44a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13be44e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13be452e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13be45750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13be45bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13be46030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13be464a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13be46910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13be46d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13be471f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13be47660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13be47ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13be47f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13be483b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13be48820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13be48c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13be49100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13be49570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13be499e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13be49e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13be4a2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13be4a730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13be4aba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13be4b010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13be4bb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13be4c270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13be4c990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13be4d0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13be4d370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13be4d630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13be4daa0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13be06770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13be06be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13be07050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13be074c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13be07930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13be07da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13be08210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13be08680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13be08af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13be08f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13be093d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13be099b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13be0a2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13be0aa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13be0b200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13be0b8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13be0bfe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13be0c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13be0cdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13be0d740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13be0de30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13be0e520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13be0ec10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13be0f300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13be0f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13be0fe60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13be102d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13be10740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13be10bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13be11020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13be11490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13be11900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13be11d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13be12030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13be124a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13be12910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13be12d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13be131f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13be13660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13be13ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13be13f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13be143b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13be14820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13be14c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13be15100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13be15570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13be159e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13be15e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13be162c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13be16730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13be16ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13be17010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13be17480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13be178f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13be17d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13be181d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13be18640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13be18ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13be18f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13be19390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13be19800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13be19c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13be1a0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13be1a550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13be1a9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13be1ae30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13be1b2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13be1b710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13be1bb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13be1bff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13be1c460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13be1c8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13be1cd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13be1d1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13be1d620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13be1da90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13be1df00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13be1e370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13be1e7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13be1ec50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13be1f0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13be1f530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13be1f9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13be1fe10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13be20280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13be206f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13be20b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13be20fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13be21440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13be218b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13be21d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13be22190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13be22600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13be22a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13be22ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13be23350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13be237c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13be23c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13be240a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13be24510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13be24980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13be24df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13be25260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13be256d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13be25b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13be25fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13be26420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13be26890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13be26d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13be27170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13be275e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13be27a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13be27ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13be28330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13be287a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13be28c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13be29080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13be294f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13be29960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13be29dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13be2a240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13be2a6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13be2ab20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13be2af90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13be2b400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13be2b870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13be2bce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13be2c150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13be2c5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13be2ca30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13be2cea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13be2d310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13be2d780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13be2dbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13be2e060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13be2e4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13be2e940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13be2edb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13be2f220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13be2f690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13be2fb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13be2ff70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13be303e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13be30850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13be30cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13be31130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13be315a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13be31a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13be31e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13be322f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13be32760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13be32bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13be33040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13be334b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13be33920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13be33d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13be34200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13be34670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13be34ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13be34f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13be353c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13be35830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13be35ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13be36110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13be36580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13be369f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13be36e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13be375e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13be37a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13be37ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13be38330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13be387a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13be38c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13be39080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13be394f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13be39960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13be39dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13be3a240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13be3a6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13be3ab20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13be3af90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13be3b400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13be3b870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13be3bce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13be3c150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13be3c5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13be3ca30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13be3cea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13be3d310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13be3d780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13be3dbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13be3e060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13be3e4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13be3e940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13be3edb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13be3f220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13be3f690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13be3fb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13be3ff70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13be403e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13be40850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13be40cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13be41130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13be415a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13be41a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13be41e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13be422f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13be42760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13be42bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13be43040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13be434b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13be43920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13be43d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13be44200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13be44670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13be44ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13be44f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13be453c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13be45830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13be45ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13be46110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13be46580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13be469f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13be46e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13be472d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13be47740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13be47bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13be48020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13be48490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13be48900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13be48d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13be491e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13be49650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13be49ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13be49f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13be4a3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13be4a810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13be4ac80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13be4b370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13be4ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13be4c150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13be4c840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13be4ccb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13be4d120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13be4d590 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Our old friend, Zorro." "He


second run: The quick brown fox jumps over the lazy Dog." "Our old friend, Zorro." "He


single seq run: The quick brown fox jumps over the lazy Dog." "Our old friend, Zorro." "He

real	0m0.953s
user	0m0.238s
sys	0m0.126s
```
### ctest_with_model_debug

Runs ctest with model files in debug mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-debug
    Start 23: test-model-load-cancel
1/2 Test #23: test-model-load-cancel ...........   Passed    0.54 sec
    Start 24: test-autorelease
2/2 Test #24: test-autorelease .................   Passed    0.57 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   1.11 sec*proc (2 tests)

Total Test time (real) =   1.12 sec
        1.14 real         0.71 user         0.05 sys
```
### ctest_with_model_release

Runs ctest with model files in release mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-release
    Start 23: test-model-load-cancel
1/2 Test #23: test-model-load-cancel ...........   Passed    0.25 sec
    Start 24: test-autorelease
2/2 Test #24: test-autorelease .................   Passed    0.33 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   0.58 sec*proc (2 tests)

Total Test time (real) =   0.59 sec
        0.59 real         0.15 user         0.05 sys
```
