Archive:  models-mnt/wikitext/wikitext-2-raw-v1.zip
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.test.raw  
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.valid.raw  
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.train.raw  
+ cmake -DCMAKE_BUILD_TYPE=Release -DLLAMA_FATAL_WARNINGS=ON -DGGML_METAL=ON -DGGML_METAL_USE_BF16=ON ..
-- The C compiler identification is AppleClang 16.0.0.16000026
-- The CXX compiler identification is AppleClang 16.0.0.16000026
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /Library/Developer/CommandLineTools/usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /Library/Developer/CommandLineTools/usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Found Git: /usr/bin/git (found version "2.39.5 (Apple Git-154)")
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
-- Found Threads: TRUE
-- ccache found, compilation results will be cached. Disable with GGML_CCACHE=OFF.
-- CMAKE_SYSTEM_PROCESSOR: arm64
-- Accelerate framework found
-- Could NOT find OpenMP_C (missing: OpenMP_C_FLAGS OpenMP_C_LIB_NAMES) 
-- Could NOT find OpenMP_CXX (missing: OpenMP_CXX_FLAGS OpenMP_CXX_LIB_NAMES) 
-- Could NOT find OpenMP (missing: OpenMP_C_FOUND OpenMP_CXX_FOUND) 
CMake Warning at ggml/src/ggml-cpu/CMakeLists.txt:44 (message):
  OpenMP not found


-- Using llamafile
-- ARM detected
-- Performing Test GGML_COMPILER_SUPPORT_DOTPROD
-- Performing Test GGML_COMPILER_SUPPORT_DOTPROD - Success
-- ARM feature DOTPROD enabled
-- Performing Test GGML_COMPILER_SUPPORT_MATMUL_INT8
-- Performing Test GGML_COMPILER_SUPPORT_MATMUL_INT8 - Success
-- ARM feature MATMUL_INT8 enabled
-- Using runtime weight conversion of Q4_0 to Q4_0_x_x to enable optimized GEMM/GEMV kernels
-- Including CPU backend
-- Looking for dgemm_
-- Looking for dgemm_ - found
-- Found BLAS: /Library/Developer/CommandLineTools/SDKs/MacOSX15.1.sdk/System/Library/Frameworks/Accelerate.framework
-- BLAS found, Libraries: /Library/Developer/CommandLineTools/SDKs/MacOSX15.1.sdk/System/Library/Frameworks/Accelerate.framework
-- BLAS found, Includes: 
-- Including BLAS backend
-- Metal framework found
-- The ASM compiler identification is AppleClang
-- Found assembler: /Library/Developer/CommandLineTools/usr/bin/cc
-- Including METAL backend
-- Configuring done (1.4s)
-- Generating done (0.2s)
-- Build files have been written to: /Users/ggml/work/llama.cpp/build-ci-release

real	0m1.630s
user	0m0.710s
sys	0m0.942s
++ nproc
+ make -j10
[  0%] Building C object examples/gguf-hash/CMakeFiles/sha1.dir/deps/sha1/sha1.c.o
[  0%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-alloc.c.o
[  2%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-backend.cpp.o
[  2%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml.c.o
[  4%] Building C object examples/gguf-hash/CMakeFiles/sha256.dir/deps/sha256/sha256.c.o
[  4%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-opt.cpp.o
[  4%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-threading.cpp.o
[  5%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-quants.c.o
[  6%] Building CXX object common/CMakeFiles/build_info.dir/build-info.cpp.o
[  7%] Building C object examples/gguf-hash/CMakeFiles/xxhash.dir/deps/xxhash/xxhash.c.o
[  7%] Built target sha1
[  7%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-aarch64.c.o
[  7%] Built target sha256
[  7%] Built target build_info
[  7%] Built target xxhash
[  8%] Linking CXX shared library libggml-base.dylib
[  8%] Built target ggml-base
[  8%] Generate assembly for embedded Metal library
Embedding Metal library
[  8%] Building CXX object ggml/src/ggml-blas/CMakeFiles/ggml-blas.dir/ggml-blas.cpp.o
[  8%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu.c.o
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu-quants.c.o
[ 10%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/cpu-feats-x86.cpp.o
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu-aarch64.c.o
[ 10%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/llamafile/sgemm.cpp.o
[ 11%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu.cpp.o
[ 12%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/amx/mmq.cpp.o
[ 12%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/amx/amx.cpp.o
[ 13%] Linking CXX shared library libggml-blas.dylib
[ 14%] Linking CXX shared library libggml-cpu.dylib
[ 14%] Building ASM object ggml/src/ggml-metal/CMakeFiles/ggml-metal.dir/__/__/__/autogenerated/ggml-metal-embed.s.o
[ 15%] Building C object ggml/src/ggml-metal/CMakeFiles/ggml-metal.dir/ggml-metal.m.o
[ 15%] Built target ggml-blas
[ 15%] Built target ggml-cpu
[ 16%] Linking C shared library libggml-metal.dylib
[ 16%] Built target ggml-metal
[ 17%] Building CXX object ggml/src/CMakeFiles/ggml.dir/ggml-backend-reg.cpp.o
[ 17%] Linking CXX shared library libggml.dylib
[ 17%] Built target ggml
[ 19%] Building CXX object examples/gguf-hash/CMakeFiles/llama-gguf-hash.dir/gguf-hash.cpp.o
[ 19%] Building CXX object examples/gguf/CMakeFiles/llama-gguf.dir/gguf.cpp.o
[ 19%] Building CXX object src/CMakeFiles/llama.dir/llama.cpp.o
[ 19%] Building CXX object src/CMakeFiles/llama.dir/llama-grammar.cpp.o
[ 20%] Building CXX object src/CMakeFiles/llama.dir/llama-vocab.cpp.o
[ 20%] Building CXX object src/CMakeFiles/llama.dir/unicode.cpp.o
[ 21%] Building CXX object src/CMakeFiles/llama.dir/llama-sampling.cpp.o
[ 22%] Building CXX object src/CMakeFiles/llama.dir/unicode-data.cpp.o
[ 22%] Linking CXX executable ../../bin/llama-gguf-hash
[ 22%] Linking CXX executable ../../bin/llama-gguf
[ 22%] Linking CXX shared library libllama.dylib
[ 22%] Built target llama-gguf
[ 22%] Built target llama-gguf-hash
[ 22%] Built target llama
[ 23%] Building CXX object common/CMakeFiles/common.dir/json-schema-to-grammar.cpp.o
[ 24%] Building CXX object common/CMakeFiles/common.dir/common.cpp.o
[ 24%] Building CXX object common/CMakeFiles/common.dir/console.cpp.o
[ 24%] Building CXX object common/CMakeFiles/common.dir/arg.cpp.o
[ 25%] Building C object tests/CMakeFiles/test-c.dir/test-c.c.o
[ 26%] Building CXX object examples/run/CMakeFiles/llama-run.dir/run.cpp.o
[ 27%] Building CXX object examples/quantize-stats/CMakeFiles/llama-quantize-stats.dir/quantize-stats.cpp.o
[ 27%] Building CXX object examples/llava/CMakeFiles/llava.dir/llava.cpp.o
[ 28%] Building CXX object examples/simple-chat/CMakeFiles/llama-simple-chat.dir/simple-chat.cpp.o
[ 29%] Building CXX object examples/simple/CMakeFiles/llama-simple.dir/simple.cpp.o
[ 29%] Building CXX object common/CMakeFiles/common.dir/log.cpp.o
[ 30%] Building CXX object common/CMakeFiles/common.dir/ngram-cache.cpp.o
[ 31%] Building CXX object examples/llava/CMakeFiles/llava.dir/clip.cpp.o
[ 31%] Linking CXX executable ../../bin/llama-quantize-stats
[ 31%] Linking CXX executable ../../bin/llama-run
[ 31%] Building CXX object common/CMakeFiles/common.dir/sampling.cpp.o
[ 31%] Linking C executable ../bin/test-c
[ 31%] Linking CXX executable ../../bin/llama-simple
[ 31%] Linking CXX executable ../../bin/llama-simple-chat
[ 32%] Building CXX object common/CMakeFiles/common.dir/speculative.cpp.o
[ 32%] Built target llava
[ 32%] Linking CXX static library libcommon.a
[ 33%] Linking CXX static library libllava_static.a
[ 33%] Linking CXX shared library libllava_shared.dylib
[ 33%] Built target test-c
[ 33%] Built target llama-run
[ 33%] Built target llama-quantize-stats
[ 33%] Built target llama-simple
[ 33%] Built target llama-simple-chat
[ 33%] Built target common
[ 33%] Built target llava_static
[ 33%] Built target llava_shared
[ 34%] Building CXX object tests/CMakeFiles/test-chat-template.dir/test-chat-template.cpp.o
[ 35%] Building CXX object tests/CMakeFiles/test-log.dir/test-log.cpp.o
[ 35%] Building CXX object tests/CMakeFiles/test-tokenizer-1-spm.dir/test-tokenizer-1-spm.cpp.o
[ 36%] Building CXX object tests/CMakeFiles/test-sampling.dir/test-sampling.cpp.o
[ 36%] Building CXX object tests/CMakeFiles/test-grammar-integration.dir/test-grammar-integration.cpp.o
[ 36%] Building CXX object tests/CMakeFiles/test-tokenizer-0.dir/test-tokenizer-0.cpp.o
[ 36%] Building CXX object tests/CMakeFiles/test-arg-parser.dir/test-arg-parser.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-grammar-parser.dir/test-grammar-parser.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-tokenizer-1-bpe.dir/test-tokenizer-1-bpe.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-llama-grammar.dir/test-llama-grammar.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-chat-template.dir/get-model.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-log.dir/get-model.cpp.o
[ 38%] Building CXX object tests/CMakeFiles/test-grammar-integration.dir/get-model.cpp.o
[ 38%] Building CXX object tests/CMakeFiles/test-sampling.dir/get-model.cpp.o
[ 39%] Linking CXX executable ../bin/test-tokenizer-1-spm
[ 41%] Linking CXX executable ../bin/test-tokenizer-1-bpe
[ 41%] Linking CXX executable ../bin/test-tokenizer-0
[ 42%] Building CXX object tests/CMakeFiles/test-arg-parser.dir/get-model.cpp.o
[ 42%] Building CXX object tests/CMakeFiles/test-grammar-parser.dir/get-model.cpp.o
[ 43%] Linking CXX executable ../bin/test-chat-template
[ 45%] Linking CXX executable ../bin/test-log
[ 45%] Linking CXX executable ../bin/test-arg-parser
[ 45%] Building CXX object tests/CMakeFiles/test-llama-grammar.dir/get-model.cpp.o
[ 46%] Linking CXX executable ../bin/test-sampling
[ 46%] Linking CXX executable ../bin/test-grammar-integration
[ 47%] Linking CXX executable ../bin/test-grammar-parser
[ 47%] Linking CXX executable ../bin/test-llama-grammar
[ 47%] Built target test-tokenizer-1-bpe
[ 47%] Built target test-tokenizer-1-spm
[ 47%] Built target test-tokenizer-0
[ 47%] Built target test-grammar-integration
[ 47%] Built target test-chat-template
[ 47%] Built target test-log
[ 47%] Built target test-sampling
[ 47%] Built target test-grammar-parser
[ 47%] Built target test-arg-parser
[ 47%] Building CXX object tests/CMakeFiles/test-model-load-cancel.dir/test-model-load-cancel.cpp.o
[ 48%] Building CXX object tests/CMakeFiles/test-backend-ops.dir/test-backend-ops.cpp.o
[ 48%] Building CXX object tests/CMakeFiles/test-barrier.dir/test-barrier.cpp.o
[ 48%] Building CXX object tests/CMakeFiles/test-rope.dir/test-rope.cpp.o
[ 49%] Building CXX object tests/CMakeFiles/test-autorelease.dir/test-autorelease.cpp.o
[ 50%] Building CXX object tests/CMakeFiles/test-quantize-fns.dir/test-quantize-fns.cpp.o
[ 52%] Building CXX object tests/CMakeFiles/test-json-schema-to-grammar.dir/test-json-schema-to-grammar.cpp.o
[ 52%] Building CXX object tests/CMakeFiles/test-quantize-perf.dir/test-quantize-perf.cpp.o
[ 52%] Built target test-llama-grammar
[ 53%] Building CXX object tests/CMakeFiles/test-model-load-cancel.dir/get-model.cpp.o
[ 54%] Building CXX object examples/batched-bench/CMakeFiles/llama-batched-bench.dir/batched-bench.cpp.o
[ 54%] Building CXX object tests/CMakeFiles/test-backend-ops.dir/get-model.cpp.o
[ 55%] Building CXX object tests/CMakeFiles/test-barrier.dir/get-model.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-rope.dir/get-model.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-quantize-fns.dir/get-model.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-autorelease.dir/get-model.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-quantize-perf.dir/get-model.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-json-schema-to-grammar.dir/get-model.cpp.o
[ 56%] Linking CXX executable ../bin/test-model-load-cancel
[ 57%] Linking CXX executable ../../bin/llama-batched-bench
[ 57%] Linking CXX executable ../bin/test-barrier
[ 58%] Building CXX object examples/batched/CMakeFiles/llama-batched.dir/batched.cpp.o
[ 59%] Linking CXX executable ../bin/test-backend-ops
[ 59%] Linking CXX executable ../bin/test-rope
[ 60%] Linking CXX executable ../bin/test-quantize-fns
[ 61%] Linking CXX executable ../bin/test-quantize-perf
[ 62%] Linking CXX executable ../bin/test-autorelease
[ 63%] Linking CXX executable ../bin/test-json-schema-to-grammar
[ 63%] Linking CXX executable ../../bin/llama-batched
[ 63%] Built target test-barrier
[ 63%] Built target llama-batched-bench
[ 63%] Built target test-model-load-cancel
[ 63%] Built target test-autorelease
[ 63%] Built target test-quantize-fns
[ 63%] Built target test-backend-ops
[ 63%] Built target test-quantize-perf
[ 63%] Built target test-rope
[ 63%] Built target test-json-schema-to-grammar
[ 63%] Built target llama-batched
[ 63%] Building CXX object examples/eval-callback/CMakeFiles/llama-eval-callback.dir/eval-callback.cpp.o
[ 63%] Building CXX object examples/gbnf-validator/CMakeFiles/llama-gbnf-validator.dir/gbnf-validator.cpp.o
[ 63%] Building CXX object examples/embedding/CMakeFiles/llama-embedding.dir/embedding.cpp.o
[ 64%] Building CXX object examples/gguf-split/CMakeFiles/llama-gguf-split.dir/gguf-split.cpp.o
[ 65%] Building CXX object examples/gritlm/CMakeFiles/llama-gritlm.dir/gritlm.cpp.o
[ 66%] Building CXX object examples/imatrix/CMakeFiles/llama-imatrix.dir/imatrix.cpp.o
[ 67%] Building CXX object examples/infill/CMakeFiles/llama-infill.dir/infill.cpp.o
[ 67%] Building CXX object examples/llama-bench/CMakeFiles/llama-bench.dir/llama-bench.cpp.o
[ 68%] Building CXX object examples/lookahead/CMakeFiles/llama-lookahead.dir/lookahead.cpp.o
[ 68%] Building CXX object examples/lookup/CMakeFiles/llama-lookup.dir/lookup.cpp.o
[ 69%] Linking CXX executable ../../bin/llama-eval-callback
[ 70%] Linking CXX executable ../../bin/llama-gbnf-validator
[ 70%] Linking CXX executable ../../bin/llama-gritlm
[ 70%] Linking CXX executable ../../bin/llama-imatrix
[ 70%] Linking CXX executable ../../bin/llama-gguf-split
[ 71%] Linking CXX executable ../../bin/llama-embedding
[ 71%] Linking CXX executable ../../bin/llama-infill
[ 72%] Linking CXX executable ../../bin/llama-bench
[ 73%] Linking CXX executable ../../bin/llama-lookahead
[ 74%] Linking CXX executable ../../bin/llama-lookup
[ 74%] Built target llama-gbnf-validator
[ 74%] Built target llama-imatrix
[ 74%] Built target llama-eval-callback
[ 74%] Built target llama-gritlm
[ 74%] Built target llama-embedding
[ 74%] Built target llama-gguf-split
[ 74%] Built target llama-bench
[ 74%] Built target llama-infill
[ 74%] Built target llama-lookup
[ 74%] Built target llama-lookahead
[ 74%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-create.dir/lookup-create.cpp.o
[ 74%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-merge.dir/lookup-merge.cpp.o
[ 75%] Generating loading.html.hpp
[ 75%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-stats.dir/lookup-stats.cpp.o
[ 74%] Building CXX object examples/parallel/CMakeFiles/llama-parallel.dir/parallel.cpp.o
[ 75%] Building CXX object examples/main/CMakeFiles/llama-cli.dir/main.cpp.o
[ 76%] Building CXX object examples/quantize/CMakeFiles/llama-quantize.dir/quantize.cpp.o
[ 76%] Building CXX object examples/passkey/CMakeFiles/llama-passkey.dir/passkey.cpp.o
[ 77%] Building CXX object examples/perplexity/CMakeFiles/llama-perplexity.dir/perplexity.cpp.o
[ 78%] Building CXX object examples/retrieval/CMakeFiles/llama-retrieval.dir/retrieval.cpp.o
[ 79%] Linking CXX executable ../../bin/llama-lookup-create
[ 79%] Generating completion.js.hpp
[ 80%] Linking CXX executable ../../bin/llama-parallel
[ 81%] Linking CXX executable ../../bin/llama-lookup-merge
[ 82%] Linking CXX executable ../../bin/llama-lookup-stats
[ 83%] Linking CXX executable ../../bin/llama-cli
[ 84%] Linking CXX executable ../../bin/llama-passkey
[ 84%] Linking CXX executable ../../bin/llama-quantize
[ 84%] Linking CXX executable ../../bin/llama-perplexity
[ 84%] Linking CXX executable ../../bin/llama-retrieval
[ 85%] Generating deps_daisyui.min.css.hpp
[ 85%] Built target llama-lookup-stats
[ 85%] Built target llama-lookup-merge
[ 85%] Built target llama-quantize
[ 85%] Built target llama-cli
[ 85%] Built target llama-parallel
[ 85%] Built target llama-lookup-create
[ 85%] Built target llama-passkey
[ 85%] Generating deps_markdown-it.js.hpp
[ 85%] Built target llama-perplexity
[ 85%] Built target llama-retrieval
[ 86%] Building CXX object examples/save-load-state/CMakeFiles/llama-save-load-state.dir/save-load-state.cpp.o
[ 87%] Building CXX object examples/speculative-simple/CMakeFiles/llama-speculative-simple.dir/speculative-simple.cpp.o
[ 88%] Building CXX object examples/speculative/CMakeFiles/llama-speculative.dir/speculative.cpp.o
[ 88%] Building CXX object examples/convert-llama2c-to-ggml/CMakeFiles/llama-convert-llama2c-to-ggml.dir/convert-llama2c-to-ggml.cpp.o
[ 89%] Building CXX object examples/tokenize/CMakeFiles/llama-tokenize.dir/tokenize.cpp.o
[ 89%] Building CXX object examples/cvector-generator/CMakeFiles/llama-cvector-generator.dir/cvector-generator.cpp.o
[ 89%] Building CXX object examples/export-lora/CMakeFiles/llama-export-lora.dir/export-lora.cpp.o
[ 90%] Building CXX object examples/llava/CMakeFiles/llama-llava-cli.dir/llava-cli.cpp.o
[ 90%] Linking CXX executable ../../bin/llama-save-load-state
[ 90%] Linking CXX executable ../../bin/llama-speculative
[ 90%] Linking CXX executable ../../bin/llama-speculative-simple
[ 92%] Linking CXX executable ../../bin/llama-convert-llama2c-to-ggml
[ 91%] Linking CXX executable ../../bin/llama-tokenize
[ 93%] Generating deps_tailwindcss.js.hpp
[ 94%] Linking CXX executable ../../bin/llama-cvector-generator
[ 95%] Linking CXX executable ../../bin/llama-export-lora
[ 95%] Linking CXX executable ../../bin/llama-llava-cli
[ 95%] Built target llama-save-load-state
[ 95%] Built target llama-speculative-simple
[ 95%] Built target llama-tokenize
[ 95%] Built target llama-export-lora
[ 95%] Built target llama-convert-llama2c-to-ggml
[ 95%] Generating deps_vue.esm-browser.js.hpp
[ 95%] Built target llama-cvector-generator
[ 95%] Built target llama-speculative
[ 96%] Generating index.html.hpp
[ 96%] Built target llama-llava-cli
[ 96%] Building CXX object pocs/vdot/CMakeFiles/llama-vdot.dir/vdot.cpp.o
[ 96%] Building CXX object examples/llava/CMakeFiles/llama-minicpmv-cli.dir/minicpmv-cli.cpp.o
[ 97%] Building CXX object pocs/vdot/CMakeFiles/llama-q8dot.dir/q8dot.cpp.o
[ 98%] Linking CXX executable ../../bin/llama-vdot
[ 99%] Linking CXX executable ../../bin/llama-minicpmv-cli
[ 99%] Linking CXX executable ../../bin/llama-q8dot
[ 99%] Built target llama-q8dot
[ 99%] Built target llama-vdot
[ 99%] Built target llama-minicpmv-cli
[100%] Building CXX object examples/server/CMakeFiles/llama-server.dir/server.cpp.o
[100%] Linking CXX executable ../../bin/llama-server
[100%] Built target llama-server

real	0m2.582s
user	0m5.714s
sys	0m8.901s

main: quantize time =  6208.04 ms
main:    total time =  6208.04 ms

main: quantize time =  1935.61 ms
main:    total time =  1935.61 ms

main: quantize time =  2637.33 ms
main:    total time =  2637.33 ms

main: quantize time =  2018.02 ms
main:    total time =  2018.02 ms

main: quantize time =  2008.92 ms
main:    total time =  2008.92 ms

main: quantize time =  5062.80 ms
main:    total time =  5062.80 ms

main: quantize time =  5740.65 ms
main:    total time =  5740.65 ms

main: quantize time =  6919.91 ms
main:    total time =  6919.91 ms

main: quantize time =  5972.05 ms
main:    total time =  5972.05 ms

main: quantize time =  4554.12 ms
main:    total time =  4554.12 ms
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.137 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.284 I main: llama backend init
0.00.000.292 I main: load the model and apply lora adapter, if any
0.00.101.918 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.113.023 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.113.037 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.113.041 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.113.042 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.113.043 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.113.043 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.113.044 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.113.046 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.113.046 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.113.047 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.113.048 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.113.048 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.113.049 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.113.050 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.113.058 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.113.058 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.113.059 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.120.111 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.122.430 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.129.490 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.129.498 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.129.498 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.129.499 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.129.500 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.129.502 I llama_model_loader: - type  f32:  194 tensors
0.00.129.502 I llama_model_loader: - type  f16:   98 tensors
0.00.169.586 I llm_load_vocab: special tokens cache size = 25
0.00.177.166 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.177.169 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.177.170 I llm_load_print_meta: arch             = gptneox
0.00.177.170 I llm_load_print_meta: vocab type       = BPE
0.00.177.170 I llm_load_print_meta: n_vocab          = 50304
0.00.177.170 I llm_load_print_meta: n_merges         = 50009
0.00.177.171 I llm_load_print_meta: vocab_only       = 0
0.00.177.171 I llm_load_print_meta: n_ctx_train      = 2048
0.00.177.171 I llm_load_print_meta: n_embd           = 2048
0.00.177.171 I llm_load_print_meta: n_layer          = 24
0.00.177.175 I llm_load_print_meta: n_head           = 16
0.00.177.176 I llm_load_print_meta: n_head_kv        = 16
0.00.177.176 I llm_load_print_meta: n_rot            = 32
0.00.177.176 I llm_load_print_meta: n_swa            = 0
0.00.177.176 I llm_load_print_meta: n_embd_head_k    = 128
0.00.177.176 I llm_load_print_meta: n_embd_head_v    = 128
0.00.177.177 I llm_load_print_meta: n_gqa            = 1
0.00.177.178 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.177.178 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.177.179 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.177.181 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.177.181 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.177.181 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.177.181 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.177.182 I llm_load_print_meta: n_ff             = 8192
0.00.177.182 I llm_load_print_meta: n_expert         = 0
0.00.177.182 I llm_load_print_meta: n_expert_used    = 0
0.00.177.182 I llm_load_print_meta: causal attn      = 1
0.00.177.182 I llm_load_print_meta: pooling type     = 0
0.00.177.183 I llm_load_print_meta: rope type        = 2
0.00.177.183 I llm_load_print_meta: rope scaling     = linear
0.00.177.184 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.177.184 I llm_load_print_meta: freq_scale_train = 1
0.00.177.185 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.177.185 I llm_load_print_meta: rope_finetuned   = unknown
0.00.177.185 I llm_load_print_meta: ssm_d_conv       = 0
0.00.177.185 I llm_load_print_meta: ssm_d_inner      = 0
0.00.177.185 I llm_load_print_meta: ssm_d_state      = 0
0.00.177.187 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.177.187 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.177.199 I llm_load_print_meta: model type       = 1.4B
0.00.177.199 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.177.200 I llm_load_print_meta: model params     = 1.41 B
0.00.177.200 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.177.201 I llm_load_print_meta: general.name     = 1.4B
0.00.177.201 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.177.201 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.177.201 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.177.202 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.177.202 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.177.202 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.177.202 I llm_load_print_meta: max token length = 1024
0.00.179.522 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.179.522 I llm_load_tensors: offloading output layer to GPU
0.00.179.523 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.179.540 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.179.542 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.180.537 I llama_new_context_with_model: n_seq_max     = 1
0.00.180.538 I llama_new_context_with_model: n_ctx         = 2048
0.00.180.539 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.180.539 I llama_new_context_with_model: n_batch       = 2048
0.00.180.539 I llama_new_context_with_model: n_ubatch      = 512
0.00.180.539 I llama_new_context_with_model: flash_attn    = 0
0.00.180.540 I llama_new_context_with_model: freq_base     = 10000.0
0.00.180.540 I llama_new_context_with_model: freq_scale    = 1
0.00.180.541 I ggml_metal_init: allocating
0.00.180.544 I ggml_metal_init: found device: Apple M4
0.00.180.546 I ggml_metal_init: picking default device: Apple M4
0.00.181.225 I ggml_metal_init: using embedded metal library
0.00.255.001 I ggml_metal_init: GPU name:   Apple M4
0.00.255.006 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.255.006 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.255.007 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.255.007 I ggml_metal_init: simdgroup reduction   = true
0.00.255.007 I ggml_metal_init: simdgroup matrix mul. = true
0.00.255.007 I ggml_metal_init: has bfloat            = true
0.00.255.007 I ggml_metal_init: use bfloat            = true
0.00.255.008 I ggml_metal_init: hasUnifiedMemory      = true
0.00.255.010 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.316.059 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.316.067 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.316.094 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.317.446 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.317.447 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.317.448 I llama_new_context_with_model: graph nodes  = 967
0.00.317.448 I llama_new_context_with_model: graph splits = 2
0.00.317.469 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.418.996 I main: llama threadpool init, n_threads = 4
0.00.419.037 I 
0.00.419.078 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.419.079 I 
0.00.419.294 I sampler seed: 1234
0.00.419.299 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.419.333 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.419.334 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.419.335 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling depressed, and I've had a hard time getting out of bed. I think the only thing I

0.02.291.981 I llama_perf_sampler_print:    sampling time =       1.27 ms /    71 runs   (    0.02 ms per token, 56082.15 tokens per second)
0.02.291.982 I llama_perf_context_print:        load time =     317.06 ms
0.02.291.983 I llama_perf_context_print: prompt eval time =      38.30 ms /     7 tokens (    5.47 ms per token,   182.78 tokens per second)
0.02.291.984 I llama_perf_context_print:        eval time =    1831.38 ms /    63 runs   (   29.07 ms per token,    34.40 tokens per second)
0.02.291.984 I llama_perf_context_print:       total time =    1872.99 ms /    70 tokens
0.02.292.135 I ggml_metal_free: deallocating

real	0m2.642s
user	0m0.158s
sys	0m0.135s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.070 I main: load the model and apply lora adapter, if any
0.00.009.774 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.037.576 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.037.581 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.037.588 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.037.589 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.037.589 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.037.591 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.037.591 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.037.592 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.037.593 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.037.593 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.037.593 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.037.594 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.037.594 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.037.594 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.037.596 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.037.596 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.037.596 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.042.255 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.043.515 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.048.245 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.048.247 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.048.247 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.048.247 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.048.248 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.048.248 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.048.249 I llama_model_loader: - type  f32:  194 tensors
0.00.048.249 I llama_model_loader: - type q8_0:   98 tensors
0.00.076.382 I llm_load_vocab: special tokens cache size = 25
0.00.086.393 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.086.397 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.086.398 I llm_load_print_meta: arch             = gptneox
0.00.086.398 I llm_load_print_meta: vocab type       = BPE
0.00.086.399 I llm_load_print_meta: n_vocab          = 50304
0.00.086.399 I llm_load_print_meta: n_merges         = 50009
0.00.086.399 I llm_load_print_meta: vocab_only       = 0
0.00.086.399 I llm_load_print_meta: n_ctx_train      = 2048
0.00.086.400 I llm_load_print_meta: n_embd           = 2048
0.00.086.400 I llm_load_print_meta: n_layer          = 24
0.00.086.405 I llm_load_print_meta: n_head           = 16
0.00.086.406 I llm_load_print_meta: n_head_kv        = 16
0.00.086.406 I llm_load_print_meta: n_rot            = 32
0.00.086.407 I llm_load_print_meta: n_swa            = 0
0.00.086.407 I llm_load_print_meta: n_embd_head_k    = 128
0.00.086.407 I llm_load_print_meta: n_embd_head_v    = 128
0.00.086.408 I llm_load_print_meta: n_gqa            = 1
0.00.086.409 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.086.410 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.086.411 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.086.412 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.086.412 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.086.412 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.086.412 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.086.413 I llm_load_print_meta: n_ff             = 8192
0.00.086.414 I llm_load_print_meta: n_expert         = 0
0.00.086.414 I llm_load_print_meta: n_expert_used    = 0
0.00.086.414 I llm_load_print_meta: causal attn      = 1
0.00.086.414 I llm_load_print_meta: pooling type     = 0
0.00.086.415 I llm_load_print_meta: rope type        = 2
0.00.086.415 I llm_load_print_meta: rope scaling     = linear
0.00.086.415 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.086.416 I llm_load_print_meta: freq_scale_train = 1
0.00.086.416 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.086.416 I llm_load_print_meta: rope_finetuned   = unknown
0.00.086.417 I llm_load_print_meta: ssm_d_conv       = 0
0.00.086.417 I llm_load_print_meta: ssm_d_inner      = 0
0.00.086.417 I llm_load_print_meta: ssm_d_state      = 0
0.00.086.417 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.086.417 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.086.431 I llm_load_print_meta: model type       = 1.4B
0.00.086.431 I llm_load_print_meta: model ftype      = Q8_0
0.00.086.432 I llm_load_print_meta: model params     = 1.41 B
0.00.086.433 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.086.433 I llm_load_print_meta: general.name     = 1.4B
0.00.086.433 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.086.434 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.086.434 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.086.434 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.086.434 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.086.435 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.086.435 I llm_load_print_meta: max token length = 1024
0.00.089.587 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.089.587 I llm_load_tensors: offloading output layer to GPU
0.00.089.587 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.089.598 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.089.600 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.091.110 I llama_new_context_with_model: n_seq_max     = 1
0.00.091.111 I llama_new_context_with_model: n_ctx         = 2048
0.00.091.112 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.091.112 I llama_new_context_with_model: n_batch       = 2048
0.00.091.112 I llama_new_context_with_model: n_ubatch      = 512
0.00.091.112 I llama_new_context_with_model: flash_attn    = 0
0.00.091.113 I llama_new_context_with_model: freq_base     = 10000.0
0.00.091.113 I llama_new_context_with_model: freq_scale    = 1
0.00.091.114 I ggml_metal_init: allocating
0.00.091.118 I ggml_metal_init: found device: Apple M4
0.00.091.121 I ggml_metal_init: picking default device: Apple M4
0.00.092.005 I ggml_metal_init: using embedded metal library
0.00.094.986 I ggml_metal_init: GPU name:   Apple M4
0.00.094.988 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.094.988 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.094.989 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.094.989 I ggml_metal_init: simdgroup reduction   = true
0.00.094.989 I ggml_metal_init: simdgroup matrix mul. = true
0.00.094.990 I ggml_metal_init: has bfloat            = true
0.00.094.990 I ggml_metal_init: use bfloat            = true
0.00.094.990 I ggml_metal_init: hasUnifiedMemory      = true
0.00.094.991 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.129.558 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.129.566 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.129.590 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.130.751 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.130.752 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.130.753 I llama_new_context_with_model: graph nodes  = 967
0.00.130.753 I llama_new_context_with_model: graph splits = 2
0.00.130.769 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.905.626 I main: llama threadpool init, n_threads = 4
0.01.905.662 I 
0.01.905.696 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.905.697 I 
0.01.905.950 I sampler seed: 1234
0.01.905.954 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.905.987 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.905.989 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.905.989 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.998.904 I llama_perf_sampler_print:    sampling time =       1.18 ms /    71 runs   (    0.02 ms per token, 60425.53 tokens per second)
0.02.998.904 I llama_perf_context_print:        load time =    1895.85 ms
0.02.998.905 I llama_perf_context_print: prompt eval time =      33.83 ms /     7 tokens (    4.83 ms per token,   206.92 tokens per second)
0.02.998.905 I llama_perf_context_print:        eval time =    1056.14 ms /    63 runs   (   16.76 ms per token,    59.65 tokens per second)
0.02.998.907 I llama_perf_context_print:       total time =    1093.28 ms /    70 tokens
0.02.999.105 I ggml_metal_free: deallocating

real	0m3.017s
user	0m0.132s
sys	0m0.262s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.052 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.083 I main: llama backend init
0.00.000.085 I main: load the model and apply lora adapter, if any
0.00.020.299 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.038.114 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.038.120 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.038.123 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.038.124 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.038.127 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.038.127 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.038.127 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.038.130 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.038.130 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.038.131 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.038.131 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.038.131 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.038.132 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.038.133 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.038.134 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.038.135 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.038.135 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.675 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.442 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.053.396 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.053.398 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.053.399 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.053.399 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.053.400 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.053.400 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.053.401 I llama_model_loader: - type  f32:  194 tensors
0.00.053.401 I llama_model_loader: - type q4_0:   97 tensors
0.00.053.402 I llama_model_loader: - type q6_K:    1 tensors
0.00.095.093 I llm_load_vocab: special tokens cache size = 25
0.00.103.129 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.103.133 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.103.133 I llm_load_print_meta: arch             = gptneox
0.00.103.134 I llm_load_print_meta: vocab type       = BPE
0.00.103.134 I llm_load_print_meta: n_vocab          = 50304
0.00.103.134 I llm_load_print_meta: n_merges         = 50009
0.00.103.134 I llm_load_print_meta: vocab_only       = 0
0.00.103.135 I llm_load_print_meta: n_ctx_train      = 2048
0.00.103.135 I llm_load_print_meta: n_embd           = 2048
0.00.103.135 I llm_load_print_meta: n_layer          = 24
0.00.103.139 I llm_load_print_meta: n_head           = 16
0.00.103.140 I llm_load_print_meta: n_head_kv        = 16
0.00.103.140 I llm_load_print_meta: n_rot            = 32
0.00.103.140 I llm_load_print_meta: n_swa            = 0
0.00.103.143 I llm_load_print_meta: n_embd_head_k    = 128
0.00.103.143 I llm_load_print_meta: n_embd_head_v    = 128
0.00.103.144 I llm_load_print_meta: n_gqa            = 1
0.00.103.145 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.103.146 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.103.146 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.103.147 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.103.147 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.103.147 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.103.147 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.103.148 I llm_load_print_meta: n_ff             = 8192
0.00.103.148 I llm_load_print_meta: n_expert         = 0
0.00.103.148 I llm_load_print_meta: n_expert_used    = 0
0.00.103.149 I llm_load_print_meta: causal attn      = 1
0.00.103.149 I llm_load_print_meta: pooling type     = 0
0.00.103.150 I llm_load_print_meta: rope type        = 2
0.00.103.153 I llm_load_print_meta: rope scaling     = linear
0.00.103.153 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.103.154 I llm_load_print_meta: freq_scale_train = 1
0.00.103.154 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.103.159 I llm_load_print_meta: rope_finetuned   = unknown
0.00.103.160 I llm_load_print_meta: ssm_d_conv       = 0
0.00.103.160 I llm_load_print_meta: ssm_d_inner      = 0
0.00.103.160 I llm_load_print_meta: ssm_d_state      = 0
0.00.103.162 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.103.162 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.103.175 I llm_load_print_meta: model type       = 1.4B
0.00.103.175 I llm_load_print_meta: model ftype      = Q4_0
0.00.103.176 I llm_load_print_meta: model params     = 1.41 B
0.00.103.176 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.103.176 I llm_load_print_meta: general.name     = 1.4B
0.00.103.177 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.103.177 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.103.177 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.103.177 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.103.178 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.103.178 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.103.178 I llm_load_print_meta: max token length = 1024
0.00.105.736 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.105.736 I llm_load_tensors: offloading output layer to GPU
0.00.105.736 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.105.747 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.105.748 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.106.928 I llama_new_context_with_model: n_seq_max     = 1
0.00.106.929 I llama_new_context_with_model: n_ctx         = 2048
0.00.106.930 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.106.930 I llama_new_context_with_model: n_batch       = 2048
0.00.106.930 I llama_new_context_with_model: n_ubatch      = 512
0.00.106.930 I llama_new_context_with_model: flash_attn    = 0
0.00.106.931 I llama_new_context_with_model: freq_base     = 10000.0
0.00.106.931 I llama_new_context_with_model: freq_scale    = 1
0.00.106.932 I ggml_metal_init: allocating
0.00.106.942 I ggml_metal_init: found device: Apple M4
0.00.106.945 I ggml_metal_init: picking default device: Apple M4
0.00.107.706 I ggml_metal_init: using embedded metal library
0.00.110.408 I ggml_metal_init: GPU name:   Apple M4
0.00.110.409 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.110.410 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.110.410 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.110.411 I ggml_metal_init: simdgroup reduction   = true
0.00.110.411 I ggml_metal_init: simdgroup matrix mul. = true
0.00.110.411 I ggml_metal_init: has bfloat            = true
0.00.110.411 I ggml_metal_init: use bfloat            = true
0.00.110.411 I ggml_metal_init: hasUnifiedMemory      = true
0.00.110.412 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.143.905 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.143.916 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.143.939 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.144.934 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.144.935 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.144.935 I llama_new_context_with_model: graph nodes  = 967
0.00.144.935 I llama_new_context_with_model: graph splits = 2
0.00.144.942 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.971.577 I main: llama threadpool init, n_threads = 4
0.00.971.654 I 
0.00.971.711 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.971.713 I 
0.00.972.156 I sampler seed: 1234
0.00.972.165 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.972.212 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.972.213 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.972.213 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.663.975 I llama_perf_sampler_print:    sampling time =       1.26 ms /    71 runs   (    0.02 ms per token, 56259.90 tokens per second)
0.01.663.976 I llama_perf_context_print:        load time =     951.27 ms
0.01.663.977 I llama_perf_context_print: prompt eval time =      42.30 ms /     7 tokens (    6.04 ms per token,   165.50 tokens per second)
0.01.663.979 I llama_perf_context_print:        eval time =     646.48 ms /    63 runs   (   10.26 ms per token,    97.45 tokens per second)
0.01.663.979 I llama_perf_context_print:       total time =     692.40 ms /    70 tokens
0.01.664.162 I ggml_metal_free: deallocating

real	0m1.706s
user	0m0.150s
sys	0m0.189s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.069 I main: llama backend init
0.00.000.072 I main: load the model and apply lora adapter, if any
0.00.011.325 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.030.520 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.030.524 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.030.525 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.030.530 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.030.530 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.030.531 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.030.531 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.030.532 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.030.532 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.030.533 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.030.533 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.030.533 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.030.533 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.030.534 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.030.536 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.030.536 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.030.537 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.035.247 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.036.472 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.041.359 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.041.360 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.041.360 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.041.361 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.041.361 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.041.361 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.041.362 I llama_model_loader: - type  f32:  194 tensors
0.00.041.362 I llama_model_loader: - type q4_1:   97 tensors
0.00.041.362 I llama_model_loader: - type q6_K:    1 tensors
0.00.068.044 I llm_load_vocab: special tokens cache size = 25
0.00.077.100 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.077.104 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.077.104 I llm_load_print_meta: arch             = gptneox
0.00.077.105 I llm_load_print_meta: vocab type       = BPE
0.00.077.105 I llm_load_print_meta: n_vocab          = 50304
0.00.077.105 I llm_load_print_meta: n_merges         = 50009
0.00.077.105 I llm_load_print_meta: vocab_only       = 0
0.00.077.106 I llm_load_print_meta: n_ctx_train      = 2048
0.00.077.106 I llm_load_print_meta: n_embd           = 2048
0.00.077.106 I llm_load_print_meta: n_layer          = 24
0.00.077.109 I llm_load_print_meta: n_head           = 16
0.00.077.110 I llm_load_print_meta: n_head_kv        = 16
0.00.077.110 I llm_load_print_meta: n_rot            = 32
0.00.077.110 I llm_load_print_meta: n_swa            = 0
0.00.077.110 I llm_load_print_meta: n_embd_head_k    = 128
0.00.077.111 I llm_load_print_meta: n_embd_head_v    = 128
0.00.077.112 I llm_load_print_meta: n_gqa            = 1
0.00.077.113 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.077.114 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.077.114 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.077.115 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.077.115 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.077.115 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.077.115 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.077.116 I llm_load_print_meta: n_ff             = 8192
0.00.077.117 I llm_load_print_meta: n_expert         = 0
0.00.077.117 I llm_load_print_meta: n_expert_used    = 0
0.00.077.119 I llm_load_print_meta: causal attn      = 1
0.00.077.121 I llm_load_print_meta: pooling type     = 0
0.00.077.121 I llm_load_print_meta: rope type        = 2
0.00.077.122 I llm_load_print_meta: rope scaling     = linear
0.00.077.122 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.077.123 I llm_load_print_meta: freq_scale_train = 1
0.00.077.123 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.077.123 I llm_load_print_meta: rope_finetuned   = unknown
0.00.077.123 I llm_load_print_meta: ssm_d_conv       = 0
0.00.077.123 I llm_load_print_meta: ssm_d_inner      = 0
0.00.077.123 I llm_load_print_meta: ssm_d_state      = 0
0.00.077.124 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.077.124 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.077.129 I llm_load_print_meta: model type       = 1.4B
0.00.077.129 I llm_load_print_meta: model ftype      = Q4_1
0.00.077.130 I llm_load_print_meta: model params     = 1.41 B
0.00.077.131 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.077.131 I llm_load_print_meta: general.name     = 1.4B
0.00.077.131 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.077.131 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.077.132 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.077.132 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.077.132 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.077.133 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.077.135 I llm_load_print_meta: max token length = 1024
0.00.079.548 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.079.548 I llm_load_tensors: offloading output layer to GPU
0.00.079.549 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.079.555 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.079.555 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.081.167 I llama_new_context_with_model: n_seq_max     = 1
0.00.081.169 I llama_new_context_with_model: n_ctx         = 2048
0.00.081.169 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.081.169 I llama_new_context_with_model: n_batch       = 2048
0.00.081.169 I llama_new_context_with_model: n_ubatch      = 512
0.00.081.170 I llama_new_context_with_model: flash_attn    = 0
0.00.081.170 I llama_new_context_with_model: freq_base     = 10000.0
0.00.081.171 I llama_new_context_with_model: freq_scale    = 1
0.00.081.171 I ggml_metal_init: allocating
0.00.081.180 I ggml_metal_init: found device: Apple M4
0.00.081.183 I ggml_metal_init: picking default device: Apple M4
0.00.082.022 I ggml_metal_init: using embedded metal library
0.00.085.237 I ggml_metal_init: GPU name:   Apple M4
0.00.085.240 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.085.240 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.085.241 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.085.241 I ggml_metal_init: simdgroup reduction   = true
0.00.085.241 I ggml_metal_init: simdgroup matrix mul. = true
0.00.085.242 I ggml_metal_init: has bfloat            = true
0.00.085.244 I ggml_metal_init: use bfloat            = true
0.00.085.244 I ggml_metal_init: hasUnifiedMemory      = true
0.00.085.245 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.118.204 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.118.212 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.118.233 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.119.226 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.119.228 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.119.228 I llama_new_context_with_model: graph nodes  = 967
0.00.119.228 I llama_new_context_with_model: graph splits = 2
0.00.119.243 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.151.844 I main: llama threadpool init, n_threads = 4
0.01.151.883 I 
0.01.151.908 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.151.908 I 
0.01.152.124 I sampler seed: 1234
0.01.152.129 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.152.174 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.152.186 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.152.186 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.886.023 I llama_perf_sampler_print:    sampling time =       1.04 ms /    71 runs   (    0.01 ms per token, 68007.66 tokens per second)
0.01.886.023 I llama_perf_context_print:        load time =    1140.52 ms
0.01.886.024 I llama_perf_context_print: prompt eval time =      40.02 ms /     7 tokens (    5.72 ms per token,   174.91 tokens per second)
0.01.886.025 I llama_perf_context_print:        eval time =     691.08 ms /    63 runs   (   10.97 ms per token,    91.16 tokens per second)
0.01.886.025 I llama_perf_context_print:       total time =     734.18 ms /    70 tokens
0.01.886.202 I ggml_metal_free: deallocating

real	0m1.906s
user	0m0.126s
sys	0m0.190s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.063 I main: llama backend init
0.00.000.065 I main: load the model and apply lora adapter, if any
0.00.017.214 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.039.887 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.039.892 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.039.899 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.039.900 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.039.900 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.039.901 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.039.901 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.039.902 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.039.903 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.039.905 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.039.905 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.039.906 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.039.906 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.039.906 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.039.908 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.039.910 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.039.911 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.046.307 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.047.957 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.054.379 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.054.381 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.054.381 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.054.382 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.054.382 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.054.383 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.054.383 I llama_model_loader: - type  f32:  194 tensors
0.00.054.384 I llama_model_loader: - type q5_0:   97 tensors
0.00.054.384 I llama_model_loader: - type q6_K:    1 tensors
0.00.097.959 I llm_load_vocab: special tokens cache size = 25
0.00.106.682 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.106.685 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.106.686 I llm_load_print_meta: arch             = gptneox
0.00.106.686 I llm_load_print_meta: vocab type       = BPE
0.00.106.686 I llm_load_print_meta: n_vocab          = 50304
0.00.106.686 I llm_load_print_meta: n_merges         = 50009
0.00.106.687 I llm_load_print_meta: vocab_only       = 0
0.00.106.687 I llm_load_print_meta: n_ctx_train      = 2048
0.00.106.687 I llm_load_print_meta: n_embd           = 2048
0.00.106.687 I llm_load_print_meta: n_layer          = 24
0.00.106.690 I llm_load_print_meta: n_head           = 16
0.00.106.691 I llm_load_print_meta: n_head_kv        = 16
0.00.106.691 I llm_load_print_meta: n_rot            = 32
0.00.106.692 I llm_load_print_meta: n_swa            = 0
0.00.106.692 I llm_load_print_meta: n_embd_head_k    = 128
0.00.106.694 I llm_load_print_meta: n_embd_head_v    = 128
0.00.106.695 I llm_load_print_meta: n_gqa            = 1
0.00.106.696 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.106.697 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.106.697 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.106.698 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.106.698 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.106.698 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.106.698 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.106.699 I llm_load_print_meta: n_ff             = 8192
0.00.106.699 I llm_load_print_meta: n_expert         = 0
0.00.106.699 I llm_load_print_meta: n_expert_used    = 0
0.00.106.699 I llm_load_print_meta: causal attn      = 1
0.00.106.700 I llm_load_print_meta: pooling type     = 0
0.00.106.701 I llm_load_print_meta: rope type        = 2
0.00.106.702 I llm_load_print_meta: rope scaling     = linear
0.00.106.702 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.106.702 I llm_load_print_meta: freq_scale_train = 1
0.00.106.703 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.106.703 I llm_load_print_meta: rope_finetuned   = unknown
0.00.106.703 I llm_load_print_meta: ssm_d_conv       = 0
0.00.106.703 I llm_load_print_meta: ssm_d_inner      = 0
0.00.106.703 I llm_load_print_meta: ssm_d_state      = 0
0.00.106.703 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.106.704 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.106.716 I llm_load_print_meta: model type       = 1.4B
0.00.106.716 I llm_load_print_meta: model ftype      = Q5_0
0.00.106.717 I llm_load_print_meta: model params     = 1.41 B
0.00.106.717 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.106.718 I llm_load_print_meta: general.name     = 1.4B
0.00.106.720 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.106.720 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.106.720 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.106.720 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.106.721 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.106.721 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.106.721 I llm_load_print_meta: max token length = 1024
0.00.109.235 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.109.235 I llm_load_tensors: offloading output layer to GPU
0.00.109.235 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.109.246 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.109.247 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.110.397 I llama_new_context_with_model: n_seq_max     = 1
0.00.110.398 I llama_new_context_with_model: n_ctx         = 2048
0.00.110.399 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.110.399 I llama_new_context_with_model: n_batch       = 2048
0.00.110.399 I llama_new_context_with_model: n_ubatch      = 512
0.00.110.399 I llama_new_context_with_model: flash_attn    = 0
0.00.110.400 I llama_new_context_with_model: freq_base     = 10000.0
0.00.110.400 I llama_new_context_with_model: freq_scale    = 1
0.00.110.401 I ggml_metal_init: allocating
0.00.110.404 I ggml_metal_init: found device: Apple M4
0.00.110.407 I ggml_metal_init: picking default device: Apple M4
0.00.111.104 I ggml_metal_init: using embedded metal library
0.00.113.700 I ggml_metal_init: GPU name:   Apple M4
0.00.113.702 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.113.703 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.113.703 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.113.703 I ggml_metal_init: simdgroup reduction   = true
0.00.113.704 I ggml_metal_init: simdgroup matrix mul. = true
0.00.113.704 I ggml_metal_init: has bfloat            = true
0.00.113.704 I ggml_metal_init: use bfloat            = true
0.00.113.704 I ggml_metal_init: hasUnifiedMemory      = true
0.00.113.706 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.144.678 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.144.688 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.144.707 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.145.672 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.145.673 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.145.674 I llama_new_context_with_model: graph nodes  = 967
0.00.145.674 I llama_new_context_with_model: graph splits = 2
0.00.145.688 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.102.455 I main: llama threadpool init, n_threads = 4
0.01.102.544 I 
0.01.102.600 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.102.602 I 
0.01.103.026 I sampler seed: 1234
0.01.103.033 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.103.061 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.103.063 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.103.063 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.912.276 I llama_perf_sampler_print:    sampling time =       1.25 ms /    71 runs   (    0.02 ms per token, 56800.00 tokens per second)
0.01.912.277 I llama_perf_context_print:        load time =    1085.23 ms
0.01.912.278 I llama_perf_context_print: prompt eval time =      47.58 ms /     7 tokens (    6.80 ms per token,   147.13 tokens per second)
0.01.912.281 I llama_perf_context_print:        eval time =     758.56 ms /    63 runs   (   12.04 ms per token,    83.05 tokens per second)
0.01.912.281 I llama_perf_context_print:       total time =     809.83 ms /    70 tokens
0.01.912.466 I ggml_metal_free: deallocating

real	0m1.953s
user	0m0.152s
sys	0m0.200s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.066 I main: llama backend init
0.00.000.068 I main: load the model and apply lora adapter, if any
0.00.008.792 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.029.431 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.029.435 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.029.436 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.029.437 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.029.437 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.029.437 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.029.438 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.029.439 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.029.439 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.029.439 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.029.439 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.029.440 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.029.440 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.029.440 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.029.444 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.029.444 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.029.444 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.033.747 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.034.842 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.039.080 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.039.081 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.039.081 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.039.082 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.039.082 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.039.082 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.039.083 I llama_model_loader: - type  f32:  194 tensors
0.00.039.083 I llama_model_loader: - type q5_1:   97 tensors
0.00.039.083 I llama_model_loader: - type q6_K:    1 tensors
0.00.063.390 I llm_load_vocab: special tokens cache size = 25
0.00.071.098 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.071.102 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.071.102 I llm_load_print_meta: arch             = gptneox
0.00.071.102 I llm_load_print_meta: vocab type       = BPE
0.00.071.103 I llm_load_print_meta: n_vocab          = 50304
0.00.071.103 I llm_load_print_meta: n_merges         = 50009
0.00.071.103 I llm_load_print_meta: vocab_only       = 0
0.00.071.103 I llm_load_print_meta: n_ctx_train      = 2048
0.00.071.103 I llm_load_print_meta: n_embd           = 2048
0.00.071.104 I llm_load_print_meta: n_layer          = 24
0.00.071.107 I llm_load_print_meta: n_head           = 16
0.00.071.108 I llm_load_print_meta: n_head_kv        = 16
0.00.071.108 I llm_load_print_meta: n_rot            = 32
0.00.071.108 I llm_load_print_meta: n_swa            = 0
0.00.071.109 I llm_load_print_meta: n_embd_head_k    = 128
0.00.071.111 I llm_load_print_meta: n_embd_head_v    = 128
0.00.071.112 I llm_load_print_meta: n_gqa            = 1
0.00.071.113 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.071.114 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.071.114 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.071.115 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.071.115 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.071.115 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.071.120 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.071.121 I llm_load_print_meta: n_ff             = 8192
0.00.071.122 I llm_load_print_meta: n_expert         = 0
0.00.071.122 I llm_load_print_meta: n_expert_used    = 0
0.00.071.124 I llm_load_print_meta: causal attn      = 1
0.00.071.124 I llm_load_print_meta: pooling type     = 0
0.00.071.124 I llm_load_print_meta: rope type        = 2
0.00.071.125 I llm_load_print_meta: rope scaling     = linear
0.00.071.129 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.071.129 I llm_load_print_meta: freq_scale_train = 1
0.00.071.129 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.071.130 I llm_load_print_meta: rope_finetuned   = unknown
0.00.071.130 I llm_load_print_meta: ssm_d_conv       = 0
0.00.071.130 I llm_load_print_meta: ssm_d_inner      = 0
0.00.071.131 I llm_load_print_meta: ssm_d_state      = 0
0.00.071.132 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.071.132 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.071.143 I llm_load_print_meta: model type       = 1.4B
0.00.071.144 I llm_load_print_meta: model ftype      = Q5_1
0.00.071.144 I llm_load_print_meta: model params     = 1.41 B
0.00.071.145 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.071.145 I llm_load_print_meta: general.name     = 1.4B
0.00.071.145 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.071.146 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.071.146 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.071.146 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.071.146 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.071.147 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.071.147 I llm_load_print_meta: max token length = 1024
0.00.073.414 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.073.414 I llm_load_tensors: offloading output layer to GPU
0.00.073.415 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.073.425 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.073.426 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.074.545 I llama_new_context_with_model: n_seq_max     = 1
0.00.074.546 I llama_new_context_with_model: n_ctx         = 2048
0.00.074.546 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.074.547 I llama_new_context_with_model: n_batch       = 2048
0.00.074.547 I llama_new_context_with_model: n_ubatch      = 512
0.00.074.547 I llama_new_context_with_model: flash_attn    = 0
0.00.074.547 I llama_new_context_with_model: freq_base     = 10000.0
0.00.074.548 I llama_new_context_with_model: freq_scale    = 1
0.00.074.548 I ggml_metal_init: allocating
0.00.074.551 I ggml_metal_init: found device: Apple M4
0.00.074.553 I ggml_metal_init: picking default device: Apple M4
0.00.075.185 I ggml_metal_init: using embedded metal library
0.00.077.542 I ggml_metal_init: GPU name:   Apple M4
0.00.077.543 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.077.544 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.077.544 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.077.544 I ggml_metal_init: simdgroup reduction   = true
0.00.077.546 I ggml_metal_init: simdgroup matrix mul. = true
0.00.077.546 I ggml_metal_init: has bfloat            = true
0.00.077.546 I ggml_metal_init: use bfloat            = true
0.00.077.547 I ggml_metal_init: hasUnifiedMemory      = true
0.00.077.548 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.108.194 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.108.203 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.108.223 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.109.337 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.109.338 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.109.338 I llama_new_context_with_model: graph nodes  = 967
0.00.109.338 I llama_new_context_with_model: graph splits = 2
0.00.109.353 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.057.498 I main: llama threadpool init, n_threads = 4
0.01.057.537 I 
0.01.057.563 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.057.565 I 
0.01.057.783 I sampler seed: 1234
0.01.057.788 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.057.823 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.057.825 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.057.825 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, literature and art.

If one's life is not happy, one can have no other way but

0.01.902.671 I llama_perf_sampler_print:    sampling time =       1.22 ms /    71 runs   (    0.02 ms per token, 58340.18 tokens per second)
0.01.902.672 I llama_perf_context_print:        load time =    1048.70 ms
0.01.902.672 I llama_perf_context_print: prompt eval time =      36.62 ms /     7 tokens (    5.23 ms per token,   191.16 tokens per second)
0.01.902.673 I llama_perf_context_print:        eval time =     805.17 ms /    63 runs   (   12.78 ms per token,    78.24 tokens per second)
0.01.902.673 I llama_perf_context_print:       total time =     845.17 ms /    70 tokens
0.01.902.840 I ggml_metal_free: deallocating

real	0m1.919s
user	0m0.116s
sys	0m0.173s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.068 I main: load the model and apply lora adapter, if any
0.00.018.529 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.027.747 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.027.753 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.027.754 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.027.755 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.027.755 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.027.756 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.027.756 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.027.757 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.027.757 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.027.758 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.027.760 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.027.761 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.027.761 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.027.761 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.027.764 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.027.764 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.027.765 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.033.172 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.034.669 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.040.525 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.040.526 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.040.527 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.040.527 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.040.528 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.040.528 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.040.529 I llama_model_loader: - type  f32:  194 tensors
0.00.040.529 I llama_model_loader: - type q2_K:   49 tensors
0.00.040.529 I llama_model_loader: - type q3_K:   48 tensors
0.00.040.530 I llama_model_loader: - type q6_K:    1 tensors
0.00.076.839 I llm_load_vocab: special tokens cache size = 25
0.00.086.096 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.086.099 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.086.100 I llm_load_print_meta: arch             = gptneox
0.00.086.100 I llm_load_print_meta: vocab type       = BPE
0.00.086.100 I llm_load_print_meta: n_vocab          = 50304
0.00.086.100 I llm_load_print_meta: n_merges         = 50009
0.00.086.101 I llm_load_print_meta: vocab_only       = 0
0.00.086.101 I llm_load_print_meta: n_ctx_train      = 2048
0.00.086.101 I llm_load_print_meta: n_embd           = 2048
0.00.086.101 I llm_load_print_meta: n_layer          = 24
0.00.086.104 I llm_load_print_meta: n_head           = 16
0.00.086.105 I llm_load_print_meta: n_head_kv        = 16
0.00.086.105 I llm_load_print_meta: n_rot            = 32
0.00.086.106 I llm_load_print_meta: n_swa            = 0
0.00.086.106 I llm_load_print_meta: n_embd_head_k    = 128
0.00.086.106 I llm_load_print_meta: n_embd_head_v    = 128
0.00.086.109 I llm_load_print_meta: n_gqa            = 1
0.00.086.110 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.086.111 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.086.112 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.086.112 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.086.112 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.086.112 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.086.113 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.086.113 I llm_load_print_meta: n_ff             = 8192
0.00.086.114 I llm_load_print_meta: n_expert         = 0
0.00.086.115 I llm_load_print_meta: n_expert_used    = 0
0.00.086.117 I llm_load_print_meta: causal attn      = 1
0.00.086.117 I llm_load_print_meta: pooling type     = 0
0.00.086.117 I llm_load_print_meta: rope type        = 2
0.00.086.118 I llm_load_print_meta: rope scaling     = linear
0.00.086.118 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.086.118 I llm_load_print_meta: freq_scale_train = 1
0.00.086.118 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.086.119 I llm_load_print_meta: rope_finetuned   = unknown
0.00.086.119 I llm_load_print_meta: ssm_d_conv       = 0
0.00.086.119 I llm_load_print_meta: ssm_d_inner      = 0
0.00.086.119 I llm_load_print_meta: ssm_d_state      = 0
0.00.086.119 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.086.119 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.086.131 I llm_load_print_meta: model type       = 1.4B
0.00.086.132 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.086.133 I llm_load_print_meta: model params     = 1.41 B
0.00.086.133 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.086.134 I llm_load_print_meta: general.name     = 1.4B
0.00.086.135 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.086.135 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.086.135 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.086.135 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.086.136 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.086.136 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.086.136 I llm_load_print_meta: max token length = 1024
0.00.088.533 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.088.534 I llm_load_tensors: offloading output layer to GPU
0.00.088.534 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.088.544 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.088.546 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.089.722 I llama_new_context_with_model: n_seq_max     = 1
0.00.089.723 I llama_new_context_with_model: n_ctx         = 2048
0.00.089.723 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.089.723 I llama_new_context_with_model: n_batch       = 2048
0.00.089.724 I llama_new_context_with_model: n_ubatch      = 512
0.00.089.724 I llama_new_context_with_model: flash_attn    = 0
0.00.089.725 I llama_new_context_with_model: freq_base     = 10000.0
0.00.089.725 I llama_new_context_with_model: freq_scale    = 1
0.00.089.725 I ggml_metal_init: allocating
0.00.089.729 I ggml_metal_init: found device: Apple M4
0.00.089.731 I ggml_metal_init: picking default device: Apple M4
0.00.090.407 I ggml_metal_init: using embedded metal library
0.00.093.051 I ggml_metal_init: GPU name:   Apple M4
0.00.093.053 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.093.053 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.093.054 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.093.054 I ggml_metal_init: simdgroup reduction   = true
0.00.093.054 I ggml_metal_init: simdgroup matrix mul. = true
0.00.093.056 I ggml_metal_init: has bfloat            = true
0.00.093.056 I ggml_metal_init: use bfloat            = true
0.00.093.056 I ggml_metal_init: hasUnifiedMemory      = true
0.00.093.059 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.123.409 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.123.416 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.123.435 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.124.407 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.124.408 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.124.409 I llama_new_context_with_model: graph nodes  = 967
0.00.124.409 I llama_new_context_with_model: graph splits = 2
0.00.124.424 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.835.318 I main: llama threadpool init, n_threads = 4
0.00.835.407 I 
0.00.835.469 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.835.471 I 
0.00.835.970 I sampler seed: 1234
0.00.835.976 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.836.019 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.836.022 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.836.022 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.520.006 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58532.56 tokens per second)
0.01.520.007 I llama_perf_context_print:        load time =     816.78 ms
0.01.520.008 I llama_perf_context_print: prompt eval time =      36.59 ms /     7 tokens (    5.23 ms per token,   191.29 tokens per second)
0.01.520.008 I llama_perf_context_print:        eval time =     644.40 ms /    63 runs   (   10.23 ms per token,    97.77 tokens per second)
0.01.520.012 I llama_perf_context_print:       total time =     684.69 ms /    70 tokens
0.01.520.184 I ggml_metal_free: deallocating

real	0m1.557s
user	0m0.145s
sys	0m0.156s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.067 I main: llama backend init
0.00.000.069 I main: load the model and apply lora adapter, if any
0.00.010.078 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.865 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.018.870 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.872 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.872 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.873 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.873 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.873 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.874 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.875 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.875 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.875 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.876 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.876 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.876 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.881 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.881 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.881 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.910 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.031 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.235 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.236 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.236 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.237 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.237 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.237 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.028.238 I llama_model_loader: - type  f32:  194 tensors
0.00.028.238 I llama_model_loader: - type q3_K:   25 tensors
0.00.028.239 I llama_model_loader: - type q4_K:   71 tensors
0.00.028.239 I llama_model_loader: - type q5_K:    1 tensors
0.00.028.239 I llama_model_loader: - type q6_K:    1 tensors
0.00.049.017 I llm_load_vocab: special tokens cache size = 25
0.00.054.933 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.054.936 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.054.936 I llm_load_print_meta: arch             = gptneox
0.00.054.936 I llm_load_print_meta: vocab type       = BPE
0.00.054.937 I llm_load_print_meta: n_vocab          = 50304
0.00.054.937 I llm_load_print_meta: n_merges         = 50009
0.00.054.937 I llm_load_print_meta: vocab_only       = 0
0.00.054.937 I llm_load_print_meta: n_ctx_train      = 2048
0.00.054.937 I llm_load_print_meta: n_embd           = 2048
0.00.054.938 I llm_load_print_meta: n_layer          = 24
0.00.054.941 I llm_load_print_meta: n_head           = 16
0.00.054.942 I llm_load_print_meta: n_head_kv        = 16
0.00.054.943 I llm_load_print_meta: n_rot            = 32
0.00.054.943 I llm_load_print_meta: n_swa            = 0
0.00.054.944 I llm_load_print_meta: n_embd_head_k    = 128
0.00.054.944 I llm_load_print_meta: n_embd_head_v    = 128
0.00.054.945 I llm_load_print_meta: n_gqa            = 1
0.00.054.945 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.054.946 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.054.946 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.054.947 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.054.947 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.054.947 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.054.947 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.054.948 I llm_load_print_meta: n_ff             = 8192
0.00.054.949 I llm_load_print_meta: n_expert         = 0
0.00.054.950 I llm_load_print_meta: n_expert_used    = 0
0.00.054.950 I llm_load_print_meta: causal attn      = 1
0.00.054.951 I llm_load_print_meta: pooling type     = 0
0.00.054.951 I llm_load_print_meta: rope type        = 2
0.00.054.951 I llm_load_print_meta: rope scaling     = linear
0.00.054.951 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.054.952 I llm_load_print_meta: freq_scale_train = 1
0.00.054.952 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.054.956 I llm_load_print_meta: rope_finetuned   = unknown
0.00.054.956 I llm_load_print_meta: ssm_d_conv       = 0
0.00.054.956 I llm_load_print_meta: ssm_d_inner      = 0
0.00.054.956 I llm_load_print_meta: ssm_d_state      = 0
0.00.054.956 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.054.957 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.054.963 I llm_load_print_meta: model type       = 1.4B
0.00.054.964 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.054.964 I llm_load_print_meta: model params     = 1.41 B
0.00.054.965 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.054.965 I llm_load_print_meta: general.name     = 1.4B
0.00.054.965 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.054.965 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.054.965 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.054.965 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.054.967 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.054.967 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.054.967 I llm_load_print_meta: max token length = 1024
0.00.056.747 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.056.747 I llm_load_tensors: offloading output layer to GPU
0.00.056.748 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.056.753 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.056.753 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.057.665 I llama_new_context_with_model: n_seq_max     = 1
0.00.057.666 I llama_new_context_with_model: n_ctx         = 2048
0.00.057.666 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.057.666 I llama_new_context_with_model: n_batch       = 2048
0.00.057.667 I llama_new_context_with_model: n_ubatch      = 512
0.00.057.667 I llama_new_context_with_model: flash_attn    = 0
0.00.057.667 I llama_new_context_with_model: freq_base     = 10000.0
0.00.057.667 I llama_new_context_with_model: freq_scale    = 1
0.00.057.668 I ggml_metal_init: allocating
0.00.057.671 I ggml_metal_init: found device: Apple M4
0.00.057.673 I ggml_metal_init: picking default device: Apple M4
0.00.058.214 I ggml_metal_init: using embedded metal library
0.00.060.117 I ggml_metal_init: GPU name:   Apple M4
0.00.060.120 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.060.120 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.060.121 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.060.121 I ggml_metal_init: simdgroup reduction   = true
0.00.060.121 I ggml_metal_init: simdgroup matrix mul. = true
0.00.060.121 I ggml_metal_init: has bfloat            = true
0.00.060.121 I ggml_metal_init: use bfloat            = true
0.00.060.122 I ggml_metal_init: hasUnifiedMemory      = true
0.00.060.124 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.086.788 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.795 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.086.815 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.914 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.916 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.916 I llama_new_context_with_model: graph nodes  = 967
0.00.087.916 I llama_new_context_with_model: graph splits = 2
0.00.087.930 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.067.457 I main: llama threadpool init, n_threads = 4
0.01.067.554 I 
0.01.067.616 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.067.619 I 
0.01.068.224 I sampler seed: 1234
0.01.068.231 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.068.283 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.068.286 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.068.286 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do that is most useful to my fellow men?'"

-Albert Einstein

"The way

0.01.842.216 I llama_perf_sampler_print:    sampling time =       1.42 ms /    71 runs   (    0.02 ms per token, 50070.52 tokens per second)
0.01.842.217 I llama_perf_context_print:        load time =    1057.37 ms
0.01.842.218 I llama_perf_context_print: prompt eval time =      36.38 ms /     7 tokens (    5.20 ms per token,   192.43 tokens per second)
0.01.842.218 I llama_perf_context_print:        eval time =     734.50 ms /    63 runs   (   11.66 ms per token,    85.77 tokens per second)
0.01.842.219 I llama_perf_context_print:       total time =     774.77 ms /    70 tokens
0.01.842.416 I ggml_metal_free: deallocating

real	0m1.858s
user	0m0.121s
sys	0m0.180s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.034 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.064 I main: llama backend init
0.00.000.066 I main: load the model and apply lora adapter, if any
0.00.018.333 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.036.731 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.036.736 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.036.739 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.036.740 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.036.740 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.036.740 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.036.741 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.036.742 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.036.744 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.036.744 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.036.744 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.036.745 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.036.745 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.036.745 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.036.747 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.036.747 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.036.747 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.041.740 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.043.132 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.048.064 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.048.066 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.048.066 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.048.067 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.048.067 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.048.067 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.048.068 I llama_model_loader: - type  f32:  194 tensors
0.00.048.068 I llama_model_loader: - type q4_K:   61 tensors
0.00.048.068 I llama_model_loader: - type q5_K:   24 tensors
0.00.048.069 I llama_model_loader: - type q6_K:   13 tensors
0.00.078.661 I llm_load_vocab: special tokens cache size = 25
0.00.089.580 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.089.584 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.089.585 I llm_load_print_meta: arch             = gptneox
0.00.089.585 I llm_load_print_meta: vocab type       = BPE
0.00.089.585 I llm_load_print_meta: n_vocab          = 50304
0.00.089.585 I llm_load_print_meta: n_merges         = 50009
0.00.089.586 I llm_load_print_meta: vocab_only       = 0
0.00.089.586 I llm_load_print_meta: n_ctx_train      = 2048
0.00.089.586 I llm_load_print_meta: n_embd           = 2048
0.00.089.586 I llm_load_print_meta: n_layer          = 24
0.00.089.590 I llm_load_print_meta: n_head           = 16
0.00.089.594 I llm_load_print_meta: n_head_kv        = 16
0.00.089.594 I llm_load_print_meta: n_rot            = 32
0.00.089.594 I llm_load_print_meta: n_swa            = 0
0.00.089.594 I llm_load_print_meta: n_embd_head_k    = 128
0.00.089.595 I llm_load_print_meta: n_embd_head_v    = 128
0.00.089.596 I llm_load_print_meta: n_gqa            = 1
0.00.089.597 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.089.604 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.089.605 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.089.605 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.089.606 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.089.606 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.089.606 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.089.607 I llm_load_print_meta: n_ff             = 8192
0.00.089.607 I llm_load_print_meta: n_expert         = 0
0.00.089.608 I llm_load_print_meta: n_expert_used    = 0
0.00.089.608 I llm_load_print_meta: causal attn      = 1
0.00.089.608 I llm_load_print_meta: pooling type     = 0
0.00.089.608 I llm_load_print_meta: rope type        = 2
0.00.089.608 I llm_load_print_meta: rope scaling     = linear
0.00.089.609 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.089.609 I llm_load_print_meta: freq_scale_train = 1
0.00.089.610 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.089.610 I llm_load_print_meta: rope_finetuned   = unknown
0.00.089.610 I llm_load_print_meta: ssm_d_conv       = 0
0.00.089.615 I llm_load_print_meta: ssm_d_inner      = 0
0.00.089.615 I llm_load_print_meta: ssm_d_state      = 0
0.00.089.615 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.089.615 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.089.627 I llm_load_print_meta: model type       = 1.4B
0.00.089.628 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.089.629 I llm_load_print_meta: model params     = 1.41 B
0.00.089.629 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.089.630 I llm_load_print_meta: general.name     = 1.4B
0.00.089.630 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.089.630 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.089.631 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.089.631 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.089.631 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.089.632 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.089.632 I llm_load_print_meta: max token length = 1024
0.00.092.067 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.092.068 I llm_load_tensors: offloading output layer to GPU
0.00.092.068 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.092.078 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.092.080 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.093.550 I llama_new_context_with_model: n_seq_max     = 1
0.00.093.551 I llama_new_context_with_model: n_ctx         = 2048
0.00.093.551 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.093.551 I llama_new_context_with_model: n_batch       = 2048
0.00.093.552 I llama_new_context_with_model: n_ubatch      = 512
0.00.093.552 I llama_new_context_with_model: flash_attn    = 0
0.00.093.553 I llama_new_context_with_model: freq_base     = 10000.0
0.00.093.553 I llama_new_context_with_model: freq_scale    = 1
0.00.093.553 I ggml_metal_init: allocating
0.00.093.558 I ggml_metal_init: found device: Apple M4
0.00.093.561 I ggml_metal_init: picking default device: Apple M4
0.00.094.360 I ggml_metal_init: using embedded metal library
0.00.097.390 I ggml_metal_init: GPU name:   Apple M4
0.00.097.392 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.097.392 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.097.393 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.097.393 I ggml_metal_init: simdgroup reduction   = true
0.00.097.393 I ggml_metal_init: simdgroup matrix mul. = true
0.00.097.393 I ggml_metal_init: has bfloat            = true
0.00.097.393 I ggml_metal_init: use bfloat            = true
0.00.097.394 I ggml_metal_init: hasUnifiedMemory      = true
0.00.097.395 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.129.827 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.129.833 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.129.852 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.130.842 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.130.843 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.130.843 I llama_new_context_with_model: graph nodes  = 967
0.00.130.844 I llama_new_context_with_model: graph splits = 2
0.00.130.858 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.272.090 I main: llama threadpool init, n_threads = 4
0.01.272.169 I 
0.01.272.230 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.272.232 I 
0.01.272.688 I sampler seed: 1234
0.01.272.694 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.272.745 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.272.745 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.272.746 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the greatest power to create the future we want to see. I believe that we are in a wonderful time when people from all over the world are coming together to create a better world. I believe that we are going

0.02.045.966 I llama_perf_sampler_print:    sampling time =       1.37 ms /    71 runs   (    0.02 ms per token, 51673.94 tokens per second)
0.02.045.967 I llama_perf_context_print:        load time =    1253.75 ms
0.02.045.968 I llama_perf_context_print: prompt eval time =      46.99 ms /     7 tokens (    6.71 ms per token,   148.97 tokens per second)
0.02.045.968 I llama_perf_context_print:        eval time =     723.06 ms /    63 runs   (   11.48 ms per token,    87.13 tokens per second)
0.02.045.970 I llama_perf_context_print:       total time =     773.89 ms /    70 tokens
0.02.046.137 I ggml_metal_free: deallocating

real	0m2.071s
user	0m0.138s
sys	0m0.210s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.034 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.064 I main: llama backend init
0.00.000.066 I main: load the model and apply lora adapter, if any
0.00.019.180 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.035.253 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.035.259 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.035.260 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.035.261 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.035.261 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.035.262 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.035.262 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.035.263 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.035.263 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.035.264 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.035.266 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.035.267 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.035.267 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.035.267 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.035.270 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.035.270 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.035.270 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.040.703 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.042.161 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.047.720 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.047.722 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.047.722 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.047.723 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.047.723 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.047.724 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.047.724 I llama_model_loader: - type  f32:  194 tensors
0.00.047.725 I llama_model_loader: - type q5_K:   61 tensors
0.00.047.725 I llama_model_loader: - type q6_K:   37 tensors
0.00.083.071 I llm_load_vocab: special tokens cache size = 25
0.00.093.372 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.093.376 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.093.376 I llm_load_print_meta: arch             = gptneox
0.00.093.377 I llm_load_print_meta: vocab type       = BPE
0.00.093.377 I llm_load_print_meta: n_vocab          = 50304
0.00.093.377 I llm_load_print_meta: n_merges         = 50009
0.00.093.378 I llm_load_print_meta: vocab_only       = 0
0.00.093.378 I llm_load_print_meta: n_ctx_train      = 2048
0.00.093.378 I llm_load_print_meta: n_embd           = 2048
0.00.093.378 I llm_load_print_meta: n_layer          = 24
0.00.093.381 I llm_load_print_meta: n_head           = 16
0.00.093.383 I llm_load_print_meta: n_head_kv        = 16
0.00.093.383 I llm_load_print_meta: n_rot            = 32
0.00.093.386 I llm_load_print_meta: n_swa            = 0
0.00.093.386 I llm_load_print_meta: n_embd_head_k    = 128
0.00.093.386 I llm_load_print_meta: n_embd_head_v    = 128
0.00.093.387 I llm_load_print_meta: n_gqa            = 1
0.00.093.388 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.093.389 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.093.390 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.093.390 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.093.391 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.093.391 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.093.391 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.093.392 I llm_load_print_meta: n_ff             = 8192
0.00.093.392 I llm_load_print_meta: n_expert         = 0
0.00.093.392 I llm_load_print_meta: n_expert_used    = 0
0.00.093.395 I llm_load_print_meta: causal attn      = 1
0.00.093.397 I llm_load_print_meta: pooling type     = 0
0.00.093.397 I llm_load_print_meta: rope type        = 2
0.00.093.397 I llm_load_print_meta: rope scaling     = linear
0.00.093.398 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.093.398 I llm_load_print_meta: freq_scale_train = 1
0.00.093.398 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.093.399 I llm_load_print_meta: rope_finetuned   = unknown
0.00.093.399 I llm_load_print_meta: ssm_d_conv       = 0
0.00.093.399 I llm_load_print_meta: ssm_d_inner      = 0
0.00.093.399 I llm_load_print_meta: ssm_d_state      = 0
0.00.093.399 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.093.400 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.093.411 I llm_load_print_meta: model type       = 1.4B
0.00.093.413 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.093.414 I llm_load_print_meta: model params     = 1.41 B
0.00.093.414 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.093.415 I llm_load_print_meta: general.name     = 1.4B
0.00.093.415 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.093.415 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.093.416 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.093.416 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.093.416 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.093.417 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.093.419 I llm_load_print_meta: max token length = 1024
0.00.095.909 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.095.909 I llm_load_tensors: offloading output layer to GPU
0.00.095.910 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.095.915 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.095.916 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.097.315 I llama_new_context_with_model: n_seq_max     = 1
0.00.097.317 I llama_new_context_with_model: n_ctx         = 2048
0.00.097.317 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.097.317 I llama_new_context_with_model: n_batch       = 2048
0.00.097.317 I llama_new_context_with_model: n_ubatch      = 512
0.00.097.318 I llama_new_context_with_model: flash_attn    = 0
0.00.097.318 I llama_new_context_with_model: freq_base     = 10000.0
0.00.097.319 I llama_new_context_with_model: freq_scale    = 1
0.00.097.319 I ggml_metal_init: allocating
0.00.097.323 I ggml_metal_init: found device: Apple M4
0.00.097.326 I ggml_metal_init: picking default device: Apple M4
0.00.098.069 I ggml_metal_init: using embedded metal library
0.00.100.955 I ggml_metal_init: GPU name:   Apple M4
0.00.100.958 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.100.959 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.100.960 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.100.960 I ggml_metal_init: simdgroup reduction   = true
0.00.100.960 I ggml_metal_init: simdgroup matrix mul. = true
0.00.100.960 I ggml_metal_init: has bfloat            = true
0.00.100.961 I ggml_metal_init: use bfloat            = true
0.00.100.961 I ggml_metal_init: hasUnifiedMemory      = true
0.00.100.962 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.132.385 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.132.401 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.132.423 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.133.457 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.133.458 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.133.458 I llama_new_context_with_model: graph nodes  = 967
0.00.133.459 I llama_new_context_with_model: graph splits = 2
0.00.133.467 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.257.149 I main: llama threadpool init, n_threads = 4
0.01.257.235 I 
0.01.257.300 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.257.302 I 
0.01.257.736 I sampler seed: 1234
0.01.257.741 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.257.780 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.257.780 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.257.780 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.02.105.828 I llama_perf_sampler_print:    sampling time =       1.30 ms /    71 runs   (    0.02 ms per token, 54447.85 tokens per second)
0.02.105.829 I llama_perf_context_print:        load time =    1237.96 ms
0.02.105.830 I llama_perf_context_print: prompt eval time =      39.38 ms /     7 tokens (    5.63 ms per token,   177.77 tokens per second)
0.02.105.830 I llama_perf_context_print:        eval time =     805.77 ms /    63 runs   (   12.79 ms per token,    78.19 tokens per second)
0.02.105.831 I llama_perf_context_print:       total time =     848.68 ms /    70 tokens
0.02.106.019 I ggml_metal_free: deallocating

real	0m2.134s
user	0m0.141s
sys	0m0.212s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.012.749 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.020.126 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.020.130 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.020.132 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.020.132 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.020.133 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.020.133 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.020.133 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.020.136 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.020.136 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.020.136 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.020.137 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.020.137 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.020.137 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.020.138 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.020.140 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.020.141 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.020.141 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.024.817 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.026.007 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.031.492 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.031.493 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.031.494 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.031.494 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.031.494 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.031.495 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.031.495 I llama_model_loader: - type  f32:  194 tensors
0.00.031.496 I llama_model_loader: - type q6_K:   98 tensors
0.00.062.859 I llm_load_vocab: special tokens cache size = 25
0.00.073.031 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.073.035 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.073.036 I llm_load_print_meta: arch             = gptneox
0.00.073.036 I llm_load_print_meta: vocab type       = BPE
0.00.073.036 I llm_load_print_meta: n_vocab          = 50304
0.00.073.036 I llm_load_print_meta: n_merges         = 50009
0.00.073.037 I llm_load_print_meta: vocab_only       = 0
0.00.073.037 I llm_load_print_meta: n_ctx_train      = 2048
0.00.073.037 I llm_load_print_meta: n_embd           = 2048
0.00.073.037 I llm_load_print_meta: n_layer          = 24
0.00.073.040 I llm_load_print_meta: n_head           = 16
0.00.073.041 I llm_load_print_meta: n_head_kv        = 16
0.00.073.042 I llm_load_print_meta: n_rot            = 32
0.00.073.042 I llm_load_print_meta: n_swa            = 0
0.00.073.042 I llm_load_print_meta: n_embd_head_k    = 128
0.00.073.042 I llm_load_print_meta: n_embd_head_v    = 128
0.00.073.043 I llm_load_print_meta: n_gqa            = 1
0.00.073.044 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.073.045 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.073.046 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.073.046 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.073.046 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.073.046 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.073.047 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.073.047 I llm_load_print_meta: n_ff             = 8192
0.00.073.048 I llm_load_print_meta: n_expert         = 0
0.00.073.048 I llm_load_print_meta: n_expert_used    = 0
0.00.073.048 I llm_load_print_meta: causal attn      = 1
0.00.073.049 I llm_load_print_meta: pooling type     = 0
0.00.073.051 I llm_load_print_meta: rope type        = 2
0.00.073.051 I llm_load_print_meta: rope scaling     = linear
0.00.073.052 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.073.052 I llm_load_print_meta: freq_scale_train = 1
0.00.073.052 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.073.053 I llm_load_print_meta: rope_finetuned   = unknown
0.00.073.053 I llm_load_print_meta: ssm_d_conv       = 0
0.00.073.053 I llm_load_print_meta: ssm_d_inner      = 0
0.00.073.053 I llm_load_print_meta: ssm_d_state      = 0
0.00.073.053 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.073.054 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.073.065 I llm_load_print_meta: model type       = 1.4B
0.00.073.065 I llm_load_print_meta: model ftype      = Q6_K
0.00.073.066 I llm_load_print_meta: model params     = 1.41 B
0.00.073.066 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.073.067 I llm_load_print_meta: general.name     = 1.4B
0.00.073.067 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.073.067 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.073.067 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.073.067 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.073.068 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.073.070 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.073.070 I llm_load_print_meta: max token length = 1024
0.00.075.269 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.075.270 I llm_load_tensors: offloading output layer to GPU
0.00.075.270 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.075.280 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.075.282 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.076.580 I llama_new_context_with_model: n_seq_max     = 1
0.00.076.581 I llama_new_context_with_model: n_ctx         = 2048
0.00.076.581 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.076.582 I llama_new_context_with_model: n_batch       = 2048
0.00.076.582 I llama_new_context_with_model: n_ubatch      = 512
0.00.076.582 I llama_new_context_with_model: flash_attn    = 0
0.00.076.583 I llama_new_context_with_model: freq_base     = 10000.0
0.00.076.583 I llama_new_context_with_model: freq_scale    = 1
0.00.076.584 I ggml_metal_init: allocating
0.00.076.587 I ggml_metal_init: found device: Apple M4
0.00.076.595 I ggml_metal_init: picking default device: Apple M4
0.00.077.301 I ggml_metal_init: using embedded metal library
0.00.080.104 I ggml_metal_init: GPU name:   Apple M4
0.00.080.106 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.080.107 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.080.107 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.080.107 I ggml_metal_init: simdgroup reduction   = true
0.00.080.108 I ggml_metal_init: simdgroup matrix mul. = true
0.00.080.108 I ggml_metal_init: has bfloat            = true
0.00.080.109 I ggml_metal_init: use bfloat            = true
0.00.080.109 I ggml_metal_init: hasUnifiedMemory      = true
0.00.080.110 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.116.721 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.116.726 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.116.742 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.117.740 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.117.741 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.117.742 I llama_new_context_with_model: graph nodes  = 967
0.00.117.742 I llama_new_context_with_model: graph splits = 2
0.00.117.755 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.592.429 I main: llama threadpool init, n_threads = 4
0.01.592.522 I 
0.01.592.579 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.592.581 I 
0.01.593.107 I sampler seed: 1234
0.01.593.113 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.593.205 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.593.207 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.593.207 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.02.472.115 I llama_perf_sampler_print:    sampling time =       1.33 ms /    71 runs   (    0.02 ms per token, 53183.52 tokens per second)
0.02.472.116 I llama_perf_context_print:        load time =    1579.67 ms
0.02.472.116 I llama_perf_context_print: prompt eval time =      39.42 ms /     7 tokens (    5.63 ms per token,   177.56 tokens per second)
0.02.472.117 I llama_perf_context_print:        eval time =     836.46 ms /    63 runs   (   13.28 ms per token,    75.32 tokens per second)
0.02.472.117 I llama_perf_context_print:       total time =     879.69 ms /    70 tokens
0.02.472.301 I ggml_metal_free: deallocating

real	0m2.505s
user	0m0.143s
sys	0m0.220s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.917 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.024.505 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.035.754 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.035.765 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.035.777 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.035.778 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.035.779 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.035.780 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.035.780 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.035.782 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.035.782 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.035.783 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.035.784 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.035.784 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.035.785 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.035.785 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.035.791 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.035.794 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.035.794 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.043.263 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.017 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.055.749 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.055.752 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.055.753 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.055.753 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.055.754 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.055.755 I llama_model_loader: - type  f32:  194 tensors
0.00.055.755 I llama_model_loader: - type  f16:   98 tensors
0.00.088.664 I llm_load_vocab: special tokens cache size = 25
0.00.095.831 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.095.834 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.095.834 I llm_load_print_meta: arch             = gptneox
0.00.095.834 I llm_load_print_meta: vocab type       = BPE
0.00.095.835 I llm_load_print_meta: n_vocab          = 50304
0.00.095.835 I llm_load_print_meta: n_merges         = 50009
0.00.095.835 I llm_load_print_meta: vocab_only       = 0
0.00.095.835 I llm_load_print_meta: n_ctx_train      = 2048
0.00.095.835 I llm_load_print_meta: n_embd           = 2048
0.00.095.835 I llm_load_print_meta: n_layer          = 24
0.00.095.838 I llm_load_print_meta: n_head           = 16
0.00.095.839 I llm_load_print_meta: n_head_kv        = 16
0.00.095.839 I llm_load_print_meta: n_rot            = 32
0.00.095.839 I llm_load_print_meta: n_swa            = 0
0.00.095.839 I llm_load_print_meta: n_embd_head_k    = 128
0.00.095.839 I llm_load_print_meta: n_embd_head_v    = 128
0.00.095.840 I llm_load_print_meta: n_gqa            = 1
0.00.095.841 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.095.842 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.095.842 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.095.842 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.095.843 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.095.843 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.095.843 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.095.843 I llm_load_print_meta: n_ff             = 8192
0.00.095.844 I llm_load_print_meta: n_expert         = 0
0.00.095.844 I llm_load_print_meta: n_expert_used    = 0
0.00.095.844 I llm_load_print_meta: causal attn      = 1
0.00.095.844 I llm_load_print_meta: pooling type     = 0
0.00.095.844 I llm_load_print_meta: rope type        = 2
0.00.095.844 I llm_load_print_meta: rope scaling     = linear
0.00.095.845 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.095.845 I llm_load_print_meta: freq_scale_train = 1
0.00.095.845 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.095.845 I llm_load_print_meta: rope_finetuned   = unknown
0.00.095.845 I llm_load_print_meta: ssm_d_conv       = 0
0.00.095.846 I llm_load_print_meta: ssm_d_inner      = 0
0.00.095.848 I llm_load_print_meta: ssm_d_state      = 0
0.00.095.848 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.095.848 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.095.860 I llm_load_print_meta: model type       = 1.4B
0.00.095.860 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.095.861 I llm_load_print_meta: model params     = 1.41 B
0.00.095.861 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.095.862 I llm_load_print_meta: general.name     = 1.4B
0.00.095.862 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.095.862 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.095.862 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.095.863 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.095.863 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.095.863 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.095.864 I llm_load_print_meta: max token length = 1024
0.00.098.452 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.098.452 I llm_load_tensors: offloading output layer to GPU
0.00.098.452 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.098.462 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.098.463 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.099.494 I llama_new_context_with_model: n_seq_max     = 1
0.00.099.495 I llama_new_context_with_model: n_ctx         = 128
0.00.099.495 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.099.495 I llama_new_context_with_model: n_batch       = 128
0.00.099.495 I llama_new_context_with_model: n_ubatch      = 128
0.00.099.495 I llama_new_context_with_model: flash_attn    = 0
0.00.099.496 I llama_new_context_with_model: freq_base     = 10000.0
0.00.099.496 I llama_new_context_with_model: freq_scale    = 1
0.00.099.497 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.099.497 I ggml_metal_init: allocating
0.00.099.505 I ggml_metal_init: found device: Apple M4
0.00.099.507 I ggml_metal_init: picking default device: Apple M4
0.00.100.107 I ggml_metal_init: using embedded metal library
0.00.102.307 I ggml_metal_init: GPU name:   Apple M4
0.00.102.309 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.102.309 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.102.309 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.102.310 I ggml_metal_init: simdgroup reduction   = true
0.00.102.310 I ggml_metal_init: simdgroup matrix mul. = true
0.00.102.310 I ggml_metal_init: has bfloat            = true
0.00.102.310 I ggml_metal_init: use bfloat            = true
0.00.102.310 I ggml_metal_init: hasUnifiedMemory      = true
0.00.102.311 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.111.692 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.111.694 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.111.709 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.112.669 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.112.670 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.112.671 I llama_new_context_with_model: graph nodes  = 967
0.00.112.671 I llama_new_context_with_model: graph splits = 2
0.00.112.683 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.534.721 I 
0.01.534.779 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.534.786 I perplexity: tokenizing the input ..
0.01.546.890 I perplexity: tokenization took 12.098 ms
0.01.546.898 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.679.922 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.681.758 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.681.829 I llama_perf_context_print:        load time =    1510.20 ms
0.01.681.831 I llama_perf_context_print: prompt eval time =     132.65 ms /   128 tokens (    1.04 ms per token,   964.97 tokens per second)
0.01.681.832 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.681.833 I llama_perf_context_print:       total time =     147.11 ms /   129 tokens
0.01.682.518 I ggml_metal_free: deallocating

real	0m1.870s
user	0m0.124s
sys	0m0.248s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.341 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.012.780 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.020.305 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.020.311 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.020.313 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.020.314 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.020.314 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.020.314 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.020.315 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.020.316 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.020.316 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.020.316 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.020.317 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.020.317 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.020.317 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.020.319 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.020.320 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.020.321 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.020.321 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.025.439 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.026.840 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.032.402 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.032.404 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.032.404 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.032.405 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.032.405 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.032.406 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.032.406 I llama_model_loader: - type  f32:  194 tensors
0.00.032.407 I llama_model_loader: - type q8_0:   98 tensors
0.00.057.690 I llm_load_vocab: special tokens cache size = 25
0.00.063.760 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.063.762 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.063.763 I llm_load_print_meta: arch             = gptneox
0.00.063.763 I llm_load_print_meta: vocab type       = BPE
0.00.063.763 I llm_load_print_meta: n_vocab          = 50304
0.00.063.763 I llm_load_print_meta: n_merges         = 50009
0.00.063.764 I llm_load_print_meta: vocab_only       = 0
0.00.063.764 I llm_load_print_meta: n_ctx_train      = 2048
0.00.063.764 I llm_load_print_meta: n_embd           = 2048
0.00.063.764 I llm_load_print_meta: n_layer          = 24
0.00.063.767 I llm_load_print_meta: n_head           = 16
0.00.063.768 I llm_load_print_meta: n_head_kv        = 16
0.00.063.768 I llm_load_print_meta: n_rot            = 32
0.00.063.768 I llm_load_print_meta: n_swa            = 0
0.00.063.768 I llm_load_print_meta: n_embd_head_k    = 128
0.00.063.770 I llm_load_print_meta: n_embd_head_v    = 128
0.00.063.772 I llm_load_print_meta: n_gqa            = 1
0.00.063.772 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.063.773 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.063.774 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.063.774 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.063.774 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.063.774 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.063.774 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.063.775 I llm_load_print_meta: n_ff             = 8192
0.00.063.775 I llm_load_print_meta: n_expert         = 0
0.00.063.775 I llm_load_print_meta: n_expert_used    = 0
0.00.063.775 I llm_load_print_meta: causal attn      = 1
0.00.063.775 I llm_load_print_meta: pooling type     = 0
0.00.063.776 I llm_load_print_meta: rope type        = 2
0.00.063.776 I llm_load_print_meta: rope scaling     = linear
0.00.063.776 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.063.776 I llm_load_print_meta: freq_scale_train = 1
0.00.063.777 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.063.777 I llm_load_print_meta: rope_finetuned   = unknown
0.00.063.777 I llm_load_print_meta: ssm_d_conv       = 0
0.00.063.777 I llm_load_print_meta: ssm_d_inner      = 0
0.00.063.777 I llm_load_print_meta: ssm_d_state      = 0
0.00.063.777 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.063.778 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.063.789 I llm_load_print_meta: model type       = 1.4B
0.00.063.789 I llm_load_print_meta: model ftype      = Q8_0
0.00.063.789 I llm_load_print_meta: model params     = 1.41 B
0.00.063.790 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.063.790 I llm_load_print_meta: general.name     = 1.4B
0.00.063.790 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.063.790 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.063.790 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.063.790 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.063.791 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.063.791 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.063.791 I llm_load_print_meta: max token length = 1024
0.00.065.470 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.065.470 I llm_load_tensors: offloading output layer to GPU
0.00.065.470 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.065.479 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.065.480 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.066.367 I llama_new_context_with_model: n_seq_max     = 1
0.00.066.368 I llama_new_context_with_model: n_ctx         = 128
0.00.066.368 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.066.368 I llama_new_context_with_model: n_batch       = 128
0.00.066.368 I llama_new_context_with_model: n_ubatch      = 128
0.00.066.368 I llama_new_context_with_model: flash_attn    = 0
0.00.066.369 I llama_new_context_with_model: freq_base     = 10000.0
0.00.066.369 I llama_new_context_with_model: freq_scale    = 1
0.00.066.369 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.066.370 I ggml_metal_init: allocating
0.00.066.376 I ggml_metal_init: found device: Apple M4
0.00.066.379 I ggml_metal_init: picking default device: Apple M4
0.00.066.947 I ggml_metal_init: using embedded metal library
0.00.069.127 I ggml_metal_init: GPU name:   Apple M4
0.00.069.129 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.069.129 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.069.130 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.069.131 I ggml_metal_init: simdgroup reduction   = true
0.00.069.131 I ggml_metal_init: simdgroup matrix mul. = true
0.00.069.131 I ggml_metal_init: has bfloat            = true
0.00.069.131 I ggml_metal_init: use bfloat            = true
0.00.069.132 I ggml_metal_init: hasUnifiedMemory      = true
0.00.069.133 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.078.303 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.078.307 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.078.321 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.079.323 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.079.324 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.079.324 I llama_new_context_with_model: graph nodes  = 967
0.00.079.325 I llama_new_context_with_model: graph splits = 2
0.00.079.337 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.955.348 I 
0.00.955.415 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.955.425 I perplexity: tokenizing the input ..
0.00.963.504 I perplexity: tokenization took 8.075 ms
0.00.963.508 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.085.101 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.01.086.322 I Final estimate: PPL = 10.1362 +/- 3.22437

0.01.086.339 I llama_perf_context_print:        load time =     942.56 ms
0.01.086.340 I llama_perf_context_print: prompt eval time =     121.37 ms /   128 tokens (    0.95 ms per token,  1054.65 tokens per second)
0.01.086.341 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.086.341 I llama_perf_context_print:       total time =     131.00 ms /   129 tokens
0.01.086.704 I ggml_metal_free: deallocating

real	0m1.104s
user	0m0.088s
sys	0m0.163s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.241 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.902 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.632 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.015.636 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.643 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.644 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.644 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.644 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.645 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.646 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.646 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.646 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.647 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.647 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.647 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.648 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.649 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.650 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.650 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.747 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.804 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.796 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.797 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.798 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.798 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.798 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.798 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.024.799 I llama_model_loader: - type  f32:  194 tensors
0.00.024.799 I llama_model_loader: - type q4_0:   97 tensors
0.00.024.799 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.633 I llm_load_vocab: special tokens cache size = 25
0.00.050.411 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.413 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.413 I llm_load_print_meta: arch             = gptneox
0.00.050.414 I llm_load_print_meta: vocab type       = BPE
0.00.050.414 I llm_load_print_meta: n_vocab          = 50304
0.00.050.414 I llm_load_print_meta: n_merges         = 50009
0.00.050.414 I llm_load_print_meta: vocab_only       = 0
0.00.050.414 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.415 I llm_load_print_meta: n_embd           = 2048
0.00.050.415 I llm_load_print_meta: n_layer          = 24
0.00.050.417 I llm_load_print_meta: n_head           = 16
0.00.050.418 I llm_load_print_meta: n_head_kv        = 16
0.00.050.423 I llm_load_print_meta: n_rot            = 32
0.00.050.423 I llm_load_print_meta: n_swa            = 0
0.00.050.424 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.424 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.425 I llm_load_print_meta: n_gqa            = 1
0.00.050.425 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.426 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.427 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.427 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.428 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.430 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.430 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.431 I llm_load_print_meta: n_ff             = 8192
0.00.050.431 I llm_load_print_meta: n_expert         = 0
0.00.050.431 I llm_load_print_meta: n_expert_used    = 0
0.00.050.431 I llm_load_print_meta: causal attn      = 1
0.00.050.431 I llm_load_print_meta: pooling type     = 0
0.00.050.431 I llm_load_print_meta: rope type        = 2
0.00.050.432 I llm_load_print_meta: rope scaling     = linear
0.00.050.432 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.432 I llm_load_print_meta: freq_scale_train = 1
0.00.050.433 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.433 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.433 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.433 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.433 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.434 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.434 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.447 I llm_load_print_meta: model type       = 1.4B
0.00.050.447 I llm_load_print_meta: model ftype      = Q4_0
0.00.050.448 I llm_load_print_meta: model params     = 1.41 B
0.00.050.448 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.050.449 I llm_load_print_meta: general.name     = 1.4B
0.00.050.449 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.449 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.449 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.449 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.450 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.450 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.451 I llm_load_print_meta: max token length = 1024
0.00.052.377 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.377 I llm_load_tensors: offloading output layer to GPU
0.00.052.377 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.387 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.052.388 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.053.372 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.373 I llama_new_context_with_model: n_ctx         = 128
0.00.053.373 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.373 I llama_new_context_with_model: n_batch       = 128
0.00.053.373 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.373 I llama_new_context_with_model: flash_attn    = 0
0.00.053.374 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.374 I llama_new_context_with_model: freq_scale    = 1
0.00.053.375 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.375 I ggml_metal_init: allocating
0.00.053.381 I ggml_metal_init: found device: Apple M4
0.00.053.383 I ggml_metal_init: picking default device: Apple M4
0.00.053.918 I ggml_metal_init: using embedded metal library
0.00.056.900 I ggml_metal_init: GPU name:   Apple M4
0.00.056.902 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.902 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.902 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.902 I ggml_metal_init: simdgroup reduction   = true
0.00.056.903 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.903 I ggml_metal_init: has bfloat            = true
0.00.056.903 I ggml_metal_init: use bfloat            = true
0.00.056.903 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.904 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.882 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.885 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.899 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.067.751 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.067.752 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.067.752 I llama_new_context_with_model: graph nodes  = 967
0.00.067.752 I llama_new_context_with_model: graph splits = 2
0.00.067.759 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.632.316 I 
0.00.632.360 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.632.367 I perplexity: tokenizing the input ..
0.00.640.434 I perplexity: tokenization took 8.062 ms
0.00.640.438 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.762.661 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.763.863 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.763.889 I llama_perf_context_print:        load time =     622.40 ms
0.00.763.891 I llama_perf_context_print: prompt eval time =     121.98 ms /   128 tokens (    0.95 ms per token,  1049.35 tokens per second)
0.00.763.892 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.763.893 I llama_perf_context_print:       total time =     131.58 ms /   129 tokens
0.00.764.262 I ggml_metal_free: deallocating

real	0m0.779s
user	0m0.075s
sys	0m0.106s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.081 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.513 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.490 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.014.494 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.495 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.496 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.500 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.501 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.501 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.502 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.502 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.503 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.503 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.505 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.505 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.506 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.508 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.508 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.509 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.649 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.797 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.928 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.929 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.929 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.930 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.930 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.930 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.023.931 I llama_model_loader: - type  f32:  194 tensors
0.00.023.931 I llama_model_loader: - type q4_1:   97 tensors
0.00.023.931 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.617 I llm_load_vocab: special tokens cache size = 25
0.00.050.425 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.427 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.428 I llm_load_print_meta: arch             = gptneox
0.00.050.428 I llm_load_print_meta: vocab type       = BPE
0.00.050.428 I llm_load_print_meta: n_vocab          = 50304
0.00.050.428 I llm_load_print_meta: n_merges         = 50009
0.00.050.429 I llm_load_print_meta: vocab_only       = 0
0.00.050.429 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.429 I llm_load_print_meta: n_embd           = 2048
0.00.050.429 I llm_load_print_meta: n_layer          = 24
0.00.050.432 I llm_load_print_meta: n_head           = 16
0.00.050.433 I llm_load_print_meta: n_head_kv        = 16
0.00.050.433 I llm_load_print_meta: n_rot            = 32
0.00.050.433 I llm_load_print_meta: n_swa            = 0
0.00.050.433 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.433 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.436 I llm_load_print_meta: n_gqa            = 1
0.00.050.437 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.439 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.440 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.440 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.440 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.440 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.440 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.441 I llm_load_print_meta: n_ff             = 8192
0.00.050.441 I llm_load_print_meta: n_expert         = 0
0.00.050.441 I llm_load_print_meta: n_expert_used    = 0
0.00.050.442 I llm_load_print_meta: causal attn      = 1
0.00.050.442 I llm_load_print_meta: pooling type     = 0
0.00.050.442 I llm_load_print_meta: rope type        = 2
0.00.050.442 I llm_load_print_meta: rope scaling     = linear
0.00.050.444 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.445 I llm_load_print_meta: freq_scale_train = 1
0.00.050.446 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.446 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.446 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.446 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.446 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.446 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.446 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.458 I llm_load_print_meta: model type       = 1.4B
0.00.050.460 I llm_load_print_meta: model ftype      = Q4_1
0.00.050.460 I llm_load_print_meta: model params     = 1.41 B
0.00.050.460 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.050.461 I llm_load_print_meta: general.name     = 1.4B
0.00.050.461 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.461 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.461 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.461 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.462 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.462 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.462 I llm_load_print_meta: max token length = 1024
0.00.052.519 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.519 I llm_load_tensors: offloading output layer to GPU
0.00.052.519 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.529 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.052.530 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.053.458 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.458 I llama_new_context_with_model: n_ctx         = 128
0.00.053.459 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.459 I llama_new_context_with_model: n_batch       = 128
0.00.053.459 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.459 I llama_new_context_with_model: flash_attn    = 0
0.00.053.459 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.460 I llama_new_context_with_model: freq_scale    = 1
0.00.053.460 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.460 I ggml_metal_init: allocating
0.00.053.465 I ggml_metal_init: found device: Apple M4
0.00.053.468 I ggml_metal_init: picking default device: Apple M4
0.00.054.028 I ggml_metal_init: using embedded metal library
0.00.055.992 I ggml_metal_init: GPU name:   Apple M4
0.00.055.994 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.994 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.994 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.995 I ggml_metal_init: simdgroup reduction   = true
0.00.055.995 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.995 I ggml_metal_init: has bfloat            = true
0.00.055.995 I ggml_metal_init: use bfloat            = true
0.00.055.996 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.996 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.107 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.109 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.125 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.015 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.015 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.016 I llama_new_context_with_model: graph nodes  = 967
0.00.066.016 I llama_new_context_with_model: graph splits = 2
0.00.066.028 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.692.344 I 
0.00.692.496 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.692.527 I perplexity: tokenizing the input ..
0.00.710.013 I perplexity: tokenization took 17.478 ms
0.00.710.032 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.849.753 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.853.581 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.853.641 I llama_perf_context_print:        load time =     683.82 ms
0.00.853.644 I llama_perf_context_print: prompt eval time =     138.78 ms /   128 tokens (    1.08 ms per token,   922.30 tokens per second)
0.00.853.647 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.853.648 I llama_perf_context_print:       total time =     161.30 ms /   129 tokens
0.00.854.867 I ggml_metal_free: deallocating

real	0m0.885s
user	0m0.112s
sys	0m0.137s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.197 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.017.148 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.027.516 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.027.523 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.027.526 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.027.527 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.027.527 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.027.530 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.027.530 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.027.531 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.027.532 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.027.533 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.027.533 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.027.534 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.027.534 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.027.535 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.027.539 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.027.539 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.027.540 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.034.030 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.035.539 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.041.024 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.041.026 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.041.026 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.041.026 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.041.027 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.041.027 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.041.028 I llama_model_loader: - type  f32:  194 tensors
0.00.041.028 I llama_model_loader: - type q5_0:   97 tensors
0.00.041.028 I llama_model_loader: - type q6_K:    1 tensors
0.00.064.775 I llm_load_vocab: special tokens cache size = 25
0.00.070.579 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.070.581 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.070.582 I llm_load_print_meta: arch             = gptneox
0.00.070.582 I llm_load_print_meta: vocab type       = BPE
0.00.070.582 I llm_load_print_meta: n_vocab          = 50304
0.00.070.582 I llm_load_print_meta: n_merges         = 50009
0.00.070.582 I llm_load_print_meta: vocab_only       = 0
0.00.070.582 I llm_load_print_meta: n_ctx_train      = 2048
0.00.070.583 I llm_load_print_meta: n_embd           = 2048
0.00.070.583 I llm_load_print_meta: n_layer          = 24
0.00.070.585 I llm_load_print_meta: n_head           = 16
0.00.070.586 I llm_load_print_meta: n_head_kv        = 16
0.00.070.586 I llm_load_print_meta: n_rot            = 32
0.00.070.586 I llm_load_print_meta: n_swa            = 0
0.00.070.586 I llm_load_print_meta: n_embd_head_k    = 128
0.00.070.587 I llm_load_print_meta: n_embd_head_v    = 128
0.00.070.587 I llm_load_print_meta: n_gqa            = 1
0.00.070.588 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.070.589 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.070.590 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.070.590 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.070.590 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.070.590 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.070.590 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.070.591 I llm_load_print_meta: n_ff             = 8192
0.00.070.591 I llm_load_print_meta: n_expert         = 0
0.00.070.591 I llm_load_print_meta: n_expert_used    = 0
0.00.070.592 I llm_load_print_meta: causal attn      = 1
0.00.070.592 I llm_load_print_meta: pooling type     = 0
0.00.070.592 I llm_load_print_meta: rope type        = 2
0.00.070.594 I llm_load_print_meta: rope scaling     = linear
0.00.070.596 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.070.597 I llm_load_print_meta: freq_scale_train = 1
0.00.070.597 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.070.597 I llm_load_print_meta: rope_finetuned   = unknown
0.00.070.597 I llm_load_print_meta: ssm_d_conv       = 0
0.00.070.597 I llm_load_print_meta: ssm_d_inner      = 0
0.00.070.597 I llm_load_print_meta: ssm_d_state      = 0
0.00.070.598 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.070.598 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.070.609 I llm_load_print_meta: model type       = 1.4B
0.00.070.609 I llm_load_print_meta: model ftype      = Q5_0
0.00.070.610 I llm_load_print_meta: model params     = 1.41 B
0.00.070.610 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.070.611 I llm_load_print_meta: general.name     = 1.4B
0.00.070.611 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.070.611 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.070.611 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.070.612 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.070.613 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.070.614 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.070.614 I llm_load_print_meta: max token length = 1024
0.00.072.368 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.072.368 I llm_load_tensors: offloading output layer to GPU
0.00.072.368 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.072.373 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.072.374 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.073.259 I llama_new_context_with_model: n_seq_max     = 1
0.00.073.260 I llama_new_context_with_model: n_ctx         = 128
0.00.073.260 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.073.260 I llama_new_context_with_model: n_batch       = 128
0.00.073.261 I llama_new_context_with_model: n_ubatch      = 128
0.00.073.261 I llama_new_context_with_model: flash_attn    = 0
0.00.073.261 I llama_new_context_with_model: freq_base     = 10000.0
0.00.073.262 I llama_new_context_with_model: freq_scale    = 1
0.00.073.262 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.073.262 I ggml_metal_init: allocating
0.00.073.269 I ggml_metal_init: found device: Apple M4
0.00.073.271 I ggml_metal_init: picking default device: Apple M4
0.00.073.800 I ggml_metal_init: using embedded metal library
0.00.075.735 I ggml_metal_init: GPU name:   Apple M4
0.00.075.736 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.075.737 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.075.737 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.075.737 I ggml_metal_init: simdgroup reduction   = true
0.00.075.737 I ggml_metal_init: simdgroup matrix mul. = true
0.00.075.738 I ggml_metal_init: has bfloat            = true
0.00.075.738 I ggml_metal_init: use bfloat            = true
0.00.075.738 I ggml_metal_init: hasUnifiedMemory      = true
0.00.075.739 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.084.671 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.084.675 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.084.697 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.085.564 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.085.565 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.085.565 I llama_new_context_with_model: graph nodes  = 967
0.00.085.565 I llama_new_context_with_model: graph splits = 2
0.00.085.572 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.753.214 I 
0.00.753.240 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.753.243 I perplexity: tokenizing the input ..
0.00.762.809 I perplexity: tokenization took 9.562 ms
0.00.762.813 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.899.885 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.901.179 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.901.203 I llama_perf_context_print:        load time =     736.06 ms
0.00.901.204 I llama_perf_context_print: prompt eval time =     136.85 ms /   128 tokens (    1.07 ms per token,   935.35 tokens per second)
0.00.901.205 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.901.206 I llama_perf_context_print:       total time =     147.99 ms /   129 tokens
0.00.901.692 I ggml_metal_free: deallocating

real	0m0.927s
user	0m0.094s
sys	0m0.121s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.084 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.873 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.387 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.014.391 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.394 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.394 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.395 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.395 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.395 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.396 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.396 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.397 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.397 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.397 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.397 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.398 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.399 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.399 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.400 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.354 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.545 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.465 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.466 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.466 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.466 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.467 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.467 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.023.467 I llama_model_loader: - type  f32:  194 tensors
0.00.023.468 I llama_model_loader: - type q5_1:   97 tensors
0.00.023.468 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.862 I llm_load_vocab: special tokens cache size = 25
0.00.049.811 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.815 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.815 I llm_load_print_meta: arch             = gptneox
0.00.049.816 I llm_load_print_meta: vocab type       = BPE
0.00.049.816 I llm_load_print_meta: n_vocab          = 50304
0.00.049.817 I llm_load_print_meta: n_merges         = 50009
0.00.049.817 I llm_load_print_meta: vocab_only       = 0
0.00.049.817 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.817 I llm_load_print_meta: n_embd           = 2048
0.00.049.817 I llm_load_print_meta: n_layer          = 24
0.00.049.820 I llm_load_print_meta: n_head           = 16
0.00.049.821 I llm_load_print_meta: n_head_kv        = 16
0.00.049.824 I llm_load_print_meta: n_rot            = 32
0.00.049.824 I llm_load_print_meta: n_swa            = 0
0.00.049.824 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.824 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.825 I llm_load_print_meta: n_gqa            = 1
0.00.049.826 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.832 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.835 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.835 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.835 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.836 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.836 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.848 I llm_load_print_meta: n_ff             = 8192
0.00.049.849 I llm_load_print_meta: n_expert         = 0
0.00.049.849 I llm_load_print_meta: n_expert_used    = 0
0.00.049.849 I llm_load_print_meta: causal attn      = 1
0.00.049.849 I llm_load_print_meta: pooling type     = 0
0.00.049.849 I llm_load_print_meta: rope type        = 2
0.00.049.849 I llm_load_print_meta: rope scaling     = linear
0.00.049.850 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.850 I llm_load_print_meta: freq_scale_train = 1
0.00.049.850 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.851 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.851 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.851 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.851 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.851 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.851 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.856 I llm_load_print_meta: model type       = 1.4B
0.00.049.857 I llm_load_print_meta: model ftype      = Q5_1
0.00.049.857 I llm_load_print_meta: model params     = 1.41 B
0.00.049.857 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.049.858 I llm_load_print_meta: general.name     = 1.4B
0.00.049.858 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.858 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.858 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.858 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.859 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.859 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.859 I llm_load_print_meta: max token length = 1024
0.00.051.675 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.675 I llm_load_tensors: offloading output layer to GPU
0.00.051.675 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.680 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.051.680 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.052.624 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.624 I llama_new_context_with_model: n_ctx         = 128
0.00.052.625 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.625 I llama_new_context_with_model: n_batch       = 128
0.00.052.625 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.625 I llama_new_context_with_model: flash_attn    = 0
0.00.052.626 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.626 I llama_new_context_with_model: freq_scale    = 1
0.00.052.626 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.627 I ggml_metal_init: allocating
0.00.052.632 I ggml_metal_init: found device: Apple M4
0.00.052.634 I ggml_metal_init: picking default device: Apple M4
0.00.053.161 I ggml_metal_init: using embedded metal library
0.00.055.397 I ggml_metal_init: GPU name:   Apple M4
0.00.055.398 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.399 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.399 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.401 I ggml_metal_init: simdgroup reduction   = true
0.00.055.401 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.401 I ggml_metal_init: has bfloat            = true
0.00.055.401 I ggml_metal_init: use bfloat            = true
0.00.055.401 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.403 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.279 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.284 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.300 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.181 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.182 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.182 I llama_new_context_with_model: graph nodes  = 967
0.00.065.182 I llama_new_context_with_model: graph splits = 2
0.00.065.194 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.638.801 I 
0.00.638.826 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.638.830 I perplexity: tokenizing the input ..
0.00.646.984 I perplexity: tokenization took 8.15 ms
0.00.646.987 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.781.515 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.782.746 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.782.775 I llama_perf_context_print:        load time =     629.93 ms
0.00.782.776 I llama_perf_context_print: prompt eval time =     134.30 ms /   128 tokens (    1.05 ms per token,   953.10 tokens per second)
0.00.782.777 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.782.781 I llama_perf_context_print:       total time =     143.97 ms /   129 tokens
0.00.783.235 I ggml_metal_free: deallocating

real	0m0.796s
user	0m0.076s
sys	0m0.111s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.964 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.395 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.400 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.406 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.407 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.407 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.407 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.408 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.408 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.409 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.409 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.410 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.411 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.412 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.412 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.413 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.414 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.414 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.458 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.500 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.482 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.483 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.483 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.483 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.484 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.484 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.484 I llama_model_loader: - type  f32:  194 tensors
0.00.024.485 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.485 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.485 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.222 I llm_load_vocab: special tokens cache size = 25
0.00.049.997 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.999 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.999 I llm_load_print_meta: arch             = gptneox
0.00.050.000 I llm_load_print_meta: vocab type       = BPE
0.00.050.000 I llm_load_print_meta: n_vocab          = 50304
0.00.050.000 I llm_load_print_meta: n_merges         = 50009
0.00.050.000 I llm_load_print_meta: vocab_only       = 0
0.00.050.001 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.001 I llm_load_print_meta: n_embd           = 2048
0.00.050.001 I llm_load_print_meta: n_layer          = 24
0.00.050.004 I llm_load_print_meta: n_head           = 16
0.00.050.005 I llm_load_print_meta: n_head_kv        = 16
0.00.050.005 I llm_load_print_meta: n_rot            = 32
0.00.050.005 I llm_load_print_meta: n_swa            = 0
0.00.050.005 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.006 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.006 I llm_load_print_meta: n_gqa            = 1
0.00.050.007 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.008 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.008 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.009 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.009 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.009 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.009 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.010 I llm_load_print_meta: n_ff             = 8192
0.00.050.010 I llm_load_print_meta: n_expert         = 0
0.00.050.010 I llm_load_print_meta: n_expert_used    = 0
0.00.050.010 I llm_load_print_meta: causal attn      = 1
0.00.050.012 I llm_load_print_meta: pooling type     = 0
0.00.050.012 I llm_load_print_meta: rope type        = 2
0.00.050.013 I llm_load_print_meta: rope scaling     = linear
0.00.050.013 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.014 I llm_load_print_meta: freq_scale_train = 1
0.00.050.014 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.014 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.014 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.014 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.014 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.014 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.015 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.021 I llm_load_print_meta: model type       = 1.4B
0.00.050.022 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.050.022 I llm_load_print_meta: model params     = 1.41 B
0.00.050.023 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.050.023 I llm_load_print_meta: general.name     = 1.4B
0.00.050.023 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.023 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.024 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.024 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.024 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.024 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.025 I llm_load_print_meta: max token length = 1024
0.00.051.787 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.787 I llm_load_tensors: offloading output layer to GPU
0.00.051.787 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.792 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.051.793 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.052.772 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.772 I llama_new_context_with_model: n_ctx         = 128
0.00.052.773 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.773 I llama_new_context_with_model: n_batch       = 128
0.00.052.773 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.773 I llama_new_context_with_model: flash_attn    = 0
0.00.052.774 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.774 I llama_new_context_with_model: freq_scale    = 1
0.00.052.774 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.774 I ggml_metal_init: allocating
0.00.052.777 I ggml_metal_init: found device: Apple M4
0.00.052.779 I ggml_metal_init: picking default device: Apple M4
0.00.053.329 I ggml_metal_init: using embedded metal library
0.00.055.288 I ggml_metal_init: GPU name:   Apple M4
0.00.055.289 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.289 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.290 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.290 I ggml_metal_init: simdgroup reduction   = true
0.00.055.290 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.290 I ggml_metal_init: has bfloat            = true
0.00.055.290 I ggml_metal_init: use bfloat            = true
0.00.055.291 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.293 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.555 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.560 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.576 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.436 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.437 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.437 I llama_new_context_with_model: graph nodes  = 967
0.00.065.438 I llama_new_context_with_model: graph splits = 2
0.00.065.445 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.426.892 I 
0.00.426.923 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.426.927 I perplexity: tokenizing the input ..
0.00.434.865 I perplexity: tokenization took 7.935 ms
0.00.434.869 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.567.255 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.568.500 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.568.529 I llama_perf_context_print:        load time =     416.93 ms
0.00.568.530 I llama_perf_context_print: prompt eval time =     132.15 ms /   128 tokens (    1.03 ms per token,   968.63 tokens per second)
0.00.568.531 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.568.532 I llama_perf_context_print:       total time =     141.64 ms /   129 tokens
0.00.569.050 I ggml_metal_free: deallocating

real	0m0.584s
user	0m0.075s
sys	0m0.084s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.080 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.250 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.013.738 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.013.743 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.013.745 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.013.746 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.013.746 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.013.746 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.013.748 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.013.748 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.013.749 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.013.749 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.013.749 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.013.750 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.013.750 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.013.750 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.013.753 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.013.753 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.013.753 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.017.755 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.018.858 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.022.852 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.022.854 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.022.854 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.022.854 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.022.855 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.022.855 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.022.855 I llama_model_loader: - type  f32:  194 tensors
0.00.022.855 I llama_model_loader: - type q3_K:   25 tensors
0.00.022.856 I llama_model_loader: - type q4_K:   71 tensors
0.00.022.856 I llama_model_loader: - type q5_K:    1 tensors
0.00.022.856 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.452 I llm_load_vocab: special tokens cache size = 25
0.00.049.463 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.466 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.467 I llm_load_print_meta: arch             = gptneox
0.00.049.467 I llm_load_print_meta: vocab type       = BPE
0.00.049.467 I llm_load_print_meta: n_vocab          = 50304
0.00.049.467 I llm_load_print_meta: n_merges         = 50009
0.00.049.468 I llm_load_print_meta: vocab_only       = 0
0.00.049.468 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.468 I llm_load_print_meta: n_embd           = 2048
0.00.049.468 I llm_load_print_meta: n_layer          = 24
0.00.049.471 I llm_load_print_meta: n_head           = 16
0.00.049.472 I llm_load_print_meta: n_head_kv        = 16
0.00.049.472 I llm_load_print_meta: n_rot            = 32
0.00.049.472 I llm_load_print_meta: n_swa            = 0
0.00.049.473 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.473 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.474 I llm_load_print_meta: n_gqa            = 1
0.00.049.474 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.480 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.480 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.481 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.481 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.481 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.481 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.482 I llm_load_print_meta: n_ff             = 8192
0.00.049.482 I llm_load_print_meta: n_expert         = 0
0.00.049.482 I llm_load_print_meta: n_expert_used    = 0
0.00.049.483 I llm_load_print_meta: causal attn      = 1
0.00.049.483 I llm_load_print_meta: pooling type     = 0
0.00.049.486 I llm_load_print_meta: rope type        = 2
0.00.049.486 I llm_load_print_meta: rope scaling     = linear
0.00.049.486 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.487 I llm_load_print_meta: freq_scale_train = 1
0.00.049.487 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.487 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.487 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.487 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.489 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.489 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.489 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.500 I llm_load_print_meta: model type       = 1.4B
0.00.049.501 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.049.501 I llm_load_print_meta: model params     = 1.41 B
0.00.049.502 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.049.502 I llm_load_print_meta: general.name     = 1.4B
0.00.049.502 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.502 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.502 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.502 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.503 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.503 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.503 I llm_load_print_meta: max token length = 1024
0.00.051.111 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.111 I llm_load_tensors: offloading output layer to GPU
0.00.051.111 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.121 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.051.122 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.051.989 I llama_new_context_with_model: n_seq_max     = 1
0.00.051.990 I llama_new_context_with_model: n_ctx         = 128
0.00.051.990 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.051.990 I llama_new_context_with_model: n_batch       = 128
0.00.051.991 I llama_new_context_with_model: n_ubatch      = 128
0.00.051.991 I llama_new_context_with_model: flash_attn    = 0
0.00.051.991 I llama_new_context_with_model: freq_base     = 10000.0
0.00.051.991 I llama_new_context_with_model: freq_scale    = 1
0.00.051.992 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.051.992 I ggml_metal_init: allocating
0.00.051.998 I ggml_metal_init: found device: Apple M4
0.00.052.000 I ggml_metal_init: picking default device: Apple M4
0.00.052.546 I ggml_metal_init: using embedded metal library
0.00.054.497 I ggml_metal_init: GPU name:   Apple M4
0.00.054.498 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.499 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.499 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.500 I ggml_metal_init: simdgroup reduction   = true
0.00.054.500 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.500 I ggml_metal_init: has bfloat            = true
0.00.054.500 I ggml_metal_init: use bfloat            = true
0.00.054.501 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.501 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.463 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.468 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.482 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.355 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.356 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.356 I llama_new_context_with_model: graph nodes  = 967
0.00.064.356 I llama_new_context_with_model: graph splits = 2
0.00.064.369 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.501.528 I 
0.00.501.554 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.501.557 I perplexity: tokenizing the input ..
0.00.509.643 I perplexity: tokenization took 8.083 ms
0.00.509.647 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.641.987 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.643.202 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.643.233 I llama_perf_context_print:        load time =     493.27 ms
0.00.643.234 I llama_perf_context_print: prompt eval time =     132.11 ms /   128 tokens (    1.03 ms per token,   968.87 tokens per second)
0.00.643.235 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.643.235 I llama_perf_context_print:       total time =     141.71 ms /   129 tokens
0.00.643.700 I ggml_metal_free: deallocating

real	0m0.658s
user	0m0.076s
sys	0m0.098s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.085 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.134 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.031 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.016.036 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.038 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.038 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.039 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.040 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.040 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.041 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.041 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.042 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.042 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.042 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.043 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.043 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.046 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.047 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.047 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.143 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.202 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.308 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.309 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.310 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.310 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.310 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.310 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.025.311 I llama_model_loader: - type  f32:  194 tensors
0.00.025.311 I llama_model_loader: - type q4_K:   61 tensors
0.00.025.311 I llama_model_loader: - type q5_K:   24 tensors
0.00.025.312 I llama_model_loader: - type q6_K:   13 tensors
0.00.045.699 I llm_load_vocab: special tokens cache size = 25
0.00.051.551 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.553 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.554 I llm_load_print_meta: arch             = gptneox
0.00.051.554 I llm_load_print_meta: vocab type       = BPE
0.00.051.554 I llm_load_print_meta: n_vocab          = 50304
0.00.051.555 I llm_load_print_meta: n_merges         = 50009
0.00.051.555 I llm_load_print_meta: vocab_only       = 0
0.00.051.555 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.555 I llm_load_print_meta: n_embd           = 2048
0.00.051.555 I llm_load_print_meta: n_layer          = 24
0.00.051.558 I llm_load_print_meta: n_head           = 16
0.00.051.559 I llm_load_print_meta: n_head_kv        = 16
0.00.051.559 I llm_load_print_meta: n_rot            = 32
0.00.051.559 I llm_load_print_meta: n_swa            = 0
0.00.051.559 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.559 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.560 I llm_load_print_meta: n_gqa            = 1
0.00.051.561 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.562 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.562 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.563 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.563 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.563 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.563 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.564 I llm_load_print_meta: n_ff             = 8192
0.00.051.564 I llm_load_print_meta: n_expert         = 0
0.00.051.564 I llm_load_print_meta: n_expert_used    = 0
0.00.051.564 I llm_load_print_meta: causal attn      = 1
0.00.051.565 I llm_load_print_meta: pooling type     = 0
0.00.051.565 I llm_load_print_meta: rope type        = 2
0.00.051.566 I llm_load_print_meta: rope scaling     = linear
0.00.051.568 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.568 I llm_load_print_meta: freq_scale_train = 1
0.00.051.568 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.568 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.569 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.569 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.569 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.569 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.569 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.580 I llm_load_print_meta: model type       = 1.4B
0.00.051.580 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.051.581 I llm_load_print_meta: model params     = 1.41 B
0.00.051.581 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.051.581 I llm_load_print_meta: general.name     = 1.4B
0.00.051.582 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.582 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.582 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.582 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.584 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.584 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.584 I llm_load_print_meta: max token length = 1024
0.00.053.141 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.141 I llm_load_tensors: offloading output layer to GPU
0.00.053.141 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.151 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.053.152 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.053.957 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.958 I llama_new_context_with_model: n_ctx         = 128
0.00.053.959 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.959 I llama_new_context_with_model: n_batch       = 128
0.00.053.959 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.959 I llama_new_context_with_model: flash_attn    = 0
0.00.053.960 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.960 I llama_new_context_with_model: freq_scale    = 1
0.00.053.960 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.961 I ggml_metal_init: allocating
0.00.053.966 I ggml_metal_init: found device: Apple M4
0.00.053.969 I ggml_metal_init: picking default device: Apple M4
0.00.054.530 I ggml_metal_init: using embedded metal library
0.00.056.451 I ggml_metal_init: GPU name:   Apple M4
0.00.056.453 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.453 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.454 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.454 I ggml_metal_init: simdgroup reduction   = true
0.00.056.454 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.454 I ggml_metal_init: has bfloat            = true
0.00.056.455 I ggml_metal_init: use bfloat            = true
0.00.056.456 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.456 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.556 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.560 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.576 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.419 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.420 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.420 I llama_new_context_with_model: graph nodes  = 967
0.00.066.420 I llama_new_context_with_model: graph splits = 2
0.00.066.432 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.615.942 I 
0.00.615.969 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.615.973 I perplexity: tokenizing the input ..
0.00.624.033 I perplexity: tokenization took 8.057 ms
0.00.624.040 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.758.360 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.759.625 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.759.657 I llama_perf_context_print:        load time =     605.81 ms
0.00.759.658 I llama_perf_context_print: prompt eval time =     134.07 ms /   128 tokens (    1.05 ms per token,   954.73 tokens per second)
0.00.759.659 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.759.660 I llama_perf_context_print:       total time =     143.71 ms /   129 tokens
0.00.760.092 I ggml_metal_free: deallocating

real	0m0.775s
user	0m0.076s
sys	0m0.114s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.081 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.015.719 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.022.361 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.022.365 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.022.366 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.022.366 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.022.367 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.022.367 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.022.367 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.022.369 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.022.369 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.022.369 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.022.369 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.022.370 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.022.370 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.022.371 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.022.373 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.022.374 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.022.374 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.026.421 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.027.469 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.031.566 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.031.567 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.031.568 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.031.568 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.031.568 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.031.568 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.031.569 I llama_model_loader: - type  f32:  194 tensors
0.00.031.569 I llama_model_loader: - type q5_K:   61 tensors
0.00.031.570 I llama_model_loader: - type q6_K:   37 tensors
0.00.051.159 I llm_load_vocab: special tokens cache size = 25
0.00.056.972 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.056.975 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.056.975 I llm_load_print_meta: arch             = gptneox
0.00.056.976 I llm_load_print_meta: vocab type       = BPE
0.00.056.976 I llm_load_print_meta: n_vocab          = 50304
0.00.056.976 I llm_load_print_meta: n_merges         = 50009
0.00.056.976 I llm_load_print_meta: vocab_only       = 0
0.00.056.976 I llm_load_print_meta: n_ctx_train      = 2048
0.00.056.976 I llm_load_print_meta: n_embd           = 2048
0.00.056.976 I llm_load_print_meta: n_layer          = 24
0.00.056.979 I llm_load_print_meta: n_head           = 16
0.00.056.980 I llm_load_print_meta: n_head_kv        = 16
0.00.056.980 I llm_load_print_meta: n_rot            = 32
0.00.056.980 I llm_load_print_meta: n_swa            = 0
0.00.056.980 I llm_load_print_meta: n_embd_head_k    = 128
0.00.056.980 I llm_load_print_meta: n_embd_head_v    = 128
0.00.056.981 I llm_load_print_meta: n_gqa            = 1
0.00.056.982 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.056.983 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.056.983 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.056.984 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.056.984 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.056.984 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.056.984 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.056.985 I llm_load_print_meta: n_ff             = 8192
0.00.056.985 I llm_load_print_meta: n_expert         = 0
0.00.056.985 I llm_load_print_meta: n_expert_used    = 0
0.00.056.985 I llm_load_print_meta: causal attn      = 1
0.00.056.985 I llm_load_print_meta: pooling type     = 0
0.00.056.986 I llm_load_print_meta: rope type        = 2
0.00.056.986 I llm_load_print_meta: rope scaling     = linear
0.00.056.989 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.056.990 I llm_load_print_meta: freq_scale_train = 1
0.00.056.990 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.056.990 I llm_load_print_meta: rope_finetuned   = unknown
0.00.056.991 I llm_load_print_meta: ssm_d_conv       = 0
0.00.056.991 I llm_load_print_meta: ssm_d_inner      = 0
0.00.056.991 I llm_load_print_meta: ssm_d_state      = 0
0.00.056.991 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.056.991 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.057.002 I llm_load_print_meta: model type       = 1.4B
0.00.057.003 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.057.003 I llm_load_print_meta: model params     = 1.41 B
0.00.057.004 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.057.004 I llm_load_print_meta: general.name     = 1.4B
0.00.057.004 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.057.004 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.057.005 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.057.005 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.057.005 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.057.006 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.057.006 I llm_load_print_meta: max token length = 1024
0.00.058.568 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.058.568 I llm_load_tensors: offloading output layer to GPU
0.00.058.568 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.058.577 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.058.578 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.059.402 I llama_new_context_with_model: n_seq_max     = 1
0.00.059.403 I llama_new_context_with_model: n_ctx         = 128
0.00.059.403 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.059.403 I llama_new_context_with_model: n_batch       = 128
0.00.059.403 I llama_new_context_with_model: n_ubatch      = 128
0.00.059.403 I llama_new_context_with_model: flash_attn    = 0
0.00.059.404 I llama_new_context_with_model: freq_base     = 10000.0
0.00.059.404 I llama_new_context_with_model: freq_scale    = 1
0.00.059.404 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.059.405 I ggml_metal_init: allocating
0.00.059.407 I ggml_metal_init: found device: Apple M4
0.00.059.409 I ggml_metal_init: picking default device: Apple M4
0.00.059.940 I ggml_metal_init: using embedded metal library
0.00.062.149 I ggml_metal_init: GPU name:   Apple M4
0.00.062.151 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.062.151 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.062.152 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.062.152 I ggml_metal_init: simdgroup reduction   = true
0.00.062.153 I ggml_metal_init: simdgroup matrix mul. = true
0.00.062.153 I ggml_metal_init: has bfloat            = true
0.00.062.153 I ggml_metal_init: use bfloat            = true
0.00.062.154 I ggml_metal_init: hasUnifiedMemory      = true
0.00.062.154 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.070.607 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.070.610 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.070.623 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.071.490 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.071.491 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.071.491 I llama_new_context_with_model: graph nodes  = 967
0.00.071.492 I llama_new_context_with_model: graph splits = 2
0.00.071.504 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.696.693 I 
0.00.696.817 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.696.852 I perplexity: tokenizing the input ..
0.00.714.426 I perplexity: tokenization took 17.563 ms
0.00.714.441 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.860.008 I perplexity: 0.15 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.862.884 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.862.957 I llama_perf_context_print:        load time =     680.97 ms
0.00.862.960 I llama_perf_context_print: prompt eval time =     144.59 ms /   128 tokens (    1.13 ms per token,   885.29 tokens per second)
0.00.862.961 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.862.962 I llama_perf_context_print:       total time =     166.26 ms /   129 tokens
0.00.864.373 I ggml_metal_free: deallocating

real	0m0.895s
user	0m0.103s
sys	0m0.141s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.191 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.016.882 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.027.291 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.027.298 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.027.301 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.027.302 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.027.302 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.027.303 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.027.306 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.027.308 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.027.308 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.027.308 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.027.309 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.027.309 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.027.316 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.027.317 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.027.321 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.027.321 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.027.321 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.033.701 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.035.145 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.040.728 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.040.729 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.040.730 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.040.730 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.040.730 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.040.731 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.040.731 I llama_model_loader: - type  f32:  194 tensors
0.00.040.732 I llama_model_loader: - type q6_K:   98 tensors
0.00.065.371 I llm_load_vocab: special tokens cache size = 25
0.00.071.244 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.071.246 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.071.247 I llm_load_print_meta: arch             = gptneox
0.00.071.247 I llm_load_print_meta: vocab type       = BPE
0.00.071.247 I llm_load_print_meta: n_vocab          = 50304
0.00.071.247 I llm_load_print_meta: n_merges         = 50009
0.00.071.248 I llm_load_print_meta: vocab_only       = 0
0.00.071.248 I llm_load_print_meta: n_ctx_train      = 2048
0.00.071.248 I llm_load_print_meta: n_embd           = 2048
0.00.071.248 I llm_load_print_meta: n_layer          = 24
0.00.071.251 I llm_load_print_meta: n_head           = 16
0.00.071.251 I llm_load_print_meta: n_head_kv        = 16
0.00.071.251 I llm_load_print_meta: n_rot            = 32
0.00.071.252 I llm_load_print_meta: n_swa            = 0
0.00.071.253 I llm_load_print_meta: n_embd_head_k    = 128
0.00.071.253 I llm_load_print_meta: n_embd_head_v    = 128
0.00.071.254 I llm_load_print_meta: n_gqa            = 1
0.00.071.254 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.071.255 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.071.256 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.071.256 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.071.256 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.071.256 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.071.256 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.071.257 I llm_load_print_meta: n_ff             = 8192
0.00.071.257 I llm_load_print_meta: n_expert         = 0
0.00.071.258 I llm_load_print_meta: n_expert_used    = 0
0.00.071.258 I llm_load_print_meta: causal attn      = 1
0.00.071.258 I llm_load_print_meta: pooling type     = 0
0.00.071.258 I llm_load_print_meta: rope type        = 2
0.00.071.258 I llm_load_print_meta: rope scaling     = linear
0.00.071.259 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.071.260 I llm_load_print_meta: freq_scale_train = 1
0.00.071.261 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.071.261 I llm_load_print_meta: rope_finetuned   = unknown
0.00.071.261 I llm_load_print_meta: ssm_d_conv       = 0
0.00.071.262 I llm_load_print_meta: ssm_d_inner      = 0
0.00.071.262 I llm_load_print_meta: ssm_d_state      = 0
0.00.071.262 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.071.262 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.071.273 I llm_load_print_meta: model type       = 1.4B
0.00.071.273 I llm_load_print_meta: model ftype      = Q6_K
0.00.071.274 I llm_load_print_meta: model params     = 1.41 B
0.00.071.274 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.071.274 I llm_load_print_meta: general.name     = 1.4B
0.00.071.275 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.071.275 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.071.275 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.071.275 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.071.275 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.071.276 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.071.276 I llm_load_print_meta: max token length = 1024
0.00.072.891 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.072.891 I llm_load_tensors: offloading output layer to GPU
0.00.072.891 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.072.901 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.072.902 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.073.732 I llama_new_context_with_model: n_seq_max     = 1
0.00.073.733 I llama_new_context_with_model: n_ctx         = 128
0.00.073.734 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.073.734 I llama_new_context_with_model: n_batch       = 128
0.00.073.734 I llama_new_context_with_model: n_ubatch      = 128
0.00.073.734 I llama_new_context_with_model: flash_attn    = 0
0.00.073.734 I llama_new_context_with_model: freq_base     = 10000.0
0.00.073.735 I llama_new_context_with_model: freq_scale    = 1
0.00.073.735 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.073.735 I ggml_metal_init: allocating
0.00.073.738 I ggml_metal_init: found device: Apple M4
0.00.073.739 I ggml_metal_init: picking default device: Apple M4
0.00.074.288 I ggml_metal_init: using embedded metal library
0.00.076.227 I ggml_metal_init: GPU name:   Apple M4
0.00.076.229 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.076.229 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.076.229 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.076.229 I ggml_metal_init: simdgroup reduction   = true
0.00.076.230 I ggml_metal_init: simdgroup matrix mul. = true
0.00.076.230 I ggml_metal_init: has bfloat            = true
0.00.076.230 I ggml_metal_init: use bfloat            = true
0.00.076.231 I ggml_metal_init: hasUnifiedMemory      = true
0.00.076.237 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.362 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.085.365 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.085.382 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.248 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.086.249 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.086.249 I llama_new_context_with_model: graph nodes  = 967
0.00.086.250 I llama_new_context_with_model: graph splits = 2
0.00.086.262 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.584.176 I 
0.00.584.205 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.584.208 I perplexity: tokenizing the input ..
0.00.594.583 I perplexity: tokenization took 10.372 ms
0.00.594.594 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.735.075 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.736.329 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.736.351 I llama_perf_context_print:        load time =     567.29 ms
0.00.736.352 I llama_perf_context_print: prompt eval time =     140.26 ms /   128 tokens (    1.10 ms per token,   912.61 tokens per second)
0.00.736.352 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.736.355 I llama_perf_context_print:       total time =     152.18 ms /   129 tokens
0.00.736.775 I ggml_metal_free: deallocating

real	0m0.762s
user	0m0.097s
sys	0m0.114s
+ ./bin/llama-imatrix --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.267 I build: 4235 (5c7a5aa0) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.023.358 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.036.103 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.036.112 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.036.115 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.036.116 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.036.116 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.036.117 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.036.117 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.036.119 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.036.119 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.036.120 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.036.121 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.036.121 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.036.122 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.036.122 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.036.125 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.036.126 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.036.126 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.012 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.070 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.052.832 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.052.834 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.052.835 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.052.835 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.052.835 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.052.836 I llama_model_loader: - type  f32:  194 tensors
0.00.052.837 I llama_model_loader: - type  f16:   98 tensors
0.00.081.467 I llm_load_vocab: special tokens cache size = 25
0.00.087.899 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.087.903 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.087.904 I llm_load_print_meta: arch             = gptneox
0.00.087.904 I llm_load_print_meta: vocab type       = BPE
0.00.087.904 I llm_load_print_meta: n_vocab          = 50304
0.00.087.904 I llm_load_print_meta: n_merges         = 50009
0.00.087.904 I llm_load_print_meta: vocab_only       = 0
0.00.087.907 I llm_load_print_meta: n_ctx_train      = 2048
0.00.087.907 I llm_load_print_meta: n_embd           = 2048
0.00.087.907 I llm_load_print_meta: n_layer          = 24
0.00.087.910 I llm_load_print_meta: n_head           = 16
0.00.087.911 I llm_load_print_meta: n_head_kv        = 16
0.00.087.911 I llm_load_print_meta: n_rot            = 32
0.00.087.911 I llm_load_print_meta: n_swa            = 0
0.00.087.911 I llm_load_print_meta: n_embd_head_k    = 128
0.00.087.912 I llm_load_print_meta: n_embd_head_v    = 128
0.00.087.913 I llm_load_print_meta: n_gqa            = 1
0.00.087.914 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.087.914 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.087.915 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.087.915 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.087.915 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.087.915 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.087.916 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.087.916 I llm_load_print_meta: n_ff             = 8192
0.00.087.916 I llm_load_print_meta: n_expert         = 0
0.00.087.916 I llm_load_print_meta: n_expert_used    = 0
0.00.087.917 I llm_load_print_meta: causal attn      = 1
0.00.087.917 I llm_load_print_meta: pooling type     = 0
0.00.087.917 I llm_load_print_meta: rope type        = 2
0.00.087.917 I llm_load_print_meta: rope scaling     = linear
0.00.087.917 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.087.918 I llm_load_print_meta: freq_scale_train = 1
0.00.087.918 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.087.919 I llm_load_print_meta: rope_finetuned   = unknown
0.00.087.919 I llm_load_print_meta: ssm_d_conv       = 0
0.00.087.919 I llm_load_print_meta: ssm_d_inner      = 0
0.00.087.920 I llm_load_print_meta: ssm_d_state      = 0
0.00.087.920 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.087.920 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.087.932 I llm_load_print_meta: model type       = 1.4B
0.00.087.933 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.087.933 I llm_load_print_meta: model params     = 1.41 B
0.00.087.934 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.087.935 I llm_load_print_meta: general.name     = 1.4B
0.00.087.935 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.087.935 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.087.936 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.087.936 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.087.936 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.087.936 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.087.936 I llm_load_print_meta: max token length = 1024
0.00.090.839 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.090.839 I llm_load_tensors: offloading output layer to GPU
0.00.090.840 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.090.850 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.090.851 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.091.884 I llama_new_context_with_model: n_seq_max     = 1
0.00.091.885 I llama_new_context_with_model: n_ctx         = 128
0.00.091.886 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.091.886 I llama_new_context_with_model: n_batch       = 128
0.00.091.886 I llama_new_context_with_model: n_ubatch      = 128
0.00.091.886 I llama_new_context_with_model: flash_attn    = 0
0.00.091.886 I llama_new_context_with_model: freq_base     = 10000.0
0.00.091.887 I llama_new_context_with_model: freq_scale    = 1
0.00.091.887 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.091.887 I ggml_metal_init: allocating
0.00.091.890 I ggml_metal_init: found device: Apple M4
0.00.091.892 I ggml_metal_init: picking default device: Apple M4
0.00.092.485 I ggml_metal_init: using embedded metal library
0.00.094.652 I ggml_metal_init: GPU name:   Apple M4
0.00.094.654 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.094.654 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.094.655 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.094.655 I ggml_metal_init: simdgroup reduction   = true
0.00.094.655 I ggml_metal_init: simdgroup matrix mul. = true
0.00.094.655 I ggml_metal_init: has bfloat            = true
0.00.094.655 I ggml_metal_init: use bfloat            = true
0.00.094.656 I ggml_metal_init: hasUnifiedMemory      = true
0.00.094.656 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.104.071 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.104.077 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.104.097 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.105.006 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.105.007 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.105.007 I llama_new_context_with_model: graph nodes  = 967
0.00.105.008 I llama_new_context_with_model: graph splits = 2
0.00.105.020 I 
0.00.105.053 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.105.055 I compute_imatrix: tokenizing the input ..
0.00.112.083 I compute_imatrix: tokenization took 7.026 ms
0.00.112.084 I compute_imatrix: computing over 1 chunks with batch_size 128
0.01.640.081 I compute_imatrix: 1.53 seconds per pass - ETA 0.02 minutes
[1]10.1498,
Final estimate: PPL = 10.1498 +/- 3.22650

0.01.643.834 I llama_perf_context_print:        load time =    1616.72 ms
0.01.643.835 I llama_perf_context_print: prompt eval time =    1527.26 ms /   128 tokens (   11.93 ms per token,    83.81 tokens per second)
0.01.643.836 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.643.837 I llama_perf_context_print:       total time =    1620.46 ms /   129 tokens
0.01.644.607 I ggml_metal_free: deallocating

real	0m1.834s
user	0m0.174s
sys	0m0.238s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4235 (5c7a5aa0)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x130f0a0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x130f0a830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x130f0ade0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x130f0b390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x130f0b940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x130f0bef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x130f0c4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x130f0ca50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x130f0d000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x130f0d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x130f0da00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x130f0df00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x130f0ea20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x130f0f1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x130f0f9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x130f10100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x130f10820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x130f10f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x130f11660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x130f11e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x130f12550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x130f12c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x130f13390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x130f13c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x130f14350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x130f14610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x130f14c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x130f15890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x130f15dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x130f16090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x130f16530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x130f167f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x130f17080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x130f175c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x130f17880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x130f17d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x130f181c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x130f18660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x130f18b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x130f18fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x130f19440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x130f198e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x130f19d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x130f1a220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x130f1a4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x130f1aaf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x130f1b100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x130f1ba20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x130f1c030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x130f1c640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x130f1cc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x130f1d260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x130f1d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x130f1de80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x130f1e670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x130f1eb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x130f1efb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x130f1f270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x130f1f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x130f20070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x130f20330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x130f207d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x130f20c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x130f21110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x130f215b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x130f21a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x130f21ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x130f22390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x130f22830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x130f22cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x130f23170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x130f23610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x130f23ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x130f23f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x130f243f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x130f24890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x130f24d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x130f251d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x130f25670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x130f25b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x130f25fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x130f26450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x130f268f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x130f26d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x130f27230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x130f276d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x130f27b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x130f28010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x130f284b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x130f28950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x130f28df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x130f29290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x130f29730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x130f29bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x130f2a070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x130f2a510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x130f2a9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x130f1b710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x130f2b000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x130f2b4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x130f2b940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x130f2bde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x130f2c280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x130f2c720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x130f2cbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x130f2d060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x130f2d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x130f2d9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x130f2de40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x130f2e2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x130f2e780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x130f2ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x130f2f0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x130f2f560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x130f2fa00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x130f2fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x130f30340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x130f307e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x130f30c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x130f31120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x130f315c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x130f31a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x130f31f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x130f323a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x130f32840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x130f32ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x130f33180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x130f33620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x130f33ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x130f33f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x130f34400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x130f348a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x130f34d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x130f351e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x130f35680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x130f35b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x130f35fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x130f36460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x130f36900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x130f36da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x130f37240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x130f376e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x130f37b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x130f38020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x130f384c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x130f38960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x130f38e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x130f392a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x130f39740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x130f39be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x130f3a080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x130f3a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x130f3a9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x130f3af10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x130f3b460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x130f3b9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x130f3bf00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x130f3c1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x130f3c7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x130f3cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x130f3d3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x130f3da00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x130f3e010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x130f3e800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x130f3eca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x130f3f140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x130f3f5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x130f3fd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x130f402e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x130f40830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x130f40d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x130f412d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x130f41820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x130f41d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x130f422c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x130f42810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x130f42d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x130f432b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x130f43800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x130f43d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x130f442a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x130f447f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x130f44d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x130f45290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x130f457e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x130f45d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x130f46280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x130f467d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x130f46d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x130f47270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x130f477c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x130f47d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x130f48260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x130f487b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x130f48d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x130f49250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x130f497a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x130f49cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x130f4a240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x130f4a790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x130f4ace0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x130f4b230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x130f4b780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x130f4bcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x130f4c220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x130f4c770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x130f4ccc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x130f4d210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x130f4d760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x130f4dcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x130f4e200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x130f4e750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x130f4eca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x130f4f1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x130f4f740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x130f4fc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x130f501e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x130f50730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x130f50c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x130f511d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x130f51720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x130f51c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x130f521c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x130f52710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x130f52bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x130f53050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x130f534f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x130f53990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x130f53e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x130f542d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x130f54770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x130f54c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x130f550b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x130f55550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x130f559f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x130f55e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x130f56330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x130f56880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x130f56fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x130f576c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x130f57de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x130f58500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x130f587c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x130f58dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x130f593e0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.161.730 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x130f0dd20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x130f0e190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x130f0e600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x130f0ea70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x130f0eee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x130f0f350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x130f0f7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x130f0fc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x130f100a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x130f10510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x130f10980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x130f10f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x130f11850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x130f11fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x130f127b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x130f12ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x130f13590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x130f13c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x130f14370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x130f14cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x130f153e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x130f15ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x130f161c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x130f168b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x130f16fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x130f17410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x130f17880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x130f17cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x130f18160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x130f185d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x130f18a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x130f18eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x130f19320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x130f195e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x130f19a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x130f19ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x130f1a330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x130f1a7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x130f1ac10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x130f1b080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x130f1b4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x130f1b960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x130f1bdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x130f1c240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x130f1c6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x130f1cb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x130f1cf90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x130f1d400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x130f1d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x130f1dce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x130f1e150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x130f1e5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x130f1ea30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x130f1eea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x130f1f310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x130f1f780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x130f1fbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x130f20060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x130f204d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x130f20940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x130f20db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x130f21220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x130f21690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x130f21b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x130f21f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x130f223e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x130f22850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x130f22cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x130f23130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x130f235a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x130f23a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x130f23e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x130f242f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x130f24760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x130f24bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x130f25040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x130f254b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x130f25920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x130f25d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x130f26200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x130f26670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x130f26ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x130f26f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x130f273c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x130f27830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x130f27ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x130f28110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x130f28580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x130f289f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x130f28e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x130f292d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x130f29740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x130f29bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x130f2a020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x130f2a490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x130f2a900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x130f2ad70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x130f2b1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x130f2b650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x130f2bac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x130f2bf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x130f2c3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x130f2c810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x130f2cc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x130f2d0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x130f2d560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x130f2d9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x130f2de40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x130f2e2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x130f2e720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x130f2eb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x130f2f000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x130f2f470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x130f2f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x130f2fd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x130f301c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x130f30630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x130f30aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x130f30f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x130f31380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x130f317f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x130f31c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x130f320d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x130f32540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x130f329b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x130f32e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x130f33290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x130f33700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x130f33b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x130f33fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x130f34450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x130f348c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x130f34d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x130f351a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x130f35610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x130f35a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x130f35ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x130f36360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x130f367d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x130f36c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x130f370b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x130f37520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x130f37990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x130f37e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x130f38270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x130f386e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x130f38b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x130f38fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x130f39430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x130f398a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x130f39d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x130f3a180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x130f3a5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x130f3aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x130f3aed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x130f3b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x130f3b7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x130f3bc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x130f3c090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x130f3c500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x130f3c970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x130f3cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x130f3d250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x130f3d6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x130f3db30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x130f3dfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x130f3e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x130f3eb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x130f3f000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x130f3f470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x130f3f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x130f3fd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x130f401c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x130f40630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x130f40aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x130f40f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x130f41380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x130f417f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x130f41c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x130f420d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x130f42540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x130f429b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x130f42e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x130f43290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x130f43700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x130f43b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x130f43fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x130f44450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x130f448c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x130f44d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x130f451a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x130f45610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x130f45a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x130f45ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x130f46360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x130f467d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x130f46c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x130f470b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x130f47520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x130f47990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x130f47e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x130f48270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x130f486e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x130f48b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x130f48fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x130f49430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x130f498a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x130f49d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x130f4a180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x130f4a5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x130f4aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x130f4aed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x130f4b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x130f4b7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x130f4bc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x130f4c090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x130f4c500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x130f4c970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x130f4cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x130f4d250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x130f4d6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x130f4db30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x130f4dfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x130f4e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x130f4e880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x130f4ecf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x130f4f160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x130f4f5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x130f4fa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x130f4feb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x130f50320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x130f50790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x130f50c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x130f51070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x130f514e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x130f51950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x130f51dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x130f52230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x130f52920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x130f53010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x130f53700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x130f53df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x130f54260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x130f546d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x130f54b40 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x130f0dd20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x130f0e190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x130f0e600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x130f0ea70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x130f0eee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x130f0f350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x130f0f7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x130f0fc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x130f100a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x130f10510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x130f10980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x130f10f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x130f11850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x130f11fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x130f127b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x130f12ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x130f13590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x130f13c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x130f14370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x130f14cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x130f153e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x130f15ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x130f161c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x130f168b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x130f16fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x130f17410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x130f17880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x130f17cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x130f18160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x130f185d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x130f18a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x130f18eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x130f19320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x130f195e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x130f19a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x130f19ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x130f1a330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x130f1a7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x130f1ac10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x130f1b080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x130f1b4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x130f1b960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x130f1bdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x130f1c240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x130f1c6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x130f1cb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x130f1cf90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x130f1d400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x130f1d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x130f1dce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x130f1e150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x130f1e5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x130f1ea30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x130f1eea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x130f1f310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x130f1f780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x130f1fbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x130f20060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x130f204d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x130f20940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x130f20db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x130f21220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x130f21690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x130f21b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x130f21f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x130f223e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x130f22850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x130f22cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x130f23130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x130f235a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x130f23a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x130f23e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x130f242f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x130f24760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x130f24bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x130f25040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x130f254b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x130f25920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x130f25d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x130f26200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x130f26670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x130f26ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x130f26f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x130f273c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x130f27830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x130f27ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x130f28110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x130f28580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x130f289f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x130f28e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x130f292d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x130f29740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x130f29bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x130f2a020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x130f2a490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x130f2a900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x130f2ad70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x130f2b1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x130f2b650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x130f2bac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x130f2bf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x130f2c3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x130f2c810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x130f2cc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x130f2d0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x130f2d560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x130f2d9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x130f2de40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x130f2e2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x130f2e720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x130f2eb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x130f2f000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x130f2f470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x130f2f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x130f2fd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x130f301c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x130f30630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x130f30aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x130f30f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x130f31380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x130f317f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x130f31c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x130f320d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x130f32540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x130f329b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x130f32e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x130f33290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x130f33700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x130f33b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x130f33fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x130f34450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x130f348c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x130f34d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x130f351a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x130f35610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x130f35a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x130f35ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x130f36360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x130f367d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x130f36c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x130f370b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x130f37520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x130f37990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x130f37e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x130f38270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x130f386e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x130f38b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x130f38fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x130f39430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x130f398a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x130f39d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x130f3a180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x130f3a5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x130f3aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x130f3aed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x130f3b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x130f3b7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x130f3bc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x130f3c090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x130f3c500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x130f3c970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x130f3cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x130f3d250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x130f3d6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x130f3db30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x130f3dfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x130f3e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x130f3eb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x130f3f000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x130f3f470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x130f3f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x130f3fd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x130f401c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x130f40630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x130f40aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x130f40f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x130f41380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x130f417f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x130f41c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x130f420d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x130f42540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x130f429b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x130f42e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x130f43290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x130f43700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x130f43b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x130f43fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x130f44450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x130f448c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x130f44d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x130f451a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x130f45610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x130f45a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x130f45ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x130f46360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x130f467d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x130f46c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x130f470b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x130f47520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x130f47990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x130f47e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x130f48270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x130f486e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x130f48b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x130f48fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x130f49430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x130f498a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x130f49d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x130f4a180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x130f4a5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x130f4aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x130f4aed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x130f4b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x130f4b7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x130f4bc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x130f4c090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x130f4c500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x130f4c970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x130f4cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x130f4d250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x130f4d6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x130f4db30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x130f4dfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x130f4e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x130f4e880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x130f4ecf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x130f4f160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x130f4f5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x130f4fa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x130f4feb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x130f50320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x130f50790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x130f50c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x130f51070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x130f514e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x130f51950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x130f51dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x130f52230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x130f52920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x130f53010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x130f53700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x130f53df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x130f54260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x130f546d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x130f54b40 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.817s
user	0m0.308s
sys	0m0.268s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4235 (5c7a5aa0)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13b107420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13b107bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13b108160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13b108710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13b108cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13b109270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13b109820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13b109dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13b10a380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13b10a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13b10ad80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13b10b280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13b10bda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13b10c550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13b10cd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13b10d480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13b10dba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13b10e2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13b10e9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13b10f1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13b10f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13b10fff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13b110710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13b110fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13b1116d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13b111990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13b111fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13b112c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13b113150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13b113410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13b1138b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13b113b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13b114400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13b114940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13b114c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13b1150a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13b115540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13b1159e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13b115e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13b116320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13b1167c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13b116c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13b117100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13b1175a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13b117860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13b117e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13b118480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13b118da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13b1193b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13b1199c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13b119fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13b11a5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13b11abf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13b11b200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13b11b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13b11be90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13b11c330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13b11c5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13b11cc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13b11d3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13b11d6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13b11db50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13b11dff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13b11e490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13b11e930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13b11edd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13b11f270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13b11f710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13b11fbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13b120050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13b1204f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13b120990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13b120e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13b1212d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13b121770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13b121c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13b1220b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13b122550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13b1229f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13b122e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13b123330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13b1237d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13b123c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13b124110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13b1245b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13b124a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13b124ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13b125390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13b125830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13b125cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13b126170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13b126610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13b126ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13b126f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13b1273f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13b127890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13b127d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13b118a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13b128380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13b128820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13b128cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13b129160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13b129600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13b129aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13b129f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13b12a3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13b12a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13b12ad20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13b12b1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13b12b660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13b12bb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13b12bfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13b12c440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13b12c8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13b12cd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13b12d220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13b12d6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13b12db60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13b12e000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13b12e4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13b12e940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13b12ede0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13b12f280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13b12f720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13b12fbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13b130060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13b130500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13b1309a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13b130e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13b1312e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13b131780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13b131c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13b1320c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13b132560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13b132a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13b132ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13b133340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13b1337e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13b133c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13b134120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13b1345c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13b134a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13b134f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13b1353a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13b135840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13b135ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13b136180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13b136620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13b136ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13b136f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13b137400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13b1378a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13b137d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13b138290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13b1387e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13b138d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13b139280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13b139540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13b139b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13b13a160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13b13a770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13b13ad80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13b13b390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13b13bb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13b13c020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13b13c4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13b13c960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13b13d110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13b13d660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13b13dbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13b13e100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13b13e650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13b13eba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13b13f0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13b13f640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13b13fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13b1400e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13b140630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13b140b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13b1410d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13b141620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13b141b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13b1420c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13b142610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13b142b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13b1430b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13b143600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13b143b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13b1440a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13b1445f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13b144b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13b145090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13b1455e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13b145b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13b146080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13b1465d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13b146b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13b147070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13b1475c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13b147b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13b148060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13b1485b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13b148b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13b149050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13b1495a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13b149af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13b14a040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13b14a590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13b14aae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13b14b030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13b14b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13b14bad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13b14c020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13b14c570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13b14cac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13b14d010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13b14d560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13b14dab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13b14e000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13b14e550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13b14eaa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13b14eff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13b14f540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13b14fa90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13b14ff30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13b1503d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13b150870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13b150d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13b1511b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13b151650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13b151af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13b151f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13b152430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13b1528d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13b152d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13b153210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13b1536b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13b153c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13b154320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13b154a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13b155160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13b155880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13b155b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13b156150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13b156760 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.088.103 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x1396059b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x139605e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x139606290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x139606700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x139606b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x139606fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x139607450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x1396078c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x139607d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x1396081a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x139608610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x139608c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x139609790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x139609f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13960a750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13960ae70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13960b590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13960bcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13960c3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13960cba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13960d2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13960d9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13960e100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13960e820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13960ef40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13960f200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13960f4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13960f930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13960fda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x139610210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x139610680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x139610bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x139611020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x1396112e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x139611750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x139611bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x139612030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x1396124a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x139612910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x139612d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x1396131f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x139613660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x139613ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x139613f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x1396143b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x139614820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x139614c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x139615100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x139615570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x1396159e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x139615e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x1396162c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x139616730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x139616ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x139617010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x139617480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x1396179f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x139617ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x139618360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x1396187d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x139618c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x1396190b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x139619520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x139619990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x139619e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13961a270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13961a6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13961ab50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13961afc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13961b430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13961b8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13961bd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13961c180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13961c5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13961ca60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13961ced0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13961d340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13961d7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13961dc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13961e090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13961e500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13961e970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13961ede0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13961f250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13961f6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13961fb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13961ffa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x139620410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x139620880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x139620cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x139621160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x1396215d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x139621a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x139621eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x139622320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x139622790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x139622c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x139623070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x1396234e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x139623950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x139623dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x139624230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x1396246a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x139624b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x139624f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x1396253f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x139625860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x139625cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x139626140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x1396265b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x139626a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x139626e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x139627300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x139627770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x139627be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x139628050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x1396284c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x139628930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x139628da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x139629210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x139629680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x139629af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x139629f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13962a3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13962a840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13962acb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13962b120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13962b590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13962ba00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13962be70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13962c2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13962c750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13962cbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13962d030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13962d4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13962d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13962dd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13962e1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13962e660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13962ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13962ef40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13962f3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13962f820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13962fc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x139630100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x139630570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x1396309e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x139630e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x1396312c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x139631730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x139631ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x139632010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x139632480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x1396328f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x139632d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x1396331d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x139633640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x139633ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x139633f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x139634390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x139634800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x139634c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x1396350e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x139635550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x1396359c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x139635e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x1396362a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x139636e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x1396370f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x1396373b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x139637820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x139637c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x139638100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x139638570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x1396389e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x139638e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x1396392c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x139639730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x139639ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13963a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13963a480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13963a8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13963ad60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13963b1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13963b640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13963bab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13963bf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13963c390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13963c800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13963cc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13963d0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13963d550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13963d9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13963de30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13963e2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13963e710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13963eb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13963eff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13963f460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13963f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13963fd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13b0057f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13b005c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13b0060d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13b006540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13b0069b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13b006e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13b007290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13b007700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13b007b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13b007fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13b008450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13b0088c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13b008d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13b0091a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13b009610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13b009a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13b009ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13b00a360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13b00a7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13b00ac40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13b00b0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13b00b520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13b00b990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13b00be00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13b00c270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13b00c6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13b00cb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13b00cfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13b00d430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13b00d8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13b00dd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13b00e180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13b00e5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13b00ea60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13b00eed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13b00f340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13b00f7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13b010280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13b0109a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13b0110c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13b0117e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13b011aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13b011d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13b0121d0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13b005aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13b005f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13b006380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13b0067f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13b006c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13b0070d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13b007540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13b0079b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13b007e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13b008290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13b008700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13b008ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13b0095d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13b009d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13b00a530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13b00ac20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13b00b310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13b00ba00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13b00c0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13b00ca70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13b00d160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13b00d850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13b00df40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13b00e630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13b00ed20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13b00f190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13b00f600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13b00fa70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13b00fee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13b010350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13b0107c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13b010c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13b0110a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13b011360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13b0117d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13b011c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13b0120b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13b012520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13b012990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13b012e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13b013470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13b013910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13b013db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13b014250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13b014510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13b014980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13b014df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13b015260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13b0156d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13b015b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13b015fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13b016420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13b016890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13b016d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13b017370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13b017810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13b017cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13b017f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13b018580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13b018d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13b019210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13b0196b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13b019b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13b019ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13b01a490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13b01a930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13b01add0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13b01b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13b01b710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13b01bbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13b01c050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13b01c4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13b01c990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13b01ce30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13b01d2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13b01d770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13b01dc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13b01e0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13b01e550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13b01e9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13b01ee90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13b01f330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13b01f7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13b01fc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13b020110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13b0205b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13b020a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13b020ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13b021390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13b021830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13b021cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13b022170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13b022610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13b022ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13b022f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13b0233f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13b023890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13b023d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13b0241d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13b024670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13b024b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13b024fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13b025450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13b0258f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13b025d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13b026230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13b0266d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13b026b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13b027010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13b0274b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13b027950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13b027df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13b028290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13b028730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13b028bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13b029070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13b029510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13b0299b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13b029e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13b02a2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13b02a790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13b02ac30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13b02b0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13b02b570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13b02ba10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13b02beb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13b02c350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13b02c7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13b02cc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13b02d130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13b02d5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13b02da70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13b02df10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13b02e3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13b02e850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13b02ecf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13b02f190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13b02f630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13b02fad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13b02ff70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13b030410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13b0308b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13b030d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13b0311f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13b031690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13b031b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13b031fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13b032470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13b032910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13b032db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13b033250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13b0336f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13b033b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13b0340e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13b034630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13b034b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13b0350d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13b035390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13b0359a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13b035fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13b0365c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13b036bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13b0371e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13b0379d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13b037e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13b038310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13b0387b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13b038f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13b0394b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13b039a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13b039f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13b03a4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13b03a9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13b03af40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13b03b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13b03b9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13b03bf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13b03c480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13b03c9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13b03cf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13b03d470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13b03d9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13b03df10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13b03e460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13b03e9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13b03ef00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13b03f450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13b03f9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13b03fef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13b040440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13b040990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13b040ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13b041430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13b041980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13b041ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13b042420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13b042970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13b042ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13b043410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13b043960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13b043eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13b044400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13b044950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13b044ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13b0453f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13b045940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13b045e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13b0463e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13b046930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13b046e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13b0473d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13b047920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13b047e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13b0483c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13b048910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13b048e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13b0493b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13b049900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13b049e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13b04a3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13b04a8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13b04ae40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13b04b390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13b04b8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13b04bd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13b04c220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13b04c6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13b04cb60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13b04d000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13b04d4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13b04d940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13b04dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13b04e280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13b04e720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13b04ebc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13b04f060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13b04f500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13b04fa50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13b050170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13b050890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13b050fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13b0516d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13b051990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13b051fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13b0525b0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


second run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


single seq run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this

real	0m0.940s
user	0m0.239s
sys	0m0.153s
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
