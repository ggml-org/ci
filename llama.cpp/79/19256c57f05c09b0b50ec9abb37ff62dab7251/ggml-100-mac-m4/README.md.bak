### ctest_debug

Runs ctest in debug mode
- status: 0
```
+ ctest --output-on-failure -L main -E test-opt
Test project /Users/ggml/work/llama.cpp/build-ci-debug
      Start  1: test-tokenizer-0-bert-bge
 1/28 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.57 sec
      Start  2: test-tokenizer-0-command-r
 2/28 Test  #2: test-tokenizer-0-command-r ........   Passed    1.09 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/28 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.17 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/28 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.44 sec
      Start  5: test-tokenizer-0-falcon
 5/28 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.27 sec
      Start  6: test-tokenizer-0-gpt-2
 6/28 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.22 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/28 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    0.66 sec
      Start  8: test-tokenizer-0-llama-spm
 8/28 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.08 sec
      Start  9: test-tokenizer-0-mpt
 9/28 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.22 sec
      Start 10: test-tokenizer-0-phi-3
10/28 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.08 sec
      Start 11: test-tokenizer-0-qwen2
11/28 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.60 sec
      Start 12: test-tokenizer-0-refact
12/28 Test #12: test-tokenizer-0-refact ...........   Passed    0.22 sec
      Start 13: test-tokenizer-0-starcoder
13/28 Test #13: test-tokenizer-0-starcoder ........   Passed    0.22 sec
      Start 14: test-sampling
14/28 Test #14: test-sampling .....................   Passed    2.14 sec
      Start 15: test-grammar-parser
15/28 Test #15: test-grammar-parser ...............   Passed    0.20 sec
      Start 16: test-grammar-integration
16/28 Test #16: test-grammar-integration ..........   Passed    0.30 sec
      Start 17: test-llama-grammar
17/28 Test #17: test-llama-grammar ................   Passed    0.20 sec
      Start 18: test-json-schema-to-grammar
18/28 Test #18: test-json-schema-to-grammar .......   Passed    2.27 sec
      Start 19: test-tokenizer-1-llama-spm
19/28 Test #19: test-tokenizer-1-llama-spm ........   Passed    1.14 sec
      Start 20: test-log
20/28 Test #20: test-log ..........................   Passed    0.23 sec
      Start 21: test-arg-parser
21/28 Test #21: test-arg-parser ...................   Passed    0.34 sec
      Start 22: test-chat-template
22/28 Test #22: test-chat-template ................   Passed    2.87 sec
      Start 23: test-gguf
23/28 Test #23: test-gguf .........................   Passed    1.06 sec
      Start 24: test-backend-ops
24/28 Test #24: test-backend-ops ..................   Passed  190.20 sec
      Start 27: test-barrier
25/28 Test #27: test-barrier ......................   Passed    0.91 sec
      Start 28: test-quantize-fns
26/28 Test #28: test-quantize-fns .................   Passed   25.98 sec
      Start 29: test-quantize-perf
27/28 Test #29: test-quantize-perf ................   Passed    0.35 sec
      Start 30: test-rope
28/28 Test #30: test-rope .........................   Passed    0.22 sec

100% tests passed, 0 tests failed out of 28

Label Time Summary:
main    = 234.23 sec*proc (28 tests)

Total Test time (real) = 234.24 sec

real	3m54.303s
user	8m11.450s
sys	0m7.118s
```

### ctest_release

Runs ctest in release mode
- status: 0
```
+ ctest --output-on-failure -L main
Test project /Users/ggml/work/llama.cpp/build-ci-release
      Start  1: test-tokenizer-0-bert-bge
 1/28 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.31 sec
      Start  2: test-tokenizer-0-command-r
 2/28 Test  #2: test-tokenizer-0-command-r ........   Passed    0.23 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/28 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.04 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/28 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.08 sec
      Start  5: test-tokenizer-0-falcon
 5/28 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.06 sec
      Start  6: test-tokenizer-0-gpt-2
 6/28 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.05 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/28 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    0.14 sec
      Start  8: test-tokenizer-0-llama-spm
 8/28 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.03 sec
      Start  9: test-tokenizer-0-mpt
 9/28 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.05 sec
      Start 10: test-tokenizer-0-phi-3
10/28 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.03 sec
      Start 11: test-tokenizer-0-qwen2
11/28 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.11 sec
      Start 12: test-tokenizer-0-refact
12/28 Test #12: test-tokenizer-0-refact ...........   Passed    0.05 sec
      Start 13: test-tokenizer-0-starcoder
13/28 Test #13: test-tokenizer-0-starcoder ........   Passed    0.05 sec
      Start 14: test-sampling
14/28 Test #14: test-sampling .....................   Passed    0.89 sec
      Start 15: test-grammar-parser
15/28 Test #15: test-grammar-parser ...............   Passed    0.17 sec
      Start 16: test-grammar-integration
16/28 Test #16: test-grammar-integration ..........   Passed    0.20 sec
      Start 17: test-llama-grammar
17/28 Test #17: test-llama-grammar ................   Passed    0.17 sec
      Start 18: test-json-schema-to-grammar
18/28 Test #18: test-json-schema-to-grammar .......   Passed    2.15 sec
      Start 19: test-tokenizer-1-llama-spm
19/28 Test #19: test-tokenizer-1-llama-spm ........   Passed    0.44 sec
      Start 20: test-log
20/28 Test #20: test-log ..........................   Passed    0.19 sec
      Start 21: test-arg-parser
21/28 Test #21: test-arg-parser ...................   Passed    0.24 sec
      Start 22: test-chat-template
22/28 Test #22: test-chat-template ................   Passed    0.46 sec
      Start 23: test-gguf
23/28 Test #23: test-gguf .........................   Passed    0.39 sec
      Start 24: test-backend-ops
24/28 Test #24: test-backend-ops ..................   Passed   30.76 sec
      Start 27: test-barrier
25/28 Test #27: test-barrier ......................   Passed    0.38 sec
      Start 28: test-quantize-fns
26/28 Test #28: test-quantize-fns .................   Passed   14.12 sec
      Start 29: test-quantize-perf
27/28 Test #29: test-quantize-perf ................   Passed    0.21 sec
      Start 30: test-rope
28/28 Test #30: test-rope .........................   Passed    0.20 sec

100% tests passed, 0 tests failed out of 28

Label Time Summary:
main    =  53.18 sec*proc (28 tests)

Total Test time (real) =  53.20 sec

real	0m53.208s
user	1m15.613s
sys	0m6.235s
```
### embd_bge_small

BGE Small (BERT):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-f16.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.131 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.018.497 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.024.062 I llama_model_loader: loaded meta data with 24 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.024.069 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.024.072 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.024.072 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.024.073 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.024.074 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.024.075 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.024.076 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.024.077 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.024.078 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.024.078 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.024.079 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.024.082 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.024.083 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.024.084 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.024.085 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.024.085 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.024.086 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.024.086 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.028.510 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.029.703 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.029.705 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.029.705 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.029.706 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.029.706 I llama_model_loader: - kv  22:               tokenizer.ggml.mask_token_id u32              = 103
0.00.029.707 I llama_model_loader: - kv  23:               general.quantization_version u32              = 2
0.00.029.708 I llama_model_loader: - type  f32:  124 tensors
0.00.029.708 I llama_model_loader: - type  f16:   73 tensors
0.00.029.709 I print_info: file format = GGUF V3 (latest)
0.00.029.709 I print_info: file type   = F16
0.00.029.711 I print_info: file size   = 63.84 MiB (16.12 BPW) 
0.00.034.360 I load: special tokens cache size = 5
0.00.036.537 I load: token to piece cache size = 0.2032 MB
0.00.036.540 I print_info: arch             = bert
0.00.036.541 I print_info: vocab_only       = 0
0.00.036.541 I print_info: n_ctx_train      = 512
0.00.036.541 I print_info: n_embd           = 384
0.00.036.542 I print_info: n_layer          = 12
0.00.036.545 I print_info: n_head           = 12
0.00.036.546 I print_info: n_head_kv        = 12
0.00.036.546 I print_info: n_rot            = 32
0.00.036.549 I print_info: n_swa            = 0
0.00.036.549 I print_info: n_embd_head_k    = 32
0.00.036.549 I print_info: n_embd_head_v    = 32
0.00.036.550 I print_info: n_gqa            = 1
0.00.036.551 I print_info: n_embd_k_gqa     = 384
0.00.036.559 I print_info: n_embd_v_gqa     = 384
0.00.036.562 I print_info: f_norm_eps       = 1.0e-12
0.00.036.562 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.036.563 I print_info: f_clamp_kqv      = 0.0e+00
0.00.036.563 I print_info: f_max_alibi_bias = 0.0e+00
0.00.036.563 I print_info: f_logit_scale    = 0.0e+00
0.00.036.564 I print_info: n_ff             = 1536
0.00.036.565 I print_info: n_expert         = 0
0.00.036.565 I print_info: n_expert_used    = 0
0.00.036.565 I print_info: causal attn      = 0
0.00.036.565 I print_info: pooling type     = 2
0.00.036.565 I print_info: rope type        = 2
0.00.036.567 I print_info: rope scaling     = linear
0.00.036.568 I print_info: freq_base_train  = 10000.0
0.00.036.568 I print_info: freq_scale_train = 1
0.00.036.569 I print_info: n_ctx_orig_yarn  = 512
0.00.036.570 I print_info: rope_finetuned   = unknown
0.00.036.570 I print_info: ssm_d_conv       = 0
0.00.036.570 I print_info: ssm_d_inner      = 0
0.00.036.570 I print_info: ssm_d_state      = 0
0.00.036.571 I print_info: ssm_dt_rank      = 0
0.00.036.571 I print_info: ssm_dt_b_c_rms   = 0
0.00.036.571 I print_info: model type       = 33M
0.00.036.572 I print_info: model params     = 33.21 M
0.00.036.572 I print_info: general.name     = Bge Small
0.00.036.573 I print_info: vocab type       = WPM
0.00.036.573 I print_info: n_vocab          = 30522
0.00.036.573 I print_info: n_merges         = 0
0.00.036.574 I print_info: BOS token        = 101 '[CLS]'
0.00.036.574 I print_info: UNK token        = 100 '[UNK]'
0.00.036.574 I print_info: SEP token        = 102 '[SEP]'
0.00.036.575 I print_info: PAD token        = 0 '[PAD]'
0.00.036.575 I print_info: MASK token       = 103 '[MASK]'
0.00.036.575 I print_info: LF token         = 0 '[PAD]'
0.00.036.576 I print_info: max token length = 21
0.00.039.581 I load_tensors: offloading 12 repeating layers to GPU
0.00.039.582 I load_tensors: offloading output layer to GPU
0.00.039.583 I load_tensors: offloaded 13/13 layers to GPU
0.00.039.606 I load_tensors: Metal_Mapped model buffer size =    40.73 MiB
0.00.039.607 I load_tensors:   CPU_Mapped model buffer size =    23.11 MiB
0.00.039.840 I llama_init_from_model: n_seq_max     = 1
0.00.039.841 I llama_init_from_model: n_ctx         = 512
0.00.039.842 I llama_init_from_model: n_ctx_per_seq = 512
0.00.039.842 I llama_init_from_model: n_batch       = 2048
0.00.039.842 I llama_init_from_model: n_ubatch      = 2048
0.00.039.842 I llama_init_from_model: flash_attn    = 0
0.00.039.843 I llama_init_from_model: freq_base     = 10000.0
0.00.039.843 I llama_init_from_model: freq_scale    = 1
0.00.039.844 I ggml_metal_init: allocating
0.00.039.848 I ggml_metal_init: found device: Apple M4
0.00.039.855 I ggml_metal_init: picking default device: Apple M4
0.00.040.488 I ggml_metal_init: using embedded metal library
0.00.044.514 I ggml_metal_init: GPU name:   Apple M4
0.00.044.516 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.044.517 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.044.517 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.044.518 I ggml_metal_init: simdgroup reduction   = true
0.00.044.518 I ggml_metal_init: simdgroup matrix mul. = true
0.00.044.518 I ggml_metal_init: has residency sets    = true
0.00.044.518 I ggml_metal_init: has bfloat            = true
0.00.044.518 I ggml_metal_init: use bfloat            = true
0.00.044.519 I ggml_metal_init: hasUnifiedMemory      = true
0.00.044.520 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.056.709 I llama_kv_cache_init: kv_size = 512, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 12, can_shift = 1
0.00.057.378 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.057.381 I llama_init_from_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.057.382 I llama_init_from_model:        CPU  output buffer size =     0.00 MiB
0.00.058.605 I llama_init_from_model:      Metal compute buffer size =    16.00 MiB
0.00.058.606 I llama_init_from_model:        CPU compute buffer size =     2.51 MiB
0.00.058.607 I llama_init_from_model: graph nodes  = 429
0.00.058.607 I llama_init_from_model: graph splits = 2
0.00.058.608 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 512
0.00.058.608 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.068.135 I 
0.00.068.162 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.068.824 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.043984 -0.019895  0.007670 -0.000838  0.001372 -0.037036  0.109436  0.042589  0.092046 -0.015918  0.006773 -0.035692 -0.017889  0.015040  0.018126  0.015860 -0.011308  0.010431 -0.085223 -0.008454  0.091368 -0.017067 -0.060328 -0.024484  0.027524  0.076059  0.027984 -0.014564  0.017645 -0.033268 -0.037874 -0.019012  0.068670 -0.009845 -0.025030  0.072346 -0.046570  0.011026 -0.050252  0.047693  0.032387 -0.011761  0.022055  0.049645  0.010465  0.005795 -0.028860  0.008933 -0.018507 -0.051466 -0.046036  0.030497 -0.035418  0.054204 -0.069650  0.044238  0.029786  0.046305  0.073410 -0.042580  0.076109  0.038851 -0.181182  0.082503  0.042250 -0.064549 -0.060097 -0.017853  0.006472  0.005873  0.017196 -0.026615  0.064578  0.112612  0.035159 -0.067416  0.027073 -0.067295 -0.033493 -0.033219  0.033252  0.013523 -0.003346 -0.037473 -0.052055  0.055155 -0.001982 -0.038276  0.064447  0.028824 -0.043334 -0.029236 -0.039462  0.036315  0.008379 -0.015481 -0.036573  0.018130  0.028600  0.342831 -0.044484  0.056114  0.017624 -0.020867 -0.066808  0.000146 -0.037885 -0.030063 -0.008541 -0.021595  0.000548 -0.003219  0.004020  0.018908 -0.008548  0.025835  0.049433  0.000091  0.050920 -0.042479 -0.031884  0.023606  0.030691 -0.023148 -0.046271 -0.079278  0.115198  0.046757  0.027829 -0.040710  0.067777 -0.022955  0.010332 -0.032937 -0.018305  0.043844  0.024268  0.052413  0.007469  0.008905  0.011244 -0.074655 -0.065561 -0.026750 -0.041192 -0.023884  0.026710  0.006912  0.027741  0.052873 -0.036673  0.057707 -0.000170  0.031764 -0.019760 -0.022083  0.041053 -0.058903  0.019619  0.043144  0.043582  0.041593 -0.022527  0.027037 -0.021833  0.005430 -0.041317 -0.001239  0.024452  0.002088  0.044333 -0.022745  0.043662  0.064763  0.055430  0.037060 -0.000919  0.046111  0.045790 -0.008487  0.063057 -0.073235 -0.011935  0.032107  0.023957  0.014725 -0.033688  0.001083 -0.015827 -0.019002  0.047872  0.110842  0.028428  0.031366 -0.013288 -0.057499  0.006644  0.005140 -0.012262 -0.051443 -0.000965 -0.017642 -0.019440 -0.040937  0.009209 -0.057957  0.050961  0.052340 -0.009617 -0.040259 -0.014075 -0.024877 -0.017251  0.006302  0.006588 -0.026919  0.015600  0.030760  0.002578  0.023206 -0.022199 -0.098557 -0.051105 -0.278031 -0.014994 -0.061553 -0.027218  0.017666 -0.010939 -0.017077  0.035055  0.046994 -0.015432  0.015232 -0.025477  0.047844 -0.005949 -0.000749 -0.061008 -0.068946 -0.060377 -0.035942  0.043319 -0.055047  0.015075  0.000537 -0.058175 -0.010439  0.012643  0.151495  0.127111 -0.013622  0.041993 -0.025672  0.014026 -0.001037 -0.150469  0.044857  0.005320 -0.036274 -0.029801 -0.020192 -0.034891  0.010235  0.033548 -0.048178 -0.051795 -0.017463 -0.023492  0.047349  0.052076 -0.016783 -0.055452  0.025836 -0.005707  0.010710  0.038705  0.008191 -0.009764 -0.105779 -0.027430 -0.096101  0.025068 -0.011260  0.092355  0.056101  0.003758  0.027791  0.002092 -0.051085 -0.039890 -0.013542 -0.044956 -0.015335  0.002910 -0.043498 -0.077951  0.065217 -0.006840 -0.001630 -0.014642  0.071560  0.023714 -0.037180  0.009175  0.001562 -0.032268  0.015468  0.037880  0.000337 -0.053207  0.021321 -0.039829  0.000031  0.013400  0.019798 -0.057879  0.006473 -0.049531 -0.267858  0.039156 -0.067972  0.038248 -0.012333  0.041485 -0.016117  0.052383 -0.071363  0.011369  0.024719 -0.007232  0.082087  0.028535 -0.021504  0.040494 -0.004570 -0.074594 -0.014749  0.020037  0.002304  0.023148  0.197212 -0.043222 -0.025983 -0.004959 -0.019278  0.074258  0.001716 -0.031979 -0.036599 -0.045082  0.000547 -0.011560  0.018126 -0.029461 -0.008463  0.006419  0.050799 -0.014959  0.006176  0.026096 -0.030809  0.048055  0.114093 -0.040826 -0.011457  0.005419 -0.003599  0.025154 -0.059142  0.013753 -0.010399  0.038709  0.051449  0.035413  0.035031 -0.017027  0.026360 -0.014490 -0.050032  0.003219  0.054121  0.039723 -0.039127 

0.00.073.719 I llama_perf_context_print:        load time =      49.63 ms
0.00.073.721 I llama_perf_context_print: prompt eval time =       4.75 ms /     9 tokens (    0.53 ms per token,  1892.74 tokens per second)
0.00.073.722 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.073.722 I llama_perf_context_print:       total time =       5.58 ms /    10 tokens
0.00.073.887 I ggml_metal_free: deallocating

real	0m0.281s
user	0m0.062s
sys	0m0.033s
```
- q8_0:
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-q8_0.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.037 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.191 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.011.912 I llama_model_loader: loaded meta data with 24 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.011.916 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.011.917 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.011.918 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.011.919 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.011.919 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.011.921 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.011.922 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.011.922 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.011.922 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.011.923 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.011.923 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.011.925 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.011.925 I llama_model_loader: - kv  11:                      bert.attention.causal bool             = false
0.00.011.926 I llama_model_loader: - kv  12:                          bert.pooling_type u32              = 2
0.00.011.926 I llama_model_loader: - kv  13:            tokenizer.ggml.token_type_count u32              = 2
0.00.011.926 I llama_model_loader: - kv  14:                       tokenizer.ggml.model str              = bert
0.00.011.927 I llama_model_loader: - kv  15:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.014.347 I llama_model_loader: - kv  16:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.014.982 I llama_model_loader: - kv  17:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.014.983 I llama_model_loader: - kv  18:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.014.984 I llama_model_loader: - kv  19:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.014.984 I llama_model_loader: - kv  20:            tokenizer.ggml.padding_token_id u32              = 0
0.00.014.984 I llama_model_loader: - kv  21:               tokenizer.ggml.mask_token_id u32              = 103
0.00.014.984 I llama_model_loader: - kv  22:               general.quantization_version u32              = 2
0.00.014.985 I llama_model_loader: - kv  23:                          general.file_type u32              = 7
0.00.014.985 I llama_model_loader: - type  f32:  124 tensors
0.00.014.986 I llama_model_loader: - type q8_0:   73 tensors
0.00.014.986 I print_info: file format = GGUF V3 (latest)
0.00.014.987 I print_info: file type   = Q8_0
0.00.014.987 I print_info: file size   = 34.38 MiB (8.68 BPW) 
0.00.017.595 I load: special tokens cache size = 5
0.00.018.858 I load: token to piece cache size = 0.2032 MB
0.00.018.861 I print_info: arch             = bert
0.00.018.861 I print_info: vocab_only       = 0
0.00.018.862 I print_info: n_ctx_train      = 512
0.00.018.862 I print_info: n_embd           = 384
0.00.018.862 I print_info: n_layer          = 12
0.00.018.866 I print_info: n_head           = 12
0.00.018.866 I print_info: n_head_kv        = 12
0.00.018.867 I print_info: n_rot            = 32
0.00.018.867 I print_info: n_swa            = 0
0.00.018.867 I print_info: n_embd_head_k    = 32
0.00.018.869 I print_info: n_embd_head_v    = 32
0.00.018.870 I print_info: n_gqa            = 1
0.00.018.871 I print_info: n_embd_k_gqa     = 384
0.00.018.871 I print_info: n_embd_v_gqa     = 384
0.00.018.872 I print_info: f_norm_eps       = 1.0e-12
0.00.018.873 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.018.874 I print_info: f_clamp_kqv      = 0.0e+00
0.00.018.874 I print_info: f_max_alibi_bias = 0.0e+00
0.00.018.874 I print_info: f_logit_scale    = 0.0e+00
0.00.018.875 I print_info: n_ff             = 1536
0.00.018.875 I print_info: n_expert         = 0
0.00.018.875 I print_info: n_expert_used    = 0
0.00.018.875 I print_info: causal attn      = 0
0.00.018.877 I print_info: pooling type     = 2
0.00.018.877 I print_info: rope type        = 2
0.00.018.877 I print_info: rope scaling     = linear
0.00.018.877 I print_info: freq_base_train  = 10000.0
0.00.018.877 I print_info: freq_scale_train = 1
0.00.018.878 I print_info: n_ctx_orig_yarn  = 512
0.00.018.878 I print_info: rope_finetuned   = unknown
0.00.018.878 I print_info: ssm_d_conv       = 0
0.00.018.878 I print_info: ssm_d_inner      = 0
0.00.018.878 I print_info: ssm_d_state      = 0
0.00.018.878 I print_info: ssm_dt_rank      = 0
0.00.018.878 I print_info: ssm_dt_b_c_rms   = 0
0.00.018.879 I print_info: model type       = 33M
0.00.018.879 I print_info: model params     = 33.21 M
0.00.018.879 I print_info: general.name     = Bge Small
0.00.018.880 I print_info: vocab type       = WPM
0.00.018.880 I print_info: n_vocab          = 30522
0.00.018.880 I print_info: n_merges         = 0
0.00.018.880 I print_info: BOS token        = 101 '[CLS]'
0.00.018.881 I print_info: UNK token        = 100 '[UNK]'
0.00.018.881 I print_info: SEP token        = 102 '[SEP]'
0.00.018.881 I print_info: PAD token        = 0 '[PAD]'
0.00.018.881 I print_info: MASK token       = 103 '[MASK]'
0.00.018.881 I print_info: LF token         = 0 '[PAD]'
0.00.018.881 I print_info: max token length = 21
0.00.020.687 I load_tensors: offloading 12 repeating layers to GPU
0.00.020.688 I load_tensors: offloading output layer to GPU
0.00.020.688 I load_tensors: offloaded 13/13 layers to GPU
0.00.020.694 I load_tensors: Metal_Mapped model buffer size =    21.75 MiB
0.00.020.694 I load_tensors:   CPU_Mapped model buffer size =    12.63 MiB
0.00.020.911 I llama_init_from_model: n_seq_max     = 1
0.00.020.912 I llama_init_from_model: n_ctx         = 512
0.00.020.913 I llama_init_from_model: n_ctx_per_seq = 512
0.00.020.913 I llama_init_from_model: n_batch       = 2048
0.00.020.913 I llama_init_from_model: n_ubatch      = 2048
0.00.020.913 I llama_init_from_model: flash_attn    = 0
0.00.020.914 I llama_init_from_model: freq_base     = 10000.0
0.00.020.914 I llama_init_from_model: freq_scale    = 1
0.00.020.914 I ggml_metal_init: allocating
0.00.020.918 I ggml_metal_init: found device: Apple M4
0.00.020.923 I ggml_metal_init: picking default device: Apple M4
0.00.021.446 I ggml_metal_init: using embedded metal library
0.00.023.866 I ggml_metal_init: GPU name:   Apple M4
0.00.023.868 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.023.869 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.023.869 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.023.869 I ggml_metal_init: simdgroup reduction   = true
0.00.023.870 I ggml_metal_init: simdgroup matrix mul. = true
0.00.023.870 I ggml_metal_init: has residency sets    = true
0.00.023.870 I ggml_metal_init: has bfloat            = true
0.00.023.870 I ggml_metal_init: use bfloat            = true
0.00.023.871 I ggml_metal_init: hasUnifiedMemory      = true
0.00.023.872 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.034.063 I llama_kv_cache_init: kv_size = 512, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 12, can_shift = 1
0.00.034.671 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.034.672 I llama_init_from_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.034.674 I llama_init_from_model:        CPU  output buffer size =     0.00 MiB
0.00.035.678 I llama_init_from_model:      Metal compute buffer size =    16.00 MiB
0.00.035.679 I llama_init_from_model:        CPU compute buffer size =     2.51 MiB
0.00.035.680 I llama_init_from_model: graph nodes  = 429
0.00.035.680 I llama_init_from_model: graph splits = 2
0.00.035.681 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 512
0.00.035.681 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.039.817 I 
0.00.039.843 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.040.416 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.044994 -0.019858  0.007986 -0.001410  0.001531 -0.036276  0.109404  0.043235  0.092836 -0.015201  0.005971 -0.036330 -0.018159  0.015015  0.017667  0.014510 -0.011792  0.011812 -0.084764 -0.008081  0.091650 -0.017638 -0.061084 -0.025066  0.026879  0.076180  0.028256 -0.014273  0.017420 -0.033553 -0.037520 -0.018280  0.068843 -0.010129 -0.024896  0.071968 -0.046406  0.011471 -0.050333  0.048931  0.032317 -0.012107  0.021812  0.049796  0.010366  0.005264 -0.028665  0.008581 -0.018508 -0.052358 -0.046410  0.029426 -0.034989  0.053289 -0.069849  0.043767  0.029291  0.046759  0.073664 -0.043090  0.075213  0.038641 -0.180496  0.081648  0.043389 -0.065615 -0.059878 -0.017387  0.006913  0.005155  0.017165 -0.026679  0.064347  0.112564  0.034871 -0.067783  0.027124 -0.066989 -0.034296 -0.033344  0.033189  0.014325 -0.004253 -0.036945 -0.052008  0.054151 -0.001715 -0.038112  0.063016  0.028668 -0.041665 -0.028879 -0.039263  0.036879  0.007718 -0.015657 -0.036270  0.018699  0.029792  0.344948 -0.043880  0.056487  0.018022 -0.021448 -0.065281  0.000253 -0.037910 -0.029663 -0.008828 -0.020643  0.001162 -0.003510  0.003091  0.018576 -0.009637  0.025316  0.049298 -0.000937  0.051568 -0.042363 -0.031550  0.023315  0.030044 -0.023267 -0.045483 -0.079644  0.114489  0.047503  0.027208 -0.041477  0.067717 -0.022845  0.010232 -0.033486 -0.017199  0.044319  0.022956  0.052194  0.008122  0.008112  0.009951 -0.074643 -0.065035 -0.025938 -0.040806 -0.024533  0.027409  0.006078  0.027693  0.052243 -0.036587  0.058682  0.001467  0.032191 -0.019964 -0.021840  0.041805 -0.058801  0.019348  0.042626  0.043999  0.040911 -0.021909  0.028025 -0.022801  0.005520 -0.041266 -0.000085  0.024325  0.001532  0.044802 -0.022888  0.043056  0.065030  0.056292  0.037666 -0.001004  0.047521  0.045624 -0.008614  0.062270 -0.073313 -0.011718  0.032708  0.023348  0.014650 -0.033924  0.001158 -0.015872 -0.018974  0.047982  0.110740  0.029177  0.030881 -0.012325 -0.057836  0.006939  0.004378 -0.011864 -0.051754 -0.003018 -0.017766 -0.020051 -0.041018  0.009118 -0.058568  0.050632  0.051795 -0.008968 -0.040668 -0.014765 -0.024320 -0.015980  0.005823  0.007147 -0.027335  0.016275  0.030734  0.002342  0.023167 -0.022169 -0.098059 -0.050901 -0.277240 -0.015100 -0.061566 -0.026219  0.017141 -0.010285 -0.017522  0.034725  0.047897 -0.016594  0.015489 -0.024132  0.048613 -0.004993 -0.000001 -0.060860 -0.068346 -0.059622 -0.036157  0.043605 -0.056353  0.014713  0.000292 -0.058627 -0.010995  0.012274  0.151597  0.127025 -0.012582  0.042765 -0.025227  0.013629 -0.000381 -0.150686  0.043974  0.004714 -0.036955 -0.029586 -0.019853 -0.034063  0.009522  0.034004 -0.048909 -0.051765 -0.017243 -0.025080  0.047588  0.050981 -0.017553 -0.056746  0.024054 -0.006285  0.011003  0.038719  0.008083 -0.008595 -0.106361 -0.027365 -0.096966  0.025294 -0.011096  0.091579  0.056180  0.004494  0.028066  0.001727 -0.051388 -0.039497 -0.013817 -0.045907 -0.015238  0.002920 -0.043938 -0.077716  0.066102 -0.006195 -0.000885 -0.013768  0.071562  0.023826 -0.036363  0.007848  0.001487 -0.032916  0.016336  0.037378  0.000625 -0.052389  0.021549 -0.039695 -0.000026  0.013496  0.020436 -0.057513  0.005900 -0.049906 -0.267546  0.038686 -0.067509  0.037450 -0.011471  0.041547 -0.015904  0.051347 -0.072313  0.012571  0.024808 -0.007420  0.082069  0.028175 -0.021956  0.040736 -0.003945 -0.074192 -0.014923  0.020417  0.002644  0.023207  0.197144 -0.043068 -0.025876 -0.004886 -0.018582  0.073936  0.001341 -0.031663 -0.037140 -0.044262  0.000049 -0.010741  0.018225 -0.028045 -0.008828  0.006047  0.050183 -0.015017  0.007037  0.025894 -0.030628  0.048075  0.112795 -0.039982 -0.011695  0.005039 -0.002800  0.025072 -0.059720  0.014182 -0.010019  0.038100  0.051088  0.034726  0.035947 -0.017035  0.027243 -0.015391 -0.051195  0.003744  0.053928  0.040014 -0.039140 

0.00.044.947 I llama_perf_context_print:        load time =      30.62 ms
0.00.044.948 I llama_perf_context_print: prompt eval time =       4.39 ms /     9 tokens (    0.49 ms per token,  2050.58 tokens per second)
0.00.044.948 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.044.949 I llama_perf_context_print:       total time =       5.13 ms /    10 tokens
0.00.045.155 I ggml_metal_free: deallocating

real	0m0.057s
user	0m0.031s
sys	0m0.016s
```
### rerank_tiny

Rerank Tiny (Jina):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/rerank-tiny/ggml-model-f16.gguf -p 'what is panda?</s></s>hi\nwhat is panda?</s></s>it'\''s a bear\nwhat is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.' -ngl 99 -c 0 --pooling rank --embd-normalize -1 --verbose-prompt
0.00.000.184 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.022.052 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.034.842 I llama_model_loader: loaded meta data with 28 key-value pairs and 70 tensors from ../models-mnt/rerank-tiny/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.034.847 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.034.849 I llama_model_loader: - kv   0:                       general.architecture str              = jina-bert-v2
0.00.034.852 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.034.853 I llama_model_loader: - kv   2:                               general.name str              = Jina Bert Implementation
0.00.034.854 I llama_model_loader: - kv   3:                       general.organization str              = Jinaai
0.00.034.854 I llama_model_loader: - kv   4:                         general.size_label str              = 33M
0.00.034.856 I llama_model_loader: - kv   5:                   jina-bert-v2.block_count u32              = 4
0.00.034.858 I llama_model_loader: - kv   6:                jina-bert-v2.context_length u32              = 8192
0.00.034.859 I llama_model_loader: - kv   7:              jina-bert-v2.embedding_length u32              = 384
0.00.034.859 I llama_model_loader: - kv   8:           jina-bert-v2.feed_forward_length u32              = 1536
0.00.034.860 I llama_model_loader: - kv   9:          jina-bert-v2.attention.head_count u32              = 12
0.00.034.865 I llama_model_loader: - kv  10:  jina-bert-v2.attention.layer_norm_epsilon f32              = 0.000000
0.00.034.866 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.034.867 I llama_model_loader: - kv  12:              jina-bert-v2.attention.causal bool             = false
0.00.034.867 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.034.868 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = jina-v1-en
0.00.042.572 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,61056]   = ["<s>", "<pad>", "</s>", "<unk>", "<m...
0.00.044.736 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,61056]   = [3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, ...
0.00.049.269 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,39382]   = ["t h", "i n", "a n", "e r", "th e", ...
0.00.049.271 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.049.272 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 2
0.00.049.272 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 3
0.00.049.272 I llama_model_loader: - kv  21:          tokenizer.ggml.seperator_token_id u32              = 2
0.00.049.273 I llama_model_loader: - kv  22:            tokenizer.ggml.padding_token_id u32              = 1
0.00.049.273 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 4
0.00.049.273 I llama_model_loader: - kv  24:            tokenizer.ggml.token_type_count u32              = 2
0.00.049.274 I llama_model_loader: - kv  25:               tokenizer.ggml.add_bos_token bool             = true
0.00.049.274 I llama_model_loader: - kv  26:               tokenizer.ggml.add_eos_token bool             = true
0.00.049.274 I llama_model_loader: - kv  27:               general.quantization_version u32              = 2
0.00.049.275 I llama_model_loader: - type  f32:   40 tensors
0.00.049.275 I llama_model_loader: - type  f16:   30 tensors
0.00.049.276 I print_info: file format = GGUF V3 (latest)
0.00.049.276 I print_info: file type   = F16
0.00.049.278 I print_info: file size   = 62.78 MiB (16.01 BPW) 
0.00.053.371 W load: empty token at index 5
0.00.058.492 W load: model vocab missing newline token, using special_pad_id instead
0.00.060.008 W load: special_eos_id is not in special_eog_ids - the tokenizer config may be incorrect
0.00.060.044 I load: special tokens cache size = 5
0.00.310.871 I load: token to piece cache size = 1.5060 MB
0.00.310.876 I print_info: arch             = jina-bert-v2
0.00.310.876 I print_info: vocab_only       = 0
0.00.310.876 I print_info: n_ctx_train      = 8192
0.00.310.877 I print_info: n_embd           = 384
0.00.310.877 I print_info: n_layer          = 4
0.00.310.883 I print_info: n_head           = 12
0.00.310.884 I print_info: n_head_kv        = 12
0.00.310.884 I print_info: n_rot            = 32
0.00.310.885 I print_info: n_swa            = 0
0.00.310.885 I print_info: n_embd_head_k    = 32
0.00.310.885 I print_info: n_embd_head_v    = 32
0.00.310.885 I print_info: n_gqa            = 1
0.00.310.886 I print_info: n_embd_k_gqa     = 384
0.00.310.887 I print_info: n_embd_v_gqa     = 384
0.00.310.888 I print_info: f_norm_eps       = 1.0e-12
0.00.310.888 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.310.889 I print_info: f_clamp_kqv      = 0.0e+00
0.00.310.889 I print_info: f_max_alibi_bias = 8.0e+00
0.00.310.889 I print_info: f_logit_scale    = 0.0e+00
0.00.310.890 I print_info: n_ff             = 1536
0.00.310.890 I print_info: n_expert         = 0
0.00.310.893 I print_info: n_expert_used    = 0
0.00.310.893 I print_info: causal attn      = 0
0.00.310.893 I print_info: pooling type     = -1
0.00.310.893 I print_info: rope type        = -1
0.00.310.894 I print_info: rope scaling     = linear
0.00.310.894 I print_info: freq_base_train  = 10000.0
0.00.310.894 I print_info: freq_scale_train = 1
0.00.310.894 I print_info: n_ctx_orig_yarn  = 8192
0.00.310.895 I print_info: rope_finetuned   = unknown
0.00.310.895 I print_info: ssm_d_conv       = 0
0.00.310.895 I print_info: ssm_d_inner      = 0
0.00.310.895 I print_info: ssm_d_state      = 0
0.00.310.895 I print_info: ssm_dt_rank      = 0
0.00.310.896 I print_info: ssm_dt_b_c_rms   = 0
0.00.310.896 I print_info: model type       = 33M
0.00.310.896 I print_info: model params     = 32.90 M
0.00.310.897 I print_info: general.name     = Jina Bert Implementation
0.00.310.898 I print_info: vocab type       = BPE
0.00.310.898 I print_info: n_vocab          = 61056
0.00.310.898 I print_info: n_merges         = 39382
0.00.310.898 I print_info: BOS token        = 0 '<s>'
0.00.310.899 I print_info: EOS token        = 2 '</s>'
0.00.310.899 I print_info: UNK token        = 3 '<unk>'
0.00.310.899 I print_info: SEP token        = 2 '</s>'
0.00.310.899 I print_info: PAD token        = 1 '<pad>'
0.00.310.899 I print_info: MASK token       = 4 '<mask>'
0.00.310.900 I print_info: EOG token        = 2 '</s>'
0.00.310.900 I print_info: max token length = 45
0.00.312.969 I load_tensors: offloading 4 repeating layers to GPU
0.00.312.970 I load_tensors: offloading output layer to GPU
0.00.312.971 I load_tensors: offloaded 5/5 layers to GPU
0.00.312.992 I load_tensors: Metal_Mapped model buffer size =    18.06 MiB
0.00.312.993 I load_tensors:   CPU_Mapped model buffer size =    44.72 MiB
0.00.313.492 I llama_init_from_model: n_seq_max     = 1
0.00.313.493 I llama_init_from_model: n_ctx         = 8192
0.00.313.493 I llama_init_from_model: n_ctx_per_seq = 8192
0.00.313.493 I llama_init_from_model: n_batch       = 2048
0.00.313.494 I llama_init_from_model: n_ubatch      = 2048
0.00.313.494 I llama_init_from_model: flash_attn    = 0
0.00.313.494 I llama_init_from_model: freq_base     = 10000.0
0.00.313.494 I llama_init_from_model: freq_scale    = 1
0.00.313.495 I ggml_metal_init: allocating
0.00.313.500 I ggml_metal_init: found device: Apple M4
0.00.313.503 I ggml_metal_init: picking default device: Apple M4
0.00.314.146 I ggml_metal_init: using embedded metal library
0.00.316.991 I ggml_metal_init: GPU name:   Apple M4
0.00.316.993 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.316.993 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.316.994 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.316.994 I ggml_metal_init: simdgroup reduction   = true
0.00.316.994 I ggml_metal_init: simdgroup matrix mul. = true
0.00.316.994 I ggml_metal_init: has residency sets    = true
0.00.316.994 I ggml_metal_init: has bfloat            = true
0.00.316.995 I ggml_metal_init: use bfloat            = true
0.00.316.995 I ggml_metal_init: hasUnifiedMemory      = true
0.00.316.996 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.326.435 I llama_kv_cache_init: kv_size = 8192, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 4, can_shift = 1
0.00.329.416 I llama_kv_cache_init:      Metal KV buffer size =    48.00 MiB
0.00.329.418 I llama_init_from_model: KV self size  =   48.00 MiB, K (f16):   24.00 MiB, V (f16):   24.00 MiB
0.00.329.419 I llama_init_from_model:        CPU  output buffer size =     0.00 MiB
0.00.335.218 I llama_init_from_model:      Metal compute buffer size =   220.01 MiB
0.00.335.219 I llama_init_from_model:        CPU compute buffer size =    22.02 MiB
0.00.335.220 I llama_init_from_model: graph nodes  = 154
0.00.335.220 I llama_init_from_model: graph splits = 2
0.00.335.221 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 8192
0.00.335.221 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.342.573 I 
0.00.342.607 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.343.004 I main: prompt 0: 'what is panda?</s></s>hi'
0.00.343.005 I main: number of tokens in prompt = 9
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 23233 -> 'hi'
     2 -> '</s>'


0.00.343.012 I main: prompt 1: 'what is panda?</s></s>it's a bear'
0.00.343.013 I main: number of tokens in prompt = 13
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21153 -> 'it'
    37 -> '''
    87 -> 's'
    69 -> 'a'
 25706 -> 'bear'
     2 -> '</s>'


0.00.343.017 I main: prompt 2: 'what is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.'
0.00.343.017 I main: number of tokens in prompt = 40
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21215 -> 'he'
 28390 -> 'giant'
 49990 -> 'panda'
    38 -> '('
 21163 -> 'il'
 26237 -> 'uro'
 21223 -> 'po'
 23179 -> 'da'
 36906 -> 'melan'
 26791 -> 'ole'
    89 -> 'u'
 21402 -> 'ca'
 21686 -> '),'
 23314 -> 'sometimes'
 22517 -> 'called'
    69 -> 'a'
 49990 -> 'panda'
 25706 -> 'bear'
 21142 -> 'or'
 22810 -> 'simply'
 49990 -> 'panda'
    42 -> ','
 21152 -> 'is'
    69 -> 'a'
 25706 -> 'bear'
 25677 -> 'species'
 28930 -> 'ende'
 22024 -> 'mic'
 21148 -> 'to'
    76 -> 'h'
 22344 -> 'ina'
    44 -> '.'
     2 -> '</s>'


0.00.343.545 I batch_decode: n_tokens = 62, n_seq = 3

rerank score 0:    0.023
rerank score 1:    0.024
rerank score 2:    0.199

0.00.347.134 I llama_perf_context_print:        load time =     320.51 ms
0.00.347.135 I llama_perf_context_print: prompt eval time =       3.57 ms /    62 tokens (    0.06 ms per token, 17381.55 tokens per second)
0.00.347.136 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.347.138 I llama_perf_context_print:       total time =       4.56 ms /    63 tokens
0.00.347.385 I ggml_metal_free: deallocating

real	0m1.553s
user	0m0.318s
sys	0m0.050s
  - rerank score 0 @ 0.023 OK
  - rerank score 1 @ 0.024 OK
  - rerank score 2 @ 0.199 OK
```
### pythia_1_4b

Pythia 1.4B:
- status: 0
- perplexity:
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
- imatrix:
```
Final estimate: PPL = 10.1498 +/- 3.22650
```
- f16: 
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.156 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.333 I main: llama backend init
0.00.000.340 I main: load the model and apply lora adapter, if any
0.00.073.770 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.085.877 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.085.889 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.085.898 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.085.899 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.085.900 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.085.900 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.085.901 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.085.903 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.085.904 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.085.905 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.085.906 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.085.907 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.085.907 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.085.908 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.085.913 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.085.913 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.085.914 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.092.722 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.094.866 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.101.577 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.101.583 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.101.584 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.101.585 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.101.586 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.101.587 I llama_model_loader: - type  f32:  194 tensors
0.00.101.588 I llama_model_loader: - type  f16:   98 tensors
0.00.101.590 I print_info: file format = GGUF V3 (latest)
0.00.101.591 I print_info: file type   = all F32 (guessed)
0.00.101.598 I print_info: file size   = 2.64 GiB (16.01 BPW) 
0.00.120.123 I load: special tokens cache size = 25
0.00.130.600 I load: token to piece cache size = 0.2984 MB
0.00.130.606 I print_info: arch             = gptneox
0.00.130.607 I print_info: vocab_only       = 0
0.00.130.607 I print_info: n_ctx_train      = 2048
0.00.130.607 I print_info: n_embd           = 2048
0.00.130.610 I print_info: n_layer          = 24
0.00.130.615 I print_info: n_head           = 16
0.00.130.619 I print_info: n_head_kv        = 16
0.00.130.620 I print_info: n_rot            = 32
0.00.130.620 I print_info: n_swa            = 0
0.00.130.620 I print_info: n_embd_head_k    = 128
0.00.130.620 I print_info: n_embd_head_v    = 128
0.00.130.621 I print_info: n_gqa            = 1
0.00.130.623 I print_info: n_embd_k_gqa     = 2048
0.00.130.624 I print_info: n_embd_v_gqa     = 2048
0.00.130.625 I print_info: f_norm_eps       = 1.0e-05
0.00.130.625 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.130.625 I print_info: f_clamp_kqv      = 0.0e+00
0.00.130.626 I print_info: f_max_alibi_bias = 0.0e+00
0.00.130.626 I print_info: f_logit_scale    = 0.0e+00
0.00.130.627 I print_info: n_ff             = 8192
0.00.130.627 I print_info: n_expert         = 0
0.00.130.627 I print_info: n_expert_used    = 0
0.00.130.628 I print_info: causal attn      = 1
0.00.130.628 I print_info: pooling type     = 0
0.00.130.628 I print_info: rope type        = 2
0.00.130.628 I print_info: rope scaling     = linear
0.00.130.629 I print_info: freq_base_train  = 10000.0
0.00.130.629 I print_info: freq_scale_train = 1
0.00.130.630 I print_info: n_ctx_orig_yarn  = 2048
0.00.130.630 I print_info: rope_finetuned   = unknown
0.00.130.630 I print_info: ssm_d_conv       = 0
0.00.130.631 I print_info: ssm_d_inner      = 0
0.00.130.631 I print_info: ssm_d_state      = 0
0.00.130.631 I print_info: ssm_dt_rank      = 0
0.00.130.631 I print_info: ssm_dt_b_c_rms   = 0
0.00.130.632 I print_info: model type       = 1.4B
0.00.130.632 I print_info: model params     = 1.41 B
0.00.130.632 I print_info: general.name     = 1.4B
0.00.130.633 I print_info: vocab type       = BPE
0.00.130.633 I print_info: n_vocab          = 50304
0.00.130.634 I print_info: n_merges         = 50009
0.00.130.635 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.130.635 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.130.636 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.130.637 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.130.638 I print_info: LF token         = 128 'Ä'
0.00.130.638 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.130.639 I print_info: max token length = 1024
0.00.186.145 I load_tensors: offloading 24 repeating layers to GPU
0.00.186.149 I load_tensors: offloading output layer to GPU
0.00.186.149 I load_tensors: offloaded 25/25 layers to GPU
0.00.186.175 I load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.186.176 I load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
0.00.186.791 I llama_init_from_model: n_seq_max     = 1
0.00.186.793 I llama_init_from_model: n_ctx         = 2048
0.00.186.793 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.186.793 I llama_init_from_model: n_batch       = 2048
0.00.186.793 I llama_init_from_model: n_ubatch      = 512
0.00.186.793 I llama_init_from_model: flash_attn    = 0
0.00.186.794 I llama_init_from_model: freq_base     = 10000.0
0.00.186.794 I llama_init_from_model: freq_scale    = 1
0.00.186.795 I ggml_metal_init: allocating
0.00.186.827 I ggml_metal_init: found device: Apple M4
0.00.186.832 I ggml_metal_init: picking default device: Apple M4
0.00.187.454 I ggml_metal_init: using embedded metal library
0.00.203.868 I ggml_metal_init: GPU name:   Apple M4
0.00.203.870 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.203.871 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.203.871 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.203.871 I ggml_metal_init: simdgroup reduction   = true
0.00.203.871 I ggml_metal_init: simdgroup matrix mul. = true
0.00.203.872 I ggml_metal_init: has residency sets    = true
0.00.203.872 I ggml_metal_init: has bfloat            = true
0.00.203.872 I ggml_metal_init: use bfloat            = true
0.00.203.872 I ggml_metal_init: hasUnifiedMemory      = true
0.00.203.873 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.251.827 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.283.154 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.283.160 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.283.183 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.288.084 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.288.086 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.288.087 I llama_init_from_model: graph nodes  = 967
0.00.288.087 I llama_init_from_model: graph splits = 2
0.00.288.094 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.288.218 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.288.218 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.353.959 I main: llama threadpool init, n_threads = 4
0.00.353.999 I 
0.00.354.031 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.354.032 I 
0.00.354.191 I sampler seed: 1234
0.00.354.195 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.354.220 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.354.222 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.354.222 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling guilty. I don't like feeling bad. I don't like feeling like I am a failure,

0.02.185.425 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58532.56 tokens per second)
0.02.185.426 I llama_perf_context_print:        load time =     279.18 ms
0.02.185.426 I llama_perf_context_print: prompt eval time =      43.72 ms /     7 tokens (    6.25 ms per token,   160.11 tokens per second)
0.02.185.429 I llama_perf_context_print:        eval time =    1784.70 ms /    63 runs   (   28.33 ms per token,    35.30 tokens per second)
0.02.185.429 I llama_perf_context_print:       total time =    1832.46 ms /    70 tokens
0.02.185.718 I ggml_metal_free: deallocating

real	0m2.513s
user	0m0.136s
sys	0m0.153s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.854 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.033.251 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.047.610 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.047.620 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.047.623 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.047.624 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.047.624 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.047.625 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.047.626 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.047.630 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.047.630 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.047.631 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.047.632 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.047.633 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.047.634 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.047.634 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.047.637 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.047.638 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.047.639 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.056.585 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.058.883 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.066.467 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.066.469 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.066.470 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.066.470 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.066.470 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.066.471 I llama_model_loader: - type  f32:  194 tensors
0.00.066.471 I llama_model_loader: - type  f16:   98 tensors
0.00.066.473 I print_info: file format = GGUF V3 (latest)
0.00.066.473 I print_info: file type   = all F32 (guessed)
0.00.066.475 I print_info: file size   = 2.64 GiB (16.01 BPW) 
0.00.079.457 I load: special tokens cache size = 25
0.00.087.990 I load: token to piece cache size = 0.2984 MB
0.00.087.994 I print_info: arch             = gptneox
0.00.087.994 I print_info: vocab_only       = 0
0.00.087.994 I print_info: n_ctx_train      = 2048
0.00.087.994 I print_info: n_embd           = 2048
0.00.087.995 I print_info: n_layer          = 24
0.00.087.998 I print_info: n_head           = 16
0.00.087.999 I print_info: n_head_kv        = 16
0.00.087.999 I print_info: n_rot            = 32
0.00.087.999 I print_info: n_swa            = 0
0.00.088.000 I print_info: n_embd_head_k    = 128
0.00.088.002 I print_info: n_embd_head_v    = 128
0.00.088.003 I print_info: n_gqa            = 1
0.00.088.004 I print_info: n_embd_k_gqa     = 2048
0.00.088.005 I print_info: n_embd_v_gqa     = 2048
0.00.088.006 I print_info: f_norm_eps       = 1.0e-05
0.00.088.007 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.088.007 I print_info: f_clamp_kqv      = 0.0e+00
0.00.088.007 I print_info: f_max_alibi_bias = 0.0e+00
0.00.088.007 I print_info: f_logit_scale    = 0.0e+00
0.00.088.008 I print_info: n_ff             = 8192
0.00.088.017 I print_info: n_expert         = 0
0.00.088.019 I print_info: n_expert_used    = 0
0.00.088.019 I print_info: causal attn      = 1
0.00.088.020 I print_info: pooling type     = 0
0.00.088.020 I print_info: rope type        = 2
0.00.088.020 I print_info: rope scaling     = linear
0.00.088.020 I print_info: freq_base_train  = 10000.0
0.00.088.021 I print_info: freq_scale_train = 1
0.00.088.021 I print_info: n_ctx_orig_yarn  = 2048
0.00.088.021 I print_info: rope_finetuned   = unknown
0.00.088.021 I print_info: ssm_d_conv       = 0
0.00.088.022 I print_info: ssm_d_inner      = 0
0.00.088.022 I print_info: ssm_d_state      = 0
0.00.088.022 I print_info: ssm_dt_rank      = 0
0.00.088.022 I print_info: ssm_dt_b_c_rms   = 0
0.00.088.022 I print_info: model type       = 1.4B
0.00.088.023 I print_info: model params     = 1.41 B
0.00.088.025 I print_info: general.name     = 1.4B
0.00.088.025 I print_info: vocab type       = BPE
0.00.088.025 I print_info: n_vocab          = 50304
0.00.088.025 I print_info: n_merges         = 50009
0.00.088.026 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.088.026 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.088.027 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.088.027 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.088.028 I print_info: LF token         = 128 'Ä'
0.00.088.030 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.088.030 I print_info: max token length = 1024
0.01.403.167 I load_tensors: offloading 24 repeating layers to GPU
0.01.403.171 I load_tensors: offloading output layer to GPU
0.01.403.171 I load_tensors: offloaded 25/25 layers to GPU
0.01.403.195 I load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.01.403.196 I load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
0.01.403.883 I llama_init_from_model: n_seq_max     = 1
0.01.403.885 I llama_init_from_model: n_ctx         = 128
0.01.403.885 I llama_init_from_model: n_ctx_per_seq = 128
0.01.403.886 I llama_init_from_model: n_batch       = 128
0.01.403.886 I llama_init_from_model: n_ubatch      = 128
0.01.403.886 I llama_init_from_model: flash_attn    = 0
0.01.403.887 I llama_init_from_model: freq_base     = 10000.0
0.01.403.887 I llama_init_from_model: freq_scale    = 1
0.01.403.888 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.01.403.889 I ggml_metal_init: allocating
0.01.403.932 I ggml_metal_init: found device: Apple M4
0.01.403.941 I ggml_metal_init: picking default device: Apple M4
0.01.405.064 I ggml_metal_init: using embedded metal library
0.01.409.702 I ggml_metal_init: GPU name:   Apple M4
0.01.409.704 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.01.409.705 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.01.409.706 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.01.409.706 I ggml_metal_init: simdgroup reduction   = true
0.01.409.706 I ggml_metal_init: simdgroup matrix mul. = true
0.01.409.707 I ggml_metal_init: has residency sets    = true
0.01.409.707 I ggml_metal_init: has bfloat            = true
0.01.409.707 I ggml_metal_init: use bfloat            = true
0.01.409.707 I ggml_metal_init: hasUnifiedMemory      = true
0.01.409.709 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.01.423.091 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.01.424.978 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.01.424.981 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.01.424.999 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.01.426.828 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.01.426.829 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.01.426.829 I llama_init_from_model: graph nodes  = 967
0.01.426.830 I llama_init_from_model: graph splits = 2
0.01.426.831 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.01.426.831 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.460.669 I 
0.01.460.705 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.01.460.725 I perplexity: tokenizing the input ..
0.01.465.578 I perplexity: tokenization took 4.851 ms
0.01.465.600 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.584.201 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.585.594 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.585.610 I llama_perf_context_print:        load time =    1427.41 ms
0.01.585.611 I llama_perf_context_print: prompt eval time =     118.34 ms /   128 tokens (    0.92 ms per token,  1081.67 tokens per second)
0.01.585.612 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.585.613 I llama_perf_context_print:       total time =     124.94 ms /   129 tokens
0.01.585.948 I ggml_metal_free: deallocating

real	0m1.796s
user	0m0.103s
sys	0m0.237s
```
- q8_0:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.048 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.089 I main: llama backend init
0.00.000.092 I main: load the model and apply lora adapter, if any
0.00.011.103 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.028.646 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.028.652 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.028.654 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.028.655 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.028.655 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.028.656 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.028.656 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.028.658 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.028.658 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.028.658 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.028.659 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.028.659 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.028.659 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.028.660 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.028.661 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.028.662 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.028.662 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.032.613 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.033.700 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.037.550 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.037.552 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.037.552 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.037.553 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.037.553 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.037.553 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.037.554 I llama_model_loader: - type  f32:  194 tensors
0.00.037.554 I llama_model_loader: - type q8_0:   98 tensors
0.00.037.555 I print_info: file format = GGUF V3 (latest)
0.00.037.558 I print_info: file type   = Q8_0
0.00.037.560 I print_info: file size   = 1.40 GiB (8.51 BPW) 
0.00.047.720 I load: special tokens cache size = 25
0.00.054.550 I load: token to piece cache size = 0.2984 MB
0.00.054.554 I print_info: arch             = gptneox
0.00.054.554 I print_info: vocab_only       = 0
0.00.054.554 I print_info: n_ctx_train      = 2048
0.00.054.555 I print_info: n_embd           = 2048
0.00.054.555 I print_info: n_layer          = 24
0.00.054.561 I print_info: n_head           = 16
0.00.054.562 I print_info: n_head_kv        = 16
0.00.054.562 I print_info: n_rot            = 32
0.00.054.562 I print_info: n_swa            = 0
0.00.054.563 I print_info: n_embd_head_k    = 128
0.00.054.563 I print_info: n_embd_head_v    = 128
0.00.054.564 I print_info: n_gqa            = 1
0.00.054.564 I print_info: n_embd_k_gqa     = 2048
0.00.054.565 I print_info: n_embd_v_gqa     = 2048
0.00.054.566 I print_info: f_norm_eps       = 1.0e-05
0.00.054.566 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.054.566 I print_info: f_clamp_kqv      = 0.0e+00
0.00.054.566 I print_info: f_max_alibi_bias = 0.0e+00
0.00.054.567 I print_info: f_logit_scale    = 0.0e+00
0.00.054.568 I print_info: n_ff             = 8192
0.00.054.568 I print_info: n_expert         = 0
0.00.054.568 I print_info: n_expert_used    = 0
0.00.054.568 I print_info: causal attn      = 1
0.00.054.568 I print_info: pooling type     = 0
0.00.054.568 I print_info: rope type        = 2
0.00.054.569 I print_info: rope scaling     = linear
0.00.054.569 I print_info: freq_base_train  = 10000.0
0.00.054.569 I print_info: freq_scale_train = 1
0.00.054.570 I print_info: n_ctx_orig_yarn  = 2048
0.00.054.570 I print_info: rope_finetuned   = unknown
0.00.054.570 I print_info: ssm_d_conv       = 0
0.00.054.570 I print_info: ssm_d_inner      = 0
0.00.054.570 I print_info: ssm_d_state      = 0
0.00.054.570 I print_info: ssm_dt_rank      = 0
0.00.054.570 I print_info: ssm_dt_b_c_rms   = 0
0.00.054.571 I print_info: model type       = 1.4B
0.00.054.571 I print_info: model params     = 1.41 B
0.00.054.571 I print_info: general.name     = 1.4B
0.00.054.572 I print_info: vocab type       = BPE
0.00.054.572 I print_info: n_vocab          = 50304
0.00.054.572 I print_info: n_merges         = 50009
0.00.054.575 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.054.575 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.054.575 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.054.575 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.054.576 I print_info: LF token         = 128 'Ä'
0.00.054.576 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.054.576 I print_info: max token length = 1024
0.01.138.021 I load_tensors: offloading 24 repeating layers to GPU
0.01.138.027 I load_tensors: offloading output layer to GPU
0.01.138.028 I load_tensors: offloaded 25/25 layers to GPU
0.01.138.051 I load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.01.138.052 I load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
0.01.138.978 I llama_init_from_model: n_seq_max     = 1
0.01.138.980 I llama_init_from_model: n_ctx         = 2048
0.01.138.980 I llama_init_from_model: n_ctx_per_seq = 2048
0.01.138.981 I llama_init_from_model: n_batch       = 2048
0.01.138.981 I llama_init_from_model: n_ubatch      = 512
0.01.138.981 I llama_init_from_model: flash_attn    = 0
0.01.138.982 I llama_init_from_model: freq_base     = 10000.0
0.01.138.982 I llama_init_from_model: freq_scale    = 1
0.01.138.984 I ggml_metal_init: allocating
0.01.138.993 I ggml_metal_init: found device: Apple M4
0.01.138.999 I ggml_metal_init: picking default device: Apple M4
0.01.140.167 I ggml_metal_init: using embedded metal library
0.01.145.360 I ggml_metal_init: GPU name:   Apple M4
0.01.145.364 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.01.145.364 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.01.145.365 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.01.145.366 I ggml_metal_init: simdgroup reduction   = true
0.01.145.366 I ggml_metal_init: simdgroup matrix mul. = true
0.01.145.366 I ggml_metal_init: has residency sets    = true
0.01.145.366 I ggml_metal_init: has bfloat            = true
0.01.145.366 I ggml_metal_init: use bfloat            = true
0.01.145.367 I ggml_metal_init: hasUnifiedMemory      = true
0.01.145.368 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.01.161.214 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.01.217.614 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.01.217.621 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.01.217.646 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.01.222.274 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.01.222.276 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.01.222.276 I llama_init_from_model: graph nodes  = 967
0.01.222.276 I llama_init_from_model: graph splits = 2
0.01.222.282 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.01.222.406 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.01.222.407 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.276.862 I main: llama threadpool init, n_threads = 4
0.01.276.907 I 
0.01.276.930 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.01.276.931 I 
0.01.277.106 I sampler seed: 1234
0.01.277.111 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.277.158 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.277.162 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.277.163 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.356.786 I llama_perf_sampler_print:    sampling time =       1.38 ms /    71 runs   (    0.02 ms per token, 51636.36 tokens per second)
0.02.356.786 I llama_perf_context_print:        load time =    1264.87 ms
0.02.356.787 I llama_perf_context_print: prompt eval time =      39.81 ms /     7 tokens (    5.69 ms per token,   175.81 tokens per second)
0.02.356.788 I llama_perf_context_print:        eval time =    1036.73 ms /    63 runs   (   16.46 ms per token,    60.77 tokens per second)
0.02.356.789 I llama_perf_context_print:       total time =    1080.81 ms /    70 tokens
0.02.357.005 I ggml_metal_free: deallocating

real	0m2.378s
user	0m0.110s
sys	0m0.280s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.254 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.126 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.017.113 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.017.119 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.121 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.121 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.122 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.127 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.127 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.128 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.129 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.129 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.129 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.130 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.130 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.131 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.133 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.133 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.133 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.277 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.438 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.565 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.567 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.567 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.567 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.567 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.568 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.026.569 I llama_model_loader: - type  f32:  194 tensors
0.00.026.569 I llama_model_loader: - type q8_0:   98 tensors
0.00.026.570 I print_info: file format = GGUF V3 (latest)
0.00.026.570 I print_info: file type   = Q8_0
0.00.026.571 I print_info: file size   = 1.40 GiB (8.51 BPW) 
0.00.035.180 I load: special tokens cache size = 25
0.00.041.237 I load: token to piece cache size = 0.2984 MB
0.00.041.242 I print_info: arch             = gptneox
0.00.041.242 I print_info: vocab_only       = 0
0.00.041.242 I print_info: n_ctx_train      = 2048
0.00.041.243 I print_info: n_embd           = 2048
0.00.041.243 I print_info: n_layer          = 24
0.00.041.246 I print_info: n_head           = 16
0.00.041.247 I print_info: n_head_kv        = 16
0.00.041.247 I print_info: n_rot            = 32
0.00.041.248 I print_info: n_swa            = 0
0.00.041.248 I print_info: n_embd_head_k    = 128
0.00.041.248 I print_info: n_embd_head_v    = 128
0.00.041.249 I print_info: n_gqa            = 1
0.00.041.250 I print_info: n_embd_k_gqa     = 2048
0.00.041.250 I print_info: n_embd_v_gqa     = 2048
0.00.041.251 I print_info: f_norm_eps       = 1.0e-05
0.00.041.251 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.041.251 I print_info: f_clamp_kqv      = 0.0e+00
0.00.041.251 I print_info: f_max_alibi_bias = 0.0e+00
0.00.041.252 I print_info: f_logit_scale    = 0.0e+00
0.00.041.252 I print_info: n_ff             = 8192
0.00.041.254 I print_info: n_expert         = 0
0.00.041.256 I print_info: n_expert_used    = 0
0.00.041.256 I print_info: causal attn      = 1
0.00.041.256 I print_info: pooling type     = 0
0.00.041.256 I print_info: rope type        = 2
0.00.041.257 I print_info: rope scaling     = linear
0.00.041.257 I print_info: freq_base_train  = 10000.0
0.00.041.257 I print_info: freq_scale_train = 1
0.00.041.258 I print_info: n_ctx_orig_yarn  = 2048
0.00.041.258 I print_info: rope_finetuned   = unknown
0.00.041.258 I print_info: ssm_d_conv       = 0
0.00.041.258 I print_info: ssm_d_inner      = 0
0.00.041.258 I print_info: ssm_d_state      = 0
0.00.041.259 I print_info: ssm_dt_rank      = 0
0.00.041.259 I print_info: ssm_dt_b_c_rms   = 0
0.00.041.259 I print_info: model type       = 1.4B
0.00.041.259 I print_info: model params     = 1.41 B
0.00.041.260 I print_info: general.name     = 1.4B
0.00.041.260 I print_info: vocab type       = BPE
0.00.041.260 I print_info: n_vocab          = 50304
0.00.041.262 I print_info: n_merges         = 50009
0.00.041.262 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.041.262 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.041.262 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.041.263 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.041.263 I print_info: LF token         = 128 'Ä'
0.00.041.263 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.041.263 I print_info: max token length = 1024
0.00.852.088 I load_tensors: offloading 24 repeating layers to GPU
0.00.852.093 I load_tensors: offloading output layer to GPU
0.00.852.094 I load_tensors: offloaded 25/25 layers to GPU
0.00.852.122 I load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.852.124 I load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
0.00.853.222 I llama_init_from_model: n_seq_max     = 1
0.00.853.224 I llama_init_from_model: n_ctx         = 128
0.00.853.224 I llama_init_from_model: n_ctx_per_seq = 128
0.00.853.225 I llama_init_from_model: n_batch       = 128
0.00.853.228 I llama_init_from_model: n_ubatch      = 128
0.00.853.229 I llama_init_from_model: flash_attn    = 0
0.00.853.229 I llama_init_from_model: freq_base     = 10000.0
0.00.853.230 I llama_init_from_model: freq_scale    = 1
0.00.853.231 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.853.232 I ggml_metal_init: allocating
0.00.853.286 I ggml_metal_init: found device: Apple M4
0.00.853.297 I ggml_metal_init: picking default device: Apple M4
0.00.854.564 I ggml_metal_init: using embedded metal library
0.00.859.875 I ggml_metal_init: GPU name:   Apple M4
0.00.859.879 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.859.880 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.859.881 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.859.881 I ggml_metal_init: simdgroup reduction   = true
0.00.859.881 I ggml_metal_init: simdgroup matrix mul. = true
0.00.859.882 I ggml_metal_init: has residency sets    = true
0.00.859.882 I ggml_metal_init: has bfloat            = true
0.00.859.882 I ggml_metal_init: use bfloat            = true
0.00.859.883 I ggml_metal_init: hasUnifiedMemory      = true
0.00.859.886 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.876.291 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.879.231 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.879.235 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.879.257 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.881.894 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.881.896 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.881.896 I llama_init_from_model: graph nodes  = 967
0.00.881.896 I llama_init_from_model: graph splits = 2
0.00.881.898 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.881.899 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.909.627 I 
0.00.909.700 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.909.722 I perplexity: tokenizing the input ..
0.00.917.146 I perplexity: tokenization took 7.422 ms
0.00.917.165 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.056.085 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.01.057.499 I Final estimate: PPL = 10.1362 +/- 3.22437

0.01.057.510 I llama_perf_context_print:        load time =     899.49 ms
0.01.057.511 I llama_perf_context_print: prompt eval time =     137.93 ms /   128 tokens (    1.08 ms per token,   928.01 tokens per second)
0.01.057.512 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.057.512 I llama_perf_context_print:       total time =     147.89 ms /   129 tokens
0.01.057.879 I ggml_metal_free: deallocating

real	0m1.075s
user	0m0.078s
sys	0m0.153s
```
- q4_0:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.046 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.087 I main: llama backend init
0.00.000.089 I main: load the model and apply lora adapter, if any
0.00.016.375 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.035.570 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.035.576 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.035.577 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.035.578 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.035.578 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.035.578 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.035.579 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.035.580 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.035.580 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.035.580 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.035.581 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.035.581 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.035.582 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.035.582 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.035.584 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.035.585 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.035.585 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.039.910 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.041.024 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.045.308 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.045.309 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.045.310 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.045.310 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.045.310 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.045.311 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.045.311 I llama_model_loader: - type  f32:  194 tensors
0.00.045.311 I llama_model_loader: - type q4_0:   97 tensors
0.00.045.312 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.312 I print_info: file format = GGUF V3 (latest)
0.00.045.313 I print_info: file type   = Q4_0
0.00.045.314 I print_info: file size   = 786.31 MiB (4.66 BPW) 
0.00.054.507 I load: special tokens cache size = 25
0.00.062.222 I load: token to piece cache size = 0.2984 MB
0.00.062.226 I print_info: arch             = gptneox
0.00.062.226 I print_info: vocab_only       = 0
0.00.062.227 I print_info: n_ctx_train      = 2048
0.00.062.227 I print_info: n_embd           = 2048
0.00.062.227 I print_info: n_layer          = 24
0.00.062.231 I print_info: n_head           = 16
0.00.062.232 I print_info: n_head_kv        = 16
0.00.062.232 I print_info: n_rot            = 32
0.00.062.233 I print_info: n_swa            = 0
0.00.062.233 I print_info: n_embd_head_k    = 128
0.00.062.233 I print_info: n_embd_head_v    = 128
0.00.062.234 I print_info: n_gqa            = 1
0.00.062.235 I print_info: n_embd_k_gqa     = 2048
0.00.062.235 I print_info: n_embd_v_gqa     = 2048
0.00.062.236 I print_info: f_norm_eps       = 1.0e-05
0.00.062.237 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.062.237 I print_info: f_clamp_kqv      = 0.0e+00
0.00.062.237 I print_info: f_max_alibi_bias = 0.0e+00
0.00.062.237 I print_info: f_logit_scale    = 0.0e+00
0.00.062.238 I print_info: n_ff             = 8192
0.00.062.238 I print_info: n_expert         = 0
0.00.062.239 I print_info: n_expert_used    = 0
0.00.062.239 I print_info: causal attn      = 1
0.00.062.239 I print_info: pooling type     = 0
0.00.062.239 I print_info: rope type        = 2
0.00.062.239 I print_info: rope scaling     = linear
0.00.062.240 I print_info: freq_base_train  = 10000.0
0.00.062.240 I print_info: freq_scale_train = 1
0.00.062.240 I print_info: n_ctx_orig_yarn  = 2048
0.00.062.241 I print_info: rope_finetuned   = unknown
0.00.062.241 I print_info: ssm_d_conv       = 0
0.00.062.241 I print_info: ssm_d_inner      = 0
0.00.062.241 I print_info: ssm_d_state      = 0
0.00.062.241 I print_info: ssm_dt_rank      = 0
0.00.062.241 I print_info: ssm_dt_b_c_rms   = 0
0.00.062.241 I print_info: model type       = 1.4B
0.00.062.242 I print_info: model params     = 1.41 B
0.00.062.242 I print_info: general.name     = 1.4B
0.00.062.243 I print_info: vocab type       = BPE
0.00.062.243 I print_info: n_vocab          = 50304
0.00.062.243 I print_info: n_merges         = 50009
0.00.062.243 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.062.244 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.062.244 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.062.244 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.062.244 I print_info: LF token         = 128 'Ä'
0.00.062.245 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.062.245 I print_info: max token length = 1024
0.00.635.167 I load_tensors: offloading 24 repeating layers to GPU
0.00.635.184 I load_tensors: offloading output layer to GPU
0.00.635.184 I load_tensors: offloaded 25/25 layers to GPU
0.00.635.220 I load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.635.221 I load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
0.00.636.810 I llama_init_from_model: n_seq_max     = 1
0.00.636.816 I llama_init_from_model: n_ctx         = 2048
0.00.636.817 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.636.817 I llama_init_from_model: n_batch       = 2048
0.00.636.818 I llama_init_from_model: n_ubatch      = 512
0.00.636.818 I llama_init_from_model: flash_attn    = 0
0.00.636.820 I llama_init_from_model: freq_base     = 10000.0
0.00.636.821 I llama_init_from_model: freq_scale    = 1
0.00.636.828 I ggml_metal_init: allocating
0.00.636.934 I ggml_metal_init: found device: Apple M4
0.00.636.948 I ggml_metal_init: picking default device: Apple M4
0.00.638.831 I ggml_metal_init: using embedded metal library
0.00.645.350 I ggml_metal_init: GPU name:   Apple M4
0.00.645.356 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.645.357 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.645.358 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.645.358 I ggml_metal_init: simdgroup reduction   = true
0.00.645.359 I ggml_metal_init: simdgroup matrix mul. = true
0.00.645.359 I ggml_metal_init: has residency sets    = true
0.00.645.359 I ggml_metal_init: has bfloat            = true
0.00.645.359 I ggml_metal_init: use bfloat            = true
0.00.645.360 I ggml_metal_init: hasUnifiedMemory      = true
0.00.645.362 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.663.562 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.719.717 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.719.724 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.719.759 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.723.981 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.723.983 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.723.983 I llama_init_from_model: graph nodes  = 967
0.00.723.983 I llama_init_from_model: graph splits = 2
0.00.723.988 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.724.121 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.724.122 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.778.877 I main: llama threadpool init, n_threads = 4
0.00.778.923 I 
0.00.778.948 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.778.950 I 
0.00.779.125 I sampler seed: 1234
0.00.779.129 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.779.186 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.779.189 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.779.190 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.456.651 I llama_perf_sampler_print:    sampling time =       1.40 ms /    71 runs   (    0.02 ms per token, 50605.84 tokens per second)
0.01.456.651 I llama_perf_context_print:        load time =     761.60 ms
0.01.456.652 I llama_perf_context_print: prompt eval time =      49.07 ms /     7 tokens (    7.01 ms per token,   142.66 tokens per second)
0.01.456.653 I llama_perf_context_print:        eval time =     625.49 ms /    63 runs   (    9.93 ms per token,   100.72 tokens per second)
0.01.456.653 I llama_perf_context_print:       total time =     678.67 ms /    70 tokens
0.01.456.943 I ggml_metal_free: deallocating

real	0m1.476s
user	0m0.114s
sys	0m0.202s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.265 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.187 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.017.325 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.017.329 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.331 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.332 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.332 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.332 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.333 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.334 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.334 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.335 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.335 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.338 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.338 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.338 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.341 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.342 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.342 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.065 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.088 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.735 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.736 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.737 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.737 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.737 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.737 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.025.738 I llama_model_loader: - type  f32:  194 tensors
0.00.025.738 I llama_model_loader: - type q4_0:   97 tensors
0.00.025.739 I llama_model_loader: - type q6_K:    1 tensors
0.00.025.739 I print_info: file format = GGUF V3 (latest)
0.00.025.740 I print_info: file type   = Q4_0
0.00.025.741 I print_info: file size   = 786.31 MiB (4.66 BPW) 
0.00.033.307 I load: special tokens cache size = 25
0.00.039.135 I load: token to piece cache size = 0.2984 MB
0.00.039.138 I print_info: arch             = gptneox
0.00.039.138 I print_info: vocab_only       = 0
0.00.039.138 I print_info: n_ctx_train      = 2048
0.00.039.138 I print_info: n_embd           = 2048
0.00.039.139 I print_info: n_layer          = 24
0.00.039.142 I print_info: n_head           = 16
0.00.039.145 I print_info: n_head_kv        = 16
0.00.039.145 I print_info: n_rot            = 32
0.00.039.145 I print_info: n_swa            = 0
0.00.039.145 I print_info: n_embd_head_k    = 128
0.00.039.145 I print_info: n_embd_head_v    = 128
0.00.039.146 I print_info: n_gqa            = 1
0.00.039.147 I print_info: n_embd_k_gqa     = 2048
0.00.039.148 I print_info: n_embd_v_gqa     = 2048
0.00.039.148 I print_info: f_norm_eps       = 1.0e-05
0.00.039.149 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.039.149 I print_info: f_clamp_kqv      = 0.0e+00
0.00.039.149 I print_info: f_max_alibi_bias = 0.0e+00
0.00.039.149 I print_info: f_logit_scale    = 0.0e+00
0.00.039.150 I print_info: n_ff             = 8192
0.00.039.150 I print_info: n_expert         = 0
0.00.039.150 I print_info: n_expert_used    = 0
0.00.039.151 I print_info: causal attn      = 1
0.00.039.151 I print_info: pooling type     = 0
0.00.039.151 I print_info: rope type        = 2
0.00.039.151 I print_info: rope scaling     = linear
0.00.039.152 I print_info: freq_base_train  = 10000.0
0.00.039.152 I print_info: freq_scale_train = 1
0.00.039.152 I print_info: n_ctx_orig_yarn  = 2048
0.00.039.152 I print_info: rope_finetuned   = unknown
0.00.039.158 I print_info: ssm_d_conv       = 0
0.00.039.161 I print_info: ssm_d_inner      = 0
0.00.039.161 I print_info: ssm_d_state      = 0
0.00.039.161 I print_info: ssm_dt_rank      = 0
0.00.039.161 I print_info: ssm_dt_b_c_rms   = 0
0.00.039.161 I print_info: model type       = 1.4B
0.00.039.163 I print_info: model params     = 1.41 B
0.00.039.163 I print_info: general.name     = 1.4B
0.00.039.163 I print_info: vocab type       = BPE
0.00.039.164 I print_info: n_vocab          = 50304
0.00.039.164 I print_info: n_merges         = 50009
0.00.039.164 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.039.164 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.039.164 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.039.165 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.039.165 I print_info: LF token         = 128 'Ä'
0.00.039.165 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.039.165 I print_info: max token length = 1024
0.00.555.274 I load_tensors: offloading 24 repeating layers to GPU
0.00.555.287 I load_tensors: offloading output layer to GPU
0.00.555.287 I load_tensors: offloaded 25/25 layers to GPU
0.00.555.319 I load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.555.320 I load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
0.00.556.700 I llama_init_from_model: n_seq_max     = 1
0.00.556.704 I llama_init_from_model: n_ctx         = 128
0.00.556.705 I llama_init_from_model: n_ctx_per_seq = 128
0.00.556.710 I llama_init_from_model: n_batch       = 128
0.00.556.711 I llama_init_from_model: n_ubatch      = 128
0.00.556.711 I llama_init_from_model: flash_attn    = 0
0.00.556.713 I llama_init_from_model: freq_base     = 10000.0
0.00.556.714 I llama_init_from_model: freq_scale    = 1
0.00.556.714 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.556.716 I ggml_metal_init: allocating
0.00.556.793 I ggml_metal_init: found device: Apple M4
0.00.556.807 I ggml_metal_init: picking default device: Apple M4
0.00.558.632 I ggml_metal_init: using embedded metal library
0.00.565.395 I ggml_metal_init: GPU name:   Apple M4
0.00.565.400 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.565.401 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.565.402 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.565.402 I ggml_metal_init: simdgroup reduction   = true
0.00.565.403 I ggml_metal_init: simdgroup matrix mul. = true
0.00.565.403 I ggml_metal_init: has residency sets    = true
0.00.565.403 I ggml_metal_init: has bfloat            = true
0.00.565.403 I ggml_metal_init: use bfloat            = true
0.00.565.405 I ggml_metal_init: hasUnifiedMemory      = true
0.00.565.406 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.583.915 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.587.489 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.587.494 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.587.548 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.590.718 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.590.720 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.590.720 I llama_init_from_model: graph nodes  = 967
0.00.590.721 I llama_init_from_model: graph splits = 2
0.00.590.724 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.590.724 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.616.869 I 
0.00.616.941 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.616.962 I perplexity: tokenizing the input ..
0.00.624.730 I perplexity: tokenization took 7.766 ms
0.00.624.751 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.760.722 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.762.073 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.762.091 I llama_perf_context_print:        load time =     606.67 ms
0.00.762.092 I llama_perf_context_print: prompt eval time =     135.00 ms /   128 tokens (    1.05 ms per token,   948.11 tokens per second)
0.00.762.093 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.762.093 I llama_perf_context_print:       total time =     145.23 ms /   129 tokens
0.00.762.541 I ggml_metal_free: deallocating

real	0m0.780s
user	0m0.080s
sys	0m0.119s
```
- q4_1:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.040 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.076 I main: llama backend init
0.00.000.079 I main: load the model and apply lora adapter, if any
0.00.008.886 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.597 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.016.602 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.607 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.608 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.608 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.608 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.609 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.611 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.611 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.612 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.612 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.612 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.616 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.616 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.618 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.618 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.618 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.236 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.209 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.780 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.781 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.781 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.781 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.782 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.782 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.024.783 I llama_model_loader: - type  f32:  194 tensors
0.00.024.783 I llama_model_loader: - type q4_1:   97 tensors
0.00.024.783 I llama_model_loader: - type q6_K:    1 tensors
0.00.024.784 I print_info: file format = GGUF V3 (latest)
0.00.024.784 I print_info: file type   = Q4_1
0.00.024.785 I print_info: file size   = 864.46 MiB (5.13 BPW) 
0.00.032.363 I load: special tokens cache size = 25
0.00.038.081 I load: token to piece cache size = 0.2984 MB
0.00.038.084 I print_info: arch             = gptneox
0.00.038.084 I print_info: vocab_only       = 0
0.00.038.084 I print_info: n_ctx_train      = 2048
0.00.038.084 I print_info: n_embd           = 2048
0.00.038.085 I print_info: n_layer          = 24
0.00.038.088 I print_info: n_head           = 16
0.00.038.088 I print_info: n_head_kv        = 16
0.00.038.088 I print_info: n_rot            = 32
0.00.038.089 I print_info: n_swa            = 0
0.00.038.089 I print_info: n_embd_head_k    = 128
0.00.038.089 I print_info: n_embd_head_v    = 128
0.00.038.090 I print_info: n_gqa            = 1
0.00.038.093 I print_info: n_embd_k_gqa     = 2048
0.00.038.093 I print_info: n_embd_v_gqa     = 2048
0.00.038.094 I print_info: f_norm_eps       = 1.0e-05
0.00.038.094 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.038.094 I print_info: f_clamp_kqv      = 0.0e+00
0.00.038.095 I print_info: f_max_alibi_bias = 0.0e+00
0.00.038.095 I print_info: f_logit_scale    = 0.0e+00
0.00.038.097 I print_info: n_ff             = 8192
0.00.038.097 I print_info: n_expert         = 0
0.00.038.097 I print_info: n_expert_used    = 0
0.00.038.097 I print_info: causal attn      = 1
0.00.038.098 I print_info: pooling type     = 0
0.00.038.104 I print_info: rope type        = 2
0.00.038.106 I print_info: rope scaling     = linear
0.00.038.106 I print_info: freq_base_train  = 10000.0
0.00.038.107 I print_info: freq_scale_train = 1
0.00.038.107 I print_info: n_ctx_orig_yarn  = 2048
0.00.038.107 I print_info: rope_finetuned   = unknown
0.00.038.107 I print_info: ssm_d_conv       = 0
0.00.038.108 I print_info: ssm_d_inner      = 0
0.00.038.109 I print_info: ssm_d_state      = 0
0.00.038.109 I print_info: ssm_dt_rank      = 0
0.00.038.109 I print_info: ssm_dt_b_c_rms   = 0
0.00.038.109 I print_info: model type       = 1.4B
0.00.038.109 I print_info: model params     = 1.41 B
0.00.038.110 I print_info: general.name     = 1.4B
0.00.038.110 I print_info: vocab type       = BPE
0.00.038.110 I print_info: n_vocab          = 50304
0.00.038.111 I print_info: n_merges         = 50009
0.00.038.111 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.038.111 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.038.111 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.038.111 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.038.111 I print_info: LF token         = 128 'Ä'
0.00.038.112 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.038.112 I print_info: max token length = 1024
0.00.650.061 I load_tensors: offloading 24 repeating layers to GPU
0.00.650.074 I load_tensors: offloading output layer to GPU
0.00.650.075 I load_tensors: offloaded 25/25 layers to GPU
0.00.650.112 I load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.650.113 I load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
0.00.651.442 I llama_init_from_model: n_seq_max     = 1
0.00.651.446 I llama_init_from_model: n_ctx         = 2048
0.00.651.447 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.651.447 I llama_init_from_model: n_batch       = 2048
0.00.651.447 I llama_init_from_model: n_ubatch      = 512
0.00.651.448 I llama_init_from_model: flash_attn    = 0
0.00.651.450 I llama_init_from_model: freq_base     = 10000.0
0.00.651.450 I llama_init_from_model: freq_scale    = 1
0.00.651.453 I ggml_metal_init: allocating
0.00.651.527 I ggml_metal_init: found device: Apple M4
0.00.651.542 I ggml_metal_init: picking default device: Apple M4
0.00.653.308 I ggml_metal_init: using embedded metal library
0.00.660.321 I ggml_metal_init: GPU name:   Apple M4
0.00.660.326 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.660.327 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.660.327 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.660.328 I ggml_metal_init: simdgroup reduction   = true
0.00.660.328 I ggml_metal_init: simdgroup matrix mul. = true
0.00.660.329 I ggml_metal_init: has residency sets    = true
0.00.660.329 I ggml_metal_init: has bfloat            = true
0.00.660.329 I ggml_metal_init: use bfloat            = true
0.00.660.330 I ggml_metal_init: hasUnifiedMemory      = true
0.00.660.331 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.678.587 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.739.162 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.739.170 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.739.194 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.743.362 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.743.364 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.743.364 I llama_init_from_model: graph nodes  = 967
0.00.743.364 I llama_init_from_model: graph splits = 2
0.00.743.372 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.743.505 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.743.506 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.799.674 I main: llama threadpool init, n_threads = 4
0.00.799.723 I 
0.00.799.748 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.799.749 I 
0.00.799.925 I sampler seed: 1234
0.00.799.930 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.799.940 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.799.941 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.799.945 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.523.922 I llama_perf_sampler_print:    sampling time =       1.29 ms /    71 runs   (    0.02 ms per token, 55167.06 tokens per second)
0.01.523.922 I llama_perf_context_print:        load time =     789.94 ms
0.01.523.923 I llama_perf_context_print: prompt eval time =      48.82 ms /     7 tokens (    6.97 ms per token,   143.39 tokens per second)
0.01.523.924 I llama_perf_context_print:        eval time =     672.35 ms /    63 runs   (   10.67 ms per token,    93.70 tokens per second)
0.01.523.924 I llama_perf_context_print:       total time =     725.10 ms /    70 tokens
0.01.524.154 I ggml_metal_free: deallocating

real	0m1.542s
user	0m0.110s
sys	0m0.217s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.094 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.725 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.015.587 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.015.593 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.599 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.599 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.600 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.600 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.600 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.603 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.603 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.603 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.604 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.604 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.604 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.605 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.607 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.607 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.608 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.174 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.142 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.786 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.787 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.788 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.788 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.788 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.789 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.023.789 I llama_model_loader: - type  f32:  194 tensors
0.00.023.789 I llama_model_loader: - type q4_1:   97 tensors
0.00.023.790 I llama_model_loader: - type q6_K:    1 tensors
0.00.023.791 I print_info: file format = GGUF V3 (latest)
0.00.023.795 I print_info: file type   = Q4_1
0.00.023.796 I print_info: file size   = 864.46 MiB (5.13 BPW) 
0.00.031.334 I load: special tokens cache size = 25
0.00.037.089 I load: token to piece cache size = 0.2984 MB
0.00.037.092 I print_info: arch             = gptneox
0.00.037.092 I print_info: vocab_only       = 0
0.00.037.093 I print_info: n_ctx_train      = 2048
0.00.037.093 I print_info: n_embd           = 2048
0.00.037.093 I print_info: n_layer          = 24
0.00.037.097 I print_info: n_head           = 16
0.00.037.098 I print_info: n_head_kv        = 16
0.00.037.098 I print_info: n_rot            = 32
0.00.037.099 I print_info: n_swa            = 0
0.00.037.099 I print_info: n_embd_head_k    = 128
0.00.037.099 I print_info: n_embd_head_v    = 128
0.00.037.101 I print_info: n_gqa            = 1
0.00.037.101 I print_info: n_embd_k_gqa     = 2048
0.00.037.102 I print_info: n_embd_v_gqa     = 2048
0.00.037.103 I print_info: f_norm_eps       = 1.0e-05
0.00.037.103 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.037.103 I print_info: f_clamp_kqv      = 0.0e+00
0.00.037.103 I print_info: f_max_alibi_bias = 0.0e+00
0.00.037.104 I print_info: f_logit_scale    = 0.0e+00
0.00.037.104 I print_info: n_ff             = 8192
0.00.037.105 I print_info: n_expert         = 0
0.00.037.105 I print_info: n_expert_used    = 0
0.00.037.105 I print_info: causal attn      = 1
0.00.037.105 I print_info: pooling type     = 0
0.00.037.105 I print_info: rope type        = 2
0.00.037.105 I print_info: rope scaling     = linear
0.00.037.106 I print_info: freq_base_train  = 10000.0
0.00.037.106 I print_info: freq_scale_train = 1
0.00.037.106 I print_info: n_ctx_orig_yarn  = 2048
0.00.037.107 I print_info: rope_finetuned   = unknown
0.00.037.107 I print_info: ssm_d_conv       = 0
0.00.037.107 I print_info: ssm_d_inner      = 0
0.00.037.107 I print_info: ssm_d_state      = 0
0.00.037.107 I print_info: ssm_dt_rank      = 0
0.00.037.107 I print_info: ssm_dt_b_c_rms   = 0
0.00.037.108 I print_info: model type       = 1.4B
0.00.037.108 I print_info: model params     = 1.41 B
0.00.037.108 I print_info: general.name     = 1.4B
0.00.037.109 I print_info: vocab type       = BPE
0.00.037.109 I print_info: n_vocab          = 50304
0.00.037.109 I print_info: n_merges         = 50009
0.00.037.109 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.037.110 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.037.110 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.037.110 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.037.110 I print_info: LF token         = 128 'Ä'
0.00.037.111 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.037.111 I print_info: max token length = 1024
0.00.646.224 I load_tensors: offloading 24 repeating layers to GPU
0.00.646.232 I load_tensors: offloading output layer to GPU
0.00.646.233 I load_tensors: offloaded 25/25 layers to GPU
0.00.646.269 I load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.646.270 I load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
0.00.647.712 I llama_init_from_model: n_seq_max     = 1
0.00.647.715 I llama_init_from_model: n_ctx         = 128
0.00.647.715 I llama_init_from_model: n_ctx_per_seq = 128
0.00.647.716 I llama_init_from_model: n_batch       = 128
0.00.647.716 I llama_init_from_model: n_ubatch      = 128
0.00.647.717 I llama_init_from_model: flash_attn    = 0
0.00.647.719 I llama_init_from_model: freq_base     = 10000.0
0.00.647.719 I llama_init_from_model: freq_scale    = 1
0.00.647.720 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.647.722 I ggml_metal_init: allocating
0.00.647.827 I ggml_metal_init: found device: Apple M4
0.00.647.845 I ggml_metal_init: picking default device: Apple M4
0.00.649.724 I ggml_metal_init: using embedded metal library
0.00.656.351 I ggml_metal_init: GPU name:   Apple M4
0.00.656.357 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.656.358 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.656.359 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.656.359 I ggml_metal_init: simdgroup reduction   = true
0.00.656.360 I ggml_metal_init: simdgroup matrix mul. = true
0.00.656.360 I ggml_metal_init: has residency sets    = true
0.00.656.360 I ggml_metal_init: has bfloat            = true
0.00.656.360 I ggml_metal_init: use bfloat            = true
0.00.656.361 I ggml_metal_init: hasUnifiedMemory      = true
0.00.656.363 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.674.517 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.678.091 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.678.095 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.678.122 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.681.270 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.681.271 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.681.272 I llama_init_from_model: graph nodes  = 967
0.00.681.272 I llama_init_from_model: graph splits = 2
0.00.681.275 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.681.276 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.706.836 I 
0.00.706.907 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.706.925 I perplexity: tokenizing the input ..
0.00.713.719 I perplexity: tokenization took 6.791 ms
0.00.713.737 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.850.285 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.851.661 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.851.676 I llama_perf_context_print:        load time =     698.10 ms
0.00.851.677 I llama_perf_context_print: prompt eval time =     136.00 ms /   128 tokens (    1.06 ms per token,   941.17 tokens per second)
0.00.851.678 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.851.679 I llama_perf_context_print:       total time =     144.84 ms /   129 tokens
0.00.852.061 I ggml_metal_free: deallocating

real	0m0.866s
user	0m0.077s
sys	0m0.133s
```
- q5_0:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.042 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.080 I main: llama backend init
0.00.000.083 I main: load the model and apply lora adapter, if any
0.00.010.406 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.017.630 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.017.634 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.635 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.636 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.636 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.636 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.637 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.638 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.638 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.639 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.639 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.640 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.642 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.643 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.645 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.645 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.646 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.302 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.328 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.019 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.021 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.021 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.021 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.022 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.022 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.026.022 I llama_model_loader: - type  f32:  194 tensors
0.00.026.023 I llama_model_loader: - type q5_0:   97 tensors
0.00.026.023 I llama_model_loader: - type q6_K:    1 tensors
0.00.026.024 I print_info: file format = GGUF V3 (latest)
0.00.026.024 I print_info: file type   = Q5_0
0.00.026.025 I print_info: file size   = 942.60 MiB (5.59 BPW) 
0.00.033.465 I load: special tokens cache size = 25
0.00.039.237 I load: token to piece cache size = 0.2984 MB
0.00.039.239 I print_info: arch             = gptneox
0.00.039.240 I print_info: vocab_only       = 0
0.00.039.240 I print_info: n_ctx_train      = 2048
0.00.039.240 I print_info: n_embd           = 2048
0.00.039.240 I print_info: n_layer          = 24
0.00.039.243 I print_info: n_head           = 16
0.00.039.243 I print_info: n_head_kv        = 16
0.00.039.244 I print_info: n_rot            = 32
0.00.039.244 I print_info: n_swa            = 0
0.00.039.244 I print_info: n_embd_head_k    = 128
0.00.039.244 I print_info: n_embd_head_v    = 128
0.00.039.245 I print_info: n_gqa            = 1
0.00.039.246 I print_info: n_embd_k_gqa     = 2048
0.00.039.246 I print_info: n_embd_v_gqa     = 2048
0.00.039.247 I print_info: f_norm_eps       = 1.0e-05
0.00.039.248 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.039.249 I print_info: f_clamp_kqv      = 0.0e+00
0.00.039.249 I print_info: f_max_alibi_bias = 0.0e+00
0.00.039.249 I print_info: f_logit_scale    = 0.0e+00
0.00.039.249 I print_info: n_ff             = 8192
0.00.039.250 I print_info: n_expert         = 0
0.00.039.250 I print_info: n_expert_used    = 0
0.00.039.250 I print_info: causal attn      = 1
0.00.039.250 I print_info: pooling type     = 0
0.00.039.251 I print_info: rope type        = 2
0.00.039.253 I print_info: rope scaling     = linear
0.00.039.253 I print_info: freq_base_train  = 10000.0
0.00.039.254 I print_info: freq_scale_train = 1
0.00.039.254 I print_info: n_ctx_orig_yarn  = 2048
0.00.039.254 I print_info: rope_finetuned   = unknown
0.00.039.254 I print_info: ssm_d_conv       = 0
0.00.039.254 I print_info: ssm_d_inner      = 0
0.00.039.254 I print_info: ssm_d_state      = 0
0.00.039.255 I print_info: ssm_dt_rank      = 0
0.00.039.255 I print_info: ssm_dt_b_c_rms   = 0
0.00.039.255 I print_info: model type       = 1.4B
0.00.039.255 I print_info: model params     = 1.41 B
0.00.039.256 I print_info: general.name     = 1.4B
0.00.039.256 I print_info: vocab type       = BPE
0.00.039.256 I print_info: n_vocab          = 50304
0.00.039.256 I print_info: n_merges         = 50009
0.00.039.257 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.039.257 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.039.257 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.039.257 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.039.257 I print_info: LF token         = 128 'Ä'
0.00.039.258 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.039.263 I print_info: max token length = 1024
0.00.690.488 I load_tensors: offloading 24 repeating layers to GPU
0.00.690.499 I load_tensors: offloading output layer to GPU
0.00.690.499 I load_tensors: offloaded 25/25 layers to GPU
0.00.690.535 I load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.690.540 I load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
0.00.692.055 I llama_init_from_model: n_seq_max     = 1
0.00.692.059 I llama_init_from_model: n_ctx         = 2048
0.00.692.059 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.692.060 I llama_init_from_model: n_batch       = 2048
0.00.692.060 I llama_init_from_model: n_ubatch      = 512
0.00.692.060 I llama_init_from_model: flash_attn    = 0
0.00.692.062 I llama_init_from_model: freq_base     = 10000.0
0.00.692.063 I llama_init_from_model: freq_scale    = 1
0.00.692.069 I ggml_metal_init: allocating
0.00.692.135 I ggml_metal_init: found device: Apple M4
0.00.692.149 I ggml_metal_init: picking default device: Apple M4
0.00.693.906 I ggml_metal_init: using embedded metal library
0.00.700.304 I ggml_metal_init: GPU name:   Apple M4
0.00.700.308 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.700.309 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.700.310 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.700.311 I ggml_metal_init: simdgroup reduction   = true
0.00.700.311 I ggml_metal_init: simdgroup matrix mul. = true
0.00.700.311 I ggml_metal_init: has residency sets    = true
0.00.700.311 I ggml_metal_init: has bfloat            = true
0.00.700.312 I ggml_metal_init: use bfloat            = true
0.00.700.313 I ggml_metal_init: hasUnifiedMemory      = true
0.00.700.315 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.717.380 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.770.506 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.770.513 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.770.548 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.774.874 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.774.876 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.774.876 I llama_init_from_model: graph nodes  = 967
0.00.774.876 I llama_init_from_model: graph splits = 2
0.00.774.883 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.775.015 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.775.016 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.836.389 I main: llama threadpool init, n_threads = 4
0.00.836.441 I 
0.00.836.467 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.836.469 I 
0.00.836.634 I sampler seed: 1234
0.00.836.639 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.836.650 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.836.650 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.836.650 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.623.991 I llama_perf_sampler_print:    sampling time =       1.43 ms /    71 runs   (    0.02 ms per token, 49719.89 tokens per second)
0.01.623.992 I llama_perf_context_print:        load time =     825.02 ms
0.01.623.994 I llama_perf_context_print: prompt eval time =      53.02 ms /     7 tokens (    7.57 ms per token,   132.04 tokens per second)
0.01.623.995 I llama_perf_context_print:        eval time =     731.80 ms /    63 runs   (   11.62 ms per token,    86.09 tokens per second)
0.01.623.995 I llama_perf_context_print:       total time =     788.56 ms /    70 tokens
0.01.624.285 I ggml_metal_free: deallocating

real	0m1.642s
user	0m0.107s
sys	0m0.211s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.102 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.917 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.020.097 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.020.101 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.020.103 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.020.103 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.020.104 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.020.104 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.020.104 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.020.105 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.020.106 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.020.106 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.020.106 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.020.107 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.020.107 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.020.108 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.020.109 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.020.110 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.020.110 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.748 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.716 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.331 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.332 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.332 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.333 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.333 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.333 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.028.334 I llama_model_loader: - type  f32:  194 tensors
0.00.028.334 I llama_model_loader: - type q5_0:   97 tensors
0.00.028.334 I llama_model_loader: - type q6_K:    1 tensors
0.00.028.335 I print_info: file format = GGUF V3 (latest)
0.00.028.335 I print_info: file type   = Q5_0
0.00.028.336 I print_info: file size   = 942.60 MiB (5.59 BPW) 
0.00.036.082 I load: special tokens cache size = 25
0.00.041.888 I load: token to piece cache size = 0.2984 MB
0.00.041.891 I print_info: arch             = gptneox
0.00.041.891 I print_info: vocab_only       = 0
0.00.041.891 I print_info: n_ctx_train      = 2048
0.00.041.891 I print_info: n_embd           = 2048
0.00.041.892 I print_info: n_layer          = 24
0.00.041.894 I print_info: n_head           = 16
0.00.041.895 I print_info: n_head_kv        = 16
0.00.041.895 I print_info: n_rot            = 32
0.00.041.898 I print_info: n_swa            = 0
0.00.041.898 I print_info: n_embd_head_k    = 128
0.00.041.898 I print_info: n_embd_head_v    = 128
0.00.041.899 I print_info: n_gqa            = 1
0.00.041.900 I print_info: n_embd_k_gqa     = 2048
0.00.041.901 I print_info: n_embd_v_gqa     = 2048
0.00.041.901 I print_info: f_norm_eps       = 1.0e-05
0.00.041.901 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.041.902 I print_info: f_clamp_kqv      = 0.0e+00
0.00.041.902 I print_info: f_max_alibi_bias = 0.0e+00
0.00.041.902 I print_info: f_logit_scale    = 0.0e+00
0.00.041.903 I print_info: n_ff             = 8192
0.00.041.903 I print_info: n_expert         = 0
0.00.041.903 I print_info: n_expert_used    = 0
0.00.041.903 I print_info: causal attn      = 1
0.00.041.903 I print_info: pooling type     = 0
0.00.041.907 I print_info: rope type        = 2
0.00.041.908 I print_info: rope scaling     = linear
0.00.041.908 I print_info: freq_base_train  = 10000.0
0.00.041.908 I print_info: freq_scale_train = 1
0.00.041.909 I print_info: n_ctx_orig_yarn  = 2048
0.00.041.909 I print_info: rope_finetuned   = unknown
0.00.041.909 I print_info: ssm_d_conv       = 0
0.00.041.909 I print_info: ssm_d_inner      = 0
0.00.041.909 I print_info: ssm_d_state      = 0
0.00.041.911 I print_info: ssm_dt_rank      = 0
0.00.041.911 I print_info: ssm_dt_b_c_rms   = 0
0.00.041.911 I print_info: model type       = 1.4B
0.00.041.912 I print_info: model params     = 1.41 B
0.00.041.912 I print_info: general.name     = 1.4B
0.00.041.912 I print_info: vocab type       = BPE
0.00.041.912 I print_info: n_vocab          = 50304
0.00.041.913 I print_info: n_merges         = 50009
0.00.041.913 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.041.913 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.041.913 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.041.913 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.041.914 I print_info: LF token         = 128 'Ä'
0.00.041.914 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.041.915 I print_info: max token length = 1024
0.00.696.864 I load_tensors: offloading 24 repeating layers to GPU
0.00.696.877 I load_tensors: offloading output layer to GPU
0.00.696.878 I load_tensors: offloaded 25/25 layers to GPU
0.00.696.912 I load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.696.933 I load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
0.00.698.534 I llama_init_from_model: n_seq_max     = 1
0.00.698.537 I llama_init_from_model: n_ctx         = 128
0.00.698.537 I llama_init_from_model: n_ctx_per_seq = 128
0.00.698.538 I llama_init_from_model: n_batch       = 128
0.00.698.539 I llama_init_from_model: n_ubatch      = 128
0.00.698.539 I llama_init_from_model: flash_attn    = 0
0.00.698.541 I llama_init_from_model: freq_base     = 10000.0
0.00.698.542 I llama_init_from_model: freq_scale    = 1
0.00.698.542 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.698.549 I ggml_metal_init: allocating
0.00.698.634 I ggml_metal_init: found device: Apple M4
0.00.698.647 I ggml_metal_init: picking default device: Apple M4
0.00.700.386 I ggml_metal_init: using embedded metal library
0.00.707.040 I ggml_metal_init: GPU name:   Apple M4
0.00.707.045 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.707.046 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.707.047 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.707.047 I ggml_metal_init: simdgroup reduction   = true
0.00.707.048 I ggml_metal_init: simdgroup matrix mul. = true
0.00.707.048 I ggml_metal_init: has residency sets    = true
0.00.707.048 I ggml_metal_init: has bfloat            = true
0.00.707.048 I ggml_metal_init: use bfloat            = true
0.00.707.049 I ggml_metal_init: hasUnifiedMemory      = true
0.00.707.060 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.724.497 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.727.894 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.727.901 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.727.949 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.731.109 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.731.111 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.731.112 I llama_init_from_model: graph nodes  = 967
0.00.731.112 I llama_init_from_model: graph splits = 2
0.00.731.116 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.731.116 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.759.988 I 
0.00.760.064 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.760.082 I perplexity: tokenizing the input ..
0.00.766.954 I perplexity: tokenization took 6.871 ms
0.00.766.966 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.901.124 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.902.463 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.902.478 I llama_perf_context_print:        load time =     750.06 ms
0.00.902.479 I llama_perf_context_print: prompt eval time =     133.93 ms /   128 tokens (    1.05 ms per token,   955.73 tokens per second)
0.00.902.480 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.902.484 I llama_perf_context_print:       total time =     142.49 ms /   129 tokens
0.00.902.915 I ggml_metal_free: deallocating

real	0m0.919s
user	0m0.077s
sys	0m0.142s
```
- q5_1:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.043 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.079 I main: llama backend init
0.00.000.081 I main: load the model and apply lora adapter, if any
0.00.008.965 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.018.966 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.018.971 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.973 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.974 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.974 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.974 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.975 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.976 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.977 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.977 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.977 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.977 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.978 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.978 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.980 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.980 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.980 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.760 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.023.822 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.027.535 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.027.536 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.027.537 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.027.537 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.027.537 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.027.541 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.027.541 I llama_model_loader: - type  f32:  194 tensors
0.00.027.543 I llama_model_loader: - type q5_1:   97 tensors
0.00.027.543 I llama_model_loader: - type q6_K:    1 tensors
0.00.027.544 I print_info: file format = GGUF V3 (latest)
0.00.027.544 I print_info: file type   = Q5_1
0.00.027.545 I print_info: file size   = 1020.74 MiB (6.05 BPW) 
0.00.035.486 I load: special tokens cache size = 25
0.00.041.439 I load: token to piece cache size = 0.2984 MB
0.00.041.443 I print_info: arch             = gptneox
0.00.041.443 I print_info: vocab_only       = 0
0.00.041.444 I print_info: n_ctx_train      = 2048
0.00.041.444 I print_info: n_embd           = 2048
0.00.041.444 I print_info: n_layer          = 24
0.00.041.447 I print_info: n_head           = 16
0.00.041.448 I print_info: n_head_kv        = 16
0.00.041.448 I print_info: n_rot            = 32
0.00.041.449 I print_info: n_swa            = 0
0.00.041.450 I print_info: n_embd_head_k    = 128
0.00.041.450 I print_info: n_embd_head_v    = 128
0.00.041.452 I print_info: n_gqa            = 1
0.00.041.453 I print_info: n_embd_k_gqa     = 2048
0.00.041.454 I print_info: n_embd_v_gqa     = 2048
0.00.041.454 I print_info: f_norm_eps       = 1.0e-05
0.00.041.454 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.041.454 I print_info: f_clamp_kqv      = 0.0e+00
0.00.041.456 I print_info: f_max_alibi_bias = 0.0e+00
0.00.041.456 I print_info: f_logit_scale    = 0.0e+00
0.00.041.456 I print_info: n_ff             = 8192
0.00.041.456 I print_info: n_expert         = 0
0.00.041.457 I print_info: n_expert_used    = 0
0.00.041.457 I print_info: causal attn      = 1
0.00.041.457 I print_info: pooling type     = 0
0.00.041.457 I print_info: rope type        = 2
0.00.041.457 I print_info: rope scaling     = linear
0.00.041.458 I print_info: freq_base_train  = 10000.0
0.00.041.458 I print_info: freq_scale_train = 1
0.00.041.458 I print_info: n_ctx_orig_yarn  = 2048
0.00.041.479 I print_info: rope_finetuned   = unknown
0.00.041.480 I print_info: ssm_d_conv       = 0
0.00.041.480 I print_info: ssm_d_inner      = 0
0.00.041.480 I print_info: ssm_d_state      = 0
0.00.041.481 I print_info: ssm_dt_rank      = 0
0.00.041.481 I print_info: ssm_dt_b_c_rms   = 0
0.00.041.481 I print_info: model type       = 1.4B
0.00.041.482 I print_info: model params     = 1.41 B
0.00.041.482 I print_info: general.name     = 1.4B
0.00.041.483 I print_info: vocab type       = BPE
0.00.041.483 I print_info: n_vocab          = 50304
0.00.041.483 I print_info: n_merges         = 50009
0.00.041.483 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.041.483 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.041.483 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.041.484 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.041.484 I print_info: LF token         = 128 'Ä'
0.00.041.484 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.041.484 I print_info: max token length = 1024
0.00.614.622 I load_tensors: offloading 24 repeating layers to GPU
0.00.614.633 I load_tensors: offloading output layer to GPU
0.00.614.634 I load_tensors: offloaded 25/25 layers to GPU
0.00.614.660 I load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.614.661 I load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
0.00.615.557 I llama_init_from_model: n_seq_max     = 1
0.00.615.564 I llama_init_from_model: n_ctx         = 2048
0.00.615.564 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.615.565 I llama_init_from_model: n_batch       = 2048
0.00.615.565 I llama_init_from_model: n_ubatch      = 512
0.00.615.565 I llama_init_from_model: flash_attn    = 0
0.00.615.567 I llama_init_from_model: freq_base     = 10000.0
0.00.615.567 I llama_init_from_model: freq_scale    = 1
0.00.615.569 I ggml_metal_init: allocating
0.00.615.619 I ggml_metal_init: found device: Apple M4
0.00.615.631 I ggml_metal_init: picking default device: Apple M4
0.00.616.933 I ggml_metal_init: using embedded metal library
0.00.621.502 I ggml_metal_init: GPU name:   Apple M4
0.00.621.508 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.621.509 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.621.509 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.621.510 I ggml_metal_init: simdgroup reduction   = true
0.00.621.510 I ggml_metal_init: simdgroup matrix mul. = true
0.00.621.510 I ggml_metal_init: has residency sets    = true
0.00.621.510 I ggml_metal_init: has bfloat            = true
0.00.621.510 I ggml_metal_init: use bfloat            = true
0.00.621.511 I ggml_metal_init: hasUnifiedMemory      = true
0.00.621.514 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.635.097 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.669.071 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.669.079 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.669.105 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.673.608 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.673.610 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.673.611 I llama_init_from_model: graph nodes  = 967
0.00.673.611 I llama_init_from_model: graph splits = 2
0.00.673.615 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.673.745 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.673.745 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.732.559 I main: llama threadpool init, n_threads = 4
0.00.732.608 I 
0.00.732.632 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.732.632 I 
0.00.732.821 I sampler seed: 1234
0.00.732.826 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.732.837 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.732.837 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.732.838 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, art or literature.

If one's life is not good, one can be sure that one is

0.01.569.061 I llama_perf_sampler_print:    sampling time =       1.41 ms /    71 runs   (    0.02 ms per token, 50354.61 tokens per second)
0.01.569.062 I llama_perf_context_print:        load time =     722.66 ms
0.01.569.063 I llama_perf_context_print: prompt eval time =      50.02 ms /     7 tokens (    7.15 ms per token,   139.93 tokens per second)
0.01.569.063 I llama_perf_context_print:        eval time =     783.60 ms /    63 runs   (   12.44 ms per token,    80.40 tokens per second)
0.01.569.064 I llama_perf_context_print:       total time =     837.44 ms /    70 tokens
0.01.569.302 I ggml_metal_free: deallocating

real	0m1.587s
user	0m0.104s
sys	0m0.190s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.096 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.864 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.015.661 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.015.666 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.667 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.669 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.673 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.674 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.674 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.675 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.675 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.676 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.676 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.677 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.677 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.678 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.680 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.680 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.680 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.262 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.232 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.918 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.920 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.920 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.921 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.921 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.921 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.023.922 I llama_model_loader: - type  f32:  194 tensors
0.00.023.923 I llama_model_loader: - type q5_1:   97 tensors
0.00.023.923 I llama_model_loader: - type q6_K:    1 tensors
0.00.023.924 I print_info: file format = GGUF V3 (latest)
0.00.023.924 I print_info: file type   = Q5_1
0.00.023.925 I print_info: file size   = 1020.74 MiB (6.05 BPW) 
0.00.031.833 I load: special tokens cache size = 25
0.00.037.679 I load: token to piece cache size = 0.2984 MB
0.00.037.682 I print_info: arch             = gptneox
0.00.037.682 I print_info: vocab_only       = 0
0.00.037.682 I print_info: n_ctx_train      = 2048
0.00.037.683 I print_info: n_embd           = 2048
0.00.037.683 I print_info: n_layer          = 24
0.00.037.687 I print_info: n_head           = 16
0.00.037.687 I print_info: n_head_kv        = 16
0.00.037.688 I print_info: n_rot            = 32
0.00.037.690 I print_info: n_swa            = 0
0.00.037.690 I print_info: n_embd_head_k    = 128
0.00.037.691 I print_info: n_embd_head_v    = 128
0.00.037.691 I print_info: n_gqa            = 1
0.00.037.692 I print_info: n_embd_k_gqa     = 2048
0.00.037.693 I print_info: n_embd_v_gqa     = 2048
0.00.037.693 I print_info: f_norm_eps       = 1.0e-05
0.00.037.694 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.037.694 I print_info: f_clamp_kqv      = 0.0e+00
0.00.037.694 I print_info: f_max_alibi_bias = 0.0e+00
0.00.037.694 I print_info: f_logit_scale    = 0.0e+00
0.00.037.695 I print_info: n_ff             = 8192
0.00.037.695 I print_info: n_expert         = 0
0.00.037.695 I print_info: n_expert_used    = 0
0.00.037.696 I print_info: causal attn      = 1
0.00.037.696 I print_info: pooling type     = 0
0.00.037.696 I print_info: rope type        = 2
0.00.037.697 I print_info: rope scaling     = linear
0.00.037.697 I print_info: freq_base_train  = 10000.0
0.00.037.697 I print_info: freq_scale_train = 1
0.00.037.698 I print_info: n_ctx_orig_yarn  = 2048
0.00.037.698 I print_info: rope_finetuned   = unknown
0.00.037.698 I print_info: ssm_d_conv       = 0
0.00.037.698 I print_info: ssm_d_inner      = 0
0.00.037.698 I print_info: ssm_d_state      = 0
0.00.037.698 I print_info: ssm_dt_rank      = 0
0.00.037.699 I print_info: ssm_dt_b_c_rms   = 0
0.00.037.699 I print_info: model type       = 1.4B
0.00.037.699 I print_info: model params     = 1.41 B
0.00.037.699 I print_info: general.name     = 1.4B
0.00.037.700 I print_info: vocab type       = BPE
0.00.037.700 I print_info: n_vocab          = 50304
0.00.037.700 I print_info: n_merges         = 50009
0.00.037.701 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.037.701 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.037.702 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.037.702 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.037.703 I print_info: LF token         = 128 'Ä'
0.00.037.703 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.037.703 I print_info: max token length = 1024
0.00.590.075 I load_tensors: offloading 24 repeating layers to GPU
0.00.590.090 I load_tensors: offloading output layer to GPU
0.00.590.091 I load_tensors: offloaded 25/25 layers to GPU
0.00.590.123 I load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.590.130 I load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
0.00.591.194 I llama_init_from_model: n_seq_max     = 1
0.00.591.199 I llama_init_from_model: n_ctx         = 128
0.00.591.200 I llama_init_from_model: n_ctx_per_seq = 128
0.00.591.200 I llama_init_from_model: n_batch       = 128
0.00.591.201 I llama_init_from_model: n_ubatch      = 128
0.00.591.201 I llama_init_from_model: flash_attn    = 0
0.00.591.203 I llama_init_from_model: freq_base     = 10000.0
0.00.591.204 I llama_init_from_model: freq_scale    = 1
0.00.591.204 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.591.207 I ggml_metal_init: allocating
0.00.591.279 I ggml_metal_init: found device: Apple M4
0.00.591.293 I ggml_metal_init: picking default device: Apple M4
0.00.593.034 I ggml_metal_init: using embedded metal library
0.00.599.668 I ggml_metal_init: GPU name:   Apple M4
0.00.599.672 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.599.673 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.599.674 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.599.674 I ggml_metal_init: simdgroup reduction   = true
0.00.599.674 I ggml_metal_init: simdgroup matrix mul. = true
0.00.599.675 I ggml_metal_init: has residency sets    = true
0.00.599.675 I ggml_metal_init: has bfloat            = true
0.00.599.675 I ggml_metal_init: use bfloat            = true
0.00.599.676 I ggml_metal_init: hasUnifiedMemory      = true
0.00.599.685 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.616.534 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.619.880 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.619.884 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.619.921 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.623.253 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.623.255 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.623.256 I llama_init_from_model: graph nodes  = 967
0.00.623.256 I llama_init_from_model: graph splits = 2
0.00.623.259 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.623.259 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.654.067 I 
0.00.654.150 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.654.169 I perplexity: tokenizing the input ..
0.00.661.846 I perplexity: tokenization took 7.673 ms
0.00.661.868 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.810.838 I perplexity: 0.15 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.812.186 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.812.205 I llama_perf_context_print:        load time =     645.19 ms
0.00.812.206 I llama_perf_context_print: prompt eval time =     148.04 ms /   128 tokens (    1.16 ms per token,   864.61 tokens per second)
0.00.812.207 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.812.207 I llama_perf_context_print:       total time =     158.14 ms /   129 tokens
0.00.812.613 I ggml_metal_free: deallocating

real	0m0.827s
user	0m0.079s
sys	0m0.135s
```
- q2_k:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.043 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.080 I main: llama backend init
0.00.000.082 I main: load the model and apply lora adapter, if any
0.00.009.919 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.205 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.016.210 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.212 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.214 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.215 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.215 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.215 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.216 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.217 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.217 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.218 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.218 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.218 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.219 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.221 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.222 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.222 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.879 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.880 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.476 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.477 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.477 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.478 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.478 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.478 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.479 I llama_model_loader: - type  f32:  194 tensors
0.00.024.479 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.479 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.480 I llama_model_loader: - type q6_K:    1 tensors
0.00.024.480 I print_info: file format = GGUF V3 (latest)
0.00.024.481 I print_info: file type   = Q2_K - Medium
0.00.024.481 I print_info: file size   = 542.04 MiB (3.21 BPW) 
0.00.032.067 I load: special tokens cache size = 25
0.00.037.898 I load: token to piece cache size = 0.2984 MB
0.00.037.901 I print_info: arch             = gptneox
0.00.037.901 I print_info: vocab_only       = 0
0.00.037.901 I print_info: n_ctx_train      = 2048
0.00.037.901 I print_info: n_embd           = 2048
0.00.037.902 I print_info: n_layer          = 24
0.00.037.904 I print_info: n_head           = 16
0.00.037.905 I print_info: n_head_kv        = 16
0.00.037.905 I print_info: n_rot            = 32
0.00.037.905 I print_info: n_swa            = 0
0.00.037.906 I print_info: n_embd_head_k    = 128
0.00.037.906 I print_info: n_embd_head_v    = 128
0.00.037.906 I print_info: n_gqa            = 1
0.00.037.907 I print_info: n_embd_k_gqa     = 2048
0.00.037.908 I print_info: n_embd_v_gqa     = 2048
0.00.037.909 I print_info: f_norm_eps       = 1.0e-05
0.00.037.909 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.037.909 I print_info: f_clamp_kqv      = 0.0e+00
0.00.037.909 I print_info: f_max_alibi_bias = 0.0e+00
0.00.037.909 I print_info: f_logit_scale    = 0.0e+00
0.00.037.910 I print_info: n_ff             = 8192
0.00.037.910 I print_info: n_expert         = 0
0.00.037.910 I print_info: n_expert_used    = 0
0.00.037.911 I print_info: causal attn      = 1
0.00.037.912 I print_info: pooling type     = 0
0.00.037.914 I print_info: rope type        = 2
0.00.037.914 I print_info: rope scaling     = linear
0.00.037.914 I print_info: freq_base_train  = 10000.0
0.00.037.915 I print_info: freq_scale_train = 1
0.00.037.915 I print_info: n_ctx_orig_yarn  = 2048
0.00.037.915 I print_info: rope_finetuned   = unknown
0.00.037.915 I print_info: ssm_d_conv       = 0
0.00.037.915 I print_info: ssm_d_inner      = 0
0.00.037.916 I print_info: ssm_d_state      = 0
0.00.037.916 I print_info: ssm_dt_rank      = 0
0.00.037.916 I print_info: ssm_dt_b_c_rms   = 0
0.00.037.916 I print_info: model type       = 1.4B
0.00.037.917 I print_info: model params     = 1.41 B
0.00.037.917 I print_info: general.name     = 1.4B
0.00.037.917 I print_info: vocab type       = BPE
0.00.037.917 I print_info: n_vocab          = 50304
0.00.037.918 I print_info: n_merges         = 50009
0.00.037.919 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.037.919 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.037.919 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.037.920 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.037.920 I print_info: LF token         = 128 'Ä'
0.00.037.920 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.037.920 I print_info: max token length = 1024
0.00.347.205 I load_tensors: offloading 24 repeating layers to GPU
0.00.347.222 I load_tensors: offloading output layer to GPU
0.00.347.223 I load_tensors: offloaded 25/25 layers to GPU
0.00.347.261 I load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.347.262 I load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
0.00.348.582 I llama_init_from_model: n_seq_max     = 1
0.00.348.587 I llama_init_from_model: n_ctx         = 2048
0.00.348.587 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.348.588 I llama_init_from_model: n_batch       = 2048
0.00.348.588 I llama_init_from_model: n_ubatch      = 512
0.00.348.588 I llama_init_from_model: flash_attn    = 0
0.00.348.590 I llama_init_from_model: freq_base     = 10000.0
0.00.348.595 I llama_init_from_model: freq_scale    = 1
0.00.348.608 I ggml_metal_init: allocating
0.00.348.689 I ggml_metal_init: found device: Apple M4
0.00.348.703 I ggml_metal_init: picking default device: Apple M4
0.00.350.563 I ggml_metal_init: using embedded metal library
0.00.356.115 I ggml_metal_init: GPU name:   Apple M4
0.00.356.134 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.356.134 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.356.135 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.356.136 I ggml_metal_init: simdgroup reduction   = true
0.00.356.136 I ggml_metal_init: simdgroup matrix mul. = true
0.00.356.137 I ggml_metal_init: has residency sets    = true
0.00.356.137 I ggml_metal_init: has bfloat            = true
0.00.356.137 I ggml_metal_init: use bfloat            = true
0.00.356.141 I ggml_metal_init: hasUnifiedMemory      = true
0.00.356.145 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.377.379 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.437.165 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.437.174 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.437.207 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.441.952 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.441.954 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.441.954 I llama_init_from_model: graph nodes  = 967
0.00.441.954 I llama_init_from_model: graph splits = 2
0.00.441.960 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.442.092 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.442.093 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.498.747 I main: llama threadpool init, n_threads = 4
0.00.498.795 I 
0.00.498.816 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.498.816 I 
0.00.498.988 I sampler seed: 1234
0.00.498.993 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.499.003 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.499.004 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.499.004 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.169.717 I llama_perf_sampler_print:    sampling time =       1.30 ms /    71 runs   (    0.02 ms per token, 54615.38 tokens per second)
0.01.169.718 I llama_perf_context_print:        load time =     487.92 ms
0.01.169.719 I llama_perf_context_print: prompt eval time =      35.46 ms /     7 tokens (    5.07 ms per token,   197.38 tokens per second)
0.01.169.719 I llama_perf_context_print:        eval time =     632.49 ms /    63 runs   (   10.04 ms per token,    99.61 tokens per second)
0.01.169.720 I llama_perf_context_print:       total time =     671.88 ms /    70 tokens
0.01.169.958 I ggml_metal_free: deallocating

real	0m1.188s
user	0m0.110s
sys	0m0.176s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.022 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.018.576 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.018.580 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.581 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.582 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.582 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.582 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.583 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.584 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.584 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.584 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.585 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.585 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.586 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.586 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.587 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.588 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.588 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.171 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.023.142 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.760 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.761 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.761 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.761 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.762 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.762 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.026.762 I llama_model_loader: - type  f32:  194 tensors
0.00.026.763 I llama_model_loader: - type q2_K:   49 tensors
0.00.026.763 I llama_model_loader: - type q3_K:   48 tensors
0.00.026.763 I llama_model_loader: - type q6_K:    1 tensors
0.00.026.763 I print_info: file format = GGUF V3 (latest)
0.00.026.764 I print_info: file type   = Q2_K - Medium
0.00.026.764 I print_info: file size   = 542.04 MiB (3.21 BPW) 
0.00.034.231 I load: special tokens cache size = 25
0.00.040.028 I load: token to piece cache size = 0.2984 MB
0.00.040.031 I print_info: arch             = gptneox
0.00.040.031 I print_info: vocab_only       = 0
0.00.040.032 I print_info: n_ctx_train      = 2048
0.00.040.032 I print_info: n_embd           = 2048
0.00.040.032 I print_info: n_layer          = 24
0.00.040.034 I print_info: n_head           = 16
0.00.040.035 I print_info: n_head_kv        = 16
0.00.040.035 I print_info: n_rot            = 32
0.00.040.035 I print_info: n_swa            = 0
0.00.040.035 I print_info: n_embd_head_k    = 128
0.00.040.038 I print_info: n_embd_head_v    = 128
0.00.040.038 I print_info: n_gqa            = 1
0.00.040.039 I print_info: n_embd_k_gqa     = 2048
0.00.040.044 I print_info: n_embd_v_gqa     = 2048
0.00.040.045 I print_info: f_norm_eps       = 1.0e-05
0.00.040.045 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.040.045 I print_info: f_clamp_kqv      = 0.0e+00
0.00.040.045 I print_info: f_max_alibi_bias = 0.0e+00
0.00.040.046 I print_info: f_logit_scale    = 0.0e+00
0.00.040.046 I print_info: n_ff             = 8192
0.00.040.047 I print_info: n_expert         = 0
0.00.040.047 I print_info: n_expert_used    = 0
0.00.040.047 I print_info: causal attn      = 1
0.00.040.048 I print_info: pooling type     = 0
0.00.040.048 I print_info: rope type        = 2
0.00.040.048 I print_info: rope scaling     = linear
0.00.040.049 I print_info: freq_base_train  = 10000.0
0.00.040.049 I print_info: freq_scale_train = 1
0.00.040.050 I print_info: n_ctx_orig_yarn  = 2048
0.00.040.051 I print_info: rope_finetuned   = unknown
0.00.040.051 I print_info: ssm_d_conv       = 0
0.00.040.051 I print_info: ssm_d_inner      = 0
0.00.040.051 I print_info: ssm_d_state      = 0
0.00.040.051 I print_info: ssm_dt_rank      = 0
0.00.040.051 I print_info: ssm_dt_b_c_rms   = 0
0.00.040.052 I print_info: model type       = 1.4B
0.00.040.052 I print_info: model params     = 1.41 B
0.00.040.052 I print_info: general.name     = 1.4B
0.00.040.053 I print_info: vocab type       = BPE
0.00.040.053 I print_info: n_vocab          = 50304
0.00.040.054 I print_info: n_merges         = 50009
0.00.040.055 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.040.055 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.040.055 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.040.055 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.040.056 I print_info: LF token         = 128 'Ä'
0.00.040.056 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.040.056 I print_info: max token length = 1024
0.00.340.731 I load_tensors: offloading 24 repeating layers to GPU
0.00.340.745 I load_tensors: offloading output layer to GPU
0.00.340.746 I load_tensors: offloaded 25/25 layers to GPU
0.00.340.775 I load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.340.776 I load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
0.00.342.152 I llama_init_from_model: n_seq_max     = 1
0.00.342.159 I llama_init_from_model: n_ctx         = 128
0.00.342.159 I llama_init_from_model: n_ctx_per_seq = 128
0.00.342.160 I llama_init_from_model: n_batch       = 128
0.00.342.160 I llama_init_from_model: n_ubatch      = 128
0.00.342.161 I llama_init_from_model: flash_attn    = 0
0.00.342.163 I llama_init_from_model: freq_base     = 10000.0
0.00.342.164 I llama_init_from_model: freq_scale    = 1
0.00.342.164 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.342.167 I ggml_metal_init: allocating
0.00.342.226 I ggml_metal_init: found device: Apple M4
0.00.342.238 I ggml_metal_init: picking default device: Apple M4
0.00.343.866 I ggml_metal_init: using embedded metal library
0.00.349.309 I ggml_metal_init: GPU name:   Apple M4
0.00.349.326 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.349.327 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.349.327 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.349.328 I ggml_metal_init: simdgroup reduction   = true
0.00.349.328 I ggml_metal_init: simdgroup matrix mul. = true
0.00.349.328 I ggml_metal_init: has residency sets    = true
0.00.349.328 I ggml_metal_init: has bfloat            = true
0.00.349.329 I ggml_metal_init: use bfloat            = true
0.00.349.330 I ggml_metal_init: hasUnifiedMemory      = true
0.00.349.335 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.371.439 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.375.122 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.375.130 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.375.171 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.378.646 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.378.649 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.378.650 I llama_init_from_model: graph nodes  = 967
0.00.378.650 I llama_init_from_model: graph splits = 2
0.00.378.654 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.378.657 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.410.992 I 
0.00.411.073 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.411.095 I perplexity: tokenizing the input ..
0.00.418.111 I perplexity: tokenization took 7.012 ms
0.00.418.130 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.552.087 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.553.540 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.553.557 I llama_perf_context_print:        load time =     400.96 ms
0.00.553.558 I llama_perf_context_print: prompt eval time =     132.92 ms /   128 tokens (    1.04 ms per token,   962.98 tokens per second)
0.00.553.558 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.553.560 I llama_perf_context_print:       total time =     142.57 ms /   129 tokens
0.00.553.935 I ggml_metal_free: deallocating

real	0m0.570s
user	0m0.082s
sys	0m0.094s
```
- q3_k:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.040 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.076 I main: llama backend init
0.00.000.078 I main: load the model and apply lora adapter, if any
0.00.008.870 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.042 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.016.047 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.050 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.051 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.051 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.051 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.051 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.053 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.053 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.054 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.054 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.054 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.055 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.055 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.057 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.057 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.057 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.848 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.864 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.569 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.570 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.570 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.571 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.571 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.571 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.024.571 I llama_model_loader: - type  f32:  194 tensors
0.00.024.572 I llama_model_loader: - type q3_K:   25 tensors
0.00.024.572 I llama_model_loader: - type q4_K:   71 tensors
0.00.024.572 I llama_model_loader: - type q5_K:    1 tensors
0.00.024.572 I llama_model_loader: - type q6_K:    1 tensors
0.00.024.573 I print_info: file format = GGUF V3 (latest)
0.00.024.573 I print_info: file type   = Q3_K - Medium
0.00.024.574 I print_info: file size   = 724.27 MiB (4.29 BPW) 
0.00.032.345 I load: special tokens cache size = 25
0.00.038.288 I load: token to piece cache size = 0.2984 MB
0.00.038.291 I print_info: arch             = gptneox
0.00.038.291 I print_info: vocab_only       = 0
0.00.038.291 I print_info: n_ctx_train      = 2048
0.00.038.292 I print_info: n_embd           = 2048
0.00.038.292 I print_info: n_layer          = 24
0.00.038.294 I print_info: n_head           = 16
0.00.038.295 I print_info: n_head_kv        = 16
0.00.038.295 I print_info: n_rot            = 32
0.00.038.295 I print_info: n_swa            = 0
0.00.038.295 I print_info: n_embd_head_k    = 128
0.00.038.297 I print_info: n_embd_head_v    = 128
0.00.038.298 I print_info: n_gqa            = 1
0.00.038.299 I print_info: n_embd_k_gqa     = 2048
0.00.038.299 I print_info: n_embd_v_gqa     = 2048
0.00.038.304 I print_info: f_norm_eps       = 1.0e-05
0.00.038.305 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.038.305 I print_info: f_clamp_kqv      = 0.0e+00
0.00.038.305 I print_info: f_max_alibi_bias = 0.0e+00
0.00.038.305 I print_info: f_logit_scale    = 0.0e+00
0.00.038.306 I print_info: n_ff             = 8192
0.00.038.306 I print_info: n_expert         = 0
0.00.038.307 I print_info: n_expert_used    = 0
0.00.038.307 I print_info: causal attn      = 1
0.00.038.307 I print_info: pooling type     = 0
0.00.038.307 I print_info: rope type        = 2
0.00.038.307 I print_info: rope scaling     = linear
0.00.038.308 I print_info: freq_base_train  = 10000.0
0.00.038.308 I print_info: freq_scale_train = 1
0.00.038.308 I print_info: n_ctx_orig_yarn  = 2048
0.00.038.308 I print_info: rope_finetuned   = unknown
0.00.038.309 I print_info: ssm_d_conv       = 0
0.00.038.309 I print_info: ssm_d_inner      = 0
0.00.038.309 I print_info: ssm_d_state      = 0
0.00.038.309 I print_info: ssm_dt_rank      = 0
0.00.038.309 I print_info: ssm_dt_b_c_rms   = 0
0.00.038.310 I print_info: model type       = 1.4B
0.00.038.317 I print_info: model params     = 1.41 B
0.00.038.319 I print_info: general.name     = 1.4B
0.00.038.320 I print_info: vocab type       = BPE
0.00.038.320 I print_info: n_vocab          = 50304
0.00.038.321 I print_info: n_merges         = 50009
0.00.038.321 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.038.321 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.038.321 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.038.322 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.038.322 I print_info: LF token         = 128 'Ä'
0.00.038.322 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.038.323 I print_info: max token length = 1024
0.00.462.130 I load_tensors: offloading 24 repeating layers to GPU
0.00.462.143 I load_tensors: offloading output layer to GPU
0.00.462.143 I load_tensors: offloaded 25/25 layers to GPU
0.00.462.177 I load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.462.179 I load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
0.00.463.529 I llama_init_from_model: n_seq_max     = 1
0.00.463.534 I llama_init_from_model: n_ctx         = 2048
0.00.463.534 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.463.535 I llama_init_from_model: n_batch       = 2048
0.00.463.535 I llama_init_from_model: n_ubatch      = 512
0.00.463.536 I llama_init_from_model: flash_attn    = 0
0.00.463.537 I llama_init_from_model: freq_base     = 10000.0
0.00.463.538 I llama_init_from_model: freq_scale    = 1
0.00.463.540 I ggml_metal_init: allocating
0.00.463.612 I ggml_metal_init: found device: Apple M4
0.00.463.627 I ggml_metal_init: picking default device: Apple M4
0.00.465.382 I ggml_metal_init: using embedded metal library
0.00.470.796 I ggml_metal_init: GPU name:   Apple M4
0.00.470.813 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.470.814 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.470.815 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.470.816 I ggml_metal_init: simdgroup reduction   = true
0.00.470.816 I ggml_metal_init: simdgroup matrix mul. = true
0.00.470.816 I ggml_metal_init: has residency sets    = true
0.00.470.817 I ggml_metal_init: has bfloat            = true
0.00.470.817 I ggml_metal_init: use bfloat            = true
0.00.470.822 I ggml_metal_init: hasUnifiedMemory      = true
0.00.470.827 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.490.992 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.549.330 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.549.340 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.549.376 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.553.814 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.553.816 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.553.816 I llama_init_from_model: graph nodes  = 967
0.00.553.816 I llama_init_from_model: graph splits = 2
0.00.553.823 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.553.957 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.553.958 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.609.448 I main: llama threadpool init, n_threads = 4
0.00.609.494 I 
0.00.609.517 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.609.518 I 
0.00.609.670 I sampler seed: 1234
0.00.609.675 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.609.715 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.609.719 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.609.719 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do,

"To be better and wiser and happier and more

"Loved than anyone

0.01.355.057 I llama_perf_sampler_print:    sampling time =       1.32 ms /    71 runs   (    0.02 ms per token, 53828.66 tokens per second)
0.01.355.058 I llama_perf_context_print:        load time =     599.69 ms
0.01.355.058 I llama_perf_context_print: prompt eval time =      50.28 ms /     7 tokens (    7.18 ms per token,   139.22 tokens per second)
0.01.355.060 I llama_perf_context_print:        eval time =     692.17 ms /    63 runs   (   10.99 ms per token,    91.02 tokens per second)
0.01.355.060 I llama_perf_context_print:       total time =     746.49 ms /    70 tokens
0.01.355.326 I ggml_metal_free: deallocating

real	0m1.372s
user	0m0.111s
sys	0m0.199s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.097 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.630 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.447 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.016.452 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.453 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.453 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.454 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.454 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.454 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.455 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.455 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.456 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.456 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.457 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.458 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.458 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.460 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.460 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.461 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.109 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.099 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.781 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.783 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.783 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.783 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.783 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.784 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.024.784 I llama_model_loader: - type  f32:  194 tensors
0.00.024.784 I llama_model_loader: - type q3_K:   25 tensors
0.00.024.785 I llama_model_loader: - type q4_K:   71 tensors
0.00.024.785 I llama_model_loader: - type q5_K:    1 tensors
0.00.024.785 I llama_model_loader: - type q6_K:    1 tensors
0.00.024.785 I print_info: file format = GGUF V3 (latest)
0.00.024.786 I print_info: file type   = Q3_K - Medium
0.00.024.787 I print_info: file size   = 724.27 MiB (4.29 BPW) 
0.00.032.294 I load: special tokens cache size = 25
0.00.038.102 I load: token to piece cache size = 0.2984 MB
0.00.038.105 I print_info: arch             = gptneox
0.00.038.105 I print_info: vocab_only       = 0
0.00.038.105 I print_info: n_ctx_train      = 2048
0.00.038.106 I print_info: n_embd           = 2048
0.00.038.106 I print_info: n_layer          = 24
0.00.038.109 I print_info: n_head           = 16
0.00.038.109 I print_info: n_head_kv        = 16
0.00.038.110 I print_info: n_rot            = 32
0.00.038.110 I print_info: n_swa            = 0
0.00.038.110 I print_info: n_embd_head_k    = 128
0.00.038.110 I print_info: n_embd_head_v    = 128
0.00.038.111 I print_info: n_gqa            = 1
0.00.038.112 I print_info: n_embd_k_gqa     = 2048
0.00.038.115 I print_info: n_embd_v_gqa     = 2048
0.00.038.116 I print_info: f_norm_eps       = 1.0e-05
0.00.038.117 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.038.117 I print_info: f_clamp_kqv      = 0.0e+00
0.00.038.117 I print_info: f_max_alibi_bias = 0.0e+00
0.00.038.117 I print_info: f_logit_scale    = 0.0e+00
0.00.038.118 I print_info: n_ff             = 8192
0.00.038.119 I print_info: n_expert         = 0
0.00.038.119 I print_info: n_expert_used    = 0
0.00.038.120 I print_info: causal attn      = 1
0.00.038.120 I print_info: pooling type     = 0
0.00.038.120 I print_info: rope type        = 2
0.00.038.120 I print_info: rope scaling     = linear
0.00.038.121 I print_info: freq_base_train  = 10000.0
0.00.038.121 I print_info: freq_scale_train = 1
0.00.038.121 I print_info: n_ctx_orig_yarn  = 2048
0.00.038.121 I print_info: rope_finetuned   = unknown
0.00.038.121 I print_info: ssm_d_conv       = 0
0.00.038.122 I print_info: ssm_d_inner      = 0
0.00.038.122 I print_info: ssm_d_state      = 0
0.00.038.122 I print_info: ssm_dt_rank      = 0
0.00.038.122 I print_info: ssm_dt_b_c_rms   = 0
0.00.038.126 I print_info: model type       = 1.4B
0.00.038.126 I print_info: model params     = 1.41 B
0.00.038.126 I print_info: general.name     = 1.4B
0.00.038.127 I print_info: vocab type       = BPE
0.00.038.127 I print_info: n_vocab          = 50304
0.00.038.127 I print_info: n_merges         = 50009
0.00.038.128 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.038.128 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.038.128 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.038.128 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.038.128 I print_info: LF token         = 128 'Ä'
0.00.038.128 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.038.129 I print_info: max token length = 1024
0.00.440.200 I load_tensors: offloading 24 repeating layers to GPU
0.00.440.216 I load_tensors: offloading output layer to GPU
0.00.440.216 I load_tensors: offloaded 25/25 layers to GPU
0.00.440.251 I load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.440.252 I load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
0.00.441.680 I llama_init_from_model: n_seq_max     = 1
0.00.441.685 I llama_init_from_model: n_ctx         = 128
0.00.441.685 I llama_init_from_model: n_ctx_per_seq = 128
0.00.441.686 I llama_init_from_model: n_batch       = 128
0.00.441.686 I llama_init_from_model: n_ubatch      = 128
0.00.441.686 I llama_init_from_model: flash_attn    = 0
0.00.441.688 I llama_init_from_model: freq_base     = 10000.0
0.00.441.689 I llama_init_from_model: freq_scale    = 1
0.00.441.690 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.441.697 I ggml_metal_init: allocating
0.00.441.793 I ggml_metal_init: found device: Apple M4
0.00.441.807 I ggml_metal_init: picking default device: Apple M4
0.00.443.571 I ggml_metal_init: using embedded metal library
0.00.449.043 I ggml_metal_init: GPU name:   Apple M4
0.00.449.047 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.449.048 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.449.049 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.449.050 I ggml_metal_init: simdgroup reduction   = true
0.00.449.051 I ggml_metal_init: simdgroup matrix mul. = true
0.00.449.051 I ggml_metal_init: has residency sets    = true
0.00.449.051 I ggml_metal_init: has bfloat            = true
0.00.449.052 I ggml_metal_init: use bfloat            = true
0.00.449.052 I ggml_metal_init: hasUnifiedMemory      = true
0.00.449.054 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.468.762 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.472.343 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.472.346 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.472.373 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.475.606 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.475.608 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.475.609 I llama_init_from_model: graph nodes  = 967
0.00.475.609 I llama_init_from_model: graph splits = 2
0.00.475.613 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.475.624 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.504.781 I 
0.00.504.867 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.504.888 I perplexity: tokenizing the input ..
0.00.512.061 I perplexity: tokenization took 7.167 ms
0.00.512.087 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.653.698 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.655.049 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.655.065 I llama_perf_context_print:        load time =     495.14 ms
0.00.655.066 I llama_perf_context_print: prompt eval time =     140.73 ms /   128 tokens (    1.10 ms per token,   909.56 tokens per second)
0.00.655.066 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.655.067 I llama_perf_context_print:       total time =     150.29 ms /   129 tokens
0.00.655.450 I ggml_metal_free: deallocating

real	0m0.669s
user	0m0.078s
sys	0m0.108s
```
- q4_k:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.040 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.076 I main: llama backend init
0.00.000.078 I main: load the model and apply lora adapter, if any
0.00.008.863 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.160 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.016.165 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.166 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.168 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.168 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.169 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.169 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.170 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.170 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.170 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.171 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.171 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.172 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.172 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.175 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.175 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.175 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.908 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.931 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.680 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.682 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.682 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.682 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.682 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.683 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.683 I llama_model_loader: - type  f32:  194 tensors
0.00.024.683 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.683 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.683 I llama_model_loader: - type q6_K:   13 tensors
0.00.024.684 I print_info: file format = GGUF V3 (latest)
0.00.024.684 I print_info: file type   = Q4_K - Medium
0.00.024.686 I print_info: file size   = 871.81 MiB (5.17 BPW) 
0.00.032.445 I load: special tokens cache size = 25
0.00.038.341 I load: token to piece cache size = 0.2984 MB
0.00.038.344 I print_info: arch             = gptneox
0.00.038.344 I print_info: vocab_only       = 0
0.00.038.344 I print_info: n_ctx_train      = 2048
0.00.038.344 I print_info: n_embd           = 2048
0.00.038.345 I print_info: n_layer          = 24
0.00.038.348 I print_info: n_head           = 16
0.00.038.348 I print_info: n_head_kv        = 16
0.00.038.348 I print_info: n_rot            = 32
0.00.038.349 I print_info: n_swa            = 0
0.00.038.349 I print_info: n_embd_head_k    = 128
0.00.038.349 I print_info: n_embd_head_v    = 128
0.00.038.350 I print_info: n_gqa            = 1
0.00.038.351 I print_info: n_embd_k_gqa     = 2048
0.00.038.351 I print_info: n_embd_v_gqa     = 2048
0.00.038.352 I print_info: f_norm_eps       = 1.0e-05
0.00.038.352 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.038.352 I print_info: f_clamp_kqv      = 0.0e+00
0.00.038.355 I print_info: f_max_alibi_bias = 0.0e+00
0.00.038.355 I print_info: f_logit_scale    = 0.0e+00
0.00.038.356 I print_info: n_ff             = 8192
0.00.038.356 I print_info: n_expert         = 0
0.00.038.356 I print_info: n_expert_used    = 0
0.00.038.358 I print_info: causal attn      = 1
0.00.038.359 I print_info: pooling type     = 0
0.00.038.360 I print_info: rope type        = 2
0.00.038.361 I print_info: rope scaling     = linear
0.00.038.361 I print_info: freq_base_train  = 10000.0
0.00.038.361 I print_info: freq_scale_train = 1
0.00.038.362 I print_info: n_ctx_orig_yarn  = 2048
0.00.038.362 I print_info: rope_finetuned   = unknown
0.00.038.362 I print_info: ssm_d_conv       = 0
0.00.038.362 I print_info: ssm_d_inner      = 0
0.00.038.363 I print_info: ssm_d_state      = 0
0.00.038.363 I print_info: ssm_dt_rank      = 0
0.00.038.363 I print_info: ssm_dt_b_c_rms   = 0
0.00.038.363 I print_info: model type       = 1.4B
0.00.038.363 I print_info: model params     = 1.41 B
0.00.038.364 I print_info: general.name     = 1.4B
0.00.038.364 I print_info: vocab type       = BPE
0.00.038.364 I print_info: n_vocab          = 50304
0.00.038.365 I print_info: n_merges         = 50009
0.00.038.365 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.038.365 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.038.365 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.038.365 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.038.366 I print_info: LF token         = 128 'Ä'
0.00.038.366 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.038.366 I print_info: max token length = 1024
0.00.538.232 I load_tensors: offloading 24 repeating layers to GPU
0.00.538.244 I load_tensors: offloading output layer to GPU
0.00.538.245 I load_tensors: offloaded 25/25 layers to GPU
0.00.538.275 I load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.538.287 I load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
0.00.539.766 I llama_init_from_model: n_seq_max     = 1
0.00.539.775 I llama_init_from_model: n_ctx         = 2048
0.00.539.776 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.539.776 I llama_init_from_model: n_batch       = 2048
0.00.539.777 I llama_init_from_model: n_ubatch      = 512
0.00.539.777 I llama_init_from_model: flash_attn    = 0
0.00.539.778 I llama_init_from_model: freq_base     = 10000.0
0.00.539.782 I llama_init_from_model: freq_scale    = 1
0.00.539.784 I ggml_metal_init: allocating
0.00.539.831 I ggml_metal_init: found device: Apple M4
0.00.539.844 I ggml_metal_init: picking default device: Apple M4
0.00.541.590 I ggml_metal_init: using embedded metal library
0.00.548.360 I ggml_metal_init: GPU name:   Apple M4
0.00.548.365 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.548.366 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.548.366 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.548.367 I ggml_metal_init: simdgroup reduction   = true
0.00.548.367 I ggml_metal_init: simdgroup matrix mul. = true
0.00.548.368 I ggml_metal_init: has residency sets    = true
0.00.548.368 I ggml_metal_init: has bfloat            = true
0.00.548.368 I ggml_metal_init: use bfloat            = true
0.00.548.369 I ggml_metal_init: hasUnifiedMemory      = true
0.00.548.371 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.566.937 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.624.188 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.624.196 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.624.219 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.628.579 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.628.581 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.628.581 I llama_init_from_model: graph nodes  = 967
0.00.628.582 I llama_init_from_model: graph splits = 2
0.00.628.587 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.628.711 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.628.712 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.686.324 I main: llama threadpool init, n_threads = 4
0.00.686.368 I 
0.00.686.391 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.686.392 I 
0.00.686.557 I sampler seed: 1234
0.00.686.561 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.686.572 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.686.573 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.686.573 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the capability to help each other out of the suffering in the world. I believe that if we just believe and feel like we are part of a bigger, more loving, more compassionate world, that we can help each

0.01.445.652 I llama_perf_sampler_print:    sampling time =       1.32 ms /    71 runs   (    0.02 ms per token, 53665.91 tokens per second)
0.01.445.652 I llama_perf_context_print:        load time =     676.50 ms
0.01.445.653 I llama_perf_context_print: prompt eval time =      56.83 ms /     7 tokens (    8.12 ms per token,   123.18 tokens per second)
0.01.445.654 I llama_perf_context_print:        eval time =     699.32 ms /    63 runs   (   11.10 ms per token,    90.09 tokens per second)
0.01.445.654 I llama_perf_context_print:       total time =     760.29 ms /    70 tokens
0.01.445.936 I ggml_metal_free: deallocating

real	0m1.464s
user	0m0.110s
sys	0m0.217s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.096 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.045 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.005 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.016.010 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.015 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.015 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.016 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.016 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.016 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.017 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.017 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.018 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.018 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.019 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.019 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.019 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.021 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.021 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.022 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.649 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.622 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.282 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.283 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.283 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.284 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.284 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.284 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.285 I llama_model_loader: - type  f32:  194 tensors
0.00.024.285 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.285 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.285 I llama_model_loader: - type q6_K:   13 tensors
0.00.024.286 I print_info: file format = GGUF V3 (latest)
0.00.024.286 I print_info: file type   = Q4_K - Medium
0.00.024.287 I print_info: file size   = 871.81 MiB (5.17 BPW) 
0.00.031.705 I load: special tokens cache size = 25
0.00.037.451 I load: token to piece cache size = 0.2984 MB
0.00.037.453 I print_info: arch             = gptneox
0.00.037.454 I print_info: vocab_only       = 0
0.00.037.454 I print_info: n_ctx_train      = 2048
0.00.037.454 I print_info: n_embd           = 2048
0.00.037.454 I print_info: n_layer          = 24
0.00.037.457 I print_info: n_head           = 16
0.00.037.458 I print_info: n_head_kv        = 16
0.00.037.458 I print_info: n_rot            = 32
0.00.037.458 I print_info: n_swa            = 0
0.00.037.458 I print_info: n_embd_head_k    = 128
0.00.037.458 I print_info: n_embd_head_v    = 128
0.00.037.459 I print_info: n_gqa            = 1
0.00.037.460 I print_info: n_embd_k_gqa     = 2048
0.00.037.460 I print_info: n_embd_v_gqa     = 2048
0.00.037.461 I print_info: f_norm_eps       = 1.0e-05
0.00.037.461 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.037.461 I print_info: f_clamp_kqv      = 0.0e+00
0.00.037.462 I print_info: f_max_alibi_bias = 0.0e+00
0.00.037.462 I print_info: f_logit_scale    = 0.0e+00
0.00.037.462 I print_info: n_ff             = 8192
0.00.037.463 I print_info: n_expert         = 0
0.00.037.463 I print_info: n_expert_used    = 0
0.00.037.463 I print_info: causal attn      = 1
0.00.037.463 I print_info: pooling type     = 0
0.00.037.463 I print_info: rope type        = 2
0.00.037.463 I print_info: rope scaling     = linear
0.00.037.464 I print_info: freq_base_train  = 10000.0
0.00.037.464 I print_info: freq_scale_train = 1
0.00.037.464 I print_info: n_ctx_orig_yarn  = 2048
0.00.037.464 I print_info: rope_finetuned   = unknown
0.00.037.464 I print_info: ssm_d_conv       = 0
0.00.037.465 I print_info: ssm_d_inner      = 0
0.00.037.466 I print_info: ssm_d_state      = 0
0.00.037.466 I print_info: ssm_dt_rank      = 0
0.00.037.466 I print_info: ssm_dt_b_c_rms   = 0
0.00.037.468 I print_info: model type       = 1.4B
0.00.037.468 I print_info: model params     = 1.41 B
0.00.037.469 I print_info: general.name     = 1.4B
0.00.037.469 I print_info: vocab type       = BPE
0.00.037.469 I print_info: n_vocab          = 50304
0.00.037.470 I print_info: n_merges         = 50009
0.00.037.470 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.037.470 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.037.474 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.037.474 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.037.474 I print_info: LF token         = 128 'Ä'
0.00.037.475 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.037.477 I print_info: max token length = 1024
0.00.521.477 I load_tensors: offloading 24 repeating layers to GPU
0.00.521.490 I load_tensors: offloading output layer to GPU
0.00.521.490 I load_tensors: offloaded 25/25 layers to GPU
0.00.521.529 I load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.521.530 I load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
0.00.523.138 I llama_init_from_model: n_seq_max     = 1
0.00.523.143 I llama_init_from_model: n_ctx         = 128
0.00.523.147 I llama_init_from_model: n_ctx_per_seq = 128
0.00.523.147 I llama_init_from_model: n_batch       = 128
0.00.523.148 I llama_init_from_model: n_ubatch      = 128
0.00.523.148 I llama_init_from_model: flash_attn    = 0
0.00.523.151 I llama_init_from_model: freq_base     = 10000.0
0.00.523.151 I llama_init_from_model: freq_scale    = 1
0.00.523.155 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.523.160 I ggml_metal_init: allocating
0.00.523.293 I ggml_metal_init: found device: Apple M4
0.00.523.307 I ggml_metal_init: picking default device: Apple M4
0.00.525.250 I ggml_metal_init: using embedded metal library
0.00.531.746 I ggml_metal_init: GPU name:   Apple M4
0.00.531.749 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.531.750 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.531.751 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.531.752 I ggml_metal_init: simdgroup reduction   = true
0.00.531.752 I ggml_metal_init: simdgroup matrix mul. = true
0.00.531.752 I ggml_metal_init: has residency sets    = true
0.00.531.753 I ggml_metal_init: has bfloat            = true
0.00.531.753 I ggml_metal_init: use bfloat            = true
0.00.531.754 I ggml_metal_init: hasUnifiedMemory      = true
0.00.531.756 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.549.022 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.552.499 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.552.503 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.552.534 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.555.716 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.555.718 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.555.719 I llama_init_from_model: graph nodes  = 967
0.00.555.719 I llama_init_from_model: graph splits = 2
0.00.555.722 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.555.722 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.585.282 I 
0.00.585.369 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.585.391 I perplexity: tokenizing the input ..
0.00.592.598 I perplexity: tokenization took 7.203 ms
0.00.592.620 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.735.017 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.736.359 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.736.375 I llama_perf_context_print:        load time =     576.23 ms
0.00.736.376 I llama_perf_context_print: prompt eval time =     141.44 ms /   128 tokens (    1.10 ms per token,   904.99 tokens per second)
0.00.736.376 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.736.377 I llama_perf_context_print:       total time =     151.10 ms /   129 tokens
0.00.736.778 I ggml_metal_free: deallocating

real	0m0.751s
user	0m0.078s
sys	0m0.130s
```
- q5_k:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.078 I main: llama backend init
0.00.000.080 I main: load the model and apply lora adapter, if any
0.00.010.638 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.017.846 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.017.851 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.853 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.853 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.855 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.855 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.855 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.856 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.857 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.859 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.860 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.860 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.860 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.861 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.865 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.865 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.865 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.021.539 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.022.535 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.221 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.026.223 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.026.223 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.026.223 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.026.224 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.026.224 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.026.225 I llama_model_loader: - type  f32:  194 tensors
0.00.026.225 I llama_model_loader: - type q5_K:   61 tensors
0.00.026.225 I llama_model_loader: - type q6_K:   37 tensors
0.00.026.226 I print_info: file format = GGUF V3 (latest)
0.00.026.226 I print_info: file type   = Q5_K - Medium
0.00.026.227 I print_info: file size   = 1006.35 MiB (5.97 BPW) 
0.00.034.059 I load: special tokens cache size = 25
0.00.039.861 I load: token to piece cache size = 0.2984 MB
0.00.039.863 I print_info: arch             = gptneox
0.00.039.864 I print_info: vocab_only       = 0
0.00.039.864 I print_info: n_ctx_train      = 2048
0.00.039.864 I print_info: n_embd           = 2048
0.00.039.864 I print_info: n_layer          = 24
0.00.039.867 I print_info: n_head           = 16
0.00.039.868 I print_info: n_head_kv        = 16
0.00.039.868 I print_info: n_rot            = 32
0.00.039.868 I print_info: n_swa            = 0
0.00.039.868 I print_info: n_embd_head_k    = 128
0.00.039.869 I print_info: n_embd_head_v    = 128
0.00.039.869 I print_info: n_gqa            = 1
0.00.039.870 I print_info: n_embd_k_gqa     = 2048
0.00.039.871 I print_info: n_embd_v_gqa     = 2048
0.00.039.871 I print_info: f_norm_eps       = 1.0e-05
0.00.039.872 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.039.872 I print_info: f_clamp_kqv      = 0.0e+00
0.00.039.872 I print_info: f_max_alibi_bias = 0.0e+00
0.00.039.872 I print_info: f_logit_scale    = 0.0e+00
0.00.039.873 I print_info: n_ff             = 8192
0.00.039.873 I print_info: n_expert         = 0
0.00.039.873 I print_info: n_expert_used    = 0
0.00.039.873 I print_info: causal attn      = 1
0.00.039.874 I print_info: pooling type     = 0
0.00.039.875 I print_info: rope type        = 2
0.00.039.877 I print_info: rope scaling     = linear
0.00.039.877 I print_info: freq_base_train  = 10000.0
0.00.039.878 I print_info: freq_scale_train = 1
0.00.039.878 I print_info: n_ctx_orig_yarn  = 2048
0.00.039.878 I print_info: rope_finetuned   = unknown
0.00.039.878 I print_info: ssm_d_conv       = 0
0.00.039.878 I print_info: ssm_d_inner      = 0
0.00.039.879 I print_info: ssm_d_state      = 0
0.00.039.879 I print_info: ssm_dt_rank      = 0
0.00.039.879 I print_info: ssm_dt_b_c_rms   = 0
0.00.039.879 I print_info: model type       = 1.4B
0.00.039.879 I print_info: model params     = 1.41 B
0.00.039.880 I print_info: general.name     = 1.4B
0.00.039.880 I print_info: vocab type       = BPE
0.00.039.880 I print_info: n_vocab          = 50304
0.00.039.881 I print_info: n_merges         = 50009
0.00.039.881 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.039.881 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.039.885 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.039.885 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.039.886 I print_info: LF token         = 128 'Ä'
0.00.039.886 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.039.886 I print_info: max token length = 1024
0.00.594.322 I load_tensors: offloading 24 repeating layers to GPU
0.00.594.335 I load_tensors: offloading output layer to GPU
0.00.594.336 I load_tensors: offloaded 25/25 layers to GPU
0.00.594.363 I load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.594.364 I load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
0.00.595.817 I llama_init_from_model: n_seq_max     = 1
0.00.595.826 I llama_init_from_model: n_ctx         = 2048
0.00.595.827 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.595.827 I llama_init_from_model: n_batch       = 2048
0.00.595.828 I llama_init_from_model: n_ubatch      = 512
0.00.595.828 I llama_init_from_model: flash_attn    = 0
0.00.595.829 I llama_init_from_model: freq_base     = 10000.0
0.00.595.829 I llama_init_from_model: freq_scale    = 1
0.00.595.838 I ggml_metal_init: allocating
0.00.595.888 I ggml_metal_init: found device: Apple M4
0.00.595.919 I ggml_metal_init: picking default device: Apple M4
0.00.597.722 I ggml_metal_init: using embedded metal library
0.00.604.504 I ggml_metal_init: GPU name:   Apple M4
0.00.604.509 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.604.510 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.604.511 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.604.511 I ggml_metal_init: simdgroup reduction   = true
0.00.604.512 I ggml_metal_init: simdgroup matrix mul. = true
0.00.604.512 I ggml_metal_init: has residency sets    = true
0.00.604.512 I ggml_metal_init: has bfloat            = true
0.00.604.512 I ggml_metal_init: use bfloat            = true
0.00.604.514 I ggml_metal_init: hasUnifiedMemory      = true
0.00.604.522 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.622.861 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.684.903 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.684.912 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.684.941 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.689.662 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.689.664 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.689.664 I llama_init_from_model: graph nodes  = 967
0.00.689.664 I llama_init_from_model: graph splits = 2
0.00.689.670 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.689.798 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.689.798 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.756.215 I main: llama threadpool init, n_threads = 4
0.00.756.259 I 
0.00.756.285 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.756.285 I 
0.00.756.456 I sampler seed: 1234
0.00.756.460 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.756.478 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.756.479 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.756.479 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.594.967 I llama_perf_sampler_print:    sampling time =       1.34 ms /    71 runs   (    0.02 ms per token, 53103.96 tokens per second)
0.01.594.968 I llama_perf_context_print:        load time =     744.70 ms
0.01.594.969 I llama_perf_context_print: prompt eval time =      51.23 ms /     7 tokens (    7.32 ms per token,   136.65 tokens per second)
0.01.594.970 I llama_perf_context_print:        eval time =     784.30 ms /    63 runs   (   12.45 ms per token,    80.33 tokens per second)
0.01.594.970 I llama_perf_context_print:       total time =     839.63 ms /    70 tokens
0.01.595.255 I ggml_metal_free: deallocating

real	0m1.614s
user	0m0.109s
sys	0m0.218s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.098 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.172 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.943 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.016.948 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.950 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.950 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.950 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.951 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.951 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.952 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.953 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.953 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.953 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.954 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.954 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.955 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.958 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.958 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.958 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.584 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.562 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.150 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.151 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.151 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.151 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.152 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.152 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.025.152 I llama_model_loader: - type  f32:  194 tensors
0.00.025.153 I llama_model_loader: - type q5_K:   61 tensors
0.00.025.153 I llama_model_loader: - type q6_K:   37 tensors
0.00.025.153 I print_info: file format = GGUF V3 (latest)
0.00.025.153 I print_info: file type   = Q5_K - Medium
0.00.025.154 I print_info: file size   = 1006.35 MiB (5.97 BPW) 
0.00.032.681 I load: special tokens cache size = 25
0.00.038.501 I load: token to piece cache size = 0.2984 MB
0.00.038.504 I print_info: arch             = gptneox
0.00.038.504 I print_info: vocab_only       = 0
0.00.038.505 I print_info: n_ctx_train      = 2048
0.00.038.505 I print_info: n_embd           = 2048
0.00.038.505 I print_info: n_layer          = 24
0.00.038.508 I print_info: n_head           = 16
0.00.038.508 I print_info: n_head_kv        = 16
0.00.038.509 I print_info: n_rot            = 32
0.00.038.509 I print_info: n_swa            = 0
0.00.038.509 I print_info: n_embd_head_k    = 128
0.00.038.509 I print_info: n_embd_head_v    = 128
0.00.038.510 I print_info: n_gqa            = 1
0.00.038.511 I print_info: n_embd_k_gqa     = 2048
0.00.038.511 I print_info: n_embd_v_gqa     = 2048
0.00.038.512 I print_info: f_norm_eps       = 1.0e-05
0.00.038.512 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.038.513 I print_info: f_clamp_kqv      = 0.0e+00
0.00.038.513 I print_info: f_max_alibi_bias = 0.0e+00
0.00.038.513 I print_info: f_logit_scale    = 0.0e+00
0.00.038.514 I print_info: n_ff             = 8192
0.00.038.514 I print_info: n_expert         = 0
0.00.038.514 I print_info: n_expert_used    = 0
0.00.038.514 I print_info: causal attn      = 1
0.00.038.514 I print_info: pooling type     = 0
0.00.038.514 I print_info: rope type        = 2
0.00.038.515 I print_info: rope scaling     = linear
0.00.038.515 I print_info: freq_base_train  = 10000.0
0.00.038.515 I print_info: freq_scale_train = 1
0.00.038.515 I print_info: n_ctx_orig_yarn  = 2048
0.00.038.516 I print_info: rope_finetuned   = unknown
0.00.038.516 I print_info: ssm_d_conv       = 0
0.00.038.516 I print_info: ssm_d_inner      = 0
0.00.038.516 I print_info: ssm_d_state      = 0
0.00.038.516 I print_info: ssm_dt_rank      = 0
0.00.038.517 I print_info: ssm_dt_b_c_rms   = 0
0.00.038.517 I print_info: model type       = 1.4B
0.00.038.517 I print_info: model params     = 1.41 B
0.00.038.517 I print_info: general.name     = 1.4B
0.00.038.518 I print_info: vocab type       = BPE
0.00.038.518 I print_info: n_vocab          = 50304
0.00.038.518 I print_info: n_merges         = 50009
0.00.038.519 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.038.519 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.038.519 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.038.519 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.038.519 I print_info: LF token         = 128 'Ä'
0.00.038.520 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.038.520 I print_info: max token length = 1024
0.00.611.052 I load_tensors: offloading 24 repeating layers to GPU
0.00.611.066 I load_tensors: offloading output layer to GPU
0.00.611.067 I load_tensors: offloaded 25/25 layers to GPU
0.00.611.098 I load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.611.100 I load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
0.00.612.481 I llama_init_from_model: n_seq_max     = 1
0.00.612.485 I llama_init_from_model: n_ctx         = 128
0.00.612.485 I llama_init_from_model: n_ctx_per_seq = 128
0.00.612.486 I llama_init_from_model: n_batch       = 128
0.00.612.486 I llama_init_from_model: n_ubatch      = 128
0.00.612.487 I llama_init_from_model: flash_attn    = 0
0.00.612.489 I llama_init_from_model: freq_base     = 10000.0
0.00.612.489 I llama_init_from_model: freq_scale    = 1
0.00.612.490 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.612.493 I ggml_metal_init: allocating
0.00.612.585 I ggml_metal_init: found device: Apple M4
0.00.612.600 I ggml_metal_init: picking default device: Apple M4
0.00.614.388 I ggml_metal_init: using embedded metal library
0.00.621.113 I ggml_metal_init: GPU name:   Apple M4
0.00.621.117 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.621.118 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.621.119 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.621.120 I ggml_metal_init: simdgroup reduction   = true
0.00.621.120 I ggml_metal_init: simdgroup matrix mul. = true
0.00.621.120 I ggml_metal_init: has residency sets    = true
0.00.621.120 I ggml_metal_init: has bfloat            = true
0.00.621.121 I ggml_metal_init: use bfloat            = true
0.00.621.121 I ggml_metal_init: hasUnifiedMemory      = true
0.00.621.123 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.638.616 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.642.089 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.642.096 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.642.133 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.645.411 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.645.413 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.645.413 I llama_init_from_model: graph nodes  = 967
0.00.645.414 I llama_init_from_model: graph splits = 2
0.00.645.417 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.645.417 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.682.993 I 
0.00.683.084 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.683.105 I perplexity: tokenizing the input ..
0.00.689.869 I perplexity: tokenization took 6.763 ms
0.00.689.883 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.841.745 I perplexity: 0.15 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.843.078 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.843.093 I llama_perf_context_print:        load time =     672.81 ms
0.00.843.094 I llama_perf_context_print: prompt eval time =     151.63 ms /   128 tokens (    1.18 ms per token,   844.16 tokens per second)
0.00.843.095 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.843.095 I llama_perf_context_print:       total time =     160.11 ms /   129 tokens
0.00.843.442 I ggml_metal_free: deallocating

real	0m0.859s
user	0m0.076s
sys	0m0.148s
```
- q6_k:
```
+ ./bin/llama-cli -no-cnv --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.043 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.082 I main: llama backend init
0.00.000.085 I main: load the model and apply lora adapter, if any
0.00.008.821 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.016.551 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.555 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.557 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.558 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.559 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.560 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.560 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.561 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.563 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.563 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.564 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.564 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.565 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.565 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.568 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.568 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.568 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.266 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.310 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.975 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.976 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.976 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.977 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.977 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.977 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.978 I llama_model_loader: - type  f32:  194 tensors
0.00.024.978 I llama_model_loader: - type q6_K:   98 tensors
0.00.024.979 I print_info: file format = GGUF V3 (latest)
0.00.024.979 I print_info: file type   = Q6_K
0.00.024.980 I print_info: file size   = 1.08 GiB (6.57 BPW) 
0.00.032.841 I load: special tokens cache size = 25
0.00.038.679 I load: token to piece cache size = 0.2984 MB
0.00.038.682 I print_info: arch             = gptneox
0.00.038.682 I print_info: vocab_only       = 0
0.00.038.683 I print_info: n_ctx_train      = 2048
0.00.038.683 I print_info: n_embd           = 2048
0.00.038.683 I print_info: n_layer          = 24
0.00.038.686 I print_info: n_head           = 16
0.00.038.686 I print_info: n_head_kv        = 16
0.00.038.687 I print_info: n_rot            = 32
0.00.038.687 I print_info: n_swa            = 0
0.00.038.687 I print_info: n_embd_head_k    = 128
0.00.038.687 I print_info: n_embd_head_v    = 128
0.00.038.688 I print_info: n_gqa            = 1
0.00.038.689 I print_info: n_embd_k_gqa     = 2048
0.00.038.689 I print_info: n_embd_v_gqa     = 2048
0.00.038.690 I print_info: f_norm_eps       = 1.0e-05
0.00.038.690 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.038.690 I print_info: f_clamp_kqv      = 0.0e+00
0.00.038.691 I print_info: f_max_alibi_bias = 0.0e+00
0.00.038.691 I print_info: f_logit_scale    = 0.0e+00
0.00.038.692 I print_info: n_ff             = 8192
0.00.038.692 I print_info: n_expert         = 0
0.00.038.692 I print_info: n_expert_used    = 0
0.00.038.692 I print_info: causal attn      = 1
0.00.038.692 I print_info: pooling type     = 0
0.00.038.694 I print_info: rope type        = 2
0.00.038.696 I print_info: rope scaling     = linear
0.00.038.698 I print_info: freq_base_train  = 10000.0
0.00.038.698 I print_info: freq_scale_train = 1
0.00.038.698 I print_info: n_ctx_orig_yarn  = 2048
0.00.038.698 I print_info: rope_finetuned   = unknown
0.00.038.699 I print_info: ssm_d_conv       = 0
0.00.038.699 I print_info: ssm_d_inner      = 0
0.00.038.700 I print_info: ssm_d_state      = 0
0.00.038.700 I print_info: ssm_dt_rank      = 0
0.00.038.700 I print_info: ssm_dt_b_c_rms   = 0
0.00.038.700 I print_info: model type       = 1.4B
0.00.038.701 I print_info: model params     = 1.41 B
0.00.038.701 I print_info: general.name     = 1.4B
0.00.038.701 I print_info: vocab type       = BPE
0.00.038.702 I print_info: n_vocab          = 50304
0.00.038.702 I print_info: n_merges         = 50009
0.00.038.702 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.038.702 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.038.702 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.038.703 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.038.703 I print_info: LF token         = 128 'Ä'
0.00.038.703 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.038.704 I print_info: max token length = 1024
0.00.659.375 I load_tensors: offloading 24 repeating layers to GPU
0.00.659.386 I load_tensors: offloading output layer to GPU
0.00.659.386 I load_tensors: offloaded 25/25 layers to GPU
0.00.659.415 I load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.659.416 I load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
0.00.660.840 I llama_init_from_model: n_seq_max     = 1
0.00.660.846 I llama_init_from_model: n_ctx         = 2048
0.00.660.846 I llama_init_from_model: n_ctx_per_seq = 2048
0.00.660.847 I llama_init_from_model: n_batch       = 2048
0.00.660.847 I llama_init_from_model: n_ubatch      = 512
0.00.660.848 I llama_init_from_model: flash_attn    = 0
0.00.660.849 I llama_init_from_model: freq_base     = 10000.0
0.00.660.850 I llama_init_from_model: freq_scale    = 1
0.00.660.854 I ggml_metal_init: allocating
0.00.660.913 I ggml_metal_init: found device: Apple M4
0.00.660.927 I ggml_metal_init: picking default device: Apple M4
0.00.662.638 I ggml_metal_init: using embedded metal library
0.00.668.399 I ggml_metal_init: GPU name:   Apple M4
0.00.668.405 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.668.406 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.668.407 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.668.407 I ggml_metal_init: simdgroup reduction   = true
0.00.668.408 I ggml_metal_init: simdgroup matrix mul. = true
0.00.668.408 I ggml_metal_init: has residency sets    = true
0.00.668.408 I ggml_metal_init: has bfloat            = true
0.00.668.408 I ggml_metal_init: use bfloat            = true
0.00.668.410 I ggml_metal_init: hasUnifiedMemory      = true
0.00.668.411 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.687.423 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.750.973 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.750.981 I llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.751.005 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.755.604 I llama_init_from_model:      Metal compute buffer size =   102.25 MiB
0.00.755.606 I llama_init_from_model:        CPU compute buffer size =     8.01 MiB
0.00.755.606 I llama_init_from_model: graph nodes  = 967
0.00.755.607 I llama_init_from_model: graph splits = 2
0.00.755.613 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.755.737 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.755.738 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.825.681 I main: llama threadpool init, n_threads = 4
0.00.825.725 I 
0.00.825.753 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.825.754 I 
0.00.825.925 I sampler seed: 1234
0.00.825.930 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.825.942 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.825.942 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.825.942 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.01.693.080 I llama_perf_sampler_print:    sampling time =       1.34 ms /    71 runs   (    0.02 ms per token, 53103.96 tokens per second)
0.01.693.081 I llama_perf_context_print:        load time =     815.99 ms
0.01.693.083 I llama_perf_context_print: prompt eval time =      54.02 ms /     7 tokens (    7.72 ms per token,   129.58 tokens per second)
0.01.693.084 I llama_perf_context_print:        eval time =     810.16 ms /    63 runs   (   12.86 ms per token,    77.76 tokens per second)
0.01.693.084 I llama_perf_context_print:       total time =     868.27 ms /    70 tokens
0.01.693.384 I ggml_metal_free: deallocating

real	0m1.713s
user	0m0.109s
sys	0m0.233s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.095 I build: 4591 (7919256c) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.941 I llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
0.00.015.522 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.015.526 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.532 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.532 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.533 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.533 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.534 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.535 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.536 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.536 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.536 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.537 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.540 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.541 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.542 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.542 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.543 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.314 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.305 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.053 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.054 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.054 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.055 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.055 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.055 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.055 I llama_model_loader: - type  f32:  194 tensors
0.00.024.056 I llama_model_loader: - type q6_K:   98 tensors
0.00.024.056 I print_info: file format = GGUF V3 (latest)
0.00.024.057 I print_info: file type   = Q6_K
0.00.024.057 I print_info: file size   = 1.08 GiB (6.57 BPW) 
0.00.031.864 I load: special tokens cache size = 25
0.00.037.705 I load: token to piece cache size = 0.2984 MB
0.00.037.707 I print_info: arch             = gptneox
0.00.037.708 I print_info: vocab_only       = 0
0.00.037.708 I print_info: n_ctx_train      = 2048
0.00.037.708 I print_info: n_embd           = 2048
0.00.037.708 I print_info: n_layer          = 24
0.00.037.711 I print_info: n_head           = 16
0.00.037.712 I print_info: n_head_kv        = 16
0.00.037.714 I print_info: n_rot            = 32
0.00.037.714 I print_info: n_swa            = 0
0.00.037.714 I print_info: n_embd_head_k    = 128
0.00.037.714 I print_info: n_embd_head_v    = 128
0.00.037.715 I print_info: n_gqa            = 1
0.00.037.716 I print_info: n_embd_k_gqa     = 2048
0.00.037.717 I print_info: n_embd_v_gqa     = 2048
0.00.037.717 I print_info: f_norm_eps       = 1.0e-05
0.00.037.718 I print_info: f_norm_rms_eps   = 0.0e+00
0.00.037.718 I print_info: f_clamp_kqv      = 0.0e+00
0.00.037.718 I print_info: f_max_alibi_bias = 0.0e+00
0.00.037.718 I print_info: f_logit_scale    = 0.0e+00
0.00.037.719 I print_info: n_ff             = 8192
0.00.037.719 I print_info: n_expert         = 0
0.00.037.719 I print_info: n_expert_used    = 0
0.00.037.719 I print_info: causal attn      = 1
0.00.037.720 I print_info: pooling type     = 0
0.00.037.720 I print_info: rope type        = 2
0.00.037.720 I print_info: rope scaling     = linear
0.00.037.720 I print_info: freq_base_train  = 10000.0
0.00.037.721 I print_info: freq_scale_train = 1
0.00.037.721 I print_info: n_ctx_orig_yarn  = 2048
0.00.037.721 I print_info: rope_finetuned   = unknown
0.00.037.725 I print_info: ssm_d_conv       = 0
0.00.037.726 I print_info: ssm_d_inner      = 0
0.00.037.726 I print_info: ssm_d_state      = 0
0.00.037.726 I print_info: ssm_dt_rank      = 0
0.00.037.726 I print_info: ssm_dt_b_c_rms   = 0
0.00.037.726 I print_info: model type       = 1.4B
0.00.037.727 I print_info: model params     = 1.41 B
0.00.037.727 I print_info: general.name     = 1.4B
0.00.037.728 I print_info: vocab type       = BPE
0.00.037.728 I print_info: n_vocab          = 50304
0.00.037.728 I print_info: n_merges         = 50009
0.00.037.728 I print_info: BOS token        = 0 '<|endoftext|>'
0.00.037.728 I print_info: EOS token        = 0 '<|endoftext|>'
0.00.037.729 I print_info: EOT token        = 0 '<|endoftext|>'
0.00.037.729 I print_info: UNK token        = 0 '<|endoftext|>'
0.00.037.729 I print_info: LF token         = 128 'Ä'
0.00.037.729 I print_info: EOG token        = 0 '<|endoftext|>'
0.00.037.729 I print_info: max token length = 1024
0.00.583.270 I load_tensors: offloading 24 repeating layers to GPU
0.00.583.273 I load_tensors: offloading output layer to GPU
0.00.583.274 I load_tensors: offloaded 25/25 layers to GPU
0.00.583.298 I load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.583.302 I load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
0.00.584.746 I llama_init_from_model: n_seq_max     = 1
0.00.584.748 I llama_init_from_model: n_ctx         = 128
0.00.584.749 I llama_init_from_model: n_ctx_per_seq = 128
0.00.584.749 I llama_init_from_model: n_batch       = 128
0.00.584.753 I llama_init_from_model: n_ubatch      = 128
0.00.584.754 I llama_init_from_model: flash_attn    = 0
0.00.584.755 I llama_init_from_model: freq_base     = 10000.0
0.00.584.758 I llama_init_from_model: freq_scale    = 1
0.00.584.759 W llama_init_from_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.584.763 I ggml_metal_init: allocating
0.00.584.824 I ggml_metal_init: found device: Apple M4
0.00.584.846 I ggml_metal_init: picking default device: Apple M4
0.00.586.473 I ggml_metal_init: using embedded metal library
0.00.592.337 I ggml_metal_init: GPU name:   Apple M4
0.00.592.340 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.592.341 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.592.342 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.592.343 I ggml_metal_init: simdgroup reduction   = true
0.00.592.343 I ggml_metal_init: simdgroup matrix mul. = true
0.00.592.343 I ggml_metal_init: has residency sets    = true
0.00.592.343 I ggml_metal_init: has bfloat            = true
0.00.592.344 I ggml_metal_init: use bfloat            = true
0.00.592.344 I ggml_metal_init: hasUnifiedMemory      = true
0.00.592.353 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.609.465 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
0.00.612.870 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.612.874 I llama_init_from_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.612.898 I llama_init_from_model:        CPU  output buffer size =     0.19 MiB
0.00.616.025 I llama_init_from_model:      Metal compute buffer size =    25.56 MiB
0.00.616.026 I llama_init_from_model:        CPU compute buffer size =     1.06 MiB
0.00.616.027 I llama_init_from_model: graph nodes  = 967
0.00.616.027 I llama_init_from_model: graph splits = 2
0.00.616.030 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.616.030 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.649.594 I 
0.00.649.678 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | DOTPROD = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.649.697 I perplexity: tokenizing the input ..
0.00.657.022 I perplexity: tokenization took 7.321 ms
0.00.657.050 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.798.067 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.799.408 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.799.427 I llama_perf_context_print:        load time =     640.64 ms
0.00.799.428 I llama_perf_context_print: prompt eval time =     140.14 ms /   128 tokens (    1.09 ms per token,   913.37 tokens per second)
0.00.799.429 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.799.429 I llama_perf_context_print:       total time =     149.84 ms /   129 tokens
0.00.799.843 I ggml_metal_free: deallocating

real	0m0.813s
user	0m0.077s
sys	0m0.132s
```
- save-load-state: 
```
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4591 (7919256c)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
print_info: file format = GGUF V3 (latest)
print_info: file type   = Q4_0
print_info: file size   = 786.31 MiB (4.66 BPW) 
init_tokenizer: initializing tokenizer for type 2
load: control token:      1 '<|padding|>' is not marked as EOG
load: special tokens cache size = 25
load: token to piece cache size = 0.2984 MB
print_info: arch             = gptneox
print_info: vocab_only       = 0
print_info: n_ctx_train      = 2048
print_info: n_embd           = 2048
print_info: n_layer          = 24
print_info: n_head           = 16
print_info: n_head_kv        = 16
print_info: n_rot            = 32
print_info: n_swa            = 0
print_info: n_embd_head_k    = 128
print_info: n_embd_head_v    = 128
print_info: n_gqa            = 1
print_info: n_embd_k_gqa     = 2048
print_info: n_embd_v_gqa     = 2048
print_info: f_norm_eps       = 1.0e-05
print_info: f_norm_rms_eps   = 0.0e+00
print_info: f_clamp_kqv      = 0.0e+00
print_info: f_max_alibi_bias = 0.0e+00
print_info: f_logit_scale    = 0.0e+00
print_info: n_ff             = 8192
print_info: n_expert         = 0
print_info: n_expert_used    = 0
print_info: causal attn      = 1
print_info: pooling type     = 0
print_info: rope type        = 2
print_info: rope scaling     = linear
print_info: freq_base_train  = 10000.0
print_info: freq_scale_train = 1
print_info: n_ctx_orig_yarn  = 2048
print_info: rope_finetuned   = unknown
print_info: ssm_d_conv       = 0
print_info: ssm_d_inner      = 0
print_info: ssm_d_state      = 0
print_info: ssm_dt_rank      = 0
print_info: ssm_dt_b_c_rms   = 0
print_info: model type       = 1.4B
print_info: model params     = 1.41 B
print_info: general.name     = 1.4B
print_info: vocab type       = BPE
print_info: n_vocab          = 50304
print_info: n_merges         = 50009
print_info: BOS token        = 0 '<|endoftext|>'
print_info: EOS token        = 0 '<|endoftext|>'
print_info: EOT token        = 0 '<|endoftext|>'
print_info: UNK token        = 0 '<|endoftext|>'
print_info: LF token         = 128 'Ä'
print_info: EOG token        = 0 '<|endoftext|>'
print_info: max token length = 1024
load_tensors: layer   0 assigned to device Metal
load_tensors: layer   1 assigned to device Metal
load_tensors: layer   2 assigned to device Metal
load_tensors: layer   3 assigned to device Metal
load_tensors: layer   4 assigned to device Metal
load_tensors: layer   5 assigned to device Metal
load_tensors: layer   6 assigned to device Metal
load_tensors: layer   7 assigned to device Metal
load_tensors: layer   8 assigned to device Metal
load_tensors: layer   9 assigned to device Metal
load_tensors: layer  10 assigned to device Metal
load_tensors: layer  11 assigned to device Metal
load_tensors: layer  12 assigned to device Metal
load_tensors: layer  13 assigned to device Metal
load_tensors: layer  14 assigned to device Metal
load_tensors: layer  15 assigned to device Metal
load_tensors: layer  16 assigned to device Metal
load_tensors: layer  17 assigned to device Metal
load_tensors: layer  18 assigned to device Metal
load_tensors: layer  19 assigned to device Metal
load_tensors: layer  20 assigned to device Metal
load_tensors: layer  21 assigned to device Metal
load_tensors: layer  22 assigned to device Metal
load_tensors: layer  23 assigned to device Metal
load_tensors: layer  24 assigned to device Metal
load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
load_tensors: offloading 24 repeating layers to GPU
load_tensors: offloading output layer to GPU
load_tensors: offloaded 25/25 layers to GPU
load_tensors: Metal_Mapped model buffer size =   786.33 MiB
load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
llama_init_from_model: n_seq_max     = 1
llama_init_from_model: n_ctx         = 2048
llama_init_from_model: n_ctx_per_seq = 2048
llama_init_from_model: n_batch       = 2048
llama_init_from_model: n_ubatch      = 512
llama_init_from_model: flash_attn    = 0
llama_init_from_model: freq_base     = 10000.0
llama_init_from_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has residency sets    = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x107605260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x1076085f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x107608a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x107608ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x107609340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x1076097b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x107609c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x10760a090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x10760a500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x10760a970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x10760ade0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x10760b480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x10760bfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x10760c750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x10760cf60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x10760d680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x10760dda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x10760e4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x10760ebe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x10760f3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x10760fad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x1076101f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x107610910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x1076111b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x1076118d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x107611b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x107611e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x1076122c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x1076129e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x107612e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x107613410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x107613920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x107613d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x107614050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x1076144c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x107614930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x107614e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x107615390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x107615890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x107615d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x107616290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x107616790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x107616c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x107617190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x107617690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x107617b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x107617f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x1076183e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x107618b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x107618fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x107619450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x1076198c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x107619d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x10761a1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x10761a860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x10761ad00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x10761b1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x10761b460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x10761ba70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x10761c260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x10761c520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x10761c9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x10761ce60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x10761d300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x10761d7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x10761dc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x10761e0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x10761e580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x10761ea20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x10761eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x10761f360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x10761f800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x10761fca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x1076201f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x107620740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x107620c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x1076211e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x107621730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x107621c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x1076221d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x107622720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x107622c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x1076231c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x107623710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x107623c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x1076241b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x107624700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x107624c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x1076251a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x1076256f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x107625c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x107626190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x1076266e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x107626c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x107627180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x1076276d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x107627c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x1076186a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x107628090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x107628840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x107628d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x1076292e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x107629830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x107629d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x10762a2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x10762a820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x10762ad70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x10762b2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x10762b810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x10762bd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x10762c2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x10762c800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x10762cd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x10762d1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x10762d690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x10762db30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x10762dfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x10762e470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x10762e910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x10762edb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x10762f250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x10762f6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x10762fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x1076302a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x107630560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x107630a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x107630f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x107631460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x107631960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x107631e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x107632360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x107632860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x107632d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x107633260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x107633760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x107633c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x107634160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x107634660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x107634b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x107635060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x107635560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x107635a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x107635f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x107636460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x107636960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x107636e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x107637360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x107637860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x107637d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x107638260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x107638760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x107638c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x107639160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x107639660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x107639b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x10763a060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x10763a560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x10763aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x10763af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x10763b460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x10763b960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x10763be60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x10763c360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x10763c860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x10763cd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x10763d260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x10763d760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x10763dc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x10763e160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x10763e660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x10763eb60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x10763f060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x10763f560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x10763fa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x10763ff60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x107640460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x107640960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x107640e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x107641360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x107641860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x107641d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x107642260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x107642760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x107642c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x107643160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x107643660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x107643b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x107644060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x107644560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x107644a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x107644f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x107645460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x107645960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x107645e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x107646410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x1076469c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x107646f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x107647520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x107647b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x107648140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x107648750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x107648f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x1076493e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x1076496a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x107649cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x10764a2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x10764aab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x10764af50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x10764b3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x10764b890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x10764c040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x10764c590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x10764cae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x10764d030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x10764d580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x10764dad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x10764e020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x10764e570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x10764eac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x10764f010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x10764f560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x10764fab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x107650000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x107650550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x107650aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x107650ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x107651540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x107651a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x107651fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x107652530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x107652a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x107652fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x107653520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x107653a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x107653fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x107654510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x107654a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x107654fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x107655500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x107655a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x107655fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x1076564f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x107656a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x107656f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x1076574e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x107657a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x107657f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x1076584d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x107658a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x107658f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x1076594c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x107659a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x107659f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x10765a4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x10765aa00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x10765af50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x10765b4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x10765b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x10765bf40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x10765c490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x10765c9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x10765cf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x10765d480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x10765d9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x10765df20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x10765e470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x10765e9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x10765ee60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x10765f300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x10765f7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x10765fc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x1076600e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x107660580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x107660a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x107660ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x107661360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x107661800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x107661ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x107662140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x1076625e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x107662a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x107662f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x107663470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x107663b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x1076642b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x1076649d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x1076650f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x1076653b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x107665ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x107665e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x107666470 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_init_from_model:        CPU  output buffer size =     0.19 MiB
llama_init_from_model:      Metal compute buffer size =   102.25 MiB
llama_init_from_model:        CPU compute buffer size =     8.01 MiB
llama_init_from_model: graph nodes  = 967
llama_init_from_model: graph splits = 2
0.00.717.812 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.717.816 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
llama_init_from_model: n_seq_max     = 1
llama_init_from_model: n_ctx         = 2048
llama_init_from_model: n_ctx_per_seq = 2048
llama_init_from_model: n_batch       = 2048
llama_init_from_model: n_ubatch      = 512
llama_init_from_model: flash_attn    = 0
llama_init_from_model: freq_base     = 10000.0
llama_init_from_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has residency sets    = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x107704bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x107705030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x1077054a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x107705910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x107705d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x1077061f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x107706660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x107706ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x107706f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x1077073b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x107707820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x107707ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x107708a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x1077091b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x1077099c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x10770a0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x10770a800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x10770af20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x10770b640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x10770be10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x10770c530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x10770cc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x10770d370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x10770da90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x10770e1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x10770e470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x10770e730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x10770eba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x10770f010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x10770f480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x10770f8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x10770fe20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x107710290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x107710550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x1077109c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x107710e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x1077112a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x107711710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x107711b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x107711ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x107712460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x1077128d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x107712d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x1077131b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x107713620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x107713a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x107713f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x107714370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x1077147e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x107714c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x1077150c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x107715530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x1077159a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x107715e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x107716280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x1077166f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x107716c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x107717160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x1077175d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x107717a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x107717eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x107718320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x107718790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x107718c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x107719070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x1077194e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x107719950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x107719dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x10771a230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x10771a6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x10771ab10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x10771af80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x10771b3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x10771b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x10771bcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x10771c140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x10771c5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x10771ca20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x10771ce90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x10771d300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x10771d770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x10771dbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x10771e050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x10771e4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x10771e930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x10771eda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x10771f210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x10771f680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x10771faf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x10771ff60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x1077203d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x107720840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x107720cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x107721120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x107721590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x107721a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x107721e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x1077222e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x107722750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x107722bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x107723030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x1077234a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x107723910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x107723d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x1077241f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x107724660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x107724ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x107724f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x1077253b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x107725820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x107725c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x107726100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x107726570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x1077269e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x107726e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x1077272c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x107727730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x107727ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x107728010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x107728480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x1077288f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x107728d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x1077291d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x107729640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x107729ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x107729f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x10772a390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x10772a800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x10772ac70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x10772b0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x10772b550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x10772b9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x10772be30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x10772c2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x10772c710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x10772cb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x10772cff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x10772d460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x10772d8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x10772dd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x10772e1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x10772e620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x10772ea90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x10772ef00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x10772f370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x10772f7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x10772fc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x1077300c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x107730530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x1077309a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x107730e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x107731280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x1077316f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x107731b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x107731fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x107732440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x1077328b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x107732d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x107733190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x107733600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x107733a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x107733ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x107734350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x1077347c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x107734c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x1077350a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x107735cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x107735f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x107736250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x1077366c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x107736b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x107736fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x107737410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x107737880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x107737cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x107738160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x1077385d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x107738a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x107738eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x107739320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x107739790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x107739c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x10773a070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x10773a4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x10773a950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x10773adc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x10773b230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x10773b6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x10773bb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x10773bf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x10773c3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x10773c860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x10773ccd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x10773d140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x10773d5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x10773da20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x10773de90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x10773e300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x10773e770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x10773ebe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x10773f050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x10773f4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x10773fa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x10773ff30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x1077403a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x107740810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x107740c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x1077410f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x107741610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x107741b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x107742690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x107742950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x107742f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x1077434d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x107743a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x107744050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x107744610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x107744bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x107745190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x107745750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x107745d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x1077462d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x107746890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x107746e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x107747410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x1077479d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x107747f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x107748550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x107748b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x1077490d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x107749690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x107749c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x10774a210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x10774a7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x10774ad90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x10774b350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x10774b910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x10774bed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x10774c490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x10774ca50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x10774d010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x10774d5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x10774db90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x10774e150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x10774e710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x10774ecd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x10774f290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x10774f850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x10774fe10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x1077503d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x107750990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x107750f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x107751510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x107751ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x107752090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x107752650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x107752c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x1077531d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x107753790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x107753d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x107754310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x1077548d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x107754e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x107755450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x107755a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x107755fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x107756590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x107756b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x107757050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x107757550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x107757a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x107757f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x107758450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x107758950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x107758e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x107759350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x107759850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x107759d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x10775a250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x10775a750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x10775ac50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x10775b150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x10775b650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x10775c060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x10775c780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x10775cea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x10775d5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x10775d880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x10775e070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x10775e330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x10775e940 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_init_from_model:        CPU  output buffer size =     0.19 MiB
llama_init_from_model:      Metal compute buffer size =   102.25 MiB
llama_init_from_model:        CPU compute buffer size =     8.01 MiB
llama_init_from_model: graph nodes  = 967
llama_init_from_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
llama_init_from_model: n_seq_max     = 1
llama_init_from_model: n_ctx         = 2048
llama_init_from_model: n_ctx_per_seq = 2048
llama_init_from_model: n_batch       = 2048
llama_init_from_model: n_ubatch      = 512
llama_init_from_model: flash_attn    = 0
llama_init_from_model: freq_base     = 10000.0
llama_init_from_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has residency sets    = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x1073086f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x107306500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x107308d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x107309180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x1073095f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x107309ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x10730a150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x10730a700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x10730acb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x10730b1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x10730b6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x10730bbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x10730c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x10730ce80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x10730d690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x10730ddb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x10730e4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x10730ebf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x10730f310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x10730fae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x107310200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x107310920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x107311040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x107311760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x107311e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x107312140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x107312750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x107312d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x107313370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x107313b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x107314000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x1073142c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x107314b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x107315090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x107315350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x1073157f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x107315c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x107316130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x1073165d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x107316a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x107316f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x1073173b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x107317850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x107317cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x107317fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x1073185c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x107318bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x1073191e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x1073197f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x107319e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x10731a410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x10731aa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x10731b030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x10731b640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x10731be30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x10731c2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x10731c770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x10731ca30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x10731d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x10731d830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x10731dcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x10731e170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x10731e610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x10731eab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x10731ef50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x10731f3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x10731f890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x10731fd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x1073201d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x107320670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x107320b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x107320fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x107321450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x1073219a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x107321ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x107322440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x107322990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x107322ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x107323430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x107323980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x107323ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x107324420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x107324970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x107324ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x107325410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x107325960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x107325eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x107326400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x107326950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x107326ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x1073273f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x107327940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x107327e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x1073283e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x107328930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x107328e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x1073293d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x107329920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x107329e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x10732a3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x10732a910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x10732ae60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x10732b3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x10732b900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x10732be50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x10732c3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x10732c8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x10732ce40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x10732d390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x10732d8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x10732de30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x10732e380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x10732e8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x10732ed70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x10732f210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x10732f6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x10732fb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x10732fff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x107330490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x107330930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x107330dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x107331270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x107331710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x107331bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x107332050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x1073324f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x107332990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x107332e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x1073332d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x107333770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x107333c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x1073340b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x107334550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x1073349f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x107334e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x107335330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x1073357d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x107335c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x107336110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x1073365b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x107336a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x107336ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x107337390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x107337830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x107337cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x107338170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x107338610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x107338ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x107338f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x1073393f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x107339890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x107339d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x10733a1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x10733a670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x10733ab10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x10733afb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x10733b450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x10733b8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x10733bd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x10733c230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x10733c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x10733cb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x10733d010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x10733d4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x10733d950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x10733ddf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x10733e290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x10733e730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x10733ebd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x10733f070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x10733f510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x10733f9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x10733fe50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x1073402f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x107340790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x107340c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x1073410d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x107341570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x107341a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x107341eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x107342350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x1073427f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x107342c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x107343130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x1073435d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x107343a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x107343f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x1073443b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x107344850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x107344cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x107345190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x107345630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x107345ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x107346020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x107346570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x107346ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x107347010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x1073472d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x1073478e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x107347ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x107348500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x107348cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x107349190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x107349450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x107349a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x10734a070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x10734a860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x10734ad00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x10734b1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x10734b640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x10734bdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x10734c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x10734c890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x10734cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x10734d330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x10734d880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x10734ddd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x10734e320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x10734e870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x10734edc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x10734f310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x10734f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x10734fdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x107350300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x107350850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x107350da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x1073512f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x107351840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x107351d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x1073522e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x107352830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x107352d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x1073532d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x107353820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x107353d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x1073542c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x107354810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x107354d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x1073552b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x107355800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x107355d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x1073562a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x1073567f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x107356d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x107357290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x1073577e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x107357d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x107358280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x1073587d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x107358d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x107359270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x1073597c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x107359d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x10735a260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x10735a7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x10735ad00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x10735b250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x10735b7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x10735bcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x10735c240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x10735c790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x10735cce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x10735d230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x10735d780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x10735dcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x10735e220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x10735e770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x10735ec10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x10735f0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x10735f550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x10735f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x10735fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x107360330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x1073607d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x107360c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x107361110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x1073615b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x107361a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x107361ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x107362390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x107362830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x107362cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x107363220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x107363940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x107364060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x107364780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x107364ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x107365160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x107365950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x107365c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x107366220 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_init_from_model:        CPU  output buffer size =     0.19 MiB
llama_init_from_model:      Metal compute buffer size =   102.25 MiB
llama_init_from_model:        CPU compute buffer size =     8.01 MiB
llama_init_from_model: graph nodes  = 967
llama_init_from_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes

main : success
ggml_metal_free: deallocating

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.809s
user	0m0.284s
sys	0m0.317s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4591 (7919256c)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_model_load_from_file_impl: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
print_info: file format = GGUF V3 (latest)
print_info: file type   = Q4_0
print_info: file size   = 786.31 MiB (4.66 BPW) 
init_tokenizer: initializing tokenizer for type 2
load: control token:      1 '<|padding|>' is not marked as EOG
load: special tokens cache size = 25
load: token to piece cache size = 0.2984 MB
print_info: arch             = gptneox
print_info: vocab_only       = 0
print_info: n_ctx_train      = 2048
print_info: n_embd           = 2048
print_info: n_layer          = 24
print_info: n_head           = 16
print_info: n_head_kv        = 16
print_info: n_rot            = 32
print_info: n_swa            = 0
print_info: n_embd_head_k    = 128
print_info: n_embd_head_v    = 128
print_info: n_gqa            = 1
print_info: n_embd_k_gqa     = 2048
print_info: n_embd_v_gqa     = 2048
print_info: f_norm_eps       = 1.0e-05
print_info: f_norm_rms_eps   = 0.0e+00
print_info: f_clamp_kqv      = 0.0e+00
print_info: f_max_alibi_bias = 0.0e+00
print_info: f_logit_scale    = 0.0e+00
print_info: n_ff             = 8192
print_info: n_expert         = 0
print_info: n_expert_used    = 0
print_info: causal attn      = 1
print_info: pooling type     = 0
print_info: rope type        = 2
print_info: rope scaling     = linear
print_info: freq_base_train  = 10000.0
print_info: freq_scale_train = 1
print_info: n_ctx_orig_yarn  = 2048
print_info: rope_finetuned   = unknown
print_info: ssm_d_conv       = 0
print_info: ssm_d_inner      = 0
print_info: ssm_d_state      = 0
print_info: ssm_dt_rank      = 0
print_info: ssm_dt_b_c_rms   = 0
print_info: model type       = 1.4B
print_info: model params     = 1.41 B
print_info: general.name     = 1.4B
print_info: vocab type       = BPE
print_info: n_vocab          = 50304
print_info: n_merges         = 50009
print_info: BOS token        = 0 '<|endoftext|>'
print_info: EOS token        = 0 '<|endoftext|>'
print_info: EOT token        = 0 '<|endoftext|>'
print_info: UNK token        = 0 '<|endoftext|>'
print_info: LF token         = 128 'Ä'
print_info: EOG token        = 0 '<|endoftext|>'
print_info: max token length = 1024
load_tensors: layer   0 assigned to device Metal
load_tensors: layer   1 assigned to device Metal
load_tensors: layer   2 assigned to device Metal
load_tensors: layer   3 assigned to device Metal
load_tensors: layer   4 assigned to device Metal
load_tensors: layer   5 assigned to device Metal
load_tensors: layer   6 assigned to device Metal
load_tensors: layer   7 assigned to device Metal
load_tensors: layer   8 assigned to device Metal
load_tensors: layer   9 assigned to device Metal
load_tensors: layer  10 assigned to device Metal
load_tensors: layer  11 assigned to device Metal
load_tensors: layer  12 assigned to device Metal
load_tensors: layer  13 assigned to device Metal
load_tensors: layer  14 assigned to device Metal
load_tensors: layer  15 assigned to device Metal
load_tensors: layer  16 assigned to device Metal
load_tensors: layer  17 assigned to device Metal
load_tensors: layer  18 assigned to device Metal
load_tensors: layer  19 assigned to device Metal
load_tensors: layer  20 assigned to device Metal
load_tensors: layer  21 assigned to device Metal
load_tensors: layer  22 assigned to device Metal
load_tensors: layer  23 assigned to device Metal
load_tensors: layer  24 assigned to device Metal
load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
load_tensors: offloading 24 repeating layers to GPU
load_tensors: offloading output layer to GPU
load_tensors: offloaded 25/25 layers to GPU
load_tensors: Metal_Mapped model buffer size =   786.33 MiB
load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
llama_init_from_model: n_seq_max     = 1
llama_init_from_model: n_ctx         = 2048
llama_init_from_model: n_ctx_per_seq = 2048
llama_init_from_model: n_batch       = 2048
llama_init_from_model: n_ubatch      = 512
llama_init_from_model: flash_attn    = 1
llama_init_from_model: freq_base     = 10000.0
llama_init_from_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has residency sets    = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x131f0d4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x131f0dbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x131f0e160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x131f0e710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x131f0ecc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x131f0f270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x131f0f820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x131f0fdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x131f10380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x131f10880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x131f10d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x131f11280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x131f11da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x131f12550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x131f12d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x131f13480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x131f13ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x131f142c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x131f149e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x131f151b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x131f158d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x131f15ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x131f16710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x131f16fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x131f176d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x131f17990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x131f17fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x131f18c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x131f19150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x131f19410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x131f198b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x131f19b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x131f1a400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x131f1a940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x131f1ac00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x131f1b0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x131f1b540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x131f1b9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x131f1be80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x131f1c320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x131f1c7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x131f1cc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x131f1d100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x131f1d5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x131f1d860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x131f1de70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x131f1e480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x131f1eda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x131f1f3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x131f1f9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x131f1ffd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x131f205e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x131f20bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x131f21200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x131f219f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x131f21e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x131f22330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x131f225f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x131f22c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x131f233f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x131f236b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x131f23b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x131f23ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x131f24490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x131f24930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x131f24dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x131f25270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x131f25710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x131f25bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x131f26050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x131f264f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x131f26990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x131f26e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x131f27380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x131f278d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x131f27e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x131f28370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x131f288c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x131f28e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x131f29360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x131f298b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x131f29e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x131f2a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x131f2a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x131f2adf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x131f2b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x131f2b890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x131f2bde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x131f2c330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x131f2c880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x131f2cdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x131f2d320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x131f2d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x131f2ddc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x131f2e310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x131f2e860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x131f2edb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x131f1ea90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x131f2f220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x131f2f9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x131f2ff20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x131f30470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x131f309c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x131f30f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x131f31460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x131f319b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x131f31f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x131f32450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x131f329a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x131f32ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x131f33440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x131f33990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x131f33ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x131f34380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x131f34820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x131f34cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x131f35160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x131f35600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x131f35aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x131f35f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x131f363e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x131f36880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x131f36d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x131f371c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x131f37660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x131f37b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x131f37fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x131f38440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x131f388e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x131f38d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x131f39220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x131f396c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x131f39b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x131f3a000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x131f3a4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x131f3a940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x131f3ade0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x131f3b280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x131f3b720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x131f3bbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x131f3c060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x131f3c500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x131f3c9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x131f3ce40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x131f3d2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x131f3d780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x131f3dc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x131f3e0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x131f3e560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x131f3ea00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x131f3eea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x131f3f340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x131f3f7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x131f3fc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x131f40120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x131f405c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x131f40a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x131f40f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x131f413a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x131f41840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x131f41ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x131f42180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x131f42620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x131f42ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x131f42f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x131f43400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x131f438a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x131f43d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x131f441e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x131f44680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x131f44b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x131f44fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x131f45460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x131f45900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x131f45da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x131f46240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x131f466e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x131f46b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x131f47020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x131f474c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x131f47960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x131f47e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x131f482a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x131f48740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x131f48be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x131f49080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x131f49520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x131f499c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x131f49e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x131f4a300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x131f4a7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x131f4ac40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x131f4b0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x131f4b630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x131f4bb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x131f4c0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x131f4c620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x131f4c8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x131f4cef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x131f4d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x131f4db10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x131f4e300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x131f4e7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x131f4ea60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x131f4f070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x131f4f680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x131f4fe70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x131f50310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x131f507b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x131f50c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x131f51400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x131f51950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x131f51ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x131f523f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x131f52940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x131f52e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x131f533e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x131f53930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x131f53e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x131f543d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x131f54920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x131f54e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x131f553c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x131f55910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x131f55e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x131f563b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x131f56900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x131f56e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x131f573a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x131f578f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x131f57e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x131f58390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x131f588e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x131f58e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x131f59380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x131f598d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x131f59e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x131f5a370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x131f5a8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x131f5ae10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x131f5b360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x131f5b8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x131f5be00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x131f5c350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x131f5c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x131f5cdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x131f5d340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x131f5d890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x131f5dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x131f5e330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x131f5e880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x131f5edd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x131f5f320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x131f5f870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x131f5fdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x131f60310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x131f60860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x131f60db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x131f61300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x131f61850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x131f61da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x131f622f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x131f62840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x131f62d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x131f632e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x131f63830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x131f63d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x131f64220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x131f646c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x131f64b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x131f65000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x131f654a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x131f65940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x131f65de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x131f66280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x131f66720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x131f66bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x131f67060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x131f67500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x131f679a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x131f67e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x131f682e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x131f68830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x131f68f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x131f69670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x131f69d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x131f6a4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x131f6a770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x131f6af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x131f6b220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x131f6b830 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_init_from_model:        CPU  output buffer size =     0.19 MiB
llama_init_from_model:      Metal compute buffer size =   102.25 MiB
llama_init_from_model:        CPU compute buffer size =     8.01 MiB
llama_init_from_model: graph nodes  = 872
llama_init_from_model: graph splits = 2
0.00.097.651 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.097.656 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
llama_init_from_model: n_seq_max     = 1
llama_init_from_model: n_ctx         = 2048
llama_init_from_model: n_ctx_per_seq = 2048
llama_init_from_model: n_batch       = 2048
llama_init_from_model: n_ubatch      = 512
llama_init_from_model: flash_attn    = 1
llama_init_from_model: freq_base     = 10000.0
llama_init_from_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has residency sets    = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x131f6b4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x131f4d1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x131f4cba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x131f4d7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x131f208a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x131f20290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x131f228b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x131f4f330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x131f17c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x131f1e740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x131f1f060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x131f1f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x131f1db20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x131f1fc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x131f16c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x131f22ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x131f2f4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x131f6aa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x131f19e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x131f1a0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x131f4f940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x131f4ddd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x131f18260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x131f18520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x131f187e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x131f6bc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x131f6bf50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x131f6c210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x131f6c4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x131f6c790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x131f6ca50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x131f6cd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x131f6cfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x131f6d290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x131f6d550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x131f6d810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x131f6dad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x131f6dd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x131f6e050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x131f6e310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x131f6e5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x131f6e890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x131f6eb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x131f6ee10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x131f6f0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x131f6f390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x131f6f650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x131f6f910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x131f6fbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x131f6fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x131f70150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x131f70410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x131f706d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x131f70990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x131f70c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x131f70f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x131f711d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x131f71490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x131f71750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x131f71a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x131f71cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x131f71f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x131f72250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x131f72510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x131f727d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x131f72a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x131f72d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x131f73010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x131f732d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x131f73590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x131f73850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x131f73b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x131f73dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x131f74090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x131f74350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x131f74610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x131f748d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x131f74b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x131f74e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x131f75110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x131f753d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x131f75690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x131f75950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x131f75c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x131f75ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x131f76190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x131f76450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x131f76710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x131f769d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x131f76c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x131f76f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x131f77210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x131f774d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x131f77790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x131f77a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x131f77d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x131f77fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x131f78290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x131f78550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x131f78810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x131f78ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x131f78d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x131f79050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x131f79310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x131f795d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x131f79890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x131f79b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x131f79e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x131f7a0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x131f7a390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x131f7a650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x131f7a910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x131f7abd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x131f7ae90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x131f7b150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x131f7b410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x131f7b6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x131f7b990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x131f7bc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x131f7bf10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x131f7c1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x131f7c490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x131f7c750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x131f7ca10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x131f7ccd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x131f7cf90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x131f7d250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x131f7d510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x131f7d7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x131f7da90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x131f7dd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x131f7e010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x131f7e2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x131f7e590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x131f7e850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x131f7eb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x131f7edd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x131f7f090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x131f7f350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x131f7f610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x131f7f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x131f7fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x131f7fe50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x131f80110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x131f803d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x131f80690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x131f80950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x131f80c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x131f80ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x131f81190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x131f81450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x131f81710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x131f819d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x131f81c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x131f81f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x131f82210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x131f824d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x131f82790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x131f82a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x131f82d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x131f82fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x131f83290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x131f83550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x131f83810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x131f83ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x131f83d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x131f84050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x131f84310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x131f845d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x131f84890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x131f84b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x131f84e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x131f850d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x131f85390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x131f85650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x131f85910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x131f85bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x131f85e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x131f86150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x131f86410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x131f866d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x131f86990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x131f86c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x131f86f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x131f871d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x131f87490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x131f87750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x131f87a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x131f87cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x131f87f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x131f88250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x131f88510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x131f887d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x131f88a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x131f88d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x131f89010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x131f892d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x131f89590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x131f89850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x131f89b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x131f89dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x131f8a090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x131f8a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x131f8a610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x131f8a8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x131f8ae10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x131f8b0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x131f8b570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x131f8ba10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x131f8beb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x131f8c660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x131f8c920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x131f8cbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x131f8d050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x131f8d4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x131f8d930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x131f8dda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x131f8e210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x131f8e680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x131f8eaf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x131f8ef60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x131f8f3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x131f8f840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x131f8fcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x131f90120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x131f90590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x131f90a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x131f90e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x131f912e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x131f91750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x131f91bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x131f92030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x131f924a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x131f92910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x131f92d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x131f931f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x131f93660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x131f93ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x131f93f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x131f943b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x131f94820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x131f94c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x131f95100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x131f95570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x131f959e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x131f95e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x131f962c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x131f96730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x131f96ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x131f97010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x131f97480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x131f978f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x131f97d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x131f981d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x131f98640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x131f98ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x131f98f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x131f99390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x131f99800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x131f99c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x131f9a0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x131f9a550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x131f9a9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x131f9ae30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x131f9b2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x131f9b710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x131f9bb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x131f9bff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x131f9c460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x131f9c8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x131f9cd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x131f9d1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x131f9d620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x131f9da90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x131f9df00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x131f9e370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x131f9e7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x131f9ec50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x131f9f0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x131f9f530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x131f9f9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x131f9fe10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x131fa0280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x131fa0cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x131fa1410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x131fa1b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x131fa2250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x131fa2510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x131fa2d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x131fa2fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x131fa35d0 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_init_from_model:        CPU  output buffer size =     0.19 MiB
llama_init_from_model:      Metal compute buffer size =   102.25 MiB
llama_init_from_model:        CPU compute buffer size =     8.01 MiB
llama_init_from_model: graph nodes  = 872
llama_init_from_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
llama_init_from_model: n_seq_max     = 1
llama_init_from_model: n_ctx         = 2048
llama_init_from_model: n_ctx_per_seq = 2048
llama_init_from_model: n_batch       = 2048
llama_init_from_model: n_ubatch      = 512
llama_init_from_model: flash_attn    = 1
llama_init_from_model: freq_base     = 10000.0
llama_init_from_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has residency sets    = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x136e046e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x136e04b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x136e04fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x136e05430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x136e058a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x136e05d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x136e06180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x136e065f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x136e06a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x136e06ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x136e07340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x136e079e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x136e08500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x136e08cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x136e094c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x136e09be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x136e0a300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x136e0aa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x136e0b140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x136e0b910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x136e0c030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x136e0c750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x136e0ce70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x136e0d590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x136e0dcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x136e0df70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x136e0e230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x136e0e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x136e0eb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x136e0ef80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x136e0f3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x136e0f920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x136e0fd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x136e10050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x136e104c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x136e10930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x136e10da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x136e11210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x136e11680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x136e11af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x136e11f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x136e123d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x136e12840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x136e12cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x136e13120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x136e13590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x136e13a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x136e13e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x136e142e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x136e14750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x136e14bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x136e15030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x136e154a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x136e15910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x136e15d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x136e161f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x136e16760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x136e16c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x136e170d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x136e17540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x136e179b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x136e17e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x136e18290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x136e18700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x136e18b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x136e18fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x136e19450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x136e198c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x136e19d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x136e1a1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x136e1a610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x136e1aa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x136e1aef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x136e1b360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x136e1b7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x136e1bc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x136e1c0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x136e1c520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x136e1c990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x136e1ce00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x136e1d270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x136e1d6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x136e1db50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x136e1dfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x136e1e430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x136e1e8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x136e1ed10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x136e1f180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x136e1f5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x136e1fa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x136e1fed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x136e20340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x136e207b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x136e20c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x136e21090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x136e21500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x136e21970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x136e21de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x136e22250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x136e226c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x136e22b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x136e22fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x136e23410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x136e23ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x136e23f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x136e243d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x136e24840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x136e24cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x136e25120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x136e25590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x136e25a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x136e25e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x136e262e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x136e26750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x136e26bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x136e27030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x136e274a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x136e27910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x136e27d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x136e281f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x136e28660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x136e28ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x136e28f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x136e293b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x136e29820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x136e29c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x136e2a100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x136e2a570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x136e2a9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x136e2ae50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x136e2b2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x136e2b730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x136e2bba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x136e2c010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x136e2c480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x136e2c8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x136e2cd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x136e2d1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x136e2d640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x136e2dab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x136e2df20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x136e2e390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x136e2e800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x136e2ec70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x136e2f0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x136e2f550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x136e2f9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x136e2fe30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x136e302a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x136e30710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x136e30b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x136e30ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x136e31460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x136e318d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x136e31d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x136e321b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x136e32620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x136e32a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x136e32f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x136e33370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x136e337e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x136e33c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x136e340c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x136e34530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x136e349a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x136e34e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x136e35280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x136e356f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x136e35b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x136e35fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x136e36440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x136e368b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x136e36d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x136e37190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x136e37600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x136e37a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x136e37ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x136e38350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x136e387c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x136e38c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x136e390a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x136e39510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x136e39980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x136e39df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x136e3a260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x136e3a6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x136e3ab40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x136e3afb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x136e3b420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x136e3b890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x136e3bd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x136e3c170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x136e3c5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x136e3ca50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x136e3cec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x136e3d330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x136e3d7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x136e3dc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x136e3e080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x136e3e4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x136e3e960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x136e3edd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x136e3f240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x136e3f6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x136e3fb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x136e3ff90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x136e40400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x136e40870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x136e40ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x136e41150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x136e41cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x136e41f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x136e42250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x136e426c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x136e42b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x136e42fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x136e43410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x136e43880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x136e43cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x136e44160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x136e445d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x136e44a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x136e44eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x136e45320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x136e45790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x136e45c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x136e46070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x136e464e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x136e46950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x136e46dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x136e47230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x136e476a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x136e47b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x136e47f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x136e483f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x136e48860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x136e48cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x136e49140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x136e495b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x136e49a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x136e49e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x136e4a300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x136e4a770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x136e4abe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x136e4b050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x136e4b4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x136e4b930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x136e4bda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x136e4c210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x136e4c680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x136e4caf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x136e4cf60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x136e4d3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x136e4d840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x136e4dcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x136e4e120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x136e4e590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x136e4ea00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x136e4ee70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x136e4f2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x136e4f750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x136e4fbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x136e50030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x136e504a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x136e50910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x136e50d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x136e511f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x136e51660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x136e51ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x136e51f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x136e523b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x136e52820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x136e52c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x136e53100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x136e53570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x136e539e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x136e53e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x136e542c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x136e54730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x136e54ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x136e55010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x136e55480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x136e558f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x136e56360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x136e56a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x136e571a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x136e578c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x136e57b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x136e57ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x136e585f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x136e58c00 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24, can_shift = 1
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_init_from_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_init_from_model:        CPU  output buffer size =     0.19 MiB
llama_init_from_model:      Metal compute buffer size =   102.25 MiB
llama_init_from_model:        CPU compute buffer size =     8.01 MiB
llama_init_from_model: graph nodes  = 872
llama_init_from_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes

main : success
ggml_metal_free: deallocating

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have done that little trick."


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have done that little trick."


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have done that little trick."

real	0m0.961s
user	0m0.234s
sys	0m0.188s
```
### ctest_with_model_debug

Runs ctest with model files in debug mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-debug
    Start 25: test-model-load-cancel
1/2 Test #25: test-model-load-cancel ...........   Passed    0.43 sec
    Start 26: test-autorelease
2/2 Test #26: test-autorelease .................   Passed    1.41 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   1.83 sec*proc (2 tests)

Total Test time (real) =   1.85 sec
        1.87 real         0.50 user         0.21 sys
```
### ctest_with_model_release

Runs ctest with model files in release mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-release
    Start 25: test-model-load-cancel
1/2 Test #25: test-model-load-cancel ...........   Passed    0.24 sec
    Start 26: test-autorelease
2/2 Test #26: test-autorelease .................   Passed    0.30 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   0.54 sec*proc (2 tests)

Total Test time (real) =   0.55 sec
        0.55 real         0.13 user         0.08 sys
```
