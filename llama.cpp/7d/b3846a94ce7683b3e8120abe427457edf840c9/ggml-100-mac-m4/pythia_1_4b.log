Archive:  models-mnt/wikitext/wikitext-2-raw-v1.zip
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.test.raw  
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.valid.raw  
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.train.raw  
+ cmake -DCMAKE_BUILD_TYPE=Release -DLLAMA_FATAL_WARNINGS=ON -DGGML_METAL=ON -DGGML_METAL_USE_BF16=ON ..
-- The C compiler identification is AppleClang 16.0.0.16000026
-- The CXX compiler identification is AppleClang 16.0.0.16000026
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /Library/Developer/CommandLineTools/usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /Library/Developer/CommandLineTools/usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Found Git: /usr/bin/git (found version "2.39.5 (Apple Git-154)")
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
-- Found Threads: TRUE
-- ccache found, compilation results will be cached. Disable with GGML_CCACHE=OFF.
-- CMAKE_SYSTEM_PROCESSOR: arm64
-- Accelerate framework found
-- Could NOT find OpenMP_C (missing: OpenMP_C_FLAGS OpenMP_C_LIB_NAMES) 
-- Could NOT find OpenMP_CXX (missing: OpenMP_CXX_FLAGS OpenMP_CXX_LIB_NAMES) 
-- Could NOT find OpenMP (missing: OpenMP_C_FOUND OpenMP_CXX_FOUND) 
CMake Warning at ggml/src/ggml-cpu/CMakeLists.txt:42 (message):
  OpenMP not found


-- Using llamafile
-- ARM detected
-- Performing Test GGML_COMPILER_SUPPORT_DOTPROD
-- Performing Test GGML_COMPILER_SUPPORT_DOTPROD - Success
-- Performing Test GGML_COMPILER_SUPPORT_MATMUL_INT8
-- Performing Test GGML_COMPILER_SUPPORT_MATMUL_INT8 - Success
-- Using runtime weight conversion of Q4_0 to Q4_0_x_x to enable optimized GEMM/GEMV kernels
-- Including CPU backend
CMake Warning at ggml/src/ggml-amx/CMakeLists.txt:104 (message):
  AMX requires x86 and gcc version > 11.0.  Turning off GGML_AMX.


-- Looking for dgemm_
-- Looking for dgemm_ - found
-- Found BLAS: /Library/Developer/CommandLineTools/SDKs/MacOSX15.1.sdk/System/Library/Frameworks/Accelerate.framework
-- BLAS found, Libraries: /Library/Developer/CommandLineTools/SDKs/MacOSX15.1.sdk/System/Library/Frameworks/Accelerate.framework
-- BLAS found, Includes: 
-- Including BLAS backend
-- Metal framework found
-- The ASM compiler identification is AppleClang
-- Found assembler: /Library/Developer/CommandLineTools/usr/bin/cc
-- Including METAL backend
-- Configuring done (1.3s)
-- Generating done (0.2s)
-- Build files have been written to: /Users/ggml/work/llama.cpp/build-ci-release

real	0m1.600s
user	0m0.689s
sys	0m0.939s
++ nproc
+ make -j10
[  2%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-threading.cpp.o
[  3%] Building C object examples/gguf-hash/CMakeFiles/xxhash.dir/deps/xxhash/xxhash.c.o
[  3%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-opt.cpp.o
[  3%] Building CXX object common/CMakeFiles/build_info.dir/build-info.cpp.o
[  4%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml.c.o
[  4%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-backend.cpp.o
[  4%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-alloc.c.o
[  5%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-quants.c.o
[  6%] Building C object examples/gguf-hash/CMakeFiles/sha1.dir/deps/sha1/sha1.c.o
[  6%] Building C object examples/gguf-hash/CMakeFiles/sha256.dir/deps/sha256/sha256.c.o
[  6%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-aarch64.c.o
[  6%] Built target xxhash
[  6%] Built target build_info
[  6%] Built target sha256
[  6%] Built target sha1
[  7%] Linking CXX shared library libggml-base.dylib
[  7%] Built target ggml-base
[  8%] Generate assembly for embedded Metal library
Embedding Metal library
[  9%] Building CXX object ggml/src/ggml-blas/CMakeFiles/ggml-blas.dir/ggml-blas.cpp.o
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu-aarch64.c.o
[ 10%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/llamafile/sgemm.cpp.o
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu.c.o
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu-quants.c.o
[ 11%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu.cpp.o
[ 11%] Linking CXX shared library libggml-cpu.dylib
[ 12%] Linking CXX shared library libggml-blas.dylib
[ 12%] Building C object ggml/src/ggml-metal/CMakeFiles/ggml-metal.dir/ggml-metal.m.o
[ 13%] Building ASM object ggml/src/ggml-metal/CMakeFiles/ggml-metal.dir/__/__/__/autogenerated/ggml-metal-embed.s.o
[ 13%] Built target ggml-blas
[ 13%] Built target ggml-cpu
[ 13%] Linking C shared library libggml-metal.dylib
[ 13%] Built target ggml-metal
[ 14%] Building CXX object ggml/src/CMakeFiles/ggml.dir/ggml-backend-reg.cpp.o
[ 15%] Linking CXX shared library libggml.dylib
[ 15%] Built target ggml
[ 16%] Building CXX object examples/gguf/CMakeFiles/llama-gguf.dir/gguf.cpp.o
[ 16%] Building CXX object examples/gguf-hash/CMakeFiles/llama-gguf-hash.dir/gguf-hash.cpp.o
[ 17%] Building CXX object src/CMakeFiles/llama.dir/llama.cpp.o
[ 18%] Building CXX object src/CMakeFiles/llama.dir/llama-grammar.cpp.o
[ 18%] Building CXX object src/CMakeFiles/llama.dir/llama-vocab.cpp.o
[ 19%] Building CXX object src/CMakeFiles/llama.dir/llama-sampling.cpp.o
[ 19%] Building CXX object src/CMakeFiles/llama.dir/unicode.cpp.o
[ 20%] Building CXX object src/CMakeFiles/llama.dir/unicode-data.cpp.o
[ 20%] Linking CXX executable ../../bin/llama-gguf-hash
[ 21%] Linking CXX executable ../../bin/llama-gguf
[ 21%] Linking CXX shared library libllama.dylib
[ 21%] Built target llama-gguf
[ 21%] Built target llama
[ 21%] Built target llama-gguf-hash
[ 21%] Building CXX object examples/simple/CMakeFiles/llama-simple.dir/simple.cpp.o
[ 21%] Building CXX object examples/simple-chat/CMakeFiles/llama-simple-chat.dir/simple-chat.cpp.o
[ 21%] Building C object tests/CMakeFiles/test-c.dir/test-c.c.o
[ 21%] Building CXX object examples/llava/CMakeFiles/llava.dir/clip.cpp.o
[ 22%] Building CXX object examples/llava/CMakeFiles/llava.dir/llava.cpp.o
[ 22%] Building CXX object examples/run/CMakeFiles/llama-run.dir/run.cpp.o
[ 22%] Building CXX object common/CMakeFiles/common.dir/arg.cpp.o
[ 22%] Building CXX object common/CMakeFiles/common.dir/console.cpp.o
[ 23%] Building CXX object common/CMakeFiles/common.dir/common.cpp.o
[ 24%] Building CXX object examples/quantize-stats/CMakeFiles/llama-quantize-stats.dir/quantize-stats.cpp.o
[ 25%] Linking C executable ../bin/test-c
[ 28%] Building CXX object common/CMakeFiles/common.dir/json-schema-to-grammar.cpp.o
[ 28%] Linking CXX executable ../../bin/llama-simple
[ 28%] Linking CXX executable ../../bin/llama-simple-chat
[ 28%] Built target llava
[ 28%] Building CXX object common/CMakeFiles/common.dir/log.cpp.o
[ 30%] Building CXX object common/CMakeFiles/common.dir/ngram-cache.cpp.o
[ 30%] Linking CXX executable ../../bin/llama-run
[ 30%] Building CXX object common/CMakeFiles/common.dir/sampling.cpp.o
[ 30%] Linking CXX executable ../../bin/llama-quantize-stats
[ 31%] Building CXX object common/CMakeFiles/common.dir/speculative.cpp.o
[ 31%] Linking CXX static library libcommon.a
[ 31%] Linking CXX static library libllava_static.a
[ 32%] Linking CXX shared library libllava_shared.dylib
[ 32%] Built target llama-run
[ 32%] Built target llama-simple
[ 32%] Built target test-c
[ 32%] Built target llama-simple-chat
[ 32%] Built target llama-quantize-stats
[ 32%] Built target llava_static
[ 32%] Built target common
[ 32%] Built target llava_shared
[ 33%] Building CXX object tests/CMakeFiles/test-log.dir/test-log.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-tokenizer-1-bpe.dir/test-tokenizer-1-bpe.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-grammar-integration.dir/test-grammar-integration.cpp.o
[ 34%] Building CXX object tests/CMakeFiles/test-sampling.dir/test-sampling.cpp.o
[ 35%] Building CXX object tests/CMakeFiles/test-grammar-parser.dir/test-grammar-parser.cpp.o
[ 35%] Building CXX object tests/CMakeFiles/test-tokenizer-0.dir/test-tokenizer-0.cpp.o
[ 35%] Building CXX object tests/CMakeFiles/test-chat-template.dir/test-chat-template.cpp.o
[ 36%] Building CXX object tests/CMakeFiles/test-arg-parser.dir/test-arg-parser.cpp.o
[ 36%] Building CXX object tests/CMakeFiles/test-tokenizer-1-spm.dir/test-tokenizer-1-spm.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-llama-grammar.dir/test-llama-grammar.cpp.o
[ 38%] Linking CXX executable ../bin/test-tokenizer-1-bpe
[ 38%] Building CXX object tests/CMakeFiles/test-grammar-parser.dir/get-model.cpp.o
[ 38%] Building CXX object tests/CMakeFiles/test-log.dir/get-model.cpp.o
[ 38%] Building CXX object tests/CMakeFiles/test-sampling.dir/get-model.cpp.o
[ 40%] Building CXX object tests/CMakeFiles/test-grammar-integration.dir/get-model.cpp.o
[ 40%] Linking CXX executable ../bin/test-tokenizer-0
[ 40%] Building CXX object tests/CMakeFiles/test-arg-parser.dir/get-model.cpp.o
[ 41%] Linking CXX executable ../bin/test-tokenizer-1-spm
[ 42%] Building CXX object tests/CMakeFiles/test-chat-template.dir/get-model.cpp.o
[ 43%] Linking CXX executable ../bin/test-log
[ 43%] Building CXX object tests/CMakeFiles/test-llama-grammar.dir/get-model.cpp.o
[ 43%] Linking CXX executable ../bin/test-grammar-integration
[ 44%] Linking CXX executable ../bin/test-grammar-parser
[ 45%] Linking CXX executable ../bin/test-arg-parser
[ 46%] Linking CXX executable ../bin/test-sampling
[ 47%] Linking CXX executable ../bin/test-chat-template
[ 48%] Linking CXX executable ../bin/test-llama-grammar
[ 48%] Built target test-tokenizer-1-bpe
[ 48%] Built target test-tokenizer-1-spm
[ 48%] Built target test-tokenizer-0
[ 48%] Built target test-grammar-integration
[ 48%] Built target test-sampling
[ 48%] Built target test-log
[ 48%] Building CXX object tests/CMakeFiles/test-backend-ops.dir/test-backend-ops.cpp.o
[ 48%] Built target test-grammar-parser
[ 49%] Building CXX object tests/CMakeFiles/test-backend-ops.dir/get-model.cpp.o
[ 49%] Building CXX object tests/CMakeFiles/test-autorelease.dir/test-autorelease.cpp.o
[ 49%] Built target test-chat-template
[ 49%] Built target test-arg-parser
[ 49%] Building CXX object tests/CMakeFiles/test-model-load-cancel.dir/test-model-load-cancel.cpp.o
[ 49%] Built target test-llama-grammar
[ 50%] Building CXX object tests/CMakeFiles/test-autorelease.dir/get-model.cpp.o
[ 51%] Building CXX object tests/CMakeFiles/test-model-load-cancel.dir/get-model.cpp.o
[ 52%] Building CXX object tests/CMakeFiles/test-barrier.dir/test-barrier.cpp.o
[ 53%] Building CXX object tests/CMakeFiles/test-quantize-fns.dir/test-quantize-fns.cpp.o
[ 53%] Building CXX object tests/CMakeFiles/test-barrier.dir/get-model.cpp.o
[ 53%] Linking CXX executable ../bin/test-backend-ops
[ 53%] Building CXX object tests/CMakeFiles/test-quantize-perf.dir/test-quantize-perf.cpp.o
[ 53%] Building CXX object tests/CMakeFiles/test-quantize-fns.dir/get-model.cpp.o
[ 53%] Linking CXX executable ../bin/test-model-load-cancel
[ 54%] Linking CXX executable ../bin/test-autorelease
[ 55%] Building CXX object tests/CMakeFiles/test-rope.dir/test-rope.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-rope.dir/get-model.cpp.o
[ 56%] Building CXX object tests/CMakeFiles/test-json-schema-to-grammar.dir/test-json-schema-to-grammar.cpp.o
[ 57%] Linking CXX executable ../bin/test-barrier
[ 58%] Building CXX object tests/CMakeFiles/test-quantize-perf.dir/get-model.cpp.o
[ 59%] Linking CXX executable ../bin/test-quantize-fns
[ 60%] Building CXX object tests/CMakeFiles/test-json-schema-to-grammar.dir/get-model.cpp.o
[ 60%] Linking CXX executable ../bin/test-rope
[ 60%] Linking CXX executable ../bin/test-quantize-perf
[ 61%] Building CXX object examples/batched-bench/CMakeFiles/llama-batched-bench.dir/batched-bench.cpp.o
[ 61%] Built target test-backend-ops
[ 61%] Built target test-autorelease
[ 61%] Built target test-barrier
[ 61%] Built target test-model-load-cancel
[ 62%] Building CXX object examples/batched/CMakeFiles/llama-batched.dir/batched.cpp.o
[ 62%] Linking CXX executable ../bin/test-json-schema-to-grammar
[ 62%] Built target test-quantize-fns
[ 62%] Linking CXX executable ../../bin/llama-batched-bench
[ 62%] Built target test-rope
[ 62%] Built target test-quantize-perf
[ 62%] Linking CXX executable ../../bin/llama-batched
[ 62%] Building CXX object examples/embedding/CMakeFiles/llama-embedding.dir/embedding.cpp.o
[ 63%] Building CXX object examples/eval-callback/CMakeFiles/llama-eval-callback.dir/eval-callback.cpp.o
[ 63%] Building CXX object examples/gguf-split/CMakeFiles/llama-gguf-split.dir/gguf-split.cpp.o
[ 63%] Building CXX object examples/gbnf-validator/CMakeFiles/llama-gbnf-validator.dir/gbnf-validator.cpp.o
[ 64%] Building CXX object examples/gritlm/CMakeFiles/llama-gritlm.dir/gritlm.cpp.o
[ 65%] Building CXX object examples/imatrix/CMakeFiles/llama-imatrix.dir/imatrix.cpp.o
[ 66%] Linking CXX executable ../../bin/llama-eval-callback
[ 66%] Linking CXX executable ../../bin/llama-gguf-split
[ 67%] Building CXX object examples/infill/CMakeFiles/llama-infill.dir/infill.cpp.o
[ 67%] Built target test-json-schema-to-grammar
[ 68%] Linking CXX executable ../../bin/llama-embedding
[ 69%] Linking CXX executable ../../bin/llama-gbnf-validator
[ 69%] Linking CXX executable ../../bin/llama-gritlm
[ 69%] Built target llama-batched
[ 69%] Linking CXX executable ../../bin/llama-imatrix
[ 69%] Built target llama-batched-bench
[ 69%] Linking CXX executable ../../bin/llama-infill
[ 70%] Building CXX object examples/llama-bench/CMakeFiles/llama-bench.dir/llama-bench.cpp.o
[ 70%] Built target llama-gguf-split
[ 70%] Building CXX object examples/lookup/CMakeFiles/llama-lookup.dir/lookup.cpp.o
[ 70%] Building CXX object examples/lookahead/CMakeFiles/llama-lookahead.dir/lookahead.cpp.o
[ 70%] Built target llama-embedding
[ 70%] Built target llama-gbnf-validator
[ 70%] Built target llama-eval-callback
[ 70%] Linking CXX executable ../../bin/llama-bench
[ 70%] Built target llama-gritlm
[ 70%] Built target llama-infill
[ 70%] Built target llama-imatrix
[ 71%] Linking CXX executable ../../bin/llama-lookup
[ 72%] Linking CXX executable ../../bin/llama-lookahead
[ 72%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-merge.dir/lookup-merge.cpp.o
[ 72%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-create.dir/lookup-create.cpp.o
[ 73%] Building CXX object examples/main/CMakeFiles/llama-cli.dir/main.cpp.o
[ 73%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-stats.dir/lookup-stats.cpp.o
[ 74%] Building CXX object examples/parallel/CMakeFiles/llama-parallel.dir/parallel.cpp.o
[ 75%] Building CXX object examples/passkey/CMakeFiles/llama-passkey.dir/passkey.cpp.o
[ 76%] Linking CXX executable ../../bin/llama-lookup-merge
[ 77%] Linking CXX executable ../../bin/llama-lookup-create
[ 78%] Building CXX object examples/perplexity/CMakeFiles/llama-perplexity.dir/perplexity.cpp.o
[ 79%] Linking CXX executable ../../bin/llama-lookup-stats
[ 79%] Linking CXX executable ../../bin/llama-cli
[ 79%] Built target llama-bench
[ 79%] Linking CXX executable ../../bin/llama-parallel
[ 79%] Built target llama-lookahead
[ 79%] Built target llama-lookup
[ 79%] Linking CXX executable ../../bin/llama-perplexity
[ 79%] Linking CXX executable ../../bin/llama-passkey
[ 79%] Generating loading.html.hpp
[ 80%] Building CXX object examples/quantize/CMakeFiles/llama-quantize.dir/quantize.cpp.o
[ 81%] Building CXX object examples/retrieval/CMakeFiles/llama-retrieval.dir/retrieval.cpp.o
[ 81%] Built target llama-lookup-merge
[ 81%] Built target llama-lookup-create
[ 82%] Generating completion.js.hpp
[ 82%] Built target llama-cli
[ 82%] Built target llama-parallel
[ 82%] Built target llama-lookup-stats
[ 82%] Linking CXX executable ../../bin/llama-quantize
[ 83%] Built target llama-perplexity
[ 83%] Linking CXX executable ../../bin/llama-retrieval
[ 83%] Building CXX object examples/save-load-state/CMakeFiles/llama-save-load-state.dir/save-load-state.cpp.o
[ 84%] Built target llama-passkey
[ 84%] Generating deps_daisyui.min.css.hpp
[ 84%] Building CXX object examples/speculative/CMakeFiles/llama-speculative.dir/speculative.cpp.o
[ 84%] Building CXX object examples/speculative-simple/CMakeFiles/llama-speculative-simple.dir/speculative-simple.cpp.o
[ 84%] Building CXX object examples/tokenize/CMakeFiles/llama-tokenize.dir/tokenize.cpp.o
[ 85%] Building CXX object examples/convert-llama2c-to-ggml/CMakeFiles/llama-convert-llama2c-to-ggml.dir/convert-llama2c-to-ggml.cpp.o
[ 85%] Building CXX object examples/cvector-generator/CMakeFiles/llama-cvector-generator.dir/cvector-generator.cpp.o
[ 85%] Building CXX object examples/export-lora/CMakeFiles/llama-export-lora.dir/export-lora.cpp.o
[ 86%] Linking CXX executable ../../bin/llama-save-load-state
[ 87%] Linking CXX executable ../../bin/llama-speculative
[ 89%] Linking CXX executable ../../bin/llama-tokenize
[ 89%] Linking CXX executable ../../bin/llama-speculative-simple
[ 90%] Linking CXX executable ../../bin/llama-convert-llama2c-to-ggml
[ 90%] Built target llama-quantize
[ 90%] Built target llama-retrieval
[ 91%] Linking CXX executable ../../bin/llama-cvector-generator
[ 91%] Generating deps_markdown-it.js.hpp
[ 92%] Linking CXX executable ../../bin/llama-export-lora
[ 93%] Building CXX object examples/llava/CMakeFiles/llama-llava-cli.dir/llava-cli.cpp.o
[ 93%] Built target llama-save-load-state
[ 93%] Built target llama-speculative
[ 93%] Built target llama-speculative-simple
[ 93%] Built target llama-tokenize
[ 93%] Built target llama-convert-llama2c-to-ggml
[ 93%] Built target llama-cvector-generator
[ 94%] Generating deps_tailwindcss.js.hpp
[ 95%] Generating deps_vue.esm-browser.js.hpp
[ 95%] Generating index.html.hpp
[ 95%] Built target llama-export-lora
[ 96%] Linking CXX executable ../../bin/llama-llava-cli
[ 97%] Building CXX object pocs/vdot/CMakeFiles/llama-vdot.dir/vdot.cpp.o
[ 97%] Building CXX object examples/llava/CMakeFiles/llama-minicpmv-cli.dir/minicpmv-cli.cpp.o
[ 98%] Building CXX object pocs/vdot/CMakeFiles/llama-q8dot.dir/q8dot.cpp.o
[ 98%] Linking CXX executable ../../bin/llama-vdot
[ 98%] Linking CXX executable ../../bin/llama-q8dot
[ 99%] Linking CXX executable ../../bin/llama-minicpmv-cli
[ 99%] Built target llama-llava-cli
[ 99%] Built target llama-q8dot
[ 99%] Built target llama-minicpmv-cli
[ 99%] Built target llama-vdot
[ 99%] Building CXX object examples/server/CMakeFiles/llama-server.dir/server.cpp.o
[100%] Linking CXX executable ../../bin/llama-server
[100%] Built target llama-server

real	0m2.613s
user	0m5.719s
sys	0m8.782s

main: quantize time =  3603.49 ms
main:    total time =  3603.49 ms

main: quantize time =  1721.56 ms
main:    total time =  1721.56 ms

main: quantize time =  1799.05 ms
main:    total time =  1799.05 ms

main: quantize time =  2187.32 ms
main:    total time =  2187.32 ms

main: quantize time =  2954.81 ms
main:    total time =  2954.81 ms

main: quantize time =  5209.31 ms
main:    total time =  5209.31 ms

main: quantize time =  5821.52 ms
main:    total time =  5821.52 ms

main: quantize time =  6848.49 ms
main:    total time =  6848.49 ms

main: quantize time =  5927.90 ms
main:    total time =  5927.90 ms

main: quantize time =  4541.74 ms
main:    total time =  4541.74 ms
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.194 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.322 I main: llama backend init
0.00.000.344 I main: load the model and apply lora adapter, if any
0.00.030.248 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.042.913 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.042.925 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.042.928 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.042.929 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.042.938 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.042.939 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.042.939 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.042.940 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.042.941 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.042.942 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.042.942 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.042.943 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.042.944 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.042.944 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.042.947 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.042.948 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.042.949 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.051.093 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.053.162 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.059.842 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.059.844 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.059.845 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.059.845 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.059.846 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.059.846 I llama_model_loader: - type  f32:  194 tensors
0.00.059.847 I llama_model_loader: - type  f16:   98 tensors
0.00.088.100 I llm_load_vocab: special tokens cache size = 25
0.00.094.771 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.094.774 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.094.774 I llm_load_print_meta: arch             = gptneox
0.00.094.774 I llm_load_print_meta: vocab type       = BPE
0.00.094.774 I llm_load_print_meta: n_vocab          = 50304
0.00.094.775 I llm_load_print_meta: n_merges         = 50009
0.00.094.775 I llm_load_print_meta: vocab_only       = 0
0.00.094.775 I llm_load_print_meta: n_ctx_train      = 2048
0.00.094.775 I llm_load_print_meta: n_embd           = 2048
0.00.094.775 I llm_load_print_meta: n_layer          = 24
0.00.094.779 I llm_load_print_meta: n_head           = 16
0.00.094.779 I llm_load_print_meta: n_head_kv        = 16
0.00.094.779 I llm_load_print_meta: n_rot            = 32
0.00.094.779 I llm_load_print_meta: n_swa            = 0
0.00.094.782 I llm_load_print_meta: n_embd_head_k    = 128
0.00.094.782 I llm_load_print_meta: n_embd_head_v    = 128
0.00.094.783 I llm_load_print_meta: n_gqa            = 1
0.00.094.783 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.094.784 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.094.784 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.094.786 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.094.786 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.094.786 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.094.786 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.094.787 I llm_load_print_meta: n_ff             = 8192
0.00.094.787 I llm_load_print_meta: n_expert         = 0
0.00.094.787 I llm_load_print_meta: n_expert_used    = 0
0.00.094.787 I llm_load_print_meta: causal attn      = 1
0.00.094.787 I llm_load_print_meta: pooling type     = 0
0.00.094.788 I llm_load_print_meta: rope type        = 2
0.00.094.788 I llm_load_print_meta: rope scaling     = linear
0.00.094.789 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.094.790 I llm_load_print_meta: freq_scale_train = 1
0.00.094.790 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.094.790 I llm_load_print_meta: rope_finetuned   = unknown
0.00.094.790 I llm_load_print_meta: ssm_d_conv       = 0
0.00.094.790 I llm_load_print_meta: ssm_d_inner      = 0
0.00.094.790 I llm_load_print_meta: ssm_d_state      = 0
0.00.094.791 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.094.791 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.094.796 I llm_load_print_meta: model type       = 1.4B
0.00.094.796 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.094.797 I llm_load_print_meta: model params     = 1.41 B
0.00.094.798 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.094.798 I llm_load_print_meta: general.name     = 1.4B
0.00.094.798 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.094.798 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.094.799 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.094.799 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.094.799 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.094.799 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.094.799 I llm_load_print_meta: max token length = 1024
0.00.096.760 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.096.761 I llm_load_tensors: offloading output layer to GPU
0.00.096.761 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.096.773 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.096.774 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.097.679 I llama_new_context_with_model: n_seq_max     = 1
0.00.097.680 I llama_new_context_with_model: n_ctx         = 2048
0.00.097.680 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.097.681 I llama_new_context_with_model: n_batch       = 2048
0.00.097.681 I llama_new_context_with_model: n_ubatch      = 512
0.00.097.681 I llama_new_context_with_model: flash_attn    = 0
0.00.097.682 I llama_new_context_with_model: freq_base     = 10000.0
0.00.097.682 I llama_new_context_with_model: freq_scale    = 1
0.00.097.682 I ggml_metal_init: allocating
0.00.097.689 I ggml_metal_init: found device: Apple M4
0.00.097.692 I ggml_metal_init: picking default device: Apple M4
0.00.098.304 I ggml_metal_init: using embedded metal library
0.00.107.307 I ggml_metal_init: GPU name:   Apple M4
0.00.107.309 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.107.310 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.107.310 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.107.310 I ggml_metal_init: simdgroup reduction   = true
0.00.107.311 I ggml_metal_init: simdgroup matrix mul. = true
0.00.107.311 I ggml_metal_init: has bfloat            = true
0.00.107.311 I ggml_metal_init: use bfloat            = true
0.00.107.311 I ggml_metal_init: hasUnifiedMemory      = true
0.00.107.312 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.147.336 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.147.341 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.147.359 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.148.263 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.148.264 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.148.265 I llama_new_context_with_model: graph nodes  = 967
0.00.148.265 I llama_new_context_with_model: graph splits = 2
0.00.148.302 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.225.649 I main: llama threadpool init, n_threads = 4
0.00.225.684 I 
0.00.225.701 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.225.701 I 
0.00.225.777 I sampler seed: 1234
0.00.225.781 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.225.805 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.225.806 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.225.806 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling depressed, and I've had a hard time getting out of bed. I think the only thing I

0.02.083.931 I llama_perf_sampler_print:    sampling time =       1.27 ms /    71 runs   (    0.02 ms per token, 55861.53 tokens per second)
0.02.083.931 I llama_perf_context_print:        load time =     195.39 ms
0.02.083.934 I llama_perf_context_print: prompt eval time =      37.84 ms /     7 tokens (    5.41 ms per token,   184.96 tokens per second)
0.02.083.935 I llama_perf_context_print:        eval time =    1817.32 ms /    63 runs   (   28.85 ms per token,    34.67 tokens per second)
0.02.083.935 I llama_perf_context_print:       total time =    1858.28 ms /    70 tokens
0.02.084.109 I ggml_metal_free: deallocating

real	0m2.401s
user	0m0.141s
sys	0m0.097s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.050 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.082 I main: llama backend init
0.00.000.090 I main: load the model and apply lora adapter, if any
0.00.009.731 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.025.228 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.025.233 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.025.235 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.025.235 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.025.236 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.025.236 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.025.236 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.025.237 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.025.238 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.025.238 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.025.238 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.025.238 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.025.239 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.025.239 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.025.241 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.025.241 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.025.242 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.029.207 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.030.294 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.034.345 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.034.347 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.034.347 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.034.347 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.034.348 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.034.348 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.034.349 I llama_model_loader: - type  f32:  194 tensors
0.00.034.349 I llama_model_loader: - type q8_0:   98 tensors
0.00.057.708 I llm_load_vocab: special tokens cache size = 25
0.00.064.012 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.064.015 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.064.016 I llm_load_print_meta: arch             = gptneox
0.00.064.016 I llm_load_print_meta: vocab type       = BPE
0.00.064.017 I llm_load_print_meta: n_vocab          = 50304
0.00.064.017 I llm_load_print_meta: n_merges         = 50009
0.00.064.017 I llm_load_print_meta: vocab_only       = 0
0.00.064.019 I llm_load_print_meta: n_ctx_train      = 2048
0.00.064.019 I llm_load_print_meta: n_embd           = 2048
0.00.064.019 I llm_load_print_meta: n_layer          = 24
0.00.064.024 I llm_load_print_meta: n_head           = 16
0.00.064.025 I llm_load_print_meta: n_head_kv        = 16
0.00.064.025 I llm_load_print_meta: n_rot            = 32
0.00.064.025 I llm_load_print_meta: n_swa            = 0
0.00.064.025 I llm_load_print_meta: n_embd_head_k    = 128
0.00.064.025 I llm_load_print_meta: n_embd_head_v    = 128
0.00.064.026 I llm_load_print_meta: n_gqa            = 1
0.00.064.027 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.064.028 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.064.028 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.064.029 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.064.029 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.064.030 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.064.030 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.064.031 I llm_load_print_meta: n_ff             = 8192
0.00.064.031 I llm_load_print_meta: n_expert         = 0
0.00.064.031 I llm_load_print_meta: n_expert_used    = 0
0.00.064.032 I llm_load_print_meta: causal attn      = 1
0.00.064.032 I llm_load_print_meta: pooling type     = 0
0.00.064.034 I llm_load_print_meta: rope type        = 2
0.00.064.035 I llm_load_print_meta: rope scaling     = linear
0.00.064.035 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.064.036 I llm_load_print_meta: freq_scale_train = 1
0.00.064.036 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.064.036 I llm_load_print_meta: rope_finetuned   = unknown
0.00.064.036 I llm_load_print_meta: ssm_d_conv       = 0
0.00.064.036 I llm_load_print_meta: ssm_d_inner      = 0
0.00.064.036 I llm_load_print_meta: ssm_d_state      = 0
0.00.064.036 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.064.037 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.064.045 I llm_load_print_meta: model type       = 1.4B
0.00.064.046 I llm_load_print_meta: model ftype      = Q8_0
0.00.064.046 I llm_load_print_meta: model params     = 1.41 B
0.00.064.047 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.064.047 I llm_load_print_meta: general.name     = 1.4B
0.00.064.047 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.064.047 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.064.047 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.064.047 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.064.048 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.064.048 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.064.048 I llm_load_print_meta: max token length = 1024
0.00.066.180 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.066.180 I llm_load_tensors: offloading output layer to GPU
0.00.066.180 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.066.186 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.066.187 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.067.180 I llama_new_context_with_model: n_seq_max     = 1
0.00.067.181 I llama_new_context_with_model: n_ctx         = 2048
0.00.067.181 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.067.181 I llama_new_context_with_model: n_batch       = 2048
0.00.067.182 I llama_new_context_with_model: n_ubatch      = 512
0.00.067.182 I llama_new_context_with_model: flash_attn    = 0
0.00.067.182 I llama_new_context_with_model: freq_base     = 10000.0
0.00.067.183 I llama_new_context_with_model: freq_scale    = 1
0.00.067.183 I ggml_metal_init: allocating
0.00.067.191 I ggml_metal_init: found device: Apple M4
0.00.067.193 I ggml_metal_init: picking default device: Apple M4
0.00.067.856 I ggml_metal_init: using embedded metal library
0.00.069.964 I ggml_metal_init: GPU name:   Apple M4
0.00.069.966 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.069.966 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.069.966 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.069.967 I ggml_metal_init: simdgroup reduction   = true
0.00.069.967 I ggml_metal_init: simdgroup matrix mul. = true
0.00.069.967 I ggml_metal_init: has bfloat            = true
0.00.069.967 I ggml_metal_init: use bfloat            = true
0.00.069.968 I ggml_metal_init: hasUnifiedMemory      = true
0.00.069.968 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.103.044 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.103.054 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.103.083 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.104.233 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.104.234 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.104.235 I llama_new_context_with_model: graph nodes  = 967
0.00.104.235 I llama_new_context_with_model: graph splits = 2
0.00.104.259 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.359.836 I main: llama threadpool init, n_threads = 4
0.01.359.870 I 
0.01.359.888 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.359.888 I 
0.01.360.117 I sampler seed: 1234
0.01.360.121 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.360.132 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.360.133 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.360.133 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.452.225 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58532.56 tokens per second)
0.02.452.226 I llama_perf_context_print:        load time =    1350.10 ms
0.02.452.227 I llama_perf_context_print: prompt eval time =      33.58 ms /     7 tokens (    4.80 ms per token,   208.48 tokens per second)
0.02.452.227 I llama_perf_context_print:        eval time =    1055.50 ms /    63 runs   (   16.75 ms per token,    59.69 tokens per second)
0.02.452.228 I llama_perf_context_print:       total time =    1092.39 ms /    70 tokens
0.02.452.387 I ggml_metal_free: deallocating

real	0m2.469s
user	0m0.114s
sys	0m0.234s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.045 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.077 I main: llama backend init
0.00.000.083 I main: load the model and apply lora adapter, if any
0.00.017.378 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.034.717 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.034.723 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.034.725 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.034.726 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.034.726 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.034.726 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.034.727 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.034.728 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.034.728 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.034.728 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.034.729 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.034.732 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.034.733 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.034.733 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.034.735 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.034.735 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.034.735 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.039.296 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.040.519 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.044.934 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.044.935 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.044.936 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.044.936 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.044.937 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.044.937 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.044.938 I llama_model_loader: - type  f32:  194 tensors
0.00.044.938 I llama_model_loader: - type q4_0:   97 tensors
0.00.044.938 I llama_model_loader: - type q6_K:    1 tensors
0.00.074.210 I llm_load_vocab: special tokens cache size = 25
0.00.084.532 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.084.537 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.084.537 I llm_load_print_meta: arch             = gptneox
0.00.084.538 I llm_load_print_meta: vocab type       = BPE
0.00.084.538 I llm_load_print_meta: n_vocab          = 50304
0.00.084.538 I llm_load_print_meta: n_merges         = 50009
0.00.084.539 I llm_load_print_meta: vocab_only       = 0
0.00.084.539 I llm_load_print_meta: n_ctx_train      = 2048
0.00.084.539 I llm_load_print_meta: n_embd           = 2048
0.00.084.539 I llm_load_print_meta: n_layer          = 24
0.00.084.544 I llm_load_print_meta: n_head           = 16
0.00.084.545 I llm_load_print_meta: n_head_kv        = 16
0.00.084.545 I llm_load_print_meta: n_rot            = 32
0.00.084.545 I llm_load_print_meta: n_swa            = 0
0.00.084.545 I llm_load_print_meta: n_embd_head_k    = 128
0.00.084.546 I llm_load_print_meta: n_embd_head_v    = 128
0.00.084.547 I llm_load_print_meta: n_gqa            = 1
0.00.084.549 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.084.552 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.084.553 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.084.554 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.084.554 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.084.554 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.084.554 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.084.556 I llm_load_print_meta: n_ff             = 8192
0.00.084.556 I llm_load_print_meta: n_expert         = 0
0.00.084.556 I llm_load_print_meta: n_expert_used    = 0
0.00.084.556 I llm_load_print_meta: causal attn      = 1
0.00.084.557 I llm_load_print_meta: pooling type     = 0
0.00.084.557 I llm_load_print_meta: rope type        = 2
0.00.084.557 I llm_load_print_meta: rope scaling     = linear
0.00.084.558 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.084.558 I llm_load_print_meta: freq_scale_train = 1
0.00.084.558 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.084.559 I llm_load_print_meta: rope_finetuned   = unknown
0.00.084.559 I llm_load_print_meta: ssm_d_conv       = 0
0.00.084.559 I llm_load_print_meta: ssm_d_inner      = 0
0.00.084.560 I llm_load_print_meta: ssm_d_state      = 0
0.00.084.560 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.084.560 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.084.573 I llm_load_print_meta: model type       = 1.4B
0.00.084.574 I llm_load_print_meta: model ftype      = Q4_0
0.00.084.574 I llm_load_print_meta: model params     = 1.41 B
0.00.084.577 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.084.578 I llm_load_print_meta: general.name     = 1.4B
0.00.084.578 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.084.578 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.084.579 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.084.579 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.084.579 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.084.580 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.084.580 I llm_load_print_meta: max token length = 1024
0.00.087.263 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.087.263 I llm_load_tensors: offloading output layer to GPU
0.00.087.264 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.087.274 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.087.275 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.088.701 I llama_new_context_with_model: n_seq_max     = 1
0.00.088.702 I llama_new_context_with_model: n_ctx         = 2048
0.00.088.703 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.088.703 I llama_new_context_with_model: n_batch       = 2048
0.00.088.703 I llama_new_context_with_model: n_ubatch      = 512
0.00.088.704 I llama_new_context_with_model: flash_attn    = 0
0.00.088.704 I llama_new_context_with_model: freq_base     = 10000.0
0.00.088.704 I llama_new_context_with_model: freq_scale    = 1
0.00.088.705 I ggml_metal_init: allocating
0.00.088.713 I ggml_metal_init: found device: Apple M4
0.00.088.716 I ggml_metal_init: picking default device: Apple M4
0.00.089.649 I ggml_metal_init: using embedded metal library
0.00.093.039 I ggml_metal_init: GPU name:   Apple M4
0.00.093.042 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.093.042 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.093.043 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.093.043 I ggml_metal_init: simdgroup reduction   = true
0.00.093.043 I ggml_metal_init: simdgroup matrix mul. = true
0.00.093.043 I ggml_metal_init: has bfloat            = true
0.00.093.044 I ggml_metal_init: use bfloat            = true
0.00.093.044 I ggml_metal_init: hasUnifiedMemory      = true
0.00.093.045 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.128.584 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.128.591 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.128.616 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.129.789 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.129.791 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.129.791 I llama_new_context_with_model: graph nodes  = 967
0.00.129.791 I llama_new_context_with_model: graph splits = 2
0.00.129.818 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.806.022 I main: llama threadpool init, n_threads = 4
0.00.806.097 I 
0.00.806.147 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.806.149 I 
0.00.806.477 I sampler seed: 1234
0.00.806.485 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.806.539 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.806.541 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.806.541 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.496.371 I llama_perf_sampler_print:    sampling time =       1.28 ms /    71 runs   (    0.02 ms per token, 55555.56 tokens per second)
0.01.496.371 I llama_perf_context_print:        load time =     788.63 ms
0.01.496.372 I llama_perf_context_print: prompt eval time =      42.08 ms /     7 tokens (    6.01 ms per token,   166.33 tokens per second)
0.01.496.372 I llama_perf_context_print:        eval time =     644.57 ms /    63 runs   (   10.23 ms per token,    97.74 tokens per second)
0.01.496.373 I llama_perf_context_print:       total time =     690.36 ms /    70 tokens
0.01.496.562 I ggml_metal_free: deallocating

real	0m1.520s
user	0m0.136s
sys	0m0.156s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.042 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.074 I main: llama backend init
0.00.000.080 I main: load the model and apply lora adapter, if any
0.00.011.654 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.023.111 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.023.115 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.023.121 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.023.122 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.023.122 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.023.123 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.023.123 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.023.124 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.023.124 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.023.124 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.023.125 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.023.125 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.023.125 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.023.126 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.023.127 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.023.127 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.023.128 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.028.146 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.029.730 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.035.260 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.035.262 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.035.262 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.035.262 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.035.263 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.035.263 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.035.264 I llama_model_loader: - type  f32:  194 tensors
0.00.035.264 I llama_model_loader: - type q4_1:   97 tensors
0.00.035.264 I llama_model_loader: - type q6_K:    1 tensors
0.00.070.191 I llm_load_vocab: special tokens cache size = 25
0.00.079.066 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.079.069 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.079.070 I llm_load_print_meta: arch             = gptneox
0.00.079.070 I llm_load_print_meta: vocab type       = BPE
0.00.079.070 I llm_load_print_meta: n_vocab          = 50304
0.00.079.071 I llm_load_print_meta: n_merges         = 50009
0.00.079.071 I llm_load_print_meta: vocab_only       = 0
0.00.079.071 I llm_load_print_meta: n_ctx_train      = 2048
0.00.079.071 I llm_load_print_meta: n_embd           = 2048
0.00.079.071 I llm_load_print_meta: n_layer          = 24
0.00.079.074 I llm_load_print_meta: n_head           = 16
0.00.079.075 I llm_load_print_meta: n_head_kv        = 16
0.00.079.075 I llm_load_print_meta: n_rot            = 32
0.00.079.075 I llm_load_print_meta: n_swa            = 0
0.00.079.075 I llm_load_print_meta: n_embd_head_k    = 128
0.00.079.076 I llm_load_print_meta: n_embd_head_v    = 128
0.00.079.076 I llm_load_print_meta: n_gqa            = 1
0.00.079.078 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.079.079 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.079.080 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.079.080 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.079.081 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.079.081 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.079.081 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.079.083 I llm_load_print_meta: n_ff             = 8192
0.00.079.084 I llm_load_print_meta: n_expert         = 0
0.00.079.084 I llm_load_print_meta: n_expert_used    = 0
0.00.079.084 I llm_load_print_meta: causal attn      = 1
0.00.079.084 I llm_load_print_meta: pooling type     = 0
0.00.079.084 I llm_load_print_meta: rope type        = 2
0.00.079.085 I llm_load_print_meta: rope scaling     = linear
0.00.079.085 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.079.085 I llm_load_print_meta: freq_scale_train = 1
0.00.079.086 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.079.086 I llm_load_print_meta: rope_finetuned   = unknown
0.00.079.086 I llm_load_print_meta: ssm_d_conv       = 0
0.00.079.086 I llm_load_print_meta: ssm_d_inner      = 0
0.00.079.087 I llm_load_print_meta: ssm_d_state      = 0
0.00.079.087 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.079.087 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.079.100 I llm_load_print_meta: model type       = 1.4B
0.00.079.100 I llm_load_print_meta: model ftype      = Q4_1
0.00.079.100 I llm_load_print_meta: model params     = 1.41 B
0.00.079.101 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.079.101 I llm_load_print_meta: general.name     = 1.4B
0.00.079.102 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.079.102 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.079.102 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.079.102 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.079.103 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.079.103 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.079.103 I llm_load_print_meta: max token length = 1024
0.00.081.583 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.081.583 I llm_load_tensors: offloading output layer to GPU
0.00.081.584 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.081.594 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.081.596 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.082.864 I llama_new_context_with_model: n_seq_max     = 1
0.00.082.865 I llama_new_context_with_model: n_ctx         = 2048
0.00.082.865 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.082.865 I llama_new_context_with_model: n_batch       = 2048
0.00.082.865 I llama_new_context_with_model: n_ubatch      = 512
0.00.082.866 I llama_new_context_with_model: flash_attn    = 0
0.00.082.866 I llama_new_context_with_model: freq_base     = 10000.0
0.00.082.866 I llama_new_context_with_model: freq_scale    = 1
0.00.082.867 I ggml_metal_init: allocating
0.00.082.870 I ggml_metal_init: found device: Apple M4
0.00.082.873 I ggml_metal_init: picking default device: Apple M4
0.00.083.542 I ggml_metal_init: using embedded metal library
0.00.086.101 I ggml_metal_init: GPU name:   Apple M4
0.00.086.103 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.086.104 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.086.104 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.086.104 I ggml_metal_init: simdgroup reduction   = true
0.00.086.105 I ggml_metal_init: simdgroup matrix mul. = true
0.00.086.105 I ggml_metal_init: has bfloat            = true
0.00.086.105 I ggml_metal_init: use bfloat            = true
0.00.086.105 I ggml_metal_init: hasUnifiedMemory      = true
0.00.086.106 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.115.131 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.115.136 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.115.154 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.116.075 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.116.077 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.116.077 I llama_new_context_with_model: graph nodes  = 967
0.00.116.077 I llama_new_context_with_model: graph splits = 2
0.00.116.089 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.718.238 I main: llama threadpool init, n_threads = 4
0.00.718.312 I 
0.00.718.362 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.718.362 I 
0.00.718.818 I sampler seed: 1234
0.00.718.825 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.718.911 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.718.917 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.718.918 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.449.568 I llama_perf_sampler_print:    sampling time =       1.17 ms /    71 runs   (    0.02 ms per token, 60944.21 tokens per second)
0.01.449.569 I llama_perf_context_print:        load time =     706.57 ms
0.01.449.570 I llama_perf_context_print: prompt eval time =      40.51 ms /     7 tokens (    5.79 ms per token,   172.81 tokens per second)
0.01.449.570 I llama_perf_context_print:        eval time =     687.13 ms /    63 runs   (   10.91 ms per token,    91.69 tokens per second)
0.01.449.571 I llama_perf_context_print:       total time =     731.34 ms /    70 tokens
0.01.449.749 I ggml_metal_free: deallocating

real	0m1.488s
user	0m0.139s
sys	0m0.174s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.070 I main: llama backend init
0.00.000.077 I main: load the model and apply lora adapter, if any
0.00.008.716 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.024.104 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.024.108 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.024.109 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.024.110 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.024.110 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.024.110 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.024.111 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.024.111 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.024.112 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.024.112 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.024.112 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.024.113 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.024.113 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.024.113 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.024.116 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.024.119 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.024.119 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.027.997 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.029.093 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.033.102 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.033.103 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.033.103 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.033.104 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.033.104 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.033.104 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.033.105 I llama_model_loader: - type  f32:  194 tensors
0.00.033.105 I llama_model_loader: - type q5_0:   97 tensors
0.00.033.105 I llama_model_loader: - type q6_K:    1 tensors
0.00.054.371 I llm_load_vocab: special tokens cache size = 25
0.00.060.503 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.060.506 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.060.507 I llm_load_print_meta: arch             = gptneox
0.00.060.507 I llm_load_print_meta: vocab type       = BPE
0.00.060.507 I llm_load_print_meta: n_vocab          = 50304
0.00.060.507 I llm_load_print_meta: n_merges         = 50009
0.00.060.508 I llm_load_print_meta: vocab_only       = 0
0.00.060.508 I llm_load_print_meta: n_ctx_train      = 2048
0.00.060.508 I llm_load_print_meta: n_embd           = 2048
0.00.060.508 I llm_load_print_meta: n_layer          = 24
0.00.060.511 I llm_load_print_meta: n_head           = 16
0.00.060.511 I llm_load_print_meta: n_head_kv        = 16
0.00.060.511 I llm_load_print_meta: n_rot            = 32
0.00.060.512 I llm_load_print_meta: n_swa            = 0
0.00.060.512 I llm_load_print_meta: n_embd_head_k    = 128
0.00.060.512 I llm_load_print_meta: n_embd_head_v    = 128
0.00.060.513 I llm_load_print_meta: n_gqa            = 1
0.00.060.514 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.060.514 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.060.515 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.060.515 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.060.515 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.060.515 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.060.516 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.060.516 I llm_load_print_meta: n_ff             = 8192
0.00.060.517 I llm_load_print_meta: n_expert         = 0
0.00.060.517 I llm_load_print_meta: n_expert_used    = 0
0.00.060.518 I llm_load_print_meta: causal attn      = 1
0.00.060.520 I llm_load_print_meta: pooling type     = 0
0.00.060.520 I llm_load_print_meta: rope type        = 2
0.00.060.520 I llm_load_print_meta: rope scaling     = linear
0.00.060.520 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.060.521 I llm_load_print_meta: freq_scale_train = 1
0.00.060.521 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.060.521 I llm_load_print_meta: rope_finetuned   = unknown
0.00.060.521 I llm_load_print_meta: ssm_d_conv       = 0
0.00.060.522 I llm_load_print_meta: ssm_d_inner      = 0
0.00.060.522 I llm_load_print_meta: ssm_d_state      = 0
0.00.060.522 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.060.522 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.060.534 I llm_load_print_meta: model type       = 1.4B
0.00.060.534 I llm_load_print_meta: model ftype      = Q5_0
0.00.060.534 I llm_load_print_meta: model params     = 1.41 B
0.00.060.535 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.060.535 I llm_load_print_meta: general.name     = 1.4B
0.00.060.535 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.060.535 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.060.535 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.060.537 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.060.537 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.060.537 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.060.537 I llm_load_print_meta: max token length = 1024
0.00.062.566 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.062.566 I llm_load_tensors: offloading output layer to GPU
0.00.062.566 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.062.576 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.062.577 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.063.562 I llama_new_context_with_model: n_seq_max     = 1
0.00.063.563 I llama_new_context_with_model: n_ctx         = 2048
0.00.063.563 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.063.563 I llama_new_context_with_model: n_batch       = 2048
0.00.063.563 I llama_new_context_with_model: n_ubatch      = 512
0.00.063.563 I llama_new_context_with_model: flash_attn    = 0
0.00.063.564 I llama_new_context_with_model: freq_base     = 10000.0
0.00.063.564 I llama_new_context_with_model: freq_scale    = 1
0.00.063.565 I ggml_metal_init: allocating
0.00.063.570 I ggml_metal_init: found device: Apple M4
0.00.063.573 I ggml_metal_init: picking default device: Apple M4
0.00.064.148 I ggml_metal_init: using embedded metal library
0.00.066.096 I ggml_metal_init: GPU name:   Apple M4
0.00.066.098 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.066.098 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.066.099 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.066.099 I ggml_metal_init: simdgroup reduction   = true
0.00.066.099 I ggml_metal_init: simdgroup matrix mul. = true
0.00.066.099 I ggml_metal_init: has bfloat            = true
0.00.066.099 I ggml_metal_init: use bfloat            = true
0.00.066.100 I ggml_metal_init: hasUnifiedMemory      = true
0.00.066.101 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.095.419 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.095.428 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.095.446 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.096.463 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.096.465 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.096.465 I llama_new_context_with_model: graph nodes  = 967
0.00.096.465 I llama_new_context_with_model: graph splits = 2
0.00.096.488 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.872.324 I main: llama threadpool init, n_threads = 4
0.00.872.360 I 
0.00.872.379 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.872.379 I 
0.00.872.619 I sampler seed: 1234
0.00.872.624 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.872.635 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.872.635 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.872.636 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.660.673 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58580.86 tokens per second)
0.01.660.674 I llama_perf_context_print:        load time =     863.60 ms
0.01.660.674 I llama_perf_context_print: prompt eval time =      36.68 ms /     7 tokens (    5.24 ms per token,   190.82 tokens per second)
0.01.660.678 I llama_perf_context_print:        eval time =     748.35 ms /    63 runs   (   11.88 ms per token,    84.18 tokens per second)
0.01.660.679 I llama_perf_context_print:       total time =     788.35 ms /    70 tokens
0.01.660.858 I ggml_metal_free: deallocating

real	0m1.678s
user	0m0.111s
sys	0m0.176s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.072 I main: llama backend init
0.00.000.079 I main: load the model and apply lora adapter, if any
0.00.014.451 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.023.325 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.023.330 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.023.333 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.023.333 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.023.334 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.023.334 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.023.334 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.023.335 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.023.336 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.023.336 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.023.336 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.023.337 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.023.337 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.023.337 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.023.340 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.023.340 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.023.341 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.027.317 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.028.385 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.032.320 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.032.321 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.032.321 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.032.322 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.032.322 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.032.322 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.032.323 I llama_model_loader: - type  f32:  194 tensors
0.00.032.323 I llama_model_loader: - type q5_1:   97 tensors
0.00.032.324 I llama_model_loader: - type q6_K:    1 tensors
0.00.055.145 I llm_load_vocab: special tokens cache size = 25
0.00.061.336 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.061.338 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.061.338 I llm_load_print_meta: arch             = gptneox
0.00.061.339 I llm_load_print_meta: vocab type       = BPE
0.00.061.339 I llm_load_print_meta: n_vocab          = 50304
0.00.061.339 I llm_load_print_meta: n_merges         = 50009
0.00.061.339 I llm_load_print_meta: vocab_only       = 0
0.00.061.339 I llm_load_print_meta: n_ctx_train      = 2048
0.00.061.340 I llm_load_print_meta: n_embd           = 2048
0.00.061.340 I llm_load_print_meta: n_layer          = 24
0.00.061.342 I llm_load_print_meta: n_head           = 16
0.00.061.343 I llm_load_print_meta: n_head_kv        = 16
0.00.061.343 I llm_load_print_meta: n_rot            = 32
0.00.061.343 I llm_load_print_meta: n_swa            = 0
0.00.061.343 I llm_load_print_meta: n_embd_head_k    = 128
0.00.061.344 I llm_load_print_meta: n_embd_head_v    = 128
0.00.061.344 I llm_load_print_meta: n_gqa            = 1
0.00.061.345 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.061.345 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.061.346 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.061.346 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.061.346 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.061.346 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.061.347 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.061.347 I llm_load_print_meta: n_ff             = 8192
0.00.061.348 I llm_load_print_meta: n_expert         = 0
0.00.061.348 I llm_load_print_meta: n_expert_used    = 0
0.00.061.349 I llm_load_print_meta: causal attn      = 1
0.00.061.350 I llm_load_print_meta: pooling type     = 0
0.00.061.351 I llm_load_print_meta: rope type        = 2
0.00.061.351 I llm_load_print_meta: rope scaling     = linear
0.00.061.351 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.061.351 I llm_load_print_meta: freq_scale_train = 1
0.00.061.351 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.061.352 I llm_load_print_meta: rope_finetuned   = unknown
0.00.061.352 I llm_load_print_meta: ssm_d_conv       = 0
0.00.061.352 I llm_load_print_meta: ssm_d_inner      = 0
0.00.061.352 I llm_load_print_meta: ssm_d_state      = 0
0.00.061.352 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.061.352 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.061.364 I llm_load_print_meta: model type       = 1.4B
0.00.061.364 I llm_load_print_meta: model ftype      = Q5_1
0.00.061.364 I llm_load_print_meta: model params     = 1.41 B
0.00.061.365 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.061.365 I llm_load_print_meta: general.name     = 1.4B
0.00.061.365 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.061.365 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.061.365 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.061.366 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.061.366 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.061.366 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.061.366 I llm_load_print_meta: max token length = 1024
0.00.063.473 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.063.473 I llm_load_tensors: offloading output layer to GPU
0.00.063.473 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.063.483 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.063.484 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.064.437 I llama_new_context_with_model: n_seq_max     = 1
0.00.064.438 I llama_new_context_with_model: n_ctx         = 2048
0.00.064.438 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.064.438 I llama_new_context_with_model: n_batch       = 2048
0.00.064.438 I llama_new_context_with_model: n_ubatch      = 512
0.00.064.438 I llama_new_context_with_model: flash_attn    = 0
0.00.064.439 I llama_new_context_with_model: freq_base     = 10000.0
0.00.064.439 I llama_new_context_with_model: freq_scale    = 1
0.00.064.439 I ggml_metal_init: allocating
0.00.064.442 I ggml_metal_init: found device: Apple M4
0.00.064.445 I ggml_metal_init: picking default device: Apple M4
0.00.065.006 I ggml_metal_init: using embedded metal library
0.00.067.026 I ggml_metal_init: GPU name:   Apple M4
0.00.067.028 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.067.028 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.067.029 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.067.029 I ggml_metal_init: simdgroup reduction   = true
0.00.067.030 I ggml_metal_init: simdgroup matrix mul. = true
0.00.067.030 I ggml_metal_init: has bfloat            = true
0.00.067.030 I ggml_metal_init: use bfloat            = true
0.00.067.031 I ggml_metal_init: hasUnifiedMemory      = true
0.00.067.031 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.098.693 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.098.703 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.098.723 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.099.860 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.099.861 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.099.861 I llama_new_context_with_model: graph nodes  = 967
0.00.099.862 I llama_new_context_with_model: graph splits = 2
0.00.099.884 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.024.608 I main: llama threadpool init, n_threads = 4
0.01.024.680 I 
0.01.024.726 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.024.727 I 
0.01.025.314 I sampler seed: 1234
0.01.025.319 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.025.389 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.025.395 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.025.395 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, literature and art.

If one's life is not happy, one can have no other way but

0.01.871.830 I llama_perf_sampler_print:    sampling time =       1.35 ms /    71 runs   (    0.02 ms per token, 52553.66 tokens per second)
0.01.871.831 I llama_perf_context_print:        load time =    1010.15 ms
0.01.871.832 I llama_perf_context_print: prompt eval time =      37.22 ms /     7 tokens (    5.32 ms per token,   188.08 tokens per second)
0.01.871.832 I llama_perf_context_print:        eval time =     806.14 ms /    63 runs   (   12.80 ms per token,    78.15 tokens per second)
0.01.871.833 I llama_perf_context_print:       total time =     847.23 ms /    70 tokens
0.01.872.006 I ggml_metal_free: deallocating

real	0m1.893s
user	0m0.124s
sys	0m0.217s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.074 I main: load the model and apply lora adapter, if any
0.00.015.612 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.021.821 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.021.828 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.021.830 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.021.835 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.021.835 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.021.836 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.021.836 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.021.837 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.021.837 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.021.837 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.021.838 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.021.838 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.021.838 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.021.840 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.021.841 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.021.842 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.021.842 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.026.132 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.027.381 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.031.740 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.031.742 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.031.743 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.031.743 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.031.743 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.031.744 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.031.744 I llama_model_loader: - type  f32:  194 tensors
0.00.031.745 I llama_model_loader: - type q2_K:   49 tensors
0.00.031.745 I llama_model_loader: - type q3_K:   48 tensors
0.00.031.745 I llama_model_loader: - type q6_K:    1 tensors
0.00.059.304 I llm_load_vocab: special tokens cache size = 25
0.00.066.079 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.066.082 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.066.082 I llm_load_print_meta: arch             = gptneox
0.00.066.083 I llm_load_print_meta: vocab type       = BPE
0.00.066.083 I llm_load_print_meta: n_vocab          = 50304
0.00.066.083 I llm_load_print_meta: n_merges         = 50009
0.00.066.083 I llm_load_print_meta: vocab_only       = 0
0.00.066.083 I llm_load_print_meta: n_ctx_train      = 2048
0.00.066.084 I llm_load_print_meta: n_embd           = 2048
0.00.066.086 I llm_load_print_meta: n_layer          = 24
0.00.066.089 I llm_load_print_meta: n_head           = 16
0.00.066.090 I llm_load_print_meta: n_head_kv        = 16
0.00.066.090 I llm_load_print_meta: n_rot            = 32
0.00.066.090 I llm_load_print_meta: n_swa            = 0
0.00.066.090 I llm_load_print_meta: n_embd_head_k    = 128
0.00.066.092 I llm_load_print_meta: n_embd_head_v    = 128
0.00.066.092 I llm_load_print_meta: n_gqa            = 1
0.00.066.093 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.066.093 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.066.094 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.066.094 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.066.094 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.066.095 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.066.095 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.066.095 I llm_load_print_meta: n_ff             = 8192
0.00.066.095 I llm_load_print_meta: n_expert         = 0
0.00.066.096 I llm_load_print_meta: n_expert_used    = 0
0.00.066.096 I llm_load_print_meta: causal attn      = 1
0.00.066.096 I llm_load_print_meta: pooling type     = 0
0.00.066.096 I llm_load_print_meta: rope type        = 2
0.00.066.096 I llm_load_print_meta: rope scaling     = linear
0.00.066.097 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.066.097 I llm_load_print_meta: freq_scale_train = 1
0.00.066.098 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.066.098 I llm_load_print_meta: rope_finetuned   = unknown
0.00.066.098 I llm_load_print_meta: ssm_d_conv       = 0
0.00.066.098 I llm_load_print_meta: ssm_d_inner      = 0
0.00.066.099 I llm_load_print_meta: ssm_d_state      = 0
0.00.066.099 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.066.100 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.066.107 I llm_load_print_meta: model type       = 1.4B
0.00.066.108 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.066.108 I llm_load_print_meta: model params     = 1.41 B
0.00.066.109 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.066.110 I llm_load_print_meta: general.name     = 1.4B
0.00.066.110 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.066.110 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.066.110 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.066.110 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.066.111 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.066.111 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.066.111 I llm_load_print_meta: max token length = 1024
0.00.067.827 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.067.827 I llm_load_tensors: offloading output layer to GPU
0.00.067.827 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.067.832 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.067.833 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.068.781 I llama_new_context_with_model: n_seq_max     = 1
0.00.068.783 I llama_new_context_with_model: n_ctx         = 2048
0.00.068.783 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.068.783 I llama_new_context_with_model: n_batch       = 2048
0.00.068.783 I llama_new_context_with_model: n_ubatch      = 512
0.00.068.784 I llama_new_context_with_model: flash_attn    = 0
0.00.068.784 I llama_new_context_with_model: freq_base     = 10000.0
0.00.068.784 I llama_new_context_with_model: freq_scale    = 1
0.00.068.785 I ggml_metal_init: allocating
0.00.068.791 I ggml_metal_init: found device: Apple M4
0.00.068.793 I ggml_metal_init: picking default device: Apple M4
0.00.069.367 I ggml_metal_init: using embedded metal library
0.00.071.440 I ggml_metal_init: GPU name:   Apple M4
0.00.071.441 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.071.442 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.071.442 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.071.442 I ggml_metal_init: simdgroup reduction   = true
0.00.071.442 I ggml_metal_init: simdgroup matrix mul. = true
0.00.071.442 I ggml_metal_init: has bfloat            = true
0.00.071.443 I ggml_metal_init: use bfloat            = true
0.00.071.443 I ggml_metal_init: hasUnifiedMemory      = true
0.00.071.444 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.110.367 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.110.372 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.110.390 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.111.397 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.111.398 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.111.399 I llama_new_context_with_model: graph nodes  = 967
0.00.111.399 I llama_new_context_with_model: graph splits = 2
0.00.111.420 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.534.593 I main: llama threadpool init, n_threads = 4
0.00.534.633 I 
0.00.534.658 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.534.658 I 
0.00.534.884 I sampler seed: 1234
0.00.534.889 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.534.925 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.534.937 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.534.938 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.220.114 I llama_perf_sampler_print:    sampling time =       1.14 ms /    71 runs   (    0.02 ms per token, 62062.94 tokens per second)
0.01.220.115 I llama_perf_context_print:        load time =     518.98 ms
0.01.220.116 I llama_perf_context_print: prompt eval time =      38.82 ms /     7 tokens (    5.55 ms per token,   180.30 tokens per second)
0.01.220.116 I llama_perf_context_print:        eval time =     643.40 ms /    63 runs   (   10.21 ms per token,    97.92 tokens per second)
0.01.220.117 I llama_perf_context_print:       total time =     685.53 ms /    70 tokens
0.01.220.285 I ggml_metal_free: deallocating

real	0m1.244s
user	0m0.121s
sys	0m0.121s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.044 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.076 I main: llama backend init
0.00.000.082 I main: load the model and apply lora adapter, if any
0.00.008.930 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.759 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.019.764 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.770 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.019.771 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.771 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.019.772 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.019.772 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.019.773 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.019.773 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.019.774 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.019.774 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.019.774 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.019.775 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.019.775 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.019.777 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.019.777 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.019.777 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.761 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.870 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.787 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.788 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.788 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.789 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.789 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.789 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.028.790 I llama_model_loader: - type  f32:  194 tensors
0.00.028.790 I llama_model_loader: - type q3_K:   25 tensors
0.00.028.790 I llama_model_loader: - type q4_K:   71 tensors
0.00.028.791 I llama_model_loader: - type q5_K:    1 tensors
0.00.028.791 I llama_model_loader: - type q6_K:    1 tensors
0.00.049.316 I llm_load_vocab: special tokens cache size = 25
0.00.055.450 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.055.452 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.055.453 I llm_load_print_meta: arch             = gptneox
0.00.055.453 I llm_load_print_meta: vocab type       = BPE
0.00.055.453 I llm_load_print_meta: n_vocab          = 50304
0.00.055.453 I llm_load_print_meta: n_merges         = 50009
0.00.055.454 I llm_load_print_meta: vocab_only       = 0
0.00.055.454 I llm_load_print_meta: n_ctx_train      = 2048
0.00.055.454 I llm_load_print_meta: n_embd           = 2048
0.00.055.454 I llm_load_print_meta: n_layer          = 24
0.00.055.457 I llm_load_print_meta: n_head           = 16
0.00.055.457 I llm_load_print_meta: n_head_kv        = 16
0.00.055.458 I llm_load_print_meta: n_rot            = 32
0.00.055.458 I llm_load_print_meta: n_swa            = 0
0.00.055.458 I llm_load_print_meta: n_embd_head_k    = 128
0.00.055.458 I llm_load_print_meta: n_embd_head_v    = 128
0.00.055.459 I llm_load_print_meta: n_gqa            = 1
0.00.055.459 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.055.461 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.055.462 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.055.462 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.055.463 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.055.464 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.055.464 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.055.464 I llm_load_print_meta: n_ff             = 8192
0.00.055.465 I llm_load_print_meta: n_expert         = 0
0.00.055.465 I llm_load_print_meta: n_expert_used    = 0
0.00.055.465 I llm_load_print_meta: causal attn      = 1
0.00.055.465 I llm_load_print_meta: pooling type     = 0
0.00.055.465 I llm_load_print_meta: rope type        = 2
0.00.055.465 I llm_load_print_meta: rope scaling     = linear
0.00.055.466 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.055.466 I llm_load_print_meta: freq_scale_train = 1
0.00.055.466 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.055.467 I llm_load_print_meta: rope_finetuned   = unknown
0.00.055.467 I llm_load_print_meta: ssm_d_conv       = 0
0.00.055.467 I llm_load_print_meta: ssm_d_inner      = 0
0.00.055.467 I llm_load_print_meta: ssm_d_state      = 0
0.00.055.467 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.055.467 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.055.475 I llm_load_print_meta: model type       = 1.4B
0.00.055.475 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.055.475 I llm_load_print_meta: model params     = 1.41 B
0.00.055.476 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.055.476 I llm_load_print_meta: general.name     = 1.4B
0.00.055.476 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.055.476 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.055.476 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.055.477 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.055.477 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.055.477 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.055.477 I llm_load_print_meta: max token length = 1024
0.00.057.230 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.057.230 I llm_load_tensors: offloading output layer to GPU
0.00.057.230 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.057.235 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.057.235 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.058.119 I llama_new_context_with_model: n_seq_max     = 1
0.00.058.119 I llama_new_context_with_model: n_ctx         = 2048
0.00.058.120 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.058.120 I llama_new_context_with_model: n_batch       = 2048
0.00.058.120 I llama_new_context_with_model: n_ubatch      = 512
0.00.058.120 I llama_new_context_with_model: flash_attn    = 0
0.00.058.120 I llama_new_context_with_model: freq_base     = 10000.0
0.00.058.121 I llama_new_context_with_model: freq_scale    = 1
0.00.058.121 I ggml_metal_init: allocating
0.00.058.124 I ggml_metal_init: found device: Apple M4
0.00.058.126 I ggml_metal_init: picking default device: Apple M4
0.00.058.658 I ggml_metal_init: using embedded metal library
0.00.060.619 I ggml_metal_init: GPU name:   Apple M4
0.00.060.621 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.060.621 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.060.622 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.060.622 I ggml_metal_init: simdgroup reduction   = true
0.00.060.622 I ggml_metal_init: simdgroup matrix mul. = true
0.00.060.622 I ggml_metal_init: has bfloat            = true
0.00.060.622 I ggml_metal_init: use bfloat            = true
0.00.060.623 I ggml_metal_init: hasUnifiedMemory      = true
0.00.060.625 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.089.175 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.089.180 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.089.199 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.090.293 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.090.294 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.090.295 I llama_new_context_with_model: graph nodes  = 967
0.00.090.295 I llama_new_context_with_model: graph splits = 2
0.00.090.319 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.661.531 I main: llama threadpool init, n_threads = 4
0.00.661.566 I 
0.00.661.583 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.661.583 I 
0.00.661.735 I sampler seed: 1234
0.00.661.739 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.661.768 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.661.768 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.661.768 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do that is most useful to my fellow men?'"

-Albert Einstein

"The way

0.01.412.277 I llama_perf_sampler_print:    sampling time =       1.13 ms /    71 runs   (    0.02 ms per token, 62887.51 tokens per second)
0.01.412.278 I llama_perf_context_print:        load time =     652.60 ms
0.01.412.278 I llama_perf_context_print: prompt eval time =      35.81 ms /     7 tokens (    5.12 ms per token,   195.46 tokens per second)
0.01.412.282 I llama_perf_context_print:        eval time =     711.81 ms /    63 runs   (   11.30 ms per token,    88.51 tokens per second)
0.01.412.283 I llama_perf_context_print:       total time =     750.75 ms /    70 tokens
0.01.412.464 I ggml_metal_free: deallocating

real	0m1.428s
user	0m0.109s
sys	0m0.145s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.042 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.073 I main: llama backend init
0.00.000.080 I main: load the model and apply lora adapter, if any
0.00.014.707 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.033.340 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.033.345 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.033.351 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.033.351 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.033.352 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.033.352 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.033.353 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.033.353 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.033.354 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.033.354 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.033.354 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.033.355 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.033.355 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.033.356 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.033.357 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.033.357 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.033.358 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.038.092 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.039.382 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.044.081 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.044.082 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.044.083 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.044.083 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.044.083 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.044.084 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.044.084 I llama_model_loader: - type  f32:  194 tensors
0.00.044.085 I llama_model_loader: - type q4_K:   61 tensors
0.00.044.085 I llama_model_loader: - type q5_K:   24 tensors
0.00.044.085 I llama_model_loader: - type q6_K:   13 tensors
0.00.075.989 I llm_load_vocab: special tokens cache size = 25
0.00.087.036 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.087.040 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.087.040 I llm_load_print_meta: arch             = gptneox
0.00.087.041 I llm_load_print_meta: vocab type       = BPE
0.00.087.041 I llm_load_print_meta: n_vocab          = 50304
0.00.087.041 I llm_load_print_meta: n_merges         = 50009
0.00.087.041 I llm_load_print_meta: vocab_only       = 0
0.00.087.042 I llm_load_print_meta: n_ctx_train      = 2048
0.00.087.042 I llm_load_print_meta: n_embd           = 2048
0.00.087.042 I llm_load_print_meta: n_layer          = 24
0.00.087.045 I llm_load_print_meta: n_head           = 16
0.00.087.047 I llm_load_print_meta: n_head_kv        = 16
0.00.087.047 I llm_load_print_meta: n_rot            = 32
0.00.087.047 I llm_load_print_meta: n_swa            = 0
0.00.087.047 I llm_load_print_meta: n_embd_head_k    = 128
0.00.087.048 I llm_load_print_meta: n_embd_head_v    = 128
0.00.087.049 I llm_load_print_meta: n_gqa            = 1
0.00.087.050 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.087.050 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.087.051 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.087.052 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.087.052 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.087.052 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.087.052 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.087.053 I llm_load_print_meta: n_ff             = 8192
0.00.087.054 I llm_load_print_meta: n_expert         = 0
0.00.087.054 I llm_load_print_meta: n_expert_used    = 0
0.00.087.054 I llm_load_print_meta: causal attn      = 1
0.00.087.054 I llm_load_print_meta: pooling type     = 0
0.00.087.057 I llm_load_print_meta: rope type        = 2
0.00.087.058 I llm_load_print_meta: rope scaling     = linear
0.00.087.058 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.087.059 I llm_load_print_meta: freq_scale_train = 1
0.00.087.061 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.087.061 I llm_load_print_meta: rope_finetuned   = unknown
0.00.087.061 I llm_load_print_meta: ssm_d_conv       = 0
0.00.087.061 I llm_load_print_meta: ssm_d_inner      = 0
0.00.087.062 I llm_load_print_meta: ssm_d_state      = 0
0.00.087.062 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.087.062 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.087.074 I llm_load_print_meta: model type       = 1.4B
0.00.087.074 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.087.075 I llm_load_print_meta: model params     = 1.41 B
0.00.087.076 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.087.076 I llm_load_print_meta: general.name     = 1.4B
0.00.087.076 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.087.077 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.087.077 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.087.077 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.087.078 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.087.078 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.087.078 I llm_load_print_meta: max token length = 1024
0.00.089.295 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.089.296 I llm_load_tensors: offloading output layer to GPU
0.00.089.296 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.089.306 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.089.308 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.090.550 I llama_new_context_with_model: n_seq_max     = 1
0.00.090.551 I llama_new_context_with_model: n_ctx         = 2048
0.00.090.551 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.090.552 I llama_new_context_with_model: n_batch       = 2048
0.00.090.552 I llama_new_context_with_model: n_ubatch      = 512
0.00.090.552 I llama_new_context_with_model: flash_attn    = 0
0.00.090.553 I llama_new_context_with_model: freq_base     = 10000.0
0.00.090.553 I llama_new_context_with_model: freq_scale    = 1
0.00.090.554 I ggml_metal_init: allocating
0.00.090.558 I ggml_metal_init: found device: Apple M4
0.00.090.561 I ggml_metal_init: picking default device: Apple M4
0.00.091.318 I ggml_metal_init: using embedded metal library
0.00.094.353 I ggml_metal_init: GPU name:   Apple M4
0.00.094.356 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.094.356 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.094.357 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.094.357 I ggml_metal_init: simdgroup reduction   = true
0.00.094.357 I ggml_metal_init: simdgroup matrix mul. = true
0.00.094.357 I ggml_metal_init: has bfloat            = true
0.00.094.357 I ggml_metal_init: use bfloat            = true
0.00.094.358 I ggml_metal_init: hasUnifiedMemory      = true
0.00.094.360 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.126.411 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.126.419 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.126.438 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.127.392 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.127.393 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.127.394 I llama_new_context_with_model: graph nodes  = 967
0.00.127.394 I llama_new_context_with_model: graph splits = 2
0.00.127.415 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.719.096 I main: llama threadpool init, n_threads = 4
0.00.719.143 I 
0.00.719.166 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.719.166 I 
0.00.719.467 I sampler seed: 1234
0.00.719.472 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.719.498 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.719.500 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.719.500 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the greatest power to create the future we want to see. I believe that we are in a wonderful time when people from all over the world are coming together to create a better world. I believe that we are going

0.01.481.525 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58872.31 tokens per second)
0.01.481.526 I llama_perf_context_print:        load time =     704.38 ms
0.01.481.526 I llama_perf_context_print: prompt eval time =      42.21 ms /     7 tokens (    6.03 ms per token,   165.84 tokens per second)
0.01.481.527 I llama_perf_context_print:        eval time =     716.83 ms /    63 runs   (   11.38 ms per token,    87.89 tokens per second)
0.01.481.527 I llama_perf_context_print:       total time =     762.43 ms /    70 tokens
0.01.481.703 I ggml_metal_free: deallocating

real	0m1.508s
user	0m0.135s
sys	0m0.169s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.074 I main: load the model and apply lora adapter, if any
0.00.012.053 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.028.468 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.028.473 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.028.479 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.028.480 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.028.480 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.028.482 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.028.482 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.028.483 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.028.484 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.028.484 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.028.484 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.028.484 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.028.485 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.028.485 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.028.486 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.028.487 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.028.487 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.033.051 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.034.451 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.039.510 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.039.512 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.039.512 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.039.513 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.039.513 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.039.513 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.039.514 I llama_model_loader: - type  f32:  194 tensors
0.00.039.514 I llama_model_loader: - type q5_K:   61 tensors
0.00.039.515 I llama_model_loader: - type q6_K:   37 tensors
0.00.071.623 I llm_load_vocab: special tokens cache size = 25
0.00.082.120 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.082.123 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.082.124 I llm_load_print_meta: arch             = gptneox
0.00.082.124 I llm_load_print_meta: vocab type       = BPE
0.00.082.125 I llm_load_print_meta: n_vocab          = 50304
0.00.082.125 I llm_load_print_meta: n_merges         = 50009
0.00.082.125 I llm_load_print_meta: vocab_only       = 0
0.00.082.125 I llm_load_print_meta: n_ctx_train      = 2048
0.00.082.126 I llm_load_print_meta: n_embd           = 2048
0.00.082.126 I llm_load_print_meta: n_layer          = 24
0.00.082.129 I llm_load_print_meta: n_head           = 16
0.00.082.130 I llm_load_print_meta: n_head_kv        = 16
0.00.082.130 I llm_load_print_meta: n_rot            = 32
0.00.082.130 I llm_load_print_meta: n_swa            = 0
0.00.082.130 I llm_load_print_meta: n_embd_head_k    = 128
0.00.082.131 I llm_load_print_meta: n_embd_head_v    = 128
0.00.082.134 I llm_load_print_meta: n_gqa            = 1
0.00.082.135 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.082.136 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.082.136 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.082.138 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.082.138 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.082.139 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.082.139 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.082.139 I llm_load_print_meta: n_ff             = 8192
0.00.082.140 I llm_load_print_meta: n_expert         = 0
0.00.082.140 I llm_load_print_meta: n_expert_used    = 0
0.00.082.140 I llm_load_print_meta: causal attn      = 1
0.00.082.140 I llm_load_print_meta: pooling type     = 0
0.00.082.140 I llm_load_print_meta: rope type        = 2
0.00.082.141 I llm_load_print_meta: rope scaling     = linear
0.00.082.143 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.082.143 I llm_load_print_meta: freq_scale_train = 1
0.00.082.143 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.082.144 I llm_load_print_meta: rope_finetuned   = unknown
0.00.082.144 I llm_load_print_meta: ssm_d_conv       = 0
0.00.082.144 I llm_load_print_meta: ssm_d_inner      = 0
0.00.082.144 I llm_load_print_meta: ssm_d_state      = 0
0.00.082.144 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.082.145 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.082.157 I llm_load_print_meta: model type       = 1.4B
0.00.082.158 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.082.158 I llm_load_print_meta: model params     = 1.41 B
0.00.082.159 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.082.161 I llm_load_print_meta: general.name     = 1.4B
0.00.082.162 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.082.162 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.082.162 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.082.162 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.082.163 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.082.163 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.082.163 I llm_load_print_meta: max token length = 1024
0.00.084.844 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.084.844 I llm_load_tensors: offloading output layer to GPU
0.00.084.844 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.084.855 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.084.856 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.086.267 I llama_new_context_with_model: n_seq_max     = 1
0.00.086.269 I llama_new_context_with_model: n_ctx         = 2048
0.00.086.269 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.086.269 I llama_new_context_with_model: n_batch       = 2048
0.00.086.270 I llama_new_context_with_model: n_ubatch      = 512
0.00.086.270 I llama_new_context_with_model: flash_attn    = 0
0.00.086.271 I llama_new_context_with_model: freq_base     = 10000.0
0.00.086.271 I llama_new_context_with_model: freq_scale    = 1
0.00.086.272 I ggml_metal_init: allocating
0.00.086.280 I ggml_metal_init: found device: Apple M4
0.00.086.283 I ggml_metal_init: picking default device: Apple M4
0.00.087.041 I ggml_metal_init: using embedded metal library
0.00.090.034 I ggml_metal_init: GPU name:   Apple M4
0.00.090.036 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.090.037 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.090.037 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.090.038 I ggml_metal_init: simdgroup reduction   = true
0.00.090.038 I ggml_metal_init: simdgroup matrix mul. = true
0.00.090.038 I ggml_metal_init: has bfloat            = true
0.00.090.038 I ggml_metal_init: use bfloat            = true
0.00.090.039 I ggml_metal_init: hasUnifiedMemory      = true
0.00.090.039 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.123.277 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.123.286 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.123.309 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.124.180 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.124.181 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.124.182 I llama_new_context_with_model: graph nodes  = 967
0.00.124.182 I llama_new_context_with_model: graph splits = 2
0.00.124.194 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.878.998 I main: llama threadpool init, n_threads = 4
0.00.879.073 I 
0.00.879.106 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.879.106 I 
0.00.879.409 I sampler seed: 1234
0.00.879.415 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.879.437 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.879.438 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.879.438 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.722.577 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59463.99 tokens per second)
0.01.722.578 I llama_perf_context_print:        load time =     866.94 ms
0.01.722.579 I llama_perf_context_print: prompt eval time =      38.80 ms /     7 tokens (    5.54 ms per token,   180.39 tokens per second)
0.01.722.579 I llama_perf_context_print:        eval time =     801.39 ms /    63 runs   (   12.72 ms per token,    78.61 tokens per second)
0.01.722.580 I llama_perf_context_print:       total time =     843.58 ms /    70 tokens
0.01.722.753 I ggml_metal_free: deallocating

real	0m1.755s
user	0m0.136s
sys	0m0.185s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.042 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.072 I main: llama backend init
0.00.000.079 I main: load the model and apply lora adapter, if any
0.00.014.849 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.028.855 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.028.859 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.028.866 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.028.867 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.028.867 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.028.867 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.028.868 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.028.868 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.028.869 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.028.869 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.028.869 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.028.870 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.028.870 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.028.870 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.028.872 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.028.872 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.028.872 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.033.523 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.034.761 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.039.290 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.039.292 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.039.292 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.039.292 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.039.293 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.039.293 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.039.293 I llama_model_loader: - type  f32:  194 tensors
0.00.039.294 I llama_model_loader: - type q6_K:   98 tensors
0.00.068.028 I llm_load_vocab: special tokens cache size = 25
0.00.076.445 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.076.448 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.076.448 I llm_load_print_meta: arch             = gptneox
0.00.076.448 I llm_load_print_meta: vocab type       = BPE
0.00.076.449 I llm_load_print_meta: n_vocab          = 50304
0.00.076.449 I llm_load_print_meta: n_merges         = 50009
0.00.076.449 I llm_load_print_meta: vocab_only       = 0
0.00.076.449 I llm_load_print_meta: n_ctx_train      = 2048
0.00.076.450 I llm_load_print_meta: n_embd           = 2048
0.00.076.450 I llm_load_print_meta: n_layer          = 24
0.00.076.453 I llm_load_print_meta: n_head           = 16
0.00.076.454 I llm_load_print_meta: n_head_kv        = 16
0.00.076.454 I llm_load_print_meta: n_rot            = 32
0.00.076.454 I llm_load_print_meta: n_swa            = 0
0.00.076.454 I llm_load_print_meta: n_embd_head_k    = 128
0.00.076.454 I llm_load_print_meta: n_embd_head_v    = 128
0.00.076.455 I llm_load_print_meta: n_gqa            = 1
0.00.076.456 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.076.457 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.076.457 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.076.458 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.076.458 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.076.458 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.076.458 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.076.459 I llm_load_print_meta: n_ff             = 8192
0.00.076.459 I llm_load_print_meta: n_expert         = 0
0.00.076.459 I llm_load_print_meta: n_expert_used    = 0
0.00.076.460 I llm_load_print_meta: causal attn      = 1
0.00.076.460 I llm_load_print_meta: pooling type     = 0
0.00.076.460 I llm_load_print_meta: rope type        = 2
0.00.076.460 I llm_load_print_meta: rope scaling     = linear
0.00.076.461 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.076.461 I llm_load_print_meta: freq_scale_train = 1
0.00.076.461 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.076.461 I llm_load_print_meta: rope_finetuned   = unknown
0.00.076.462 I llm_load_print_meta: ssm_d_conv       = 0
0.00.076.462 I llm_load_print_meta: ssm_d_inner      = 0
0.00.076.462 I llm_load_print_meta: ssm_d_state      = 0
0.00.076.462 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.076.462 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.076.469 I llm_load_print_meta: model type       = 1.4B
0.00.076.469 I llm_load_print_meta: model ftype      = Q6_K
0.00.076.469 I llm_load_print_meta: model params     = 1.41 B
0.00.076.470 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.076.470 I llm_load_print_meta: general.name     = 1.4B
0.00.076.470 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.076.471 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.076.471 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.076.471 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.076.471 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.076.472 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.076.472 I llm_load_print_meta: max token length = 1024
0.00.078.357 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.078.357 I llm_load_tensors: offloading output layer to GPU
0.00.078.358 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.078.362 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.078.363 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.079.448 I llama_new_context_with_model: n_seq_max     = 1
0.00.079.449 I llama_new_context_with_model: n_ctx         = 2048
0.00.079.450 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.079.450 I llama_new_context_with_model: n_batch       = 2048
0.00.079.450 I llama_new_context_with_model: n_ubatch      = 512
0.00.079.450 I llama_new_context_with_model: flash_attn    = 0
0.00.079.451 I llama_new_context_with_model: freq_base     = 10000.0
0.00.079.451 I llama_new_context_with_model: freq_scale    = 1
0.00.079.451 I ggml_metal_init: allocating
0.00.079.455 I ggml_metal_init: found device: Apple M4
0.00.079.458 I ggml_metal_init: picking default device: Apple M4
0.00.080.161 I ggml_metal_init: using embedded metal library
0.00.082.956 I ggml_metal_init: GPU name:   Apple M4
0.00.082.959 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.082.959 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.082.960 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.082.960 I ggml_metal_init: simdgroup reduction   = true
0.00.082.960 I ggml_metal_init: simdgroup matrix mul. = true
0.00.082.960 I ggml_metal_init: has bfloat            = true
0.00.082.960 I ggml_metal_init: use bfloat            = true
0.00.082.961 I ggml_metal_init: hasUnifiedMemory      = true
0.00.082.962 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.114.259 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.114.265 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.114.284 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.115.169 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.115.170 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.115.171 I llama_new_context_with_model: graph nodes  = 967
0.00.115.171 I llama_new_context_with_model: graph splits = 2
0.00.115.192 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.921.596 I main: llama threadpool init, n_threads = 4
0.00.921.632 I 
0.00.921.654 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.921.655 I 
0.00.921.806 I sampler seed: 1234
0.00.921.810 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.921.834 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.921.835 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.921.835 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.01.802.930 I llama_perf_sampler_print:    sampling time =       1.14 ms /    71 runs   (    0.02 ms per token, 62117.24 tokens per second)
0.01.802.931 I llama_perf_context_print:        load time =     906.74 ms
0.01.802.932 I llama_perf_context_print: prompt eval time =      38.40 ms /     7 tokens (    5.49 ms per token,   182.29 tokens per second)
0.01.802.932 I llama_perf_context_print:        eval time =     839.86 ms /    63 runs   (   13.33 ms per token,    75.01 tokens per second)
0.01.802.933 I llama_perf_context_print:       total time =     881.34 ms /    70 tokens
0.01.803.110 I ggml_metal_free: deallocating

real	0m1.827s
user	0m0.125s
sys	0m0.175s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.897 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.025.201 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.036.816 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.036.831 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.036.835 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.036.836 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.036.837 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.036.837 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.036.838 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.036.839 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.036.840 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.036.840 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.036.841 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.036.841 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.036.842 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.036.843 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.036.847 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.036.851 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.036.852 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.043.937 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.181 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.055.298 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.055.304 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.055.305 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.055.305 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.055.306 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.055.307 I llama_model_loader: - type  f32:  194 tensors
0.00.055.308 I llama_model_loader: - type  f16:   98 tensors
0.00.090.161 I llm_load_vocab: special tokens cache size = 25
0.00.097.557 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.097.561 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.097.562 I llm_load_print_meta: arch             = gptneox
0.00.097.562 I llm_load_print_meta: vocab type       = BPE
0.00.097.562 I llm_load_print_meta: n_vocab          = 50304
0.00.097.567 I llm_load_print_meta: n_merges         = 50009
0.00.097.568 I llm_load_print_meta: vocab_only       = 0
0.00.097.568 I llm_load_print_meta: n_ctx_train      = 2048
0.00.097.568 I llm_load_print_meta: n_embd           = 2048
0.00.097.568 I llm_load_print_meta: n_layer          = 24
0.00.097.571 I llm_load_print_meta: n_head           = 16
0.00.097.572 I llm_load_print_meta: n_head_kv        = 16
0.00.097.572 I llm_load_print_meta: n_rot            = 32
0.00.097.574 I llm_load_print_meta: n_swa            = 0
0.00.097.574 I llm_load_print_meta: n_embd_head_k    = 128
0.00.097.574 I llm_load_print_meta: n_embd_head_v    = 128
0.00.097.575 I llm_load_print_meta: n_gqa            = 1
0.00.097.576 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.097.576 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.097.577 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.097.577 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.097.577 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.097.577 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.097.577 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.097.578 I llm_load_print_meta: n_ff             = 8192
0.00.097.578 I llm_load_print_meta: n_expert         = 0
0.00.097.578 I llm_load_print_meta: n_expert_used    = 0
0.00.097.579 I llm_load_print_meta: causal attn      = 1
0.00.097.579 I llm_load_print_meta: pooling type     = 0
0.00.097.579 I llm_load_print_meta: rope type        = 2
0.00.097.579 I llm_load_print_meta: rope scaling     = linear
0.00.097.581 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.097.581 I llm_load_print_meta: freq_scale_train = 1
0.00.097.581 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.097.581 I llm_load_print_meta: rope_finetuned   = unknown
0.00.097.581 I llm_load_print_meta: ssm_d_conv       = 0
0.00.097.581 I llm_load_print_meta: ssm_d_inner      = 0
0.00.097.582 I llm_load_print_meta: ssm_d_state      = 0
0.00.097.583 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.097.583 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.097.595 I llm_load_print_meta: model type       = 1.4B
0.00.097.596 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.097.596 I llm_load_print_meta: model params     = 1.41 B
0.00.097.597 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.097.597 I llm_load_print_meta: general.name     = 1.4B
0.00.097.597 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.097.597 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.097.597 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.097.598 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.097.599 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.097.599 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.097.599 I llm_load_print_meta: max token length = 1024
0.00.100.249 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.100.250 I llm_load_tensors: offloading output layer to GPU
0.00.100.250 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.100.260 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.100.261 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.101.233 I llama_new_context_with_model: n_seq_max     = 1
0.00.101.234 I llama_new_context_with_model: n_ctx         = 128
0.00.101.234 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.101.234 I llama_new_context_with_model: n_batch       = 128
0.00.101.234 I llama_new_context_with_model: n_ubatch      = 128
0.00.101.234 I llama_new_context_with_model: flash_attn    = 0
0.00.101.235 I llama_new_context_with_model: freq_base     = 10000.0
0.00.101.235 I llama_new_context_with_model: freq_scale    = 1
0.00.101.235 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.101.236 I ggml_metal_init: allocating
0.00.101.239 I ggml_metal_init: found device: Apple M4
0.00.101.241 I ggml_metal_init: picking default device: Apple M4
0.00.101.879 I ggml_metal_init: using embedded metal library
0.00.104.163 I ggml_metal_init: GPU name:   Apple M4
0.00.104.165 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.104.165 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.104.166 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.104.166 I ggml_metal_init: simdgroup reduction   = true
0.00.104.166 I ggml_metal_init: simdgroup matrix mul. = true
0.00.104.166 I ggml_metal_init: has bfloat            = true
0.00.104.166 I ggml_metal_init: use bfloat            = true
0.00.104.167 I ggml_metal_init: hasUnifiedMemory      = true
0.00.104.167 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.113.487 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.113.489 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.113.504 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.114.355 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.114.357 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.114.357 I llama_new_context_with_model: graph nodes  = 967
0.00.114.357 I llama_new_context_with_model: graph splits = 2
0.00.114.370 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.827.922 I 
0.00.827.956 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.827.961 I perplexity: tokenizing the input ..
0.00.842.394 I perplexity: tokenization took 14.431 ms
0.00.842.431 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.963.255 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.00.964.881 I Final estimate: PPL = 10.1498 +/- 3.22650

0.00.964.905 I llama_perf_context_print:        load time =     802.71 ms
0.00.964.906 I llama_perf_context_print: prompt eval time =     119.89 ms /   128 tokens (    0.94 ms per token,  1067.66 tokens per second)
0.00.964.908 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.964.909 I llama_perf_context_print:       total time =     136.98 ms /   129 tokens
0.00.965.546 I ggml_metal_free: deallocating

real	0m1.163s
user	0m0.130s
sys	0m0.175s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.115 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.931 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.530 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.018.535 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.537 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.537 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.538 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.538 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.539 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.539 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.542 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.542 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.543 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.543 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.543 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.544 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.547 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.547 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.547 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.583 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.951 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.030.026 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.030.028 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.030.028 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.030.029 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.030.029 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.030.030 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.030.031 I llama_model_loader: - type  f32:  194 tensors
0.00.030.031 I llama_model_loader: - type q8_0:   98 tensors
0.00.052.799 I llm_load_vocab: special tokens cache size = 25
0.00.058.951 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.058.953 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.058.954 I llm_load_print_meta: arch             = gptneox
0.00.058.954 I llm_load_print_meta: vocab type       = BPE
0.00.058.954 I llm_load_print_meta: n_vocab          = 50304
0.00.058.954 I llm_load_print_meta: n_merges         = 50009
0.00.058.955 I llm_load_print_meta: vocab_only       = 0
0.00.058.955 I llm_load_print_meta: n_ctx_train      = 2048
0.00.058.955 I llm_load_print_meta: n_embd           = 2048
0.00.058.955 I llm_load_print_meta: n_layer          = 24
0.00.058.958 I llm_load_print_meta: n_head           = 16
0.00.058.959 I llm_load_print_meta: n_head_kv        = 16
0.00.058.961 I llm_load_print_meta: n_rot            = 32
0.00.058.961 I llm_load_print_meta: n_swa            = 0
0.00.058.961 I llm_load_print_meta: n_embd_head_k    = 128
0.00.058.961 I llm_load_print_meta: n_embd_head_v    = 128
0.00.058.962 I llm_load_print_meta: n_gqa            = 1
0.00.058.963 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.058.964 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.058.964 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.058.965 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.058.965 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.058.965 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.058.965 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.058.966 I llm_load_print_meta: n_ff             = 8192
0.00.058.966 I llm_load_print_meta: n_expert         = 0
0.00.058.967 I llm_load_print_meta: n_expert_used    = 0
0.00.058.967 I llm_load_print_meta: causal attn      = 1
0.00.058.967 I llm_load_print_meta: pooling type     = 0
0.00.058.967 I llm_load_print_meta: rope type        = 2
0.00.058.967 I llm_load_print_meta: rope scaling     = linear
0.00.058.969 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.058.969 I llm_load_print_meta: freq_scale_train = 1
0.00.058.970 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.058.970 I llm_load_print_meta: rope_finetuned   = unknown
0.00.058.970 I llm_load_print_meta: ssm_d_conv       = 0
0.00.058.970 I llm_load_print_meta: ssm_d_inner      = 0
0.00.058.970 I llm_load_print_meta: ssm_d_state      = 0
0.00.058.971 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.058.971 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.058.978 I llm_load_print_meta: model type       = 1.4B
0.00.058.978 I llm_load_print_meta: model ftype      = Q8_0
0.00.058.979 I llm_load_print_meta: model params     = 1.41 B
0.00.058.979 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.058.979 I llm_load_print_meta: general.name     = 1.4B
0.00.058.980 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.058.980 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.058.980 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.058.981 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.058.981 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.058.981 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.058.981 I llm_load_print_meta: max token length = 1024
0.00.060.789 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.060.790 I llm_load_tensors: offloading output layer to GPU
0.00.060.790 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.060.795 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.060.795 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.061.748 I llama_new_context_with_model: n_seq_max     = 1
0.00.061.749 I llama_new_context_with_model: n_ctx         = 128
0.00.061.749 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.061.750 I llama_new_context_with_model: n_batch       = 128
0.00.061.750 I llama_new_context_with_model: n_ubatch      = 128
0.00.061.750 I llama_new_context_with_model: flash_attn    = 0
0.00.061.750 I llama_new_context_with_model: freq_base     = 10000.0
0.00.061.751 I llama_new_context_with_model: freq_scale    = 1
0.00.061.751 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.061.751 I ggml_metal_init: allocating
0.00.061.755 I ggml_metal_init: found device: Apple M4
0.00.061.757 I ggml_metal_init: picking default device: Apple M4
0.00.062.300 I ggml_metal_init: using embedded metal library
0.00.064.210 I ggml_metal_init: GPU name:   Apple M4
0.00.064.211 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.064.211 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.064.212 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.064.212 I ggml_metal_init: simdgroup reduction   = true
0.00.064.212 I ggml_metal_init: simdgroup matrix mul. = true
0.00.064.212 I ggml_metal_init: has bfloat            = true
0.00.064.212 I ggml_metal_init: use bfloat            = true
0.00.064.213 I ggml_metal_init: hasUnifiedMemory      = true
0.00.064.215 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.073.332 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.073.335 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.073.350 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.074.258 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.074.259 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.074.259 I llama_new_context_with_model: graph nodes  = 967
0.00.074.259 I llama_new_context_with_model: graph splits = 2
0.00.074.272 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.860.374 I 
0.00.860.393 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.860.396 I perplexity: tokenizing the input ..
0.00.868.509 I perplexity: tokenization took 8.111 ms
0.00.868.521 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.990.483 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.00.991.634 I Final estimate: PPL = 10.1362 +/- 3.22437

0.00.991.654 I llama_perf_context_print:        load time =     849.44 ms
0.00.991.655 I llama_perf_context_print: prompt eval time =     121.74 ms /   128 tokens (    0.95 ms per token,  1051.46 tokens per second)
0.00.991.656 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.991.657 I llama_perf_context_print:       total time =     131.28 ms /   129 tokens
0.00.992.117 I ggml_metal_free: deallocating

real	0m1.008s
user	0m0.087s
sys	0m0.166s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.095 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.399 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.372 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.016.377 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.378 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.383 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.383 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.383 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.384 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.385 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.385 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.385 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.386 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.386 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.386 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.387 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.388 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.389 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.389 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.218 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.270 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.128 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.129 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.129 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.129 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.130 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.130 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.025.131 I llama_model_loader: - type  f32:  194 tensors
0.00.025.131 I llama_model_loader: - type q4_0:   97 tensors
0.00.025.131 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.423 I llm_load_vocab: special tokens cache size = 25
0.00.051.425 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.428 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.428 I llm_load_print_meta: arch             = gptneox
0.00.051.429 I llm_load_print_meta: vocab type       = BPE
0.00.051.429 I llm_load_print_meta: n_vocab          = 50304
0.00.051.429 I llm_load_print_meta: n_merges         = 50009
0.00.051.429 I llm_load_print_meta: vocab_only       = 0
0.00.051.429 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.430 I llm_load_print_meta: n_embd           = 2048
0.00.051.430 I llm_load_print_meta: n_layer          = 24
0.00.051.433 I llm_load_print_meta: n_head           = 16
0.00.051.434 I llm_load_print_meta: n_head_kv        = 16
0.00.051.434 I llm_load_print_meta: n_rot            = 32
0.00.051.434 I llm_load_print_meta: n_swa            = 0
0.00.051.434 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.434 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.435 I llm_load_print_meta: n_gqa            = 1
0.00.051.436 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.436 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.437 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.438 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.438 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.438 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.438 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.439 I llm_load_print_meta: n_ff             = 8192
0.00.051.439 I llm_load_print_meta: n_expert         = 0
0.00.051.439 I llm_load_print_meta: n_expert_used    = 0
0.00.051.439 I llm_load_print_meta: causal attn      = 1
0.00.051.439 I llm_load_print_meta: pooling type     = 0
0.00.051.442 I llm_load_print_meta: rope type        = 2
0.00.051.442 I llm_load_print_meta: rope scaling     = linear
0.00.051.443 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.443 I llm_load_print_meta: freq_scale_train = 1
0.00.051.443 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.443 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.444 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.444 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.444 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.444 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.444 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.456 I llm_load_print_meta: model type       = 1.4B
0.00.051.456 I llm_load_print_meta: model ftype      = Q4_0
0.00.051.456 I llm_load_print_meta: model params     = 1.41 B
0.00.051.460 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.051.460 I llm_load_print_meta: general.name     = 1.4B
0.00.051.460 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.462 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.462 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.462 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.462 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.462 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.462 I llm_load_print_meta: max token length = 1024
0.00.053.083 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.083 I llm_load_tensors: offloading output layer to GPU
0.00.053.084 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.093 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.053.094 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.053.943 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.943 I llama_new_context_with_model: n_ctx         = 128
0.00.053.943 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.944 I llama_new_context_with_model: n_batch       = 128
0.00.053.944 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.944 I llama_new_context_with_model: flash_attn    = 0
0.00.053.944 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.945 I llama_new_context_with_model: freq_scale    = 1
0.00.053.945 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.945 I ggml_metal_init: allocating
0.00.053.948 I ggml_metal_init: found device: Apple M4
0.00.053.950 I ggml_metal_init: picking default device: Apple M4
0.00.054.491 I ggml_metal_init: using embedded metal library
0.00.056.409 I ggml_metal_init: GPU name:   Apple M4
0.00.056.410 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.411 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.411 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.411 I ggml_metal_init: simdgroup reduction   = true
0.00.056.411 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.411 I ggml_metal_init: has bfloat            = true
0.00.056.412 I ggml_metal_init: use bfloat            = true
0.00.056.412 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.413 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.811 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.813 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.828 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.731 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.732 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.733 I llama_new_context_with_model: graph nodes  = 967
0.00.066.733 I llama_new_context_with_model: graph splits = 2
0.00.066.745 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.596.456 I 
0.00.596.488 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.596.492 I perplexity: tokenizing the input ..
0.00.604.253 I perplexity: tokenization took 7.759 ms
0.00.604.265 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.726.700 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.727.847 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.727.861 I llama_perf_context_print:        load time =     586.05 ms
0.00.727.863 I llama_perf_context_print: prompt eval time =     122.18 ms /   128 tokens (    0.95 ms per token,  1047.63 tokens per second)
0.00.727.864 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.727.864 I llama_perf_context_print:       total time =     131.41 ms /   129 tokens
0.00.728.258 I ggml_metal_free: deallocating

real	0m0.745s
user	0m0.078s
sys	0m0.103s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.095 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.576 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.529 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.015.534 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.535 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.538 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.538 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.538 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.538 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.541 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.541 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.542 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.542 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.543 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.543 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.543 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.545 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.545 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.546 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.349 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.342 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.190 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.191 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.192 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.192 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.192 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.193 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.024.193 I llama_model_loader: - type  f32:  194 tensors
0.00.024.194 I llama_model_loader: - type q4_1:   97 tensors
0.00.024.194 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.571 I llm_load_vocab: special tokens cache size = 25
0.00.051.703 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.706 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.707 I llm_load_print_meta: arch             = gptneox
0.00.051.707 I llm_load_print_meta: vocab type       = BPE
0.00.051.707 I llm_load_print_meta: n_vocab          = 50304
0.00.051.707 I llm_load_print_meta: n_merges         = 50009
0.00.051.708 I llm_load_print_meta: vocab_only       = 0
0.00.051.708 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.708 I llm_load_print_meta: n_embd           = 2048
0.00.051.708 I llm_load_print_meta: n_layer          = 24
0.00.051.711 I llm_load_print_meta: n_head           = 16
0.00.051.712 I llm_load_print_meta: n_head_kv        = 16
0.00.051.712 I llm_load_print_meta: n_rot            = 32
0.00.051.714 I llm_load_print_meta: n_swa            = 0
0.00.051.715 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.715 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.716 I llm_load_print_meta: n_gqa            = 1
0.00.051.716 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.717 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.717 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.718 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.718 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.718 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.718 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.719 I llm_load_print_meta: n_ff             = 8192
0.00.051.720 I llm_load_print_meta: n_expert         = 0
0.00.051.720 I llm_load_print_meta: n_expert_used    = 0
0.00.051.720 I llm_load_print_meta: causal attn      = 1
0.00.051.721 I llm_load_print_meta: pooling type     = 0
0.00.051.722 I llm_load_print_meta: rope type        = 2
0.00.051.722 I llm_load_print_meta: rope scaling     = linear
0.00.051.722 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.722 I llm_load_print_meta: freq_scale_train = 1
0.00.051.723 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.723 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.723 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.723 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.723 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.723 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.723 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.735 I llm_load_print_meta: model type       = 1.4B
0.00.051.735 I llm_load_print_meta: model ftype      = Q4_1
0.00.051.735 I llm_load_print_meta: model params     = 1.41 B
0.00.051.736 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.051.737 I llm_load_print_meta: general.name     = 1.4B
0.00.051.738 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.738 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.739 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.739 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.739 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.739 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.739 I llm_load_print_meta: max token length = 1024
0.00.053.385 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.385 I llm_load_tensors: offloading output layer to GPU
0.00.053.385 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.395 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.053.396 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.054.264 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.264 I llama_new_context_with_model: n_ctx         = 128
0.00.054.265 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.265 I llama_new_context_with_model: n_batch       = 128
0.00.054.265 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.265 I llama_new_context_with_model: flash_attn    = 0
0.00.054.266 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.266 I llama_new_context_with_model: freq_scale    = 1
0.00.054.266 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.266 I ggml_metal_init: allocating
0.00.054.272 I ggml_metal_init: found device: Apple M4
0.00.054.274 I ggml_metal_init: picking default device: Apple M4
0.00.054.808 I ggml_metal_init: using embedded metal library
0.00.056.713 I ggml_metal_init: GPU name:   Apple M4
0.00.056.714 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.715 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.715 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.715 I ggml_metal_init: simdgroup reduction   = true
0.00.056.715 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.715 I ggml_metal_init: has bfloat            = true
0.00.056.716 I ggml_metal_init: use bfloat            = true
0.00.056.716 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.717 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.904 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.906 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.920 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.830 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.831 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.832 I llama_new_context_with_model: graph nodes  = 967
0.00.066.832 I llama_new_context_with_model: graph splits = 2
0.00.066.845 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.631.843 I 
0.00.631.859 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.631.861 I perplexity: tokenizing the input ..
0.00.639.513 I perplexity: tokenization took 7.651 ms
0.00.639.524 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.761.235 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.762.454 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.762.467 I llama_perf_context_print:        load time =     622.26 ms
0.00.762.468 I llama_perf_context_print: prompt eval time =     121.49 ms /   128 tokens (    0.95 ms per token,  1053.58 tokens per second)
0.00.762.468 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.762.469 I llama_perf_context_print:       total time =     130.62 ms /   129 tokens
0.00.762.897 I ggml_metal_free: deallocating

real	0m0.778s
user	0m0.078s
sys	0m0.111s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.100 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.972 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.860 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.014.864 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.866 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.866 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.867 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.867 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.867 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.868 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.868 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.869 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.869 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.869 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.870 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.870 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.871 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.872 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.872 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.765 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.877 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.835 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.836 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.837 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.837 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.837 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.837 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.023.838 I llama_model_loader: - type  f32:  194 tensors
0.00.023.838 I llama_model_loader: - type q5_0:   97 tensors
0.00.023.838 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.488 I llm_load_vocab: special tokens cache size = 25
0.00.050.682 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.684 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.685 I llm_load_print_meta: arch             = gptneox
0.00.050.685 I llm_load_print_meta: vocab type       = BPE
0.00.050.685 I llm_load_print_meta: n_vocab          = 50304
0.00.050.685 I llm_load_print_meta: n_merges         = 50009
0.00.050.685 I llm_load_print_meta: vocab_only       = 0
0.00.050.686 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.686 I llm_load_print_meta: n_embd           = 2048
0.00.050.686 I llm_load_print_meta: n_layer          = 24
0.00.050.689 I llm_load_print_meta: n_head           = 16
0.00.050.689 I llm_load_print_meta: n_head_kv        = 16
0.00.050.690 I llm_load_print_meta: n_rot            = 32
0.00.050.690 I llm_load_print_meta: n_swa            = 0
0.00.050.690 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.690 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.691 I llm_load_print_meta: n_gqa            = 1
0.00.050.692 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.692 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.694 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.695 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.695 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.695 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.695 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.696 I llm_load_print_meta: n_ff             = 8192
0.00.050.696 I llm_load_print_meta: n_expert         = 0
0.00.050.696 I llm_load_print_meta: n_expert_used    = 0
0.00.050.696 I llm_load_print_meta: causal attn      = 1
0.00.050.697 I llm_load_print_meta: pooling type     = 0
0.00.050.699 I llm_load_print_meta: rope type        = 2
0.00.050.699 I llm_load_print_meta: rope scaling     = linear
0.00.050.699 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.700 I llm_load_print_meta: freq_scale_train = 1
0.00.050.700 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.700 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.700 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.700 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.701 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.701 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.701 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.713 I llm_load_print_meta: model type       = 1.4B
0.00.050.713 I llm_load_print_meta: model ftype      = Q5_0
0.00.050.713 I llm_load_print_meta: model params     = 1.41 B
0.00.050.714 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.050.714 I llm_load_print_meta: general.name     = 1.4B
0.00.050.714 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.715 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.715 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.715 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.715 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.715 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.715 I llm_load_print_meta: max token length = 1024
0.00.052.725 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.725 I llm_load_tensors: offloading output layer to GPU
0.00.052.725 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.735 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.052.736 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.053.696 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.697 I llama_new_context_with_model: n_ctx         = 128
0.00.053.697 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.697 I llama_new_context_with_model: n_batch       = 128
0.00.053.697 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.698 I llama_new_context_with_model: flash_attn    = 0
0.00.053.698 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.698 I llama_new_context_with_model: freq_scale    = 1
0.00.053.699 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.699 I ggml_metal_init: allocating
0.00.053.702 I ggml_metal_init: found device: Apple M4
0.00.053.704 I ggml_metal_init: picking default device: Apple M4
0.00.054.247 I ggml_metal_init: using embedded metal library
0.00.056.195 I ggml_metal_init: GPU name:   Apple M4
0.00.056.196 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.197 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.197 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.197 I ggml_metal_init: simdgroup reduction   = true
0.00.056.197 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.198 I ggml_metal_init: has bfloat            = true
0.00.056.198 I ggml_metal_init: use bfloat            = true
0.00.056.198 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.199 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.615 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.618 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.632 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.573 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.575 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.575 I llama_new_context_with_model: graph nodes  = 967
0.00.066.575 I llama_new_context_with_model: graph splits = 2
0.00.066.590 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.729.340 I 
0.00.729.363 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.729.366 I perplexity: tokenizing the input ..
0.00.737.579 I perplexity: tokenization took 8.212 ms
0.00.737.591 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.872.087 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.873.243 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.873.265 I llama_perf_context_print:        load time =     720.37 ms
0.00.873.266 I llama_perf_context_print: prompt eval time =     134.27 ms /   128 tokens (    1.05 ms per token,   953.30 tokens per second)
0.00.873.267 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.873.267 I llama_perf_context_print:       total time =     143.92 ms /   129 tokens
0.00.873.730 I ggml_metal_free: deallocating

real	0m0.886s
user	0m0.078s
sys	0m0.131s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.088 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.706 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.559 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.015.563 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.564 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.565 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.565 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.565 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.566 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.566 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.567 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.569 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.569 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.569 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.570 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.570 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.572 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.572 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.572 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.457 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.507 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.376 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.377 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.377 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.378 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.378 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.378 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.024.379 I llama_model_loader: - type  f32:  194 tensors
0.00.024.379 I llama_model_loader: - type q5_1:   97 tensors
0.00.024.379 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.796 I llm_load_vocab: special tokens cache size = 25
0.00.050.964 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.966 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.967 I llm_load_print_meta: arch             = gptneox
0.00.050.967 I llm_load_print_meta: vocab type       = BPE
0.00.050.967 I llm_load_print_meta: n_vocab          = 50304
0.00.050.968 I llm_load_print_meta: n_merges         = 50009
0.00.050.968 I llm_load_print_meta: vocab_only       = 0
0.00.050.968 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.968 I llm_load_print_meta: n_embd           = 2048
0.00.050.968 I llm_load_print_meta: n_layer          = 24
0.00.050.971 I llm_load_print_meta: n_head           = 16
0.00.050.971 I llm_load_print_meta: n_head_kv        = 16
0.00.050.972 I llm_load_print_meta: n_rot            = 32
0.00.050.974 I llm_load_print_meta: n_swa            = 0
0.00.050.974 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.974 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.975 I llm_load_print_meta: n_gqa            = 1
0.00.050.976 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.976 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.977 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.977 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.977 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.978 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.978 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.978 I llm_load_print_meta: n_ff             = 8192
0.00.050.979 I llm_load_print_meta: n_expert         = 0
0.00.050.979 I llm_load_print_meta: n_expert_used    = 0
0.00.050.979 I llm_load_print_meta: causal attn      = 1
0.00.050.979 I llm_load_print_meta: pooling type     = 0
0.00.050.979 I llm_load_print_meta: rope type        = 2
0.00.050.979 I llm_load_print_meta: rope scaling     = linear
0.00.050.984 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.984 I llm_load_print_meta: freq_scale_train = 1
0.00.050.985 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.985 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.986 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.987 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.987 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.988 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.988 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.999 I llm_load_print_meta: model type       = 1.4B
0.00.050.999 I llm_load_print_meta: model ftype      = Q5_1
0.00.050.999 I llm_load_print_meta: model params     = 1.41 B
0.00.051.000 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.051.000 I llm_load_print_meta: general.name     = 1.4B
0.00.051.000 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.000 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.000 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.001 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.001 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.002 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.003 I llm_load_print_meta: max token length = 1024
0.00.052.557 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.557 I llm_load_tensors: offloading output layer to GPU
0.00.052.557 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.566 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.052.567 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.053.421 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.422 I llama_new_context_with_model: n_ctx         = 128
0.00.053.423 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.423 I llama_new_context_with_model: n_batch       = 128
0.00.053.423 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.423 I llama_new_context_with_model: flash_attn    = 0
0.00.053.423 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.424 I llama_new_context_with_model: freq_scale    = 1
0.00.053.424 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.424 I ggml_metal_init: allocating
0.00.053.428 I ggml_metal_init: found device: Apple M4
0.00.053.430 I ggml_metal_init: picking default device: Apple M4
0.00.053.927 I ggml_metal_init: using embedded metal library
0.00.055.852 I ggml_metal_init: GPU name:   Apple M4
0.00.055.853 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.853 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.854 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.854 I ggml_metal_init: simdgroup reduction   = true
0.00.055.854 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.854 I ggml_metal_init: has bfloat            = true
0.00.055.854 I ggml_metal_init: use bfloat            = true
0.00.055.855 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.856 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.179 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.182 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.196 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.092 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.093 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.094 I llama_new_context_with_model: graph nodes  = 967
0.00.066.094 I llama_new_context_with_model: graph splits = 2
0.00.066.106 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.786.561 I 
0.00.786.578 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.786.581 I perplexity: tokenizing the input ..
0.00.793.871 I perplexity: tokenization took 7.288 ms
0.00.793.883 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.928.738 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.929.989 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.930.007 I llama_perf_context_print:        load time =     776.85 ms
0.00.930.008 I llama_perf_context_print: prompt eval time =     134.63 ms /   128 tokens (    1.05 ms per token,   950.75 tokens per second)
0.00.930.009 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.930.010 I llama_perf_context_print:       total time =     143.45 ms /   129 tokens
0.00.930.413 I ggml_metal_free: deallocating

real	0m0.948s
user	0m0.077s
sys	0m0.144s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.100 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.633 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.365 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.369 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.371 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.371 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.371 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.372 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.373 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.374 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.374 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.374 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.375 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.375 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.375 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.376 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.378 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.379 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.379 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.281 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.339 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.236 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.237 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.237 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.238 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.238 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.238 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.239 I llama_model_loader: - type  f32:  194 tensors
0.00.024.239 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.240 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.240 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.456 I llm_load_vocab: special tokens cache size = 25
0.00.051.602 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.604 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.605 I llm_load_print_meta: arch             = gptneox
0.00.051.605 I llm_load_print_meta: vocab type       = BPE
0.00.051.605 I llm_load_print_meta: n_vocab          = 50304
0.00.051.606 I llm_load_print_meta: n_merges         = 50009
0.00.051.606 I llm_load_print_meta: vocab_only       = 0
0.00.051.606 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.606 I llm_load_print_meta: n_embd           = 2048
0.00.051.606 I llm_load_print_meta: n_layer          = 24
0.00.051.609 I llm_load_print_meta: n_head           = 16
0.00.051.610 I llm_load_print_meta: n_head_kv        = 16
0.00.051.610 I llm_load_print_meta: n_rot            = 32
0.00.051.610 I llm_load_print_meta: n_swa            = 0
0.00.051.610 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.610 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.611 I llm_load_print_meta: n_gqa            = 1
0.00.051.612 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.613 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.613 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.614 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.614 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.614 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.614 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.615 I llm_load_print_meta: n_ff             = 8192
0.00.051.615 I llm_load_print_meta: n_expert         = 0
0.00.051.615 I llm_load_print_meta: n_expert_used    = 0
0.00.051.616 I llm_load_print_meta: causal attn      = 1
0.00.051.616 I llm_load_print_meta: pooling type     = 0
0.00.051.616 I llm_load_print_meta: rope type        = 2
0.00.051.616 I llm_load_print_meta: rope scaling     = linear
0.00.051.619 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.619 I llm_load_print_meta: freq_scale_train = 1
0.00.051.619 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.619 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.620 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.620 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.620 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.620 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.620 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.632 I llm_load_print_meta: model type       = 1.4B
0.00.051.632 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.051.633 I llm_load_print_meta: model params     = 1.41 B
0.00.051.633 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.051.634 I llm_load_print_meta: general.name     = 1.4B
0.00.051.634 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.634 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.634 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.634 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.635 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.635 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.635 I llm_load_print_meta: max token length = 1024
0.00.053.559 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.559 I llm_load_tensors: offloading output layer to GPU
0.00.053.559 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.569 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.053.570 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.054.500 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.501 I llama_new_context_with_model: n_ctx         = 128
0.00.054.501 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.501 I llama_new_context_with_model: n_batch       = 128
0.00.054.501 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.501 I llama_new_context_with_model: flash_attn    = 0
0.00.054.502 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.502 I llama_new_context_with_model: freq_scale    = 1
0.00.054.502 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.503 I ggml_metal_init: allocating
0.00.054.508 I ggml_metal_init: found device: Apple M4
0.00.054.510 I ggml_metal_init: picking default device: Apple M4
0.00.055.045 I ggml_metal_init: using embedded metal library
0.00.056.999 I ggml_metal_init: GPU name:   Apple M4
0.00.057.001 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.001 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.001 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.002 I ggml_metal_init: simdgroup reduction   = true
0.00.057.002 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.002 I ggml_metal_init: has bfloat            = true
0.00.057.002 I ggml_metal_init: use bfloat            = true
0.00.057.002 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.003 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.224 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.228 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.241 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.067.184 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.067.185 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.067.185 I llama_new_context_with_model: graph nodes  = 967
0.00.067.186 I llama_new_context_with_model: graph splits = 2
0.00.067.198 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.425.887 I 
0.00.425.904 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.425.908 I perplexity: tokenizing the input ..
0.00.433.409 I perplexity: tokenization took 7.501 ms
0.00.433.421 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.565.737 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.566.965 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.566.982 I llama_perf_context_print:        load time =     416.25 ms
0.00.566.986 I llama_perf_context_print: prompt eval time =     132.09 ms /   128 tokens (    1.03 ms per token,   969.04 tokens per second)
0.00.566.987 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.566.987 I llama_perf_context_print:       total time =     141.09 ms /   129 tokens
0.00.567.356 I ggml_metal_free: deallocating

real	0m0.584s
user	0m0.078s
sys	0m0.075s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.088 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.672 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.486 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.014.491 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.493 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.494 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.494 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.494 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.495 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.495 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.496 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.496 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.497 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.498 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.498 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.499 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.500 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.500 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.501 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.386 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.458 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.319 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.320 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.321 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.321 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.321 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.322 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.023.322 I llama_model_loader: - type  f32:  194 tensors
0.00.023.323 I llama_model_loader: - type q3_K:   25 tensors
0.00.023.323 I llama_model_loader: - type q4_K:   71 tensors
0.00.023.323 I llama_model_loader: - type q5_K:    1 tensors
0.00.023.323 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.993 I llm_load_vocab: special tokens cache size = 25
0.00.051.100 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.104 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.104 I llm_load_print_meta: arch             = gptneox
0.00.051.105 I llm_load_print_meta: vocab type       = BPE
0.00.051.105 I llm_load_print_meta: n_vocab          = 50304
0.00.051.105 I llm_load_print_meta: n_merges         = 50009
0.00.051.105 I llm_load_print_meta: vocab_only       = 0
0.00.051.107 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.107 I llm_load_print_meta: n_embd           = 2048
0.00.051.107 I llm_load_print_meta: n_layer          = 24
0.00.051.110 I llm_load_print_meta: n_head           = 16
0.00.051.111 I llm_load_print_meta: n_head_kv        = 16
0.00.051.111 I llm_load_print_meta: n_rot            = 32
0.00.051.111 I llm_load_print_meta: n_swa            = 0
0.00.051.112 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.112 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.112 I llm_load_print_meta: n_gqa            = 1
0.00.051.113 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.114 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.114 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.115 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.115 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.115 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.115 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.116 I llm_load_print_meta: n_ff             = 8192
0.00.051.116 I llm_load_print_meta: n_expert         = 0
0.00.051.116 I llm_load_print_meta: n_expert_used    = 0
0.00.051.116 I llm_load_print_meta: causal attn      = 1
0.00.051.117 I llm_load_print_meta: pooling type     = 0
0.00.051.117 I llm_load_print_meta: rope type        = 2
0.00.051.117 I llm_load_print_meta: rope scaling     = linear
0.00.051.118 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.118 I llm_load_print_meta: freq_scale_train = 1
0.00.051.118 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.118 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.119 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.119 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.121 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.121 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.121 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.133 I llm_load_print_meta: model type       = 1.4B
0.00.051.134 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.051.134 I llm_load_print_meta: model params     = 1.41 B
0.00.051.135 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.051.135 I llm_load_print_meta: general.name     = 1.4B
0.00.051.135 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.135 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.135 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.135 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.136 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.136 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.136 I llm_load_print_meta: max token length = 1024
0.00.053.225 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.225 I llm_load_tensors: offloading output layer to GPU
0.00.053.225 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.235 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.053.236 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.054.242 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.243 I llama_new_context_with_model: n_ctx         = 128
0.00.054.243 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.243 I llama_new_context_with_model: n_batch       = 128
0.00.054.243 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.243 I llama_new_context_with_model: flash_attn    = 0
0.00.054.244 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.244 I llama_new_context_with_model: freq_scale    = 1
0.00.054.245 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.245 I ggml_metal_init: allocating
0.00.054.251 I ggml_metal_init: found device: Apple M4
0.00.054.253 I ggml_metal_init: picking default device: Apple M4
0.00.054.783 I ggml_metal_init: using embedded metal library
0.00.056.730 I ggml_metal_init: GPU name:   Apple M4
0.00.056.732 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.732 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.733 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.734 I ggml_metal_init: simdgroup reduction   = true
0.00.056.734 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.735 I ggml_metal_init: has bfloat            = true
0.00.056.735 I ggml_metal_init: use bfloat            = true
0.00.056.735 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.737 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.809 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.811 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.825 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.734 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.735 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.735 I llama_new_context_with_model: graph nodes  = 967
0.00.066.735 I llama_new_context_with_model: graph splits = 2
0.00.066.748 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.497.307 I 
0.00.497.324 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.497.327 I perplexity: tokenizing the input ..
0.00.505.264 I perplexity: tokenization took 7.936 ms
0.00.505.274 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.636.517 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.637.751 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.637.759 I llama_perf_context_print:        load time =     488.63 ms
0.00.637.760 I llama_perf_context_print: prompt eval time =     131.02 ms /   128 tokens (    1.02 ms per token,   976.97 tokens per second)
0.00.637.761 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.637.761 I llama_perf_context_print:       total time =     140.45 ms /   129 tokens
0.00.638.120 I ggml_metal_free: deallocating

real	0m0.651s
user	0m0.078s
sys	0m0.098s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.090 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.888 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.727 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.015.732 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.733 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.734 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.738 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.739 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.741 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.741 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.742 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.742 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.742 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.743 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.743 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.743 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.745 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.745 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.745 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.636 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.742 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.613 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.614 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.614 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.615 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.615 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.615 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.616 I llama_model_loader: - type  f32:  194 tensors
0.00.024.616 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.617 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.617 I llama_model_loader: - type q6_K:   13 tensors
0.00.045.824 I llm_load_vocab: special tokens cache size = 25
0.00.051.869 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.875 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.875 I llm_load_print_meta: arch             = gptneox
0.00.051.876 I llm_load_print_meta: vocab type       = BPE
0.00.051.876 I llm_load_print_meta: n_vocab          = 50304
0.00.051.876 I llm_load_print_meta: n_merges         = 50009
0.00.051.876 I llm_load_print_meta: vocab_only       = 0
0.00.051.877 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.877 I llm_load_print_meta: n_embd           = 2048
0.00.051.877 I llm_load_print_meta: n_layer          = 24
0.00.051.881 I llm_load_print_meta: n_head           = 16
0.00.051.881 I llm_load_print_meta: n_head_kv        = 16
0.00.051.882 I llm_load_print_meta: n_rot            = 32
0.00.051.882 I llm_load_print_meta: n_swa            = 0
0.00.051.884 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.884 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.884 I llm_load_print_meta: n_gqa            = 1
0.00.051.885 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.886 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.887 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.887 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.887 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.887 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.888 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.888 I llm_load_print_meta: n_ff             = 8192
0.00.051.888 I llm_load_print_meta: n_expert         = 0
0.00.051.889 I llm_load_print_meta: n_expert_used    = 0
0.00.051.889 I llm_load_print_meta: causal attn      = 1
0.00.051.889 I llm_load_print_meta: pooling type     = 0
0.00.051.889 I llm_load_print_meta: rope type        = 2
0.00.051.889 I llm_load_print_meta: rope scaling     = linear
0.00.051.889 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.890 I llm_load_print_meta: freq_scale_train = 1
0.00.051.890 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.890 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.890 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.890 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.891 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.891 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.892 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.904 I llm_load_print_meta: model type       = 1.4B
0.00.051.904 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.051.905 I llm_load_print_meta: model params     = 1.41 B
0.00.051.905 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.051.905 I llm_load_print_meta: general.name     = 1.4B
0.00.051.906 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.907 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.907 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.907 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.907 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.908 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.909 I llm_load_print_meta: max token length = 1024
0.00.053.989 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.989 I llm_load_tensors: offloading output layer to GPU
0.00.053.990 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.000 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.054.001 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.054.986 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.987 I llama_new_context_with_model: n_ctx         = 128
0.00.054.988 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.988 I llama_new_context_with_model: n_batch       = 128
0.00.054.988 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.988 I llama_new_context_with_model: flash_attn    = 0
0.00.054.988 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.989 I llama_new_context_with_model: freq_scale    = 1
0.00.054.989 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.989 I ggml_metal_init: allocating
0.00.054.992 I ggml_metal_init: found device: Apple M4
0.00.054.994 I ggml_metal_init: picking default device: Apple M4
0.00.055.545 I ggml_metal_init: using embedded metal library
0.00.057.542 I ggml_metal_init: GPU name:   Apple M4
0.00.057.543 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.544 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.544 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.544 I ggml_metal_init: simdgroup reduction   = true
0.00.057.544 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.544 I ggml_metal_init: has bfloat            = true
0.00.057.545 I ggml_metal_init: use bfloat            = true
0.00.057.545 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.546 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.046 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.048 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.072 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.072 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.073 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.073 I llama_new_context_with_model: graph nodes  = 967
0.00.068.074 I llama_new_context_with_model: graph splits = 2
0.00.068.086 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.580.832 I 
0.00.580.863 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.580.868 I perplexity: tokenizing the input ..
0.00.588.720 I perplexity: tokenization took 7.852 ms
0.00.588.732 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.723.137 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.724.317 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.724.331 I llama_perf_context_print:        load time =     570.94 ms
0.00.724.332 I llama_perf_context_print: prompt eval time =     134.17 ms /   128 tokens (    1.05 ms per token,   954.03 tokens per second)
0.00.724.333 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.724.333 I llama_perf_context_print:       total time =     143.50 ms /   129 tokens
0.00.724.776 I ggml_metal_free: deallocating

real	0m0.741s
user	0m0.079s
sys	0m0.114s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.086 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.544 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.411 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.014.416 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.418 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.418 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.419 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.419 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.419 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.420 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.420 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.421 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.421 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.421 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.422 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.422 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.423 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.424 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.424 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.175 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.199 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.022.949 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.022.950 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.022.950 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.022.951 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.022.951 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.022.951 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.022.952 I llama_model_loader: - type  f32:  194 tensors
0.00.022.952 I llama_model_loader: - type q5_K:   61 tensors
0.00.022.952 I llama_model_loader: - type q6_K:   37 tensors
0.00.043.312 I llm_load_vocab: special tokens cache size = 25
0.00.049.517 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.520 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.520 I llm_load_print_meta: arch             = gptneox
0.00.049.521 I llm_load_print_meta: vocab type       = BPE
0.00.049.521 I llm_load_print_meta: n_vocab          = 50304
0.00.049.521 I llm_load_print_meta: n_merges         = 50009
0.00.049.521 I llm_load_print_meta: vocab_only       = 0
0.00.049.522 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.522 I llm_load_print_meta: n_embd           = 2048
0.00.049.522 I llm_load_print_meta: n_layer          = 24
0.00.049.525 I llm_load_print_meta: n_head           = 16
0.00.049.525 I llm_load_print_meta: n_head_kv        = 16
0.00.049.526 I llm_load_print_meta: n_rot            = 32
0.00.049.526 I llm_load_print_meta: n_swa            = 0
0.00.049.526 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.526 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.527 I llm_load_print_meta: n_gqa            = 1
0.00.049.528 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.529 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.530 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.530 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.530 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.530 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.530 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.531 I llm_load_print_meta: n_ff             = 8192
0.00.049.531 I llm_load_print_meta: n_expert         = 0
0.00.049.532 I llm_load_print_meta: n_expert_used    = 0
0.00.049.532 I llm_load_print_meta: causal attn      = 1
0.00.049.532 I llm_load_print_meta: pooling type     = 0
0.00.049.532 I llm_load_print_meta: rope type        = 2
0.00.049.532 I llm_load_print_meta: rope scaling     = linear
0.00.049.532 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.533 I llm_load_print_meta: freq_scale_train = 1
0.00.049.533 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.533 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.533 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.533 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.534 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.535 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.536 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.547 I llm_load_print_meta: model type       = 1.4B
0.00.049.547 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.049.548 I llm_load_print_meta: model params     = 1.41 B
0.00.049.548 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.049.548 I llm_load_print_meta: general.name     = 1.4B
0.00.049.548 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.549 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.549 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.549 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.549 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.549 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.550 I llm_load_print_meta: max token length = 1024
0.00.051.127 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.128 I llm_load_tensors: offloading output layer to GPU
0.00.051.128 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.137 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.051.138 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.051.954 I llama_new_context_with_model: n_seq_max     = 1
0.00.051.955 I llama_new_context_with_model: n_ctx         = 128
0.00.051.955 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.051.955 I llama_new_context_with_model: n_batch       = 128
0.00.051.956 I llama_new_context_with_model: n_ubatch      = 128
0.00.051.956 I llama_new_context_with_model: flash_attn    = 0
0.00.051.956 I llama_new_context_with_model: freq_base     = 10000.0
0.00.051.957 I llama_new_context_with_model: freq_scale    = 1
0.00.051.957 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.051.957 I ggml_metal_init: allocating
0.00.051.963 I ggml_metal_init: found device: Apple M4
0.00.051.965 I ggml_metal_init: picking default device: Apple M4
0.00.052.506 I ggml_metal_init: using embedded metal library
0.00.054.402 I ggml_metal_init: GPU name:   Apple M4
0.00.054.403 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.404 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.404 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.404 I ggml_metal_init: simdgroup reduction   = true
0.00.054.405 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.405 I ggml_metal_init: has bfloat            = true
0.00.054.405 I ggml_metal_init: use bfloat            = true
0.00.054.405 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.406 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.688 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.691 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.706 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.630 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.631 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.631 I llama_new_context_with_model: graph nodes  = 967
0.00.064.632 I llama_new_context_with_model: graph splits = 2
0.00.064.643 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.652.985 I 
0.00.653.003 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.653.007 I perplexity: tokenizing the input ..
0.00.661.023 I perplexity: tokenization took 8.015 ms
0.00.661.037 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.801.102 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.802.247 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.802.259 I llama_perf_context_print:        load time =     644.44 ms
0.00.802.260 I llama_perf_context_print: prompt eval time =     139.84 ms /   128 tokens (    1.09 ms per token,   915.32 tokens per second)
0.00.802.261 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.802.261 I llama_perf_context_print:       total time =     149.27 ms /   129 tokens
0.00.802.608 I ggml_metal_free: deallocating

real	0m0.815s
user	0m0.077s
sys	0m0.119s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.102 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.100 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.782 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.015.785 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.787 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.788 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.788 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.788 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.788 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.789 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.790 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.790 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.790 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.791 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.791 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.791 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.793 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.794 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.794 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.618 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.684 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.581 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.582 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.582 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.583 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.583 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.583 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.584 I llama_model_loader: - type  f32:  194 tensors
0.00.024.584 I llama_model_loader: - type q6_K:   98 tensors
0.00.044.939 I llm_load_vocab: special tokens cache size = 25
0.00.050.994 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.001 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.002 I llm_load_print_meta: arch             = gptneox
0.00.051.002 I llm_load_print_meta: vocab type       = BPE
0.00.051.002 I llm_load_print_meta: n_vocab          = 50304
0.00.051.002 I llm_load_print_meta: n_merges         = 50009
0.00.051.003 I llm_load_print_meta: vocab_only       = 0
0.00.051.003 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.003 I llm_load_print_meta: n_embd           = 2048
0.00.051.003 I llm_load_print_meta: n_layer          = 24
0.00.051.006 I llm_load_print_meta: n_head           = 16
0.00.051.006 I llm_load_print_meta: n_head_kv        = 16
0.00.051.007 I llm_load_print_meta: n_rot            = 32
0.00.051.007 I llm_load_print_meta: n_swa            = 0
0.00.051.007 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.007 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.008 I llm_load_print_meta: n_gqa            = 1
0.00.051.009 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.010 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.010 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.010 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.011 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.011 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.011 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.012 I llm_load_print_meta: n_ff             = 8192
0.00.051.012 I llm_load_print_meta: n_expert         = 0
0.00.051.012 I llm_load_print_meta: n_expert_used    = 0
0.00.051.012 I llm_load_print_meta: causal attn      = 1
0.00.051.012 I llm_load_print_meta: pooling type     = 0
0.00.051.013 I llm_load_print_meta: rope type        = 2
0.00.051.013 I llm_load_print_meta: rope scaling     = linear
0.00.051.013 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.013 I llm_load_print_meta: freq_scale_train = 1
0.00.051.014 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.014 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.014 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.014 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.014 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.014 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.015 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.021 I llm_load_print_meta: model type       = 1.4B
0.00.051.022 I llm_load_print_meta: model ftype      = Q6_K
0.00.051.022 I llm_load_print_meta: model params     = 1.41 B
0.00.051.022 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.051.022 I llm_load_print_meta: general.name     = 1.4B
0.00.051.023 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.023 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.023 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.023 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.023 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.023 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.024 I llm_load_print_meta: max token length = 1024
0.00.052.815 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.815 I llm_load_tensors: offloading output layer to GPU
0.00.052.815 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.820 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.052.821 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.053.692 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.693 I llama_new_context_with_model: n_ctx         = 128
0.00.053.694 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.694 I llama_new_context_with_model: n_batch       = 128
0.00.053.694 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.694 I llama_new_context_with_model: flash_attn    = 0
0.00.053.695 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.695 I llama_new_context_with_model: freq_scale    = 1
0.00.053.695 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.695 I ggml_metal_init: allocating
0.00.053.699 I ggml_metal_init: found device: Apple M4
0.00.053.701 I ggml_metal_init: picking default device: Apple M4
0.00.054.238 I ggml_metal_init: using embedded metal library
0.00.056.132 I ggml_metal_init: GPU name:   Apple M4
0.00.056.133 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.134 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.134 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.134 I ggml_metal_init: simdgroup reduction   = true
0.00.056.134 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.134 I ggml_metal_init: has bfloat            = true
0.00.056.135 I ggml_metal_init: use bfloat            = true
0.00.056.135 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.137 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.486 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.489 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.504 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.401 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.402 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.403 I llama_new_context_with_model: graph nodes  = 967
0.00.066.403 I llama_new_context_with_model: graph splits = 2
0.00.066.410 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.134.581 I 
0.00.134.603 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.134.607 I perplexity: tokenizing the input ..
0.00.142.094 I perplexity: tokenization took 7.486 ms
0.00.142.109 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.281.501 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.282.766 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.282.775 I llama_perf_context_print:        load time =     124.48 ms
0.00.282.776 I llama_perf_context_print: prompt eval time =     139.16 ms /   128 tokens (    1.09 ms per token,   919.82 tokens per second)
0.00.282.777 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.282.777 I llama_perf_context_print:       total time =     148.19 ms /   129 tokens
0.00.283.060 I ggml_metal_free: deallocating

real	0m0.298s
user	0m0.076s
sys	0m0.038s
+ ./bin/llama-imatrix --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.265 I build: 4181 (7db3846a) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.021.989 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.034.562 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.034.566 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.034.569 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.034.569 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.034.570 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.034.570 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.034.570 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.034.572 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.034.572 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.034.572 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.034.573 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.034.573 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.034.574 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.034.574 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.034.576 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.034.579 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.034.579 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.042.305 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.044.108 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.050.830 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.050.832 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.050.832 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.050.833 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.050.833 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.050.834 I llama_model_loader: - type  f32:  194 tensors
0.00.050.834 I llama_model_loader: - type  f16:   98 tensors
0.00.078.101 I llm_load_vocab: special tokens cache size = 25
0.00.084.446 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.084.449 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.084.449 I llm_load_print_meta: arch             = gptneox
0.00.084.449 I llm_load_print_meta: vocab type       = BPE
0.00.084.449 I llm_load_print_meta: n_vocab          = 50304
0.00.084.450 I llm_load_print_meta: n_merges         = 50009
0.00.084.450 I llm_load_print_meta: vocab_only       = 0
0.00.084.450 I llm_load_print_meta: n_ctx_train      = 2048
0.00.084.450 I llm_load_print_meta: n_embd           = 2048
0.00.084.450 I llm_load_print_meta: n_layer          = 24
0.00.084.453 I llm_load_print_meta: n_head           = 16
0.00.084.454 I llm_load_print_meta: n_head_kv        = 16
0.00.084.454 I llm_load_print_meta: n_rot            = 32
0.00.084.456 I llm_load_print_meta: n_swa            = 0
0.00.084.456 I llm_load_print_meta: n_embd_head_k    = 128
0.00.084.456 I llm_load_print_meta: n_embd_head_v    = 128
0.00.084.457 I llm_load_print_meta: n_gqa            = 1
0.00.084.458 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.084.459 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.084.459 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.084.459 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.084.460 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.084.460 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.084.460 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.084.461 I llm_load_print_meta: n_ff             = 8192
0.00.084.461 I llm_load_print_meta: n_expert         = 0
0.00.084.461 I llm_load_print_meta: n_expert_used    = 0
0.00.084.461 I llm_load_print_meta: causal attn      = 1
0.00.084.461 I llm_load_print_meta: pooling type     = 0
0.00.084.461 I llm_load_print_meta: rope type        = 2
0.00.084.462 I llm_load_print_meta: rope scaling     = linear
0.00.084.462 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.084.462 I llm_load_print_meta: freq_scale_train = 1
0.00.084.463 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.084.469 I llm_load_print_meta: rope_finetuned   = unknown
0.00.084.470 I llm_load_print_meta: ssm_d_conv       = 0
0.00.084.470 I llm_load_print_meta: ssm_d_inner      = 0
0.00.084.471 I llm_load_print_meta: ssm_d_state      = 0
0.00.084.471 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.084.471 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.084.485 I llm_load_print_meta: model type       = 1.4B
0.00.084.486 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.084.486 I llm_load_print_meta: model params     = 1.41 B
0.00.084.490 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.084.490 I llm_load_print_meta: general.name     = 1.4B
0.00.084.490 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.084.490 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.084.490 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.084.491 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.084.491 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.084.493 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.084.493 I llm_load_print_meta: max token length = 1024
0.00.087.024 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.087.025 I llm_load_tensors: offloading output layer to GPU
0.00.087.025 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.087.035 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.087.036 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.088.140 I llama_new_context_with_model: n_seq_max     = 1
0.00.088.141 I llama_new_context_with_model: n_ctx         = 128
0.00.088.141 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.088.141 I llama_new_context_with_model: n_batch       = 128
0.00.088.141 I llama_new_context_with_model: n_ubatch      = 128
0.00.088.142 I llama_new_context_with_model: flash_attn    = 0
0.00.088.142 I llama_new_context_with_model: freq_base     = 10000.0
0.00.088.142 I llama_new_context_with_model: freq_scale    = 1
0.00.088.143 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.088.143 I ggml_metal_init: allocating
0.00.088.148 I ggml_metal_init: found device: Apple M4
0.00.088.150 I ggml_metal_init: picking default device: Apple M4
0.00.088.714 I ggml_metal_init: using embedded metal library
0.00.090.765 I ggml_metal_init: GPU name:   Apple M4
0.00.090.767 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.090.767 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.090.768 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.090.768 I ggml_metal_init: simdgroup reduction   = true
0.00.090.768 I ggml_metal_init: simdgroup matrix mul. = true
0.00.090.768 I ggml_metal_init: has bfloat            = true
0.00.090.768 I ggml_metal_init: use bfloat            = true
0.00.090.769 I ggml_metal_init: hasUnifiedMemory      = true
0.00.090.770 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.099.834 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.099.836 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.099.850 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.100.837 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.100.838 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.100.838 I llama_new_context_with_model: graph nodes  = 967
0.00.100.839 I llama_new_context_with_model: graph splits = 2
0.00.100.851 I 
0.00.100.881 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.100.882 I compute_imatrix: tokenizing the input ..
0.00.108.169 I compute_imatrix: tokenization took 7.287 ms
0.00.108.171 I compute_imatrix: computing over 1 chunks with batch_size 128
0.01.614.086 I compute_imatrix: 1.51 seconds per pass - ETA 0.02 minutes
[1]10.1498,
Final estimate: PPL = 10.1498 +/- 3.22650

0.01.616.637 I llama_perf_context_print:        load time =    1592.10 ms
0.01.616.638 I llama_perf_context_print: prompt eval time =    1505.26 ms /   128 tokens (   11.76 ms per token,    85.04 tokens per second)
0.01.616.639 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.616.639 I llama_perf_context_print:       total time =    1594.64 ms /   129 tokens
0.01.617.159 I ggml_metal_free: deallocating

real	0m1.806s
user	0m0.166s
sys	0m0.254s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4181 (7db3846a)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x14a507220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x14a507950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x14a507f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x14a5084b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x14a508a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x14a509010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x14a5095c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x14a509b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x14a50a120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x14a50a620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x14a50ab20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x14a50b020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x14a50bb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x14a50c2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x14a50cb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x14a50d220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x14a50d940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x14a50e060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x14a50e780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x14a50ef50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x14a50f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x14a50fd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x14a5104b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x14a510d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x14a511470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x14a511730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x14a511d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x14a5129b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x14a512ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x14a5131b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x14a513650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x14a513910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x14a5141a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x14a5146e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x14a5149a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x14a514e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x14a5152e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x14a515780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x14a515c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x14a5160c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x14a516560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x14a516a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x14a516ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x14a517340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x14a517600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x14a517c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x14a518220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x14a518b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x14a519150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x14a519760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x14a519d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x14a51a380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x14a51a990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x14a51afa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x14a51b790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x14a51bc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x14a51c0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x14a51c390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x14a51c9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x14a51d190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x14a51d450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x14a51d8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x14a51dd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x14a51e230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x14a51e6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x14a51eb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x14a51f010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x14a51f4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x14a51f950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x14a51fdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x14a520290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x14a520730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x14a520bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x14a521070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x14a521510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x14a5219b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x14a521e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x14a5222f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x14a522790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x14a522c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x14a5230d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x14a523570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x14a523a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x14a523eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x14a524350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x14a5247f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x14a524c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x14a525130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x14a5255d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x14a525a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x14a525f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x14a5263b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x14a526850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x14a526cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x14a527190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x14a527630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x14a527ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x14a518830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x14a528120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x14a5285c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x14a528a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x14a528f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x14a5293a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x14a529840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x14a529ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x14a52a180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x14a52a620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x14a52aac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x14a52af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x14a52b400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x14a52b8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x14a52bd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x14a52c1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x14a52c680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x14a52cb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x14a52cfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x14a52d460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x14a52d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x14a52dda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x14a52e240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x14a52e6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x14a52eb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x14a52f020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x14a52f4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x14a52f960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x14a52fe00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x14a5302a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x14a530740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x14a530be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x14a531080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x14a531520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x14a5319c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x14a531e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x14a532300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x14a5327a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x14a532c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x14a5330e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x14a533580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x14a533a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x14a533ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x14a534360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x14a534800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x14a534ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x14a535140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x14a5355e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x14a535a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x14a535f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x14a5363c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x14a536860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x14a536d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x14a5371a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x14a537640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x14a537ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x14a538030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x14a538580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x14a538ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x14a539020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x14a5392e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x14a5398f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x14a539f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x14a53a510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x14a53ab20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x14a53b130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x14a53b920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x14a53bdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x14a53c260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x14a53c700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x14a53ceb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x14a53d400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x14a53d950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x14a53dea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x14a53e3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x14a53e940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x14a53ee90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x14a53f3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x14a53f930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x14a53fe80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x14a5403d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x14a540920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x14a540e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x14a5413c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x14a541910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x14a541e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x14a5423b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x14a542900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x14a542e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x14a5433a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x14a5438f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x14a543e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x14a544390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x14a5448e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x14a544e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x14a545380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x14a5458d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x14a545e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x14a546370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x14a5468c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x14a546e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x14a547360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x14a5478b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x14a547e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x14a548350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x14a5488a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x14a548df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x14a549340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x14a549890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x14a549de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x14a54a330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x14a54a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x14a54add0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x14a54b320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x14a54b870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x14a54bdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x14a54c310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x14a54c860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x14a54cdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x14a54d300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x14a54d850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x14a54dda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x14a54e2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x14a54e840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x14a54ed90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x14a54f2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x14a54f830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x14a54fcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x14a550170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x14a550610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x14a550ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x14a550f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x14a5513f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x14a551890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x14a551d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x14a5521d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x14a552670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x14a552b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x14a552fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x14a553450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x14a5539a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x14a5540c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x14a5547e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x14a554f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x14a555620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x14a5558e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x14a555ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x14a556500 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.132.283 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x14a305bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x14a306030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x14a309a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x14a309ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x14a309fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x14a30a410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x14a30a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x14a30acf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x14a30b160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x14a30b690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x14a30bb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x14a30c180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x14a30cca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x14a30d450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x14a30dc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x14a30e380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x14a30eaa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x14a30f1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x14a30f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x14a3100b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x14a3107d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x14a310ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x14a311610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x14a311d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x14a312450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x14a312710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x14a3129d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x14a312e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x14a3132b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x14a313720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x14a313c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x14a314130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x14a3145a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x14a314860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x14a314cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x14a315140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x14a3156a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x14a315ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x14a3160a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x14a3165a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x14a316aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x14a316fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x14a3174a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x14a3179a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x14a317ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x14a318310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x14a318780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x14a318bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x14a319060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x14a3194d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x14a319940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x14a319db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x14a31a220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x14a31a690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x14a31ab00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x14a31b2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x14a31b770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x14a31ba30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x14a31c040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x14a31c830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x14a31ccd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x14a31d170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x14a31d610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x14a31dab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x14a31df50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x14a31e3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x14a31e890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x14a31ed30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x14a31f1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x14a31f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x14a31fb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x14a31ffb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x14a320450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x14a3208f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x14a320d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x14a321230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x14a3216d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x14a321b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x14a322010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x14a3224b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x14a322950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x14a322df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x14a323290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x14a323730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x14a323bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x14a324070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x14a324510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x14a3249b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x14a324e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x14a3252f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x14a325790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x14a325c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x14a3260d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x14a326570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x14a326a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x14a326eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x14a327350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x14a3277f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x14a327c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x14a328130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x14a3285d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x14a328a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x14a328f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x14a3293b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x14a329850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x14a329cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x14a32a190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x14a32a630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x14a32aad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x14a32af70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x14a32b410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x14a32b8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x14a32bd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x14a32c1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x14a32c690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x14a32cb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x14a32cfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x14a32d470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x14a32d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x14a32ddb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x14a32e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x14a32e6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x14a32eb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x14a32f030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x14a32f4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x14a32f970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x14a32fe10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x14a3302b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x14a330750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x14a330bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x14a331090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x14a331530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x14a3319d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x14a331e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x14a332310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x14a3327b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x14a332c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x14a3330f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x14a333590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x14a333a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x14a333ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x14a334370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x14a334810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x14a334cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x14a335150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x14a3355f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x14a335a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x14a335f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x14a3363d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x14a336870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x14a336d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x14a3371b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x14a337650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x14a337ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x14a3380f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x14a338640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x14a338b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x14a338e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x14a339460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x14a339a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x14a33a080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x14a33a690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x14a33aca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x14a33b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x14a33b930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x14a33bdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x14a33c270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x14a33ca20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x14a33cf70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x14a33d4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x14a33da10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x14a33df60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x14a33e4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x14a33ea00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x14a33ef50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x14a33f4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x14a33f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x14a33ff40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x14a340490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x14a3409e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x14a340f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x14a341480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x14a3419d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x14a341f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x14a342470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x14a3429c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x14a342f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x14a343460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x14a3439b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x14a343f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x14a344450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x14a3449a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x14a344ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x14a345440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x14a345990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x14a345ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x14a346430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x14a346980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x14a346ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x14a347420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x14a347970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x14a347ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x14a348410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x14a348960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x14a348eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x14a349400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x14a349950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x14a349ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x14a34a3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x14a34a940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x14a34ae90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x14a34b3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x14a34b930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x14a34be80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x14a34c3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x14a34c920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x14a34ce70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x14a34d3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x14a34d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x14a34de60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x14a34e3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x14a34e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x14a34ee50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x14a34f3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x14a34f840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x14a34fce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x14a350180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x14a350620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x14a350ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x14a350f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x14a351400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x14a3518a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x14a351d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x14a3521e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x14a352680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x14a352b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x14a352fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x14a353510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x14a353c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x14a354350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x14a354a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x14a355190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x14a355450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x14a355a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x14a356070 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x14a309e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x14a30a2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x14a30a760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x14a30abd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x14a30b040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x14a30b4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x14a30b920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x14a30bd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x14a30c200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x14a30c670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x14a30cae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x14a30d0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x14a30d9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x14a30e130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x14a30e910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x14a30f000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x14a30f6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x14a30fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x14a3104d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x14a310e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x14a311540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x14a311c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x14a312320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x14a312a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x14a313100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x14a313570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x14a3139e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x14a313e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x14a3142c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x14a314730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x14a314ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x14a315010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x14a315480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x14a315740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x14a315bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x14a316020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x14a316490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x14a316900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x14a316d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x14a3171e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x14a317650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x14a317ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x14a317f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x14a3183a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x14a318810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x14a318c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x14a3190f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x14a319560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x14a3199d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x14a319e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x14a31a2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x14a31a720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x14a31ab90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x14a31b000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x14a31b470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x14a31b8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x14a31bd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x14a31c1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x14a31c630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x14a31caa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x14a31cf10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x14a31d380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x14a31d7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x14a31dc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x14a31e0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x14a31e540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x14a31e9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x14a31ee20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x14a31f290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x14a31f700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x14a31fb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x14a31ffe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x14a320450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x14a3208c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x14a320d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x14a3211a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x14a321610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x14a321a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x14a321ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x14a322360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x14a3227d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x14a322c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x14a3230b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x14a323520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x14a323990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x14a323e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x14a324270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x14a3246e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x14a324b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x14a324fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x14a325430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x14a3258a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x14a325d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x14a326180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x14a3265f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x14a326a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x14a326ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x14a327340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x14a3277b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x14a327c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x14a328090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x14a328500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x14a328970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x14a328de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x14a329250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x14a3296c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x14a329b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x14a329fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x14a32a410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x14a32a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x14a32acf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x14a32b160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x14a32b5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x14a32ba40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x14a32beb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x14a32c320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x14a32c790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x14a32cc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x14a32d070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x14a32d4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x14a32d950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x14a32ddc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x14a32e230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x14a32e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x14a32eb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x14a32ef80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x14a32f3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x14a32f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x14a32fcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x14a330140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x14a3305b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x14a330a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x14a330e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x14a331300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x14a331770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x14a331be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x14a332050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x14a3324c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x14a332930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x14a332da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x14a333210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x14a333680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x14a333af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x14a333f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x14a3343d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x14a334840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x14a334cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x14a335120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x14a335590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x14a335a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x14a335e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x14a3362e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x14a336750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x14a336bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x14a337030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x14a3374a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x14a337910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x14a337d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x14a3381f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x14a338660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x14a338ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x14a338f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x14a3393b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x14a339820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x14a339c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x14a33a100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x14a33a570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x14a33acf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x14a33b160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x14a33b5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x14a33ba40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x14a33beb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x14a33c320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x14a33c790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x14a33cc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x14a33d070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x14a33d4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x14a33d950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x14a33ddc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x14a33e230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x14a33e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x14a33eb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x14a33ef80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x14a33f3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x14a33f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x14a33fcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x14a340140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x14a3405b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x14a340a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x14a340e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x14a341300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x14a341770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x14a341be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x14a342050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x14a3424c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x14a342930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x14a342da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x14a343210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x14a343680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x14a343af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x14a343f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x14a3443d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x14a344840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x14a344cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x14a345120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x14a345590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x14a345a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x14a345e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x14a3462e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x14a346750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x14a346bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x14a347030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x14a3474a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x14a347910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x14a347d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x14a3481f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x14a348660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x14a348ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x14a348f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x14a3493b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x14a349820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x14a349c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x14a34a100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x14a34a570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x14a34a9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x14a34ae50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x14a34b2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x14a34b730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x14a34bba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x14a34c010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x14a34c480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x14a34c8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x14a34cd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x14a34d1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x14a34d640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x14a34dab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x14a34df20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x14a34e390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x14a34ea80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x14a34f170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x14a34f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x14a34ff50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x14a3503c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x14a350830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x14a350ca0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.748s
user	0m0.287s
sys	0m0.294s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4181 (7db3846a)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x12870d1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x12870d8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x12870de90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x12870e440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x12870e9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12870efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12870f550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12870fb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x1287100b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x1287105b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x128710ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x128710fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x128711ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x128712280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x128712a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x1287131b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x1287138d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x128713ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x128714710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x128714ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x128715600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x128715d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x128716440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x128716ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x128717400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x1287176c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x128717cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x128718940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x128718e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x128719140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x1287195e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x1287198a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x12871a130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x12871a670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x12871a930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x12871add0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x12871b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x12871b710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x12871bbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x12871c050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x12871c4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x12871c990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x12871ce30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x12871d2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x12871d590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x12871dba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x12871e1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x12871ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x12871f0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x12871f6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12871fd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x128720310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x128720920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x128720f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x128721720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x128721bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x128722060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x128722320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x128722930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x128723120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x1287233e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x128723880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x128723d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x1287241c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x128724660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x128724b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x128724fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x128725440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x1287258e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x128725d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x128726220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x1287266c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x128726b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x128727000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x1287274a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x128727940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x128727de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x128728280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x128728720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x128728bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x128729060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x128729500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x1287299a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x128729e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x12872a2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x12872a780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x12872ac20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x12872b0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x12872b560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x12872ba00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x12872bea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x12872c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x12872c7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x12872cc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x12872d120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x12872d5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x12872da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x12871e7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x12872e0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x12872e550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x12872e9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x12872ee90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x12872f330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x12872f7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x12872fc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x128730110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x1287305b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x128730a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x128730ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x128731390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x128731830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x128731cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x128732170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x128732610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x128732ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x128732f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x1287333f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x128733890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x128733d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x1287341d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x128734670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x128734b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x128734fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x128735450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x1287358f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x128735d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x128736230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x1287366d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x128736b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x128737010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x1287374b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x128737950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x128737df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x128738290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x128738730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x128738bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x128739070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x128739510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x1287399b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x128739e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x12873a2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x12873a790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x12873ac30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x12873b0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x12873b570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x12873ba10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x12873beb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x12873c350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x12873c7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x12873cc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x12873d130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x12873d5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x12873da70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x12873dfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x12873e510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x12873ea60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x12873efb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x12873f270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x12873f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x12873fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x1287404a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x128740ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x1287410c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x1287418b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x128741d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x1287421f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x128742690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x128742e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x128743390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x1287438e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x128743e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x128744380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x1287448d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x128744e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x128745370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x1287458c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x128745e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x128746360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x1287468b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x128746e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x128747350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x1287478a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x128747df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x128748340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x128748890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x128748de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x128749330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x128749880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x128749dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x12874a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x12874a870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x12874adc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x12874b310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x12874b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x12874bdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x12874c300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12874c850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12874cda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12874d2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12874d840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12874dd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12874e2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12874e830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12874ed80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12874f2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12874f820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12874fd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x1287502c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x128750810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x128750d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x1287512b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x128751800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x128751d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x1287522a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x1287527f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x128752d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x128753290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x1287537e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x128753d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x128754280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x1287547d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x128754d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x128755270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x1287557c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x128755c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x128756100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x1287565a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x128756a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x128756ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x128757380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x128757820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x128757cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x128758160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x128758600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x128758aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x128758f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x1287593e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x128759930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x12875a050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x12875a770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x12875ae90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x12875b5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x12875b870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12875be80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12875c490 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.087.046 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x128608cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x128609140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x1286095b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x128609a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x128609e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12860a300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12860a770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12860abe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12860b050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12860b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12860b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12860c070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x12860cb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x12860d340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x12860db50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x12860e270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x12860e990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x12860f0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x12860f7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x12860ffa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x1286106c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x128610de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x128611500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x128611c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x128612340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x128612600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x1286128c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x128612d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x1286131a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x128613610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x128613b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x128614020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x128614490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x128614750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x128614bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x128615030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x128615590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x128615a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x128615f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x128616490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x128616990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x128616e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x128617390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x128617890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x128617d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x128618200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x128618670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x128618ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x128618f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x1286193c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x128619830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x128619ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12861a110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12861a580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12861a9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x12861b1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x12861b660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x12861b920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x12861bf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x12861c720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x12861cbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x12861d060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x12861d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x12861d9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x12861de40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x12861e2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x12861e780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x12861ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x12861f0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x12861f560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x12861fa00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x12861fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x128620340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x1286207e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x128620c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x128621120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x1286215c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x128621a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x128621f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x1286223a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x128622840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x128622ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x128623180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x128623620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x128623ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x128623f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x128624400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x1286248a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x128624d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x1286251e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x128625680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x128625b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x128625fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x128626460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x128626900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x128626da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x128627240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x1286276e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x128627b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x128628020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x1286284c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x128628960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x128628e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x1286292a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x128629740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x128629be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x12862a080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x12862a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x12862a9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x12862ae60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x12862b300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x12862b7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x12862bc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x12862c0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x12862c580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x12862ca20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x12862cec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x12862d360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x12862d800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x12862dca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x12862e140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x12862e5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x12862ea80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x12862ef20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x12862f3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x12862f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x12862fd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x1286301a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x128630640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x128630ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x128630f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x128631420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x1286318c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x128631d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x128632200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x1286326a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x128632b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x128632fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x128633480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x128633920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x128633dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x128634260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x128634700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x128634ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x128635040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x1286354e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x128635980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x128635e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x1286362c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x128636760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x128636c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x1286370a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x128637540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x128637a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x128637fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x128638530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x128638a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x128638d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x128639350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x128639960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x128639f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x12863a580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x12863ab90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x12863b380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x12863b820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x12863bcc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x12863c160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x12863c910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x12863ce60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x12863d3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x12863d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x12863de50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x12863e3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x12863e8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x12863ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x12863f390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x12863f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x12863fe30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x128640380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x1286408d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x128640e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x128641370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x1286418c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x128641e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x128642360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x1286428b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x128642e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x128643350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x1286438a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x128643df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x128644340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x128644890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x128644de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x128645330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x128645880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x128645dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12a004230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12a0046a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12a004b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12a004f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12a0053f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12a005860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12a005cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12a006140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12a0065b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12a006a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12a006e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x12a007300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x12a007770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x12a007be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x12a008050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x12a0084c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x12a008930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x12a008da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x12a009210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x12a009680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x12a009af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x12a009f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x12a00a3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x12a00a840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x12a00acb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x12a00b120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x12a00b590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x12a00ba00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x12a00be70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x12a00c2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x12a00c750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x12a00cbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x12a00d030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x12a00d4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x12a00d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x12a00dd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x12a00e1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x12a00e660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x12a00ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x12a00ef40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x12a00f3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x12a00f820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x12a0102c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x12a0109e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x12a011100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x12a011820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x12a011ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12a011da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12a012210 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x12a0044e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x12a004950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x12a004dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x12a005230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x12a0056a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12a005b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12a005f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12a0063f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12a006860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12a006cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12a007140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12a007720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x12a008010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x12a008790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x12a008f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x12a009660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x12a009d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x12a00a440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x12a00ab30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x12a00b4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x12a00bba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x12a00c290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x12a00c980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x12a00d070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x12a00d760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x12a00dbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x12a00e040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x12a00e4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x12a00e920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x12a00ed90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x12a00f200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x12a00f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x12a00fae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x12a00fda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x12a010210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x12a010680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x12a010af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x12a010f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x12a0113d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x12a011840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x12a011cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x12a012120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x12a012590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x12a012a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x12a012e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x12a0132e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x12a013750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x12a013bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x12a014030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x12a0144a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12a014910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x12a014d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12a0151f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12a015660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12a015ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x12a016130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x12a0165d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x12a016890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x12a016ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x12a017690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x12a017b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x12a017fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x12a018470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x12a018910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x12a018db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x12a019250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x12a0196f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x12a019b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x12a01a030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x12a01a4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x12a01a970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x12a01ae10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x12a01b2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x12a01b750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x12a01bbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x12a01c090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x12a01c530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x12a01c9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x12a01ce70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x12a01d310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x12a01d7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x12a01dc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x12a01e0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x12a01e590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x12a01ea30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x12a01eed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x12a01f370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x12a01f810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x12a01fcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x12a020150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x12a0205f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x12a020a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x12a020f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x12a0213d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x12a021870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x12a021d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x12a0221b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x12a022650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x12a022af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x12a022f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x12a023430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x12a0238d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x12a023d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x12a024210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x12a0246b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x12a024b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x12a024ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x12a025490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x12a025930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x12a025dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x12a026270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x12a026710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x12a026bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x12a027050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x12a0274f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x12a027990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x12a027e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x12a0282d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x12a028770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x12a028c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x12a0290b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x12a029550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x12a0299f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x12a029e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x12a02a330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x12a02a7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x12a02ac70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x12a02b110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x12a02b5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x12a02ba50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x12a02bef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x12a02c390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x12a02c830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x12a02ccd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x12a02d170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x12a02d610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x12a02dab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x12a02df50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x12a02e3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x12a02e890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x12a02ed30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x12a02f1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x12a02f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x12a02fb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x12a02ffb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x12a030450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x12a0308f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x12a030d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x12a031230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x12a0316d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x12a031b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x12a032010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x12a0324b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x12a032a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x12a032f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x12a0334a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x12a0339f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x12a033cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x12a0342c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x12a0348d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x12a034ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x12a0354f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x12a035b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x12a0362f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x12a036790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x12a036c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x12a0370d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x12a037880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x12a037dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x12a038320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x12a038870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x12a038dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x12a039310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x12a039860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x12a039db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x12a03a300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x12a03a850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x12a03ada0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x12a03b2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x12a03b840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x12a03bd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x12a03c2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x12a03c830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x12a03cd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x12a03d2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x12a03d820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x12a03dd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x12a03e2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x12a03e810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x12a03ed60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x12a03f2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x12a03f800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x12a03fd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x12a0402a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x12a0407f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x12a040d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12a041290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12a0417e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12a041d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12a042280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12a0427d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12a042d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12a043270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12a0437c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12a043d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12a044260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12a0447b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x12a044d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x12a045250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x12a0457a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x12a045cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x12a046240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x12a046790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x12a046ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x12a047230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x12a047780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x12a047cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x12a048220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x12a048770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x12a048cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x12a049210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x12a049760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x12a049cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x12a04a200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x12a04a6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x12a04ab40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x12a04afe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x12a04b480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x12a04b920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x12a04bdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x12a04c260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x12a04c700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x12a04cba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x12a04d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x12a04d4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x12a04d980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x12a04de20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x12a04e370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x12a04ea90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x12a04f1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x12a04f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x12a04fff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x12a0502b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12a0508c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12a050ed0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


second run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


single seq run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this

real	0m0.906s
user	0m0.241s
sys	0m0.123s
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
