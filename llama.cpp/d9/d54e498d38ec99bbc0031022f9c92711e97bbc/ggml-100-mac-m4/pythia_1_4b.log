Archive:  models-mnt/wikitext/wikitext-2-raw-v1.zip
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.test.raw  
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.valid.raw  
  inflating: models-mnt/wikitext/wikitext-2-raw/wiki.train.raw  
+ cmake -DCMAKE_BUILD_TYPE=Release -DLLAMA_FATAL_WARNINGS=ON -DGGML_METAL=ON -DGGML_METAL_USE_BF16=ON ..
-- The C compiler identification is AppleClang 16.0.0.16000026
-- The CXX compiler identification is AppleClang 16.0.0.16000026
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Check for working C compiler: /Library/Developer/CommandLineTools/usr/bin/cc - skipped
-- Detecting C compile features
-- Detecting C compile features - done
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Check for working CXX compiler: /Library/Developer/CommandLineTools/usr/bin/c++ - skipped
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- Found Git: /usr/bin/git (found version "2.39.5 (Apple Git-154)")
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD
-- Performing Test CMAKE_HAVE_LIBC_PTHREAD - Success
-- Found Threads: TRUE
-- ccache found, compilation results will be cached. Disable with GGML_CCACHE=OFF.
-- CMAKE_SYSTEM_PROCESSOR: arm64
-- Accelerate framework found
-- Could NOT find OpenMP_C (missing: OpenMP_C_FLAGS OpenMP_C_LIB_NAMES) 
-- Could NOT find OpenMP_CXX (missing: OpenMP_CXX_FLAGS OpenMP_CXX_LIB_NAMES) 
-- Could NOT find OpenMP (missing: OpenMP_C_FOUND OpenMP_CXX_FOUND) 
CMake Warning at ggml/src/ggml-cpu/CMakeLists.txt:43 (message):
  OpenMP not found


-- Using llamafile
-- ARM detected
-- Performing Test COMPILER_SUPPORTS_FP16_FORMAT_I3E
-- Performing Test COMPILER_SUPPORTS_FP16_FORMAT_I3E - Failed
-- Using runtime weight conversion of Q4_0 to Q4_0_x_x to enable optimized GEMM/GEMV kernels
-- Including CPU backend
CMake Warning at ggml/src/ggml-amx/CMakeLists.txt:106 (message):
  AMX requires x86 and gcc version > 11.0.  Turning off GGML_AMX.


-- Looking for dgemm_
-- Looking for dgemm_ - found
-- Found BLAS: /Library/Developer/CommandLineTools/SDKs/MacOSX15.1.sdk/System/Library/Frameworks/Accelerate.framework
-- BLAS found, Libraries: /Library/Developer/CommandLineTools/SDKs/MacOSX15.1.sdk/System/Library/Frameworks/Accelerate.framework
-- BLAS found, Includes: 
-- Including BLAS backend
-- Metal framework found
-- The ASM compiler identification is AppleClang
-- Found assembler: /Library/Developer/CommandLineTools/usr/bin/cc
-- Including METAL backend
-- Configuring done (1.1s)
-- Generating done (0.2s)
-- Build files have been written to: /Users/ggml/work/llama.cpp/build-ci-release

real	0m1.312s
user	0m0.545s
sys	0m0.789s
++ nproc
+ make -j10
[  0%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml.c.o
[  1%] Building C object examples/gguf-hash/CMakeFiles/xxhash.dir/deps/xxhash/xxhash.c.o
[  2%] Building CXX object common/CMakeFiles/build_info.dir/build-info.cpp.o
[  3%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-threading.cpp.o
[  3%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-alloc.c.o
[  3%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-backend.cpp.o
[  4%] Building CXX object ggml/src/CMakeFiles/ggml-base.dir/ggml-opt.cpp.o
[  5%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-quants.c.o
[  6%] Building C object examples/gguf-hash/CMakeFiles/sha256.dir/deps/sha256/sha256.c.o
[  6%] Building C object examples/gguf-hash/CMakeFiles/sha1.dir/deps/sha1/sha1.c.o
[  6%] Built target build_info
[  6%] Building C object ggml/src/CMakeFiles/ggml-base.dir/ggml-aarch64.c.o
[  6%] Built target xxhash
[  6%] Built target sha256
[  6%] Built target sha1
[  7%] Linking CXX shared library libggml-base.dylib
[  7%] Built target ggml-base
[  8%] Generate assembly for embedded Metal library
Embedding Metal library
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu.c.o
[ 10%] Building CXX object ggml/src/ggml-blas/CMakeFiles/ggml-blas.dir/ggml-blas.cpp.o
[ 10%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu-quants.c.o
[ 11%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/llamafile/sgemm.cpp.o
[ 11%] Building CXX object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu.cpp.o
[ 12%] Building C object ggml/src/ggml-cpu/CMakeFiles/ggml-cpu.dir/ggml-cpu-aarch64.c.o
[ 12%] Linking CXX shared library libggml-cpu.dylib
[ 12%] Linking CXX shared library libggml-blas.dylib
[ 12%] Building C object ggml/src/ggml-metal/CMakeFiles/ggml-metal.dir/ggml-metal.m.o
[ 13%] Building ASM object ggml/src/ggml-metal/CMakeFiles/ggml-metal.dir/__/__/__/autogenerated/ggml-metal-embed.s.o
[ 13%] Built target ggml-cpu
[ 13%] Built target ggml-blas
[ 14%] Linking C shared library libggml-metal.dylib
[ 14%] Built target ggml-metal
[ 14%] Building CXX object ggml/src/CMakeFiles/ggml.dir/ggml-backend-reg.cpp.o
[ 15%] Linking CXX shared library libggml.dylib
[ 15%] Built target ggml
[ 15%] Building CXX object src/CMakeFiles/llama.dir/llama.cpp.o
[ 16%] Building CXX object examples/gguf/CMakeFiles/llama-gguf.dir/gguf.cpp.o
[ 18%] Building CXX object src/CMakeFiles/llama.dir/llama-vocab.cpp.o
[ 18%] Building CXX object examples/gguf-hash/CMakeFiles/llama-gguf-hash.dir/gguf-hash.cpp.o
[ 18%] Building CXX object src/CMakeFiles/llama.dir/llama-grammar.cpp.o
[ 19%] Building CXX object src/CMakeFiles/llama.dir/llama-sampling.cpp.o
[ 19%] Building CXX object src/CMakeFiles/llama.dir/unicode.cpp.o
[ 20%] Building CXX object src/CMakeFiles/llama.dir/unicode-data.cpp.o
[ 20%] Linking CXX executable ../../bin/llama-gguf
[ 20%] Linking CXX executable ../../bin/llama-gguf-hash
[ 20%] Linking CXX shared library libllama.dylib
[ 20%] Built target llama-gguf-hash
[ 20%] Built target llama-gguf
[ 20%] Built target llama
[ 20%] Building CXX object common/CMakeFiles/common.dir/arg.cpp.o
[ 21%] Building CXX object examples/llava/CMakeFiles/llava.dir/clip.cpp.o
[ 21%] Building CXX object examples/llava/CMakeFiles/llava.dir/llava.cpp.o
[ 21%] Building C object tests/CMakeFiles/test-c.dir/test-c.c.o
[ 23%] Building CXX object examples/quantize-stats/CMakeFiles/llama-quantize-stats.dir/quantize-stats.cpp.o
[ 23%] Building CXX object common/CMakeFiles/common.dir/common.cpp.o
[ 23%] Building CXX object common/CMakeFiles/common.dir/console.cpp.o
[ 24%] Building CXX object common/CMakeFiles/common.dir/json-schema-to-grammar.cpp.o
[ 25%] Building CXX object examples/simple/CMakeFiles/llama-simple.dir/simple.cpp.o
[ 26%] Building CXX object examples/simple-chat/CMakeFiles/llama-simple-chat.dir/simple-chat.cpp.o
[ 26%] Building CXX object common/CMakeFiles/common.dir/sampling.cpp.o
[ 27%] Built target llava
[ 27%] Building CXX object common/CMakeFiles/common.dir/ngram-cache.cpp.o
[ 29%] Linking C executable ../bin/test-c
[ 29%] Building CXX object common/CMakeFiles/common.dir/speculative.cpp.o
[ 29%] Building CXX object common/CMakeFiles/common.dir/log.cpp.o
[ 29%] Linking CXX executable ../../bin/llama-simple-chat
[ 29%] Linking CXX executable ../../bin/llama-quantize-stats
[ 29%] Linking CXX executable ../../bin/llama-simple
[ 30%] Linking CXX static library libllava_static.a
[ 30%] Linking CXX shared library libllava_shared.dylib
[ 31%] Linking CXX static library libcommon.a
[ 31%] Built target test-c
[ 31%] Built target llama-quantize-stats
[ 31%] Built target llama-simple
[ 31%] Built target llama-simple-chat
[ 31%] Built target llava_static
[ 31%] Built target common
[ 31%] Built target llava_shared
[ 31%] Building CXX object tests/CMakeFiles/test-log.dir/test-log.cpp.o
[ 32%] Building CXX object tests/CMakeFiles/test-sampling.dir/test-sampling.cpp.o
[ 32%] Building CXX object tests/CMakeFiles/test-tokenizer-1-spm.dir/test-tokenizer-1-spm.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-quantize-fns.dir/test-quantize-fns.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-tokenizer-1-bpe.dir/test-tokenizer-1-bpe.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-grammar-parser.dir/test-grammar-parser.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-chat-template.dir/test-chat-template.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-tokenizer-0.dir/test-tokenizer-0.cpp.o
[ 33%] Building CXX object tests/CMakeFiles/test-quantize-perf.dir/test-quantize-perf.cpp.o
[ 34%] Building CXX object tests/CMakeFiles/test-arg-parser.dir/test-arg-parser.cpp.o
[ 34%] Building CXX object tests/CMakeFiles/test-sampling.dir/get-model.cpp.o
[ 35%] Linking CXX executable ../bin/test-tokenizer-1-spm
[ 36%] Building CXX object tests/CMakeFiles/test-log.dir/get-model.cpp.o
[ 37%] Linking CXX executable ../bin/test-tokenizer-1-bpe
[ 38%] Building CXX object tests/CMakeFiles/test-grammar-parser.dir/get-model.cpp.o
[ 37%] Building CXX object tests/CMakeFiles/test-quantize-fns.dir/get-model.cpp.o
[ 39%] Linking CXX executable ../bin/test-tokenizer-0
[ 40%] Building CXX object tests/CMakeFiles/test-quantize-perf.dir/get-model.cpp.o
[ 40%] Building CXX object tests/CMakeFiles/test-arg-parser.dir/get-model.cpp.o
[ 41%] Building CXX object tests/CMakeFiles/test-chat-template.dir/get-model.cpp.o
[ 42%] Linking CXX executable ../bin/test-sampling
[ 43%] Linking CXX executable ../bin/test-grammar-parser
[ 43%] Linking CXX executable ../bin/test-log
[ 44%] Linking CXX executable ../bin/test-quantize-fns
[ 44%] Linking CXX executable ../bin/test-quantize-perf
[ 44%] Linking CXX executable ../bin/test-chat-template
[ 45%] Linking CXX executable ../bin/test-arg-parser
[ 45%] Built target test-tokenizer-0
[ 45%] Built target test-tokenizer-1-spm
[ 45%] Built target test-tokenizer-1-bpe
[ 45%] Built target test-grammar-parser
[ 45%] Built target test-sampling
[ 45%] Built target test-quantize-fns
[ 45%] Built target test-log
[ 45%] Built target test-quantize-perf
[ 46%] Built target test-arg-parser
[ 46%] Building CXX object tests/CMakeFiles/test-llama-grammar.dir/test-llama-grammar.cpp.o
[ 46%] Built target test-chat-template
[ 47%] Building CXX object tests/CMakeFiles/test-grammar-integration.dir/test-grammar-integration.cpp.o
[ 47%] Building CXX object tests/CMakeFiles/test-grammar-integration.dir/get-model.cpp.o
[ 47%] Building CXX object tests/CMakeFiles/test-llama-grammar.dir/get-model.cpp.o
[ 47%] Building CXX object tests/CMakeFiles/test-barrier.dir/test-barrier.cpp.o
[ 48%] Building CXX object tests/CMakeFiles/test-barrier.dir/get-model.cpp.o
[ 49%] Building CXX object tests/CMakeFiles/test-backend-ops.dir/test-backend-ops.cpp.o
[ 50%] Building CXX object tests/CMakeFiles/test-model-load-cancel.dir/test-model-load-cancel.cpp.o
[ 51%] Building CXX object tests/CMakeFiles/test-rope.dir/test-rope.cpp.o
[ 51%] Building CXX object tests/CMakeFiles/test-autorelease.dir/test-autorelease.cpp.o
[ 51%] Building CXX object tests/CMakeFiles/test-backend-ops.dir/get-model.cpp.o
[ 52%] Linking CXX executable ../bin/test-llama-grammar
[ 53%] Linking CXX executable ../bin/test-grammar-integration
[ 54%] Building CXX object tests/CMakeFiles/test-model-load-cancel.dir/get-model.cpp.o
[ 55%] Linking CXX executable ../bin/test-barrier
[ 55%] Building CXX object tests/CMakeFiles/test-json-schema-to-grammar.dir/test-json-schema-to-grammar.cpp.o
[ 55%] Building CXX object tests/CMakeFiles/test-rope.dir/get-model.cpp.o
[ 56%] Linking CXX executable ../bin/test-backend-ops
[ 57%] Building CXX object tests/CMakeFiles/test-autorelease.dir/get-model.cpp.o
[ 57%] Linking CXX executable ../bin/test-model-load-cancel
[ 58%] Building CXX object tests/CMakeFiles/test-json-schema-to-grammar.dir/get-model.cpp.o
[ 58%] Building CXX object examples/cvector-generator/CMakeFiles/llama-cvector-generator.dir/cvector-generator.cpp.o
[ 59%] Linking CXX executable ../bin/test-rope
[ 59%] Built target test-llama-grammar
[ 60%] Building CXX object examples/batched-bench/CMakeFiles/llama-batched-bench.dir/batched-bench.cpp.o
[ 60%] Linking CXX executable ../bin/test-autorelease
[ 60%] Built target test-grammar-integration
[ 60%] Built target test-barrier
[ 60%] Linking CXX executable ../bin/test-json-schema-to-grammar
[ 60%] Built target test-backend-ops
[ 61%] Linking CXX executable ../../bin/llama-cvector-generator
[ 61%] Built target test-model-load-cancel
[ 62%] Linking CXX executable ../../bin/llama-batched-bench
[ 62%] Building CXX object examples/convert-llama2c-to-ggml/CMakeFiles/llama-convert-llama2c-to-ggml.dir/convert-llama2c-to-ggml.cpp.o
[ 63%] Building CXX object examples/batched/CMakeFiles/llama-batched.dir/batched.cpp.o
[ 63%] Building CXX object examples/embedding/CMakeFiles/llama-embedding.dir/embedding.cpp.o
[ 64%] Building CXX object examples/eval-callback/CMakeFiles/llama-eval-callback.dir/eval-callback.cpp.o
[ 64%] Built target test-autorelease
[ 64%] Built target test-rope
[ 65%] Building CXX object examples/export-lora/CMakeFiles/llama-export-lora.dir/export-lora.cpp.o
[ 66%] Linking CXX executable ../../bin/llama-convert-llama2c-to-ggml
[ 66%] Linking CXX executable ../../bin/llama-batched
[ 66%] Built target test-json-schema-to-grammar
[ 67%] Linking CXX executable ../../bin/llama-embedding
[ 67%] Built target llama-cvector-generator
[ 67%] Linking CXX executable ../../bin/llama-eval-callback
[ 68%] Building CXX object examples/gguf-split/CMakeFiles/llama-gguf-split.dir/gguf-split.cpp.o
[ 68%] Built target llama-batched-bench
[ 69%] Building CXX object examples/gbnf-validator/CMakeFiles/llama-gbnf-validator.dir/gbnf-validator.cpp.o
[ 69%] Linking CXX executable ../../bin/llama-export-lora
[ 69%] Building CXX object examples/gritlm/CMakeFiles/llama-gritlm.dir/gritlm.cpp.o
[ 70%] Linking CXX executable ../../bin/llama-gguf-split
[ 70%] Building CXX object examples/imatrix/CMakeFiles/llama-imatrix.dir/imatrix.cpp.o
[ 70%] Building CXX object examples/infill/CMakeFiles/llama-infill.dir/infill.cpp.o
[ 70%] Linking CXX executable ../../bin/llama-gbnf-validator
[ 70%] Built target llama-convert-llama2c-to-ggml
[ 70%] Built target llama-batched
[ 70%] Built target llama-embedding
[ 71%] Linking CXX executable ../../bin/llama-gritlm
[ 71%] Built target llama-eval-callback
[ 72%] Linking CXX executable ../../bin/llama-imatrix
[ 73%] Linking CXX executable ../../bin/llama-infill
[ 73%] Built target llama-export-lora
[ 73%] Building CXX object examples/llava/CMakeFiles/llama-llava-cli.dir/llava-cli.cpp.o
[ 73%] Building CXX object examples/llama-bench/CMakeFiles/llama-bench.dir/llama-bench.cpp.o
[ 73%] Built target llama-gguf-split
[ 74%] Building CXX object examples/llava/CMakeFiles/llama-minicpmv-cli.dir/minicpmv-cli.cpp.o
[ 74%] Built target llama-gbnf-validator
[ 74%] Building CXX object examples/lookahead/CMakeFiles/llama-lookahead.dir/lookahead.cpp.o
[ 75%] Building CXX object examples/lookup/CMakeFiles/llama-lookup.dir/lookup.cpp.o
[ 76%] Linking CXX executable ../../bin/llama-llava-cli
[ 77%] Linking CXX executable ../../bin/llama-bench
[ 77%] Built target llama-infill
[ 77%] Built target llama-imatrix
[ 78%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-create.dir/lookup-create.cpp.o
[ 78%] Linking CXX executable ../../bin/llama-minicpmv-cli
[ 79%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-merge.dir/lookup-merge.cpp.o
[ 79%] Built target llama-gritlm
[ 80%] Linking CXX executable ../../bin/llama-lookahead
[ 80%] Linking CXX executable ../../bin/llama-lookup
[ 80%] Building CXX object examples/main/CMakeFiles/llama-cli.dir/main.cpp.o
[ 81%] Building CXX object examples/lookup/CMakeFiles/llama-lookup-stats.dir/lookup-stats.cpp.o
[ 81%] Linking CXX executable ../../bin/llama-lookup-merge
[ 81%] Linking CXX executable ../../bin/llama-lookup-create
[ 82%] Building CXX object examples/parallel/CMakeFiles/llama-parallel.dir/parallel.cpp.o
[ 82%] Built target llama-bench
[ 82%] Built target llama-llava-cli
[ 82%] Built target llama-minicpmv-cli
[ 82%] Linking CXX executable ../../bin/llama-lookup-stats
[ 83%] Linking CXX executable ../../bin/llama-cli
[ 83%] Built target llama-lookahead
[ 83%] Built target llama-lookup
[ 84%] Linking CXX executable ../../bin/llama-parallel
[ 84%] Building CXX object examples/passkey/CMakeFiles/llama-passkey.dir/passkey.cpp.o
[ 84%] Building CXX object examples/perplexity/CMakeFiles/llama-perplexity.dir/perplexity.cpp.o
[ 84%] Built target llama-lookup-merge
[ 84%] Building CXX object examples/quantize/CMakeFiles/llama-quantize.dir/quantize.cpp.o
[ 85%] Generating loading.html.hpp
[ 85%] Built target llama-lookup-create
[ 86%] Building CXX object examples/retrieval/CMakeFiles/llama-retrieval.dir/retrieval.cpp.o
[ 87%] Linking CXX executable ../../bin/llama-passkey
[ 88%] Built target llama-cli
[ 88%] Linking CXX executable ../../bin/llama-quantize
[ 89%] Linking CXX executable ../../bin/llama-perplexity
[ 89%] Generating completion.js.hpp
[ 90%] Building CXX object examples/save-load-state/CMakeFiles/llama-save-load-state.dir/save-load-state.cpp.o
[ 90%] Built target llama-lookup-stats
[ 91%] Building CXX object examples/speculative/CMakeFiles/llama-speculative.dir/speculative.cpp.o
[ 91%] Built target llama-parallel
[ 91%] Linking CXX executable ../../bin/llama-retrieval
[ 91%] Generating deps_daisyui.min.css.hpp
[ 92%] Generating deps_markdown-it.js.hpp
[ 92%] Linking CXX executable ../../bin/llama-save-load-state
[ 94%] Generating deps_tailwindcss.js.hpp
[ 94%] Building CXX object examples/speculative-simple/CMakeFiles/llama-speculative-simple.dir/speculative-simple.cpp.o
[ 94%] Linking CXX executable ../../bin/llama-speculative
[ 94%] Built target llama-quantize
[ 94%] Built target llama-passkey
[ 95%] Linking CXX executable ../../bin/llama-speculative-simple
[ 95%] Built target llama-perplexity
[ 95%] Built target llama-retrieval
[ 95%] Generating deps_vue.esm-browser.js.hpp
[ 96%] Generating index.html.hpp
[ 96%] Built target llama-save-load-state
[ 96%] Building CXX object examples/tokenize/CMakeFiles/llama-tokenize.dir/tokenize.cpp.o
[ 96%] Built target llama-speculative
[ 96%] Building CXX object pocs/vdot/CMakeFiles/llama-vdot.dir/vdot.cpp.o
[ 96%] Built target llama-speculative-simple
[ 97%] Linking CXX executable ../../bin/llama-tokenize
[ 98%] Linking CXX executable ../../bin/llama-vdot
[ 98%] Building CXX object pocs/vdot/CMakeFiles/llama-q8dot.dir/q8dot.cpp.o
[ 99%] Linking CXX executable ../../bin/llama-q8dot
[ 99%] Built target llama-vdot
[ 99%] Built target llama-tokenize
[ 99%] Built target llama-q8dot
[100%] Building CXX object examples/server/CMakeFiles/llama-server.dir/server.cpp.o
[100%] Linking CXX executable ../../bin/llama-server
[100%] Built target llama-server

real	0m2.483s
user	0m5.904s
sys	0m8.971s

main: quantize time =  3962.30 ms
main:    total time =  3962.30 ms

main: quantize time =  2084.42 ms
main:    total time =  2084.42 ms

main: quantize time =  2206.89 ms
main:    total time =  2206.89 ms

main: quantize time =  2518.39 ms
main:    total time =  2518.39 ms

main: quantize time =  2251.26 ms
main:    total time =  2251.26 ms

main: quantize time =  5162.97 ms
main:    total time =  5162.97 ms

main: quantize time =  5760.54 ms
main:    total time =  5760.54 ms

main: quantize time =  6904.15 ms
main:    total time =  6904.15 ms

main: quantize time =  5906.52 ms
main:    total time =  5906.52 ms

main: quantize time =  4569.19 ms
main:    total time =  4569.19 ms
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.115 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.255 I main: llama backend init
0.00.000.263 I main: load the model and apply lora adapter, if any
0.00.028.877 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.040.703 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.040.716 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.040.720 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.040.721 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.040.722 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.040.722 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.040.723 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.040.725 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.040.726 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.040.726 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.040.727 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.040.728 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.040.729 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.040.729 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.040.733 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.040.733 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.040.734 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.049.189 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.051.213 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.058.356 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.058.358 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.058.359 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.058.359 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.058.360 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.058.360 I llama_model_loader: - type  f32:  194 tensors
0.00.058.361 I llama_model_loader: - type  f16:   98 tensors
0.00.087.742 I llm_load_vocab: special tokens cache size = 25
0.00.094.435 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.094.438 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.094.438 I llm_load_print_meta: arch             = gptneox
0.00.094.438 I llm_load_print_meta: vocab type       = BPE
0.00.094.439 I llm_load_print_meta: n_vocab          = 50304
0.00.094.439 I llm_load_print_meta: n_merges         = 50009
0.00.094.439 I llm_load_print_meta: vocab_only       = 0
0.00.094.439 I llm_load_print_meta: n_ctx_train      = 2048
0.00.094.439 I llm_load_print_meta: n_embd           = 2048
0.00.094.439 I llm_load_print_meta: n_layer          = 24
0.00.094.442 I llm_load_print_meta: n_head           = 16
0.00.094.443 I llm_load_print_meta: n_head_kv        = 16
0.00.094.443 I llm_load_print_meta: n_rot            = 32
0.00.094.443 I llm_load_print_meta: n_swa            = 0
0.00.094.443 I llm_load_print_meta: n_embd_head_k    = 128
0.00.094.443 I llm_load_print_meta: n_embd_head_v    = 128
0.00.094.444 I llm_load_print_meta: n_gqa            = 1
0.00.094.445 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.094.445 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.094.446 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.094.446 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.094.446 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.094.446 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.094.446 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.094.447 I llm_load_print_meta: n_ff             = 8192
0.00.094.447 I llm_load_print_meta: n_expert         = 0
0.00.094.447 I llm_load_print_meta: n_expert_used    = 0
0.00.094.447 I llm_load_print_meta: causal attn      = 1
0.00.094.447 I llm_load_print_meta: pooling type     = 0
0.00.094.447 I llm_load_print_meta: rope type        = 2
0.00.094.448 I llm_load_print_meta: rope scaling     = linear
0.00.094.448 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.094.448 I llm_load_print_meta: freq_scale_train = 1
0.00.094.448 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.094.449 I llm_load_print_meta: rope_finetuned   = unknown
0.00.094.449 I llm_load_print_meta: ssm_d_conv       = 0
0.00.094.449 I llm_load_print_meta: ssm_d_inner      = 0
0.00.094.449 I llm_load_print_meta: ssm_d_state      = 0
0.00.094.449 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.094.449 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.094.461 I llm_load_print_meta: model type       = 1.4B
0.00.094.462 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.094.462 I llm_load_print_meta: model params     = 1.41 B
0.00.094.463 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.094.463 I llm_load_print_meta: general.name     = 1.4B
0.00.094.463 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.094.463 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.094.463 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.094.463 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.094.464 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.094.464 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.094.464 I llm_load_print_meta: max token length = 1024
0.00.097.063 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.097.063 I llm_load_tensors: offloading output layer to GPU
0.00.097.064 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.097.081 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.097.082 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.098.035 I llama_new_context_with_model: n_seq_max     = 1
0.00.098.036 I llama_new_context_with_model: n_ctx         = 2048
0.00.098.036 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.098.036 I llama_new_context_with_model: n_batch       = 2048
0.00.098.036 I llama_new_context_with_model: n_ubatch      = 512
0.00.098.036 I llama_new_context_with_model: flash_attn    = 0
0.00.098.037 I llama_new_context_with_model: freq_base     = 10000.0
0.00.098.037 I llama_new_context_with_model: freq_scale    = 1
0.00.098.037 I ggml_metal_init: allocating
0.00.098.041 I ggml_metal_init: found device: Apple M4
0.00.098.043 I ggml_metal_init: picking default device: Apple M4
0.00.098.662 I ggml_metal_init: using embedded metal library
0.00.108.053 I ggml_metal_init: GPU name:   Apple M4
0.00.108.055 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.108.055 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.108.055 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.108.056 I ggml_metal_init: simdgroup reduction   = true
0.00.108.056 I ggml_metal_init: simdgroup matrix mul. = true
0.00.108.056 I ggml_metal_init: has bfloat            = true
0.00.108.056 I ggml_metal_init: use bfloat            = true
0.00.108.056 I ggml_metal_init: hasUnifiedMemory      = true
0.00.108.057 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.141.583 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.141.588 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.141.610 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.142.520 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.142.521 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.142.521 I llama_new_context_with_model: graph nodes  = 967
0.00.142.521 I llama_new_context_with_model: graph splits = 2
0.00.142.543 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.232.055 I main: llama threadpool init, n_threads = 4
0.00.232.099 I 
0.00.232.124 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.232.125 I 
0.00.232.222 I sampler seed: 1234
0.00.232.226 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.232.251 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.232.253 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.232.253 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling depressed, and I've had a hard time getting out of bed. I think the only thing I

0.02.088.561 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57258.06 tokens per second)
0.02.088.562 I llama_perf_context_print:        load time =     203.16 ms
0.02.088.563 I llama_perf_context_print: prompt eval time =      38.41 ms /     7 tokens (    5.49 ms per token,   182.24 tokens per second)
0.02.088.564 I llama_perf_context_print:        eval time =    1815.02 ms /    63 runs   (   28.81 ms per token,    34.71 tokens per second)
0.02.088.564 I llama_perf_context_print:       total time =    1856.51 ms /    70 tokens
0.02.088.744 I ggml_metal_free: deallocating

real	0m2.360s
user	0m0.141s
sys	0m0.094s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.040 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.078 I main: llama backend init
0.00.000.081 I main: load the model and apply lora adapter, if any
0.00.009.505 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.724 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.019.728 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.730 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.019.731 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.731 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.019.731 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.019.732 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.019.733 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.019.733 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.019.734 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.019.735 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.019.736 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.019.736 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.019.736 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.019.738 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.019.738 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.019.739 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.586 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.641 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.554 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.555 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.556 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.556 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.556 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.557 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.028.557 I llama_model_loader: - type  f32:  194 tensors
0.00.028.558 I llama_model_loader: - type q8_0:   98 tensors
0.00.050.968 I llm_load_vocab: special tokens cache size = 25
0.00.056.873 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.056.877 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.056.878 I llm_load_print_meta: arch             = gptneox
0.00.056.878 I llm_load_print_meta: vocab type       = BPE
0.00.056.878 I llm_load_print_meta: n_vocab          = 50304
0.00.056.878 I llm_load_print_meta: n_merges         = 50009
0.00.056.880 I llm_load_print_meta: vocab_only       = 0
0.00.056.880 I llm_load_print_meta: n_ctx_train      = 2048
0.00.056.882 I llm_load_print_meta: n_embd           = 2048
0.00.056.883 I llm_load_print_meta: n_layer          = 24
0.00.056.888 I llm_load_print_meta: n_head           = 16
0.00.056.889 I llm_load_print_meta: n_head_kv        = 16
0.00.056.889 I llm_load_print_meta: n_rot            = 32
0.00.056.890 I llm_load_print_meta: n_swa            = 0
0.00.056.891 I llm_load_print_meta: n_embd_head_k    = 128
0.00.056.891 I llm_load_print_meta: n_embd_head_v    = 128
0.00.056.892 I llm_load_print_meta: n_gqa            = 1
0.00.056.893 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.056.894 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.056.894 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.056.895 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.056.895 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.056.895 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.056.895 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.056.896 I llm_load_print_meta: n_ff             = 8192
0.00.056.898 I llm_load_print_meta: n_expert         = 0
0.00.056.898 I llm_load_print_meta: n_expert_used    = 0
0.00.056.898 I llm_load_print_meta: causal attn      = 1
0.00.056.898 I llm_load_print_meta: pooling type     = 0
0.00.056.898 I llm_load_print_meta: rope type        = 2
0.00.056.900 I llm_load_print_meta: rope scaling     = linear
0.00.056.900 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.056.900 I llm_load_print_meta: freq_scale_train = 1
0.00.056.900 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.056.900 I llm_load_print_meta: rope_finetuned   = unknown
0.00.056.901 I llm_load_print_meta: ssm_d_conv       = 0
0.00.056.901 I llm_load_print_meta: ssm_d_inner      = 0
0.00.056.901 I llm_load_print_meta: ssm_d_state      = 0
0.00.056.901 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.056.901 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.056.910 I llm_load_print_meta: model type       = 1.4B
0.00.056.910 I llm_load_print_meta: model ftype      = Q8_0
0.00.056.910 I llm_load_print_meta: model params     = 1.41 B
0.00.056.911 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.056.912 I llm_load_print_meta: general.name     = 1.4B
0.00.056.913 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.056.913 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.056.913 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.056.913 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.056.913 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.056.914 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.056.914 I llm_load_print_meta: max token length = 1024
0.00.059.023 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.059.023 I llm_load_tensors: offloading output layer to GPU
0.00.059.024 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.059.029 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.059.030 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.060.031 I llama_new_context_with_model: n_seq_max     = 1
0.00.060.032 I llama_new_context_with_model: n_ctx         = 2048
0.00.060.032 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.060.032 I llama_new_context_with_model: n_batch       = 2048
0.00.060.032 I llama_new_context_with_model: n_ubatch      = 512
0.00.060.032 I llama_new_context_with_model: flash_attn    = 0
0.00.060.033 I llama_new_context_with_model: freq_base     = 10000.0
0.00.060.033 I llama_new_context_with_model: freq_scale    = 1
0.00.060.034 I ggml_metal_init: allocating
0.00.060.043 I ggml_metal_init: found device: Apple M4
0.00.060.046 I ggml_metal_init: picking default device: Apple M4
0.00.060.766 I ggml_metal_init: using embedded metal library
0.00.062.877 I ggml_metal_init: GPU name:   Apple M4
0.00.062.879 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.062.879 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.062.880 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.062.880 I ggml_metal_init: simdgroup reduction   = true
0.00.062.880 I ggml_metal_init: simdgroup matrix mul. = true
0.00.062.880 I ggml_metal_init: has bfloat            = true
0.00.062.881 I ggml_metal_init: use bfloat            = true
0.00.062.881 I ggml_metal_init: hasUnifiedMemory      = true
0.00.062.882 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.098.194 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.098.203 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.098.227 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.099.351 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.099.352 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.099.352 I llama_new_context_with_model: graph nodes  = 967
0.00.099.352 I llama_new_context_with_model: graph splits = 2
0.00.099.366 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.147.874 I main: llama threadpool init, n_threads = 4
0.01.147.903 I 
0.01.147.923 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.01.147.924 I 
0.01.148.098 I sampler seed: 1234
0.01.148.103 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.148.112 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.148.113 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.148.113 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.239.117 I llama_perf_sampler_print:    sampling time =       1.28 ms /    71 runs   (    0.02 ms per token, 55686.27 tokens per second)
0.02.239.118 I llama_perf_context_print:        load time =    1138.37 ms
0.02.239.119 I llama_perf_context_print: prompt eval time =      33.55 ms /     7 tokens (    4.79 ms per token,   208.67 tokens per second)
0.02.239.119 I llama_perf_context_print:        eval time =    1054.35 ms /    63 runs   (   16.74 ms per token,    59.75 tokens per second)
0.02.239.120 I llama_perf_context_print:       total time =    1091.25 ms /    70 tokens
0.02.239.300 I ggml_metal_free: deallocating

real	0m2.256s
user	0m0.111s
sys	0m0.240s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.042 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.074 I main: llama backend init
0.00.000.076 I main: load the model and apply lora adapter, if any
0.00.017.088 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.025.700 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.025.705 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.025.707 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.025.709 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.025.709 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.025.710 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.025.710 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.025.711 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.025.711 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.025.712 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.025.712 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.025.712 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.025.713 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.025.713 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.025.714 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.025.715 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.025.715 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.030.093 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.031.322 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.035.771 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.035.773 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.035.773 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.035.773 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.035.773 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.035.774 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.035.774 I llama_model_loader: - type  f32:  194 tensors
0.00.035.775 I llama_model_loader: - type q4_0:   97 tensors
0.00.035.775 I llama_model_loader: - type q6_K:    1 tensors
0.00.060.320 I llm_load_vocab: special tokens cache size = 25
0.00.067.027 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.067.031 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.067.031 I llm_load_print_meta: arch             = gptneox
0.00.067.031 I llm_load_print_meta: vocab type       = BPE
0.00.067.032 I llm_load_print_meta: n_vocab          = 50304
0.00.067.032 I llm_load_print_meta: n_merges         = 50009
0.00.067.032 I llm_load_print_meta: vocab_only       = 0
0.00.067.032 I llm_load_print_meta: n_ctx_train      = 2048
0.00.067.032 I llm_load_print_meta: n_embd           = 2048
0.00.067.032 I llm_load_print_meta: n_layer          = 24
0.00.067.038 I llm_load_print_meta: n_head           = 16
0.00.067.039 I llm_load_print_meta: n_head_kv        = 16
0.00.067.039 I llm_load_print_meta: n_rot            = 32
0.00.067.039 I llm_load_print_meta: n_swa            = 0
0.00.067.039 I llm_load_print_meta: n_embd_head_k    = 128
0.00.067.041 I llm_load_print_meta: n_embd_head_v    = 128
0.00.067.041 I llm_load_print_meta: n_gqa            = 1
0.00.067.042 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.067.043 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.067.044 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.067.044 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.067.044 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.067.044 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.067.044 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.067.045 I llm_load_print_meta: n_ff             = 8192
0.00.067.045 I llm_load_print_meta: n_expert         = 0
0.00.067.045 I llm_load_print_meta: n_expert_used    = 0
0.00.067.045 I llm_load_print_meta: causal attn      = 1
0.00.067.046 I llm_load_print_meta: pooling type     = 0
0.00.067.047 I llm_load_print_meta: rope type        = 2
0.00.067.047 I llm_load_print_meta: rope scaling     = linear
0.00.067.047 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.067.048 I llm_load_print_meta: freq_scale_train = 1
0.00.067.048 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.067.048 I llm_load_print_meta: rope_finetuned   = unknown
0.00.067.048 I llm_load_print_meta: ssm_d_conv       = 0
0.00.067.048 I llm_load_print_meta: ssm_d_inner      = 0
0.00.067.048 I llm_load_print_meta: ssm_d_state      = 0
0.00.067.048 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.067.049 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.067.063 I llm_load_print_meta: model type       = 1.4B
0.00.067.064 I llm_load_print_meta: model ftype      = Q4_0
0.00.067.064 I llm_load_print_meta: model params     = 1.41 B
0.00.067.064 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.067.064 I llm_load_print_meta: general.name     = 1.4B
0.00.067.065 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.067.065 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.067.065 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.067.065 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.067.066 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.067.066 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.067.066 I llm_load_print_meta: max token length = 1024
0.00.069.423 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.069.424 I llm_load_tensors: offloading output layer to GPU
0.00.069.424 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.069.435 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.069.436 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.070.457 I llama_new_context_with_model: n_seq_max     = 1
0.00.070.458 I llama_new_context_with_model: n_ctx         = 2048
0.00.070.458 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.070.458 I llama_new_context_with_model: n_batch       = 2048
0.00.070.458 I llama_new_context_with_model: n_ubatch      = 512
0.00.070.458 I llama_new_context_with_model: flash_attn    = 0
0.00.070.459 I llama_new_context_with_model: freq_base     = 10000.0
0.00.070.459 I llama_new_context_with_model: freq_scale    = 1
0.00.070.459 I ggml_metal_init: allocating
0.00.070.463 I ggml_metal_init: found device: Apple M4
0.00.070.465 I ggml_metal_init: picking default device: Apple M4
0.00.071.142 I ggml_metal_init: using embedded metal library
0.00.073.378 I ggml_metal_init: GPU name:   Apple M4
0.00.073.379 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.073.380 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.073.380 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.073.380 I ggml_metal_init: simdgroup reduction   = true
0.00.073.380 I ggml_metal_init: simdgroup matrix mul. = true
0.00.073.381 I ggml_metal_init: has bfloat            = true
0.00.073.381 I ggml_metal_init: use bfloat            = true
0.00.073.381 I ggml_metal_init: hasUnifiedMemory      = true
0.00.073.382 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.108.873 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.108.880 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.108.903 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.109.929 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.109.930 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.109.930 I llama_new_context_with_model: graph nodes  = 967
0.00.109.930 I llama_new_context_with_model: graph splits = 2
0.00.109.945 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.786.600 I main: llama threadpool init, n_threads = 4
0.00.786.636 I 
0.00.786.653 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.786.654 I 
0.00.786.795 I sampler seed: 1234
0.00.786.800 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.786.810 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.786.811 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.786.811 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.466.024 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58629.23 tokens per second)
0.01.466.025 I llama_perf_context_print:        load time =     769.51 ms
0.01.466.026 I llama_perf_context_print: prompt eval time =      32.66 ms /     7 tokens (    4.67 ms per token,   214.33 tokens per second)
0.01.466.027 I llama_perf_context_print:        eval time =     643.51 ms /    63 runs   (   10.21 ms per token,    97.90 tokens per second)
0.01.466.027 I llama_perf_context_print:       total time =     679.43 ms /    70 tokens
0.01.466.211 I ggml_metal_free: deallocating

real	0m1.486s
user	0m0.115s
sys	0m0.190s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.066 I main: llama backend init
0.00.000.069 I main: load the model and apply lora adapter, if any
0.00.008.755 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.026.339 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.026.343 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.026.345 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.026.345 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.026.346 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.026.346 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.026.346 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.026.348 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.026.349 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.026.349 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.026.349 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.026.350 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.026.350 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.026.351 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.026.353 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.026.354 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.026.354 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.030.119 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.031.238 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.035.149 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.035.150 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.035.150 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.035.151 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.035.151 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.035.151 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.035.152 I llama_model_loader: - type  f32:  194 tensors
0.00.035.152 I llama_model_loader: - type q4_1:   97 tensors
0.00.035.152 I llama_model_loader: - type q6_K:    1 tensors
0.00.058.611 I llm_load_vocab: special tokens cache size = 25
0.00.064.906 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.064.909 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.064.910 I llm_load_print_meta: arch             = gptneox
0.00.064.910 I llm_load_print_meta: vocab type       = BPE
0.00.064.910 I llm_load_print_meta: n_vocab          = 50304
0.00.064.910 I llm_load_print_meta: n_merges         = 50009
0.00.064.910 I llm_load_print_meta: vocab_only       = 0
0.00.064.911 I llm_load_print_meta: n_ctx_train      = 2048
0.00.064.911 I llm_load_print_meta: n_embd           = 2048
0.00.064.911 I llm_load_print_meta: n_layer          = 24
0.00.064.914 I llm_load_print_meta: n_head           = 16
0.00.064.914 I llm_load_print_meta: n_head_kv        = 16
0.00.064.914 I llm_load_print_meta: n_rot            = 32
0.00.064.914 I llm_load_print_meta: n_swa            = 0
0.00.064.915 I llm_load_print_meta: n_embd_head_k    = 128
0.00.064.915 I llm_load_print_meta: n_embd_head_v    = 128
0.00.064.915 I llm_load_print_meta: n_gqa            = 1
0.00.064.916 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.064.917 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.064.917 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.064.917 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.064.917 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.064.918 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.064.918 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.064.918 I llm_load_print_meta: n_ff             = 8192
0.00.064.919 I llm_load_print_meta: n_expert         = 0
0.00.064.919 I llm_load_print_meta: n_expert_used    = 0
0.00.064.920 I llm_load_print_meta: causal attn      = 1
0.00.064.922 I llm_load_print_meta: pooling type     = 0
0.00.064.922 I llm_load_print_meta: rope type        = 2
0.00.064.922 I llm_load_print_meta: rope scaling     = linear
0.00.064.923 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.064.923 I llm_load_print_meta: freq_scale_train = 1
0.00.064.923 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.064.923 I llm_load_print_meta: rope_finetuned   = unknown
0.00.064.923 I llm_load_print_meta: ssm_d_conv       = 0
0.00.064.924 I llm_load_print_meta: ssm_d_inner      = 0
0.00.064.924 I llm_load_print_meta: ssm_d_state      = 0
0.00.064.924 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.064.924 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.064.935 I llm_load_print_meta: model type       = 1.4B
0.00.064.936 I llm_load_print_meta: model ftype      = Q4_1
0.00.064.937 I llm_load_print_meta: model params     = 1.41 B
0.00.064.937 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.064.938 I llm_load_print_meta: general.name     = 1.4B
0.00.064.938 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.064.938 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.064.938 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.064.939 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.064.939 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.064.939 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.064.939 I llm_load_print_meta: max token length = 1024
0.00.067.017 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.067.017 I llm_load_tensors: offloading output layer to GPU
0.00.067.017 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.067.027 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.067.028 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.068.050 I llama_new_context_with_model: n_seq_max     = 1
0.00.068.051 I llama_new_context_with_model: n_ctx         = 2048
0.00.068.051 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.068.052 I llama_new_context_with_model: n_batch       = 2048
0.00.068.052 I llama_new_context_with_model: n_ubatch      = 512
0.00.068.052 I llama_new_context_with_model: flash_attn    = 0
0.00.068.052 I llama_new_context_with_model: freq_base     = 10000.0
0.00.068.053 I llama_new_context_with_model: freq_scale    = 1
0.00.068.053 I ggml_metal_init: allocating
0.00.068.060 I ggml_metal_init: found device: Apple M4
0.00.068.062 I ggml_metal_init: picking default device: Apple M4
0.00.068.662 I ggml_metal_init: using embedded metal library
0.00.070.847 I ggml_metal_init: GPU name:   Apple M4
0.00.070.849 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.070.849 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.070.849 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.070.850 I ggml_metal_init: simdgroup reduction   = true
0.00.070.850 I ggml_metal_init: simdgroup matrix mul. = true
0.00.070.850 I ggml_metal_init: has bfloat            = true
0.00.070.885 I ggml_metal_init: use bfloat            = true
0.00.070.887 I ggml_metal_init: hasUnifiedMemory      = true
0.00.070.888 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.099.167 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.099.174 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.099.191 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.100.216 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.100.218 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.100.218 I llama_new_context_with_model: graph nodes  = 967
0.00.100.218 I llama_new_context_with_model: graph splits = 2
0.00.100.232 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.785.147 I main: llama threadpool init, n_threads = 4
0.00.785.181 I 
0.00.785.198 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.785.198 I 
0.00.785.344 I sampler seed: 1234
0.00.785.349 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.785.359 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.785.359 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.785.359 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.508.445 I llama_perf_sampler_print:    sampling time =       1.12 ms /    71 runs   (    0.02 ms per token, 63111.11 tokens per second)
0.01.508.445 I llama_perf_context_print:        load time =     776.39 ms
0.01.508.446 I llama_perf_context_print: prompt eval time =      32.72 ms /     7 tokens (    4.67 ms per token,   213.92 tokens per second)
0.01.508.448 I llama_perf_context_print:        eval time =     687.42 ms /    63 runs   (   10.91 ms per token,    91.65 tokens per second)
0.01.508.448 I llama_perf_context_print:       total time =     723.30 ms /    70 tokens
0.01.508.629 I ggml_metal_free: deallocating

real	0m1.522s
user	0m0.111s
sys	0m0.192s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.070 I main: load the model and apply lora adapter, if any
0.00.009.792 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.872 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.016.876 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.878 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.878 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.878 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.879 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.881 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.882 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.882 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.882 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.883 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.885 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.885 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.886 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.888 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.889 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.889 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.757 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.836 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.663 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.664 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.664 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.665 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.665 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.665 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.025.666 I llama_model_loader: - type  f32:  194 tensors
0.00.025.666 I llama_model_loader: - type q5_0:   97 tensors
0.00.025.667 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.979 I llm_load_vocab: special tokens cache size = 25
0.00.051.840 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.842 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.843 I llm_load_print_meta: arch             = gptneox
0.00.051.843 I llm_load_print_meta: vocab type       = BPE
0.00.051.843 I llm_load_print_meta: n_vocab          = 50304
0.00.051.843 I llm_load_print_meta: n_merges         = 50009
0.00.051.844 I llm_load_print_meta: vocab_only       = 0
0.00.051.844 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.844 I llm_load_print_meta: n_embd           = 2048
0.00.051.844 I llm_load_print_meta: n_layer          = 24
0.00.051.847 I llm_load_print_meta: n_head           = 16
0.00.051.848 I llm_load_print_meta: n_head_kv        = 16
0.00.051.848 I llm_load_print_meta: n_rot            = 32
0.00.051.848 I llm_load_print_meta: n_swa            = 0
0.00.051.848 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.848 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.849 I llm_load_print_meta: n_gqa            = 1
0.00.051.850 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.851 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.851 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.852 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.852 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.852 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.852 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.853 I llm_load_print_meta: n_ff             = 8192
0.00.051.853 I llm_load_print_meta: n_expert         = 0
0.00.051.853 I llm_load_print_meta: n_expert_used    = 0
0.00.051.854 I llm_load_print_meta: causal attn      = 1
0.00.051.856 I llm_load_print_meta: pooling type     = 0
0.00.051.856 I llm_load_print_meta: rope type        = 2
0.00.051.856 I llm_load_print_meta: rope scaling     = linear
0.00.051.857 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.857 I llm_load_print_meta: freq_scale_train = 1
0.00.051.857 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.858 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.858 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.858 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.858 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.858 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.858 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.869 I llm_load_print_meta: model type       = 1.4B
0.00.051.870 I llm_load_print_meta: model ftype      = Q5_0
0.00.051.870 I llm_load_print_meta: model params     = 1.41 B
0.00.051.871 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.051.871 I llm_load_print_meta: general.name     = 1.4B
0.00.051.871 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.871 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.873 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.874 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.874 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.874 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.874 I llm_load_print_meta: max token length = 1024
0.00.053.459 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.460 I llm_load_tensors: offloading output layer to GPU
0.00.053.460 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.469 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.053.470 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.054.346 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.347 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.347 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.347 I llama_new_context_with_model: n_batch       = 2048
0.00.054.347 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.348 I llama_new_context_with_model: flash_attn    = 0
0.00.054.348 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.348 I llama_new_context_with_model: freq_scale    = 1
0.00.054.349 I ggml_metal_init: allocating
0.00.054.352 I ggml_metal_init: found device: Apple M4
0.00.054.354 I ggml_metal_init: picking default device: Apple M4
0.00.054.903 I ggml_metal_init: using embedded metal library
0.00.056.828 I ggml_metal_init: GPU name:   Apple M4
0.00.056.829 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.830 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.830 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.830 I ggml_metal_init: simdgroup reduction   = true
0.00.056.830 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.831 I ggml_metal_init: has bfloat            = true
0.00.056.831 I ggml_metal_init: use bfloat            = true
0.00.056.831 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.833 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.084.352 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.084.359 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.084.378 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.085.252 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.085.253 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.085.254 I llama_new_context_with_model: graph nodes  = 967
0.00.085.254 I llama_new_context_with_model: graph splits = 2
0.00.085.261 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.743.430 I main: llama threadpool init, n_threads = 4
0.00.743.465 I 
0.00.743.481 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.743.483 I 
0.00.743.624 I sampler seed: 1234
0.00.743.629 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.743.639 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.743.640 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.743.640 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.532.814 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57211.93 tokens per second)
0.01.532.816 I llama_perf_context_print:        load time =     733.63 ms
0.01.532.816 I llama_perf_context_print: prompt eval time =      36.52 ms /     7 tokens (    5.22 ms per token,   191.68 tokens per second)
0.01.532.817 I llama_perf_context_print:        eval time =     749.60 ms /    63 runs   (   11.90 ms per token,    84.04 tokens per second)
0.01.532.817 I llama_perf_context_print:       total time =     789.38 ms /    70 tokens
0.01.532.995 I ggml_metal_free: deallocating

real	0m1.547s
user	0m0.106s
sys	0m0.186s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.008.332 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.376 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.015.380 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.382 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.382 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.383 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.383 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.384 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.385 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.385 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.385 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.386 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.386 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.386 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.387 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.388 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.389 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.389 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.153 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.180 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.909 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.911 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.911 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.911 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.911 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.912 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.023.912 I llama_model_loader: - type  f32:  194 tensors
0.00.023.913 I llama_model_loader: - type q5_1:   97 tensors
0.00.023.913 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.889 I llm_load_vocab: special tokens cache size = 25
0.00.050.683 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.686 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.686 I llm_load_print_meta: arch             = gptneox
0.00.050.686 I llm_load_print_meta: vocab type       = BPE
0.00.050.687 I llm_load_print_meta: n_vocab          = 50304
0.00.050.687 I llm_load_print_meta: n_merges         = 50009
0.00.050.687 I llm_load_print_meta: vocab_only       = 0
0.00.050.687 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.687 I llm_load_print_meta: n_embd           = 2048
0.00.050.688 I llm_load_print_meta: n_layer          = 24
0.00.050.690 I llm_load_print_meta: n_head           = 16
0.00.050.691 I llm_load_print_meta: n_head_kv        = 16
0.00.050.691 I llm_load_print_meta: n_rot            = 32
0.00.050.692 I llm_load_print_meta: n_swa            = 0
0.00.050.692 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.692 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.695 I llm_load_print_meta: n_gqa            = 1
0.00.050.696 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.697 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.697 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.698 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.698 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.698 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.698 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.705 I llm_load_print_meta: n_ff             = 8192
0.00.050.707 I llm_load_print_meta: n_expert         = 0
0.00.050.707 I llm_load_print_meta: n_expert_used    = 0
0.00.050.707 I llm_load_print_meta: causal attn      = 1
0.00.050.707 I llm_load_print_meta: pooling type     = 0
0.00.050.708 I llm_load_print_meta: rope type        = 2
0.00.050.708 I llm_load_print_meta: rope scaling     = linear
0.00.050.708 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.708 I llm_load_print_meta: freq_scale_train = 1
0.00.050.709 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.710 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.710 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.710 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.710 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.710 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.710 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.722 I llm_load_print_meta: model type       = 1.4B
0.00.050.722 I llm_load_print_meta: model ftype      = Q5_1
0.00.050.722 I llm_load_print_meta: model params     = 1.41 B
0.00.050.723 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.050.723 I llm_load_print_meta: general.name     = 1.4B
0.00.050.723 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.723 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.723 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.724 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.724 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.724 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.724 I llm_load_print_meta: max token length = 1024
0.00.052.273 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.273 I llm_load_tensors: offloading output layer to GPU
0.00.052.273 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.283 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.052.284 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.053.123 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.123 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.124 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.124 I llama_new_context_with_model: n_batch       = 2048
0.00.053.124 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.124 I llama_new_context_with_model: flash_attn    = 0
0.00.053.125 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.125 I llama_new_context_with_model: freq_scale    = 1
0.00.053.125 I ggml_metal_init: allocating
0.00.053.131 I ggml_metal_init: found device: Apple M4
0.00.053.133 I ggml_metal_init: picking default device: Apple M4
0.00.053.672 I ggml_metal_init: using embedded metal library
0.00.055.603 I ggml_metal_init: GPU name:   Apple M4
0.00.055.604 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.605 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.605 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.605 I ggml_metal_init: simdgroup reduction   = true
0.00.055.605 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.606 I ggml_metal_init: has bfloat            = true
0.00.055.606 I ggml_metal_init: use bfloat            = true
0.00.055.606 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.607 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.082.313 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.082.318 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.082.336 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.083.217 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.083.218 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.083.218 I llama_new_context_with_model: graph nodes  = 967
0.00.083.218 I llama_new_context_with_model: graph splits = 2
0.00.083.231 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.809.721 I main: llama threadpool init, n_threads = 4
0.00.809.755 I 
0.00.809.777 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.809.779 I 
0.00.810.058 I sampler seed: 1234
0.00.810.064 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.810.075 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.810.077 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.810.077 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, literature and art.

If one's life is not happy, one can have no other way but

0.01.646.933 I llama_perf_sampler_print:    sampling time =       1.16 ms /    71 runs   (    0.02 ms per token, 61312.61 tokens per second)
0.01.646.933 I llama_perf_context_print:        load time =     801.38 ms
0.01.646.934 I llama_perf_context_print: prompt eval time =      36.83 ms /     7 tokens (    5.26 ms per token,   190.06 tokens per second)
0.01.646.935 I llama_perf_context_print:        eval time =     797.12 ms /    63 runs   (   12.65 ms per token,    79.03 tokens per second)
0.01.646.939 I llama_perf_context_print:       total time =     837.22 ms /    70 tokens
0.01.647.131 I ggml_metal_free: deallocating

real	0m1.663s
user	0m0.108s
sys	0m0.207s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.079 I main: llama backend init
0.00.000.081 I main: load the model and apply lora adapter, if any
0.00.010.256 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.900 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.904 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.910 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.911 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.911 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.912 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.912 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.913 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.913 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.913 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.914 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.914 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.915 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.915 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.916 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.917 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.917 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.788 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.852 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.678 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.679 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.679 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.680 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.680 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.680 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.681 I llama_model_loader: - type  f32:  194 tensors
0.00.024.681 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.681 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.682 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.698 I llm_load_vocab: special tokens cache size = 25
0.00.051.508 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.511 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.511 I llm_load_print_meta: arch             = gptneox
0.00.051.511 I llm_load_print_meta: vocab type       = BPE
0.00.051.512 I llm_load_print_meta: n_vocab          = 50304
0.00.051.512 I llm_load_print_meta: n_merges         = 50009
0.00.051.512 I llm_load_print_meta: vocab_only       = 0
0.00.051.512 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.512 I llm_load_print_meta: n_embd           = 2048
0.00.051.513 I llm_load_print_meta: n_layer          = 24
0.00.051.516 I llm_load_print_meta: n_head           = 16
0.00.051.519 I llm_load_print_meta: n_head_kv        = 16
0.00.051.519 I llm_load_print_meta: n_rot            = 32
0.00.051.519 I llm_load_print_meta: n_swa            = 0
0.00.051.519 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.519 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.520 I llm_load_print_meta: n_gqa            = 1
0.00.051.525 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.526 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.526 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.527 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.527 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.527 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.527 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.528 I llm_load_print_meta: n_ff             = 8192
0.00.051.528 I llm_load_print_meta: n_expert         = 0
0.00.051.528 I llm_load_print_meta: n_expert_used    = 0
0.00.051.529 I llm_load_print_meta: causal attn      = 1
0.00.051.529 I llm_load_print_meta: pooling type     = 0
0.00.051.530 I llm_load_print_meta: rope type        = 2
0.00.051.530 I llm_load_print_meta: rope scaling     = linear
0.00.051.530 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.531 I llm_load_print_meta: freq_scale_train = 1
0.00.051.531 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.531 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.531 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.531 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.531 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.531 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.532 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.544 I llm_load_print_meta: model type       = 1.4B
0.00.051.544 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.051.544 I llm_load_print_meta: model params     = 1.41 B
0.00.051.545 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.051.545 I llm_load_print_meta: general.name     = 1.4B
0.00.051.546 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.547 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.547 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.547 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.547 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.547 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.547 I llm_load_print_meta: max token length = 1024
0.00.053.493 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.493 I llm_load_tensors: offloading output layer to GPU
0.00.053.493 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.503 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.053.504 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.054.481 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.482 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.482 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.482 I llama_new_context_with_model: n_batch       = 2048
0.00.054.482 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.483 I llama_new_context_with_model: flash_attn    = 0
0.00.054.483 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.483 I llama_new_context_with_model: freq_scale    = 1
0.00.054.484 I ggml_metal_init: allocating
0.00.054.489 I ggml_metal_init: found device: Apple M4
0.00.054.491 I ggml_metal_init: picking default device: Apple M4
0.00.055.023 I ggml_metal_init: using embedded metal library
0.00.056.994 I ggml_metal_init: GPU name:   Apple M4
0.00.056.995 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.996 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.996 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.996 I ggml_metal_init: simdgroup reduction   = true
0.00.056.997 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.997 I ggml_metal_init: has bfloat            = true
0.00.056.997 I ggml_metal_init: use bfloat            = true
0.00.056.997 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.998 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.084.443 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.084.458 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.084.479 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.085.451 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.085.452 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.085.453 I llama_new_context_with_model: graph nodes  = 967
0.00.085.453 I llama_new_context_with_model: graph splits = 2
0.00.085.467 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.502.062 I main: llama threadpool init, n_threads = 4
0.00.502.092 I 
0.00.502.112 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.502.112 I 
0.00.502.335 I sampler seed: 1234
0.00.502.340 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.502.360 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.502.360 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.502.360 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.191.478 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57489.88 tokens per second)
0.01.191.479 I llama_perf_context_print:        load time =     491.80 ms
0.01.191.480 I llama_perf_context_print: prompt eval time =      35.80 ms /     7 tokens (    5.12 ms per token,   195.50 tokens per second)
0.01.191.481 I llama_perf_context_print:        eval time =     650.29 ms /    63 runs   (   10.32 ms per token,    96.88 tokens per second)
0.01.191.481 I llama_perf_context_print:       total time =     689.42 ms /    70 tokens
0.01.191.669 I ggml_metal_free: deallocating

real	0m1.207s
user	0m0.107s
sys	0m0.142s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.071 I main: load the model and apply lora adapter, if any
0.00.013.328 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.845 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.019.850 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.853 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.019.854 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.854 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.019.855 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.019.855 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.019.856 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.019.856 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.019.856 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.019.858 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.019.858 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.019.858 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.019.859 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.019.862 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.019.862 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.019.862 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.632 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.662 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.356 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.357 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.357 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.358 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.358 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.358 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.028.359 I llama_model_loader: - type  f32:  194 tensors
0.00.028.359 I llama_model_loader: - type q3_K:   25 tensors
0.00.028.360 I llama_model_loader: - type q4_K:   71 tensors
0.00.028.360 I llama_model_loader: - type q5_K:    1 tensors
0.00.028.360 I llama_model_loader: - type q6_K:    1 tensors
0.00.048.639 I llm_load_vocab: special tokens cache size = 25
0.00.054.646 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.054.649 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.054.650 I llm_load_print_meta: arch             = gptneox
0.00.054.650 I llm_load_print_meta: vocab type       = BPE
0.00.054.650 I llm_load_print_meta: n_vocab          = 50304
0.00.054.650 I llm_load_print_meta: n_merges         = 50009
0.00.054.650 I llm_load_print_meta: vocab_only       = 0
0.00.054.651 I llm_load_print_meta: n_ctx_train      = 2048
0.00.054.651 I llm_load_print_meta: n_embd           = 2048
0.00.054.651 I llm_load_print_meta: n_layer          = 24
0.00.054.654 I llm_load_print_meta: n_head           = 16
0.00.054.656 I llm_load_print_meta: n_head_kv        = 16
0.00.054.657 I llm_load_print_meta: n_rot            = 32
0.00.054.657 I llm_load_print_meta: n_swa            = 0
0.00.054.657 I llm_load_print_meta: n_embd_head_k    = 128
0.00.054.657 I llm_load_print_meta: n_embd_head_v    = 128
0.00.054.658 I llm_load_print_meta: n_gqa            = 1
0.00.054.663 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.054.664 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.054.665 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.054.665 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.054.665 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.054.665 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.054.666 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.054.666 I llm_load_print_meta: n_ff             = 8192
0.00.054.667 I llm_load_print_meta: n_expert         = 0
0.00.054.667 I llm_load_print_meta: n_expert_used    = 0
0.00.054.668 I llm_load_print_meta: causal attn      = 1
0.00.054.669 I llm_load_print_meta: pooling type     = 0
0.00.054.669 I llm_load_print_meta: rope type        = 2
0.00.054.669 I llm_load_print_meta: rope scaling     = linear
0.00.054.669 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.054.670 I llm_load_print_meta: freq_scale_train = 1
0.00.054.670 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.054.670 I llm_load_print_meta: rope_finetuned   = unknown
0.00.054.670 I llm_load_print_meta: ssm_d_conv       = 0
0.00.054.670 I llm_load_print_meta: ssm_d_inner      = 0
0.00.054.670 I llm_load_print_meta: ssm_d_state      = 0
0.00.054.677 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.054.678 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.054.691 I llm_load_print_meta: model type       = 1.4B
0.00.054.692 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.054.692 I llm_load_print_meta: model params     = 1.41 B
0.00.054.693 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.054.693 I llm_load_print_meta: general.name     = 1.4B
0.00.054.693 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.054.694 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.054.694 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.054.694 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.054.694 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.054.694 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.054.694 I llm_load_print_meta: max token length = 1024
0.00.056.341 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.056.342 I llm_load_tensors: offloading output layer to GPU
0.00.056.342 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.056.351 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.056.352 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.057.217 I llama_new_context_with_model: n_seq_max     = 1
0.00.057.218 I llama_new_context_with_model: n_ctx         = 2048
0.00.057.218 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.057.218 I llama_new_context_with_model: n_batch       = 2048
0.00.057.218 I llama_new_context_with_model: n_ubatch      = 512
0.00.057.218 I llama_new_context_with_model: flash_attn    = 0
0.00.057.219 I llama_new_context_with_model: freq_base     = 10000.0
0.00.057.219 I llama_new_context_with_model: freq_scale    = 1
0.00.057.220 I ggml_metal_init: allocating
0.00.057.223 I ggml_metal_init: found device: Apple M4
0.00.057.225 I ggml_metal_init: picking default device: Apple M4
0.00.057.775 I ggml_metal_init: using embedded metal library
0.00.059.743 I ggml_metal_init: GPU name:   Apple M4
0.00.059.745 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.059.745 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.059.745 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.059.746 I ggml_metal_init: simdgroup reduction   = true
0.00.059.746 I ggml_metal_init: simdgroup matrix mul. = true
0.00.059.746 I ggml_metal_init: has bfloat            = true
0.00.059.746 I ggml_metal_init: use bfloat            = true
0.00.059.746 I ggml_metal_init: hasUnifiedMemory      = true
0.00.059.747 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.088.847 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.088.857 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.088.876 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.089.884 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.089.885 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.089.886 I llama_new_context_with_model: graph nodes  = 967
0.00.089.886 I llama_new_context_with_model: graph splits = 2
0.00.089.899 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.611.809 I main: llama threadpool init, n_threads = 4
0.00.611.842 I 
0.00.611.885 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.611.887 I 
0.00.612.101 I sampler seed: 1234
0.00.612.108 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.612.118 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.612.120 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.612.120 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do that is most useful to my fellow men?'"

-Albert Einstein

"The way

0.01.355.929 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59814.66 tokens per second)
0.01.355.931 I llama_perf_context_print:        load time =     598.48 ms
0.01.355.932 I llama_perf_context_print: prompt eval time =      35.59 ms /     7 tokens (    5.08 ms per token,   196.68 tokens per second)
0.01.355.932 I llama_perf_context_print:        eval time =     705.24 ms /    63 runs   (   11.19 ms per token,    89.33 tokens per second)
0.01.355.933 I llama_perf_context_print:       total time =     744.12 ms /    70 tokens
0.01.356.106 I ggml_metal_free: deallocating

real	0m1.371s
user	0m0.107s
sys	0m0.171s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.069 I main: llama backend init
0.00.000.071 I main: load the model and apply lora adapter, if any
0.00.012.941 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.064 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.019.069 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.071 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.019.071 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.072 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.019.072 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.019.072 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.019.073 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.019.073 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.019.074 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.019.074 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.019.074 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.019.075 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.019.075 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.019.077 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.019.077 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.019.077 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.850 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.023.903 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.027.647 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.027.649 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.027.649 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.027.649 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.027.650 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.027.650 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.027.650 I llama_model_loader: - type  f32:  194 tensors
0.00.027.651 I llama_model_loader: - type q4_K:   61 tensors
0.00.027.651 I llama_model_loader: - type q5_K:   24 tensors
0.00.027.651 I llama_model_loader: - type q6_K:   13 tensors
0.00.048.718 I llm_load_vocab: special tokens cache size = 25
0.00.054.689 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.054.691 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.054.692 I llm_load_print_meta: arch             = gptneox
0.00.054.692 I llm_load_print_meta: vocab type       = BPE
0.00.054.692 I llm_load_print_meta: n_vocab          = 50304
0.00.054.692 I llm_load_print_meta: n_merges         = 50009
0.00.054.693 I llm_load_print_meta: vocab_only       = 0
0.00.054.693 I llm_load_print_meta: n_ctx_train      = 2048
0.00.054.693 I llm_load_print_meta: n_embd           = 2048
0.00.054.693 I llm_load_print_meta: n_layer          = 24
0.00.054.695 I llm_load_print_meta: n_head           = 16
0.00.054.699 I llm_load_print_meta: n_head_kv        = 16
0.00.054.699 I llm_load_print_meta: n_rot            = 32
0.00.054.699 I llm_load_print_meta: n_swa            = 0
0.00.054.699 I llm_load_print_meta: n_embd_head_k    = 128
0.00.054.699 I llm_load_print_meta: n_embd_head_v    = 128
0.00.054.700 I llm_load_print_meta: n_gqa            = 1
0.00.054.701 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.054.702 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.054.702 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.054.703 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.054.703 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.054.703 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.054.704 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.054.706 I llm_load_print_meta: n_ff             = 8192
0.00.054.706 I llm_load_print_meta: n_expert         = 0
0.00.054.706 I llm_load_print_meta: n_expert_used    = 0
0.00.054.706 I llm_load_print_meta: causal attn      = 1
0.00.054.707 I llm_load_print_meta: pooling type     = 0
0.00.054.707 I llm_load_print_meta: rope type        = 2
0.00.054.707 I llm_load_print_meta: rope scaling     = linear
0.00.054.707 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.054.708 I llm_load_print_meta: freq_scale_train = 1
0.00.054.708 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.054.708 I llm_load_print_meta: rope_finetuned   = unknown
0.00.054.708 I llm_load_print_meta: ssm_d_conv       = 0
0.00.054.708 I llm_load_print_meta: ssm_d_inner      = 0
0.00.054.708 I llm_load_print_meta: ssm_d_state      = 0
0.00.054.709 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.054.713 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.054.724 I llm_load_print_meta: model type       = 1.4B
0.00.054.724 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.054.725 I llm_load_print_meta: model params     = 1.41 B
0.00.054.725 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.054.725 I llm_load_print_meta: general.name     = 1.4B
0.00.054.726 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.054.726 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.054.726 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.054.726 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.054.726 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.054.726 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.054.727 I llm_load_print_meta: max token length = 1024
0.00.056.279 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.056.280 I llm_load_tensors: offloading output layer to GPU
0.00.056.280 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.056.289 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.056.291 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.057.143 I llama_new_context_with_model: n_seq_max     = 1
0.00.057.144 I llama_new_context_with_model: n_ctx         = 2048
0.00.057.144 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.057.144 I llama_new_context_with_model: n_batch       = 2048
0.00.057.144 I llama_new_context_with_model: n_ubatch      = 512
0.00.057.145 I llama_new_context_with_model: flash_attn    = 0
0.00.057.145 I llama_new_context_with_model: freq_base     = 10000.0
0.00.057.145 I llama_new_context_with_model: freq_scale    = 1
0.00.057.146 I ggml_metal_init: allocating
0.00.057.149 I ggml_metal_init: found device: Apple M4
0.00.057.151 I ggml_metal_init: picking default device: Apple M4
0.00.057.697 I ggml_metal_init: using embedded metal library
0.00.059.634 I ggml_metal_init: GPU name:   Apple M4
0.00.059.635 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.059.636 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.059.636 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.059.636 I ggml_metal_init: simdgroup reduction   = true
0.00.059.637 I ggml_metal_init: simdgroup matrix mul. = true
0.00.059.637 I ggml_metal_init: has bfloat            = true
0.00.059.637 I ggml_metal_init: use bfloat            = true
0.00.059.637 I ggml_metal_init: hasUnifiedMemory      = true
0.00.059.638 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.086.935 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.943 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.086.959 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.934 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.935 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.935 I llama_new_context_with_model: graph nodes  = 967
0.00.087.936 I llama_new_context_with_model: graph splits = 2
0.00.087.943 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.690.023 I main: llama threadpool init, n_threads = 4
0.00.690.068 I 
0.00.690.088 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.690.088 I 
0.00.690.239 I sampler seed: 1234
0.00.690.243 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.690.252 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.690.252 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.690.252 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the greatest power to create the future we want to see. I believe that we are in a wonderful time when people from all over the world are coming together to create a better world. I believe that we are going

0.01.442.617 I llama_perf_sampler_print:    sampling time =       1.26 ms /    71 runs   (    0.02 ms per token, 56170.89 tokens per second)
0.01.442.617 I llama_perf_context_print:        load time =     677.08 ms
0.01.442.618 I llama_perf_context_print: prompt eval time =      36.50 ms /     7 tokens (    5.21 ms per token,   191.80 tokens per second)
0.01.442.619 I llama_perf_context_print:        eval time =     712.82 ms /    63 runs   (   11.31 ms per token,    88.38 tokens per second)
0.01.442.620 I llama_perf_context_print:       total time =     752.60 ms /    70 tokens
0.01.442.801 I ggml_metal_free: deallocating

real	0m1.459s
user	0m0.109s
sys	0m0.180s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.035 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.008.516 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.909 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.014.914 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.915 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.916 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.916 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.916 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.917 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.918 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.918 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.918 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.919 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.919 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.919 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.920 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.921 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.921 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.921 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.731 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.826 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.590 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.591 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.592 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.592 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.592 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.592 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.023.593 I llama_model_loader: - type  f32:  194 tensors
0.00.023.593 I llama_model_loader: - type q5_K:   61 tensors
0.00.023.593 I llama_model_loader: - type q6_K:   37 tensors
0.00.043.756 I llm_load_vocab: special tokens cache size = 25
0.00.049.667 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.671 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.671 I llm_load_print_meta: arch             = gptneox
0.00.049.672 I llm_load_print_meta: vocab type       = BPE
0.00.049.672 I llm_load_print_meta: n_vocab          = 50304
0.00.049.672 I llm_load_print_meta: n_merges         = 50009
0.00.049.672 I llm_load_print_meta: vocab_only       = 0
0.00.049.672 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.672 I llm_load_print_meta: n_embd           = 2048
0.00.049.673 I llm_load_print_meta: n_layer          = 24
0.00.049.675 I llm_load_print_meta: n_head           = 16
0.00.049.676 I llm_load_print_meta: n_head_kv        = 16
0.00.049.676 I llm_load_print_meta: n_rot            = 32
0.00.049.676 I llm_load_print_meta: n_swa            = 0
0.00.049.676 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.676 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.677 I llm_load_print_meta: n_gqa            = 1
0.00.049.678 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.679 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.679 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.679 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.680 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.682 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.682 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.683 I llm_load_print_meta: n_ff             = 8192
0.00.049.683 I llm_load_print_meta: n_expert         = 0
0.00.049.683 I llm_load_print_meta: n_expert_used    = 0
0.00.049.684 I llm_load_print_meta: causal attn      = 1
0.00.049.685 I llm_load_print_meta: pooling type     = 0
0.00.049.685 I llm_load_print_meta: rope type        = 2
0.00.049.685 I llm_load_print_meta: rope scaling     = linear
0.00.049.686 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.686 I llm_load_print_meta: freq_scale_train = 1
0.00.049.686 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.686 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.686 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.687 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.687 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.687 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.687 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.693 I llm_load_print_meta: model type       = 1.4B
0.00.049.693 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.049.694 I llm_load_print_meta: model params     = 1.41 B
0.00.049.694 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.049.694 I llm_load_print_meta: general.name     = 1.4B
0.00.049.694 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.696 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.696 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.696 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.696 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.697 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.697 I llm_load_print_meta: max token length = 1024
0.00.051.221 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.221 I llm_load_tensors: offloading output layer to GPU
0.00.051.221 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.226 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.051.226 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.052.051 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.052 I llama_new_context_with_model: n_ctx         = 2048
0.00.052.052 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.052.052 I llama_new_context_with_model: n_batch       = 2048
0.00.052.052 I llama_new_context_with_model: n_ubatch      = 512
0.00.052.052 I llama_new_context_with_model: flash_attn    = 0
0.00.052.053 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.053 I llama_new_context_with_model: freq_scale    = 1
0.00.052.053 I ggml_metal_init: allocating
0.00.052.057 I ggml_metal_init: found device: Apple M4
0.00.052.059 I ggml_metal_init: picking default device: Apple M4
0.00.052.594 I ggml_metal_init: using embedded metal library
0.00.054.521 I ggml_metal_init: GPU name:   Apple M4
0.00.054.523 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.523 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.523 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.524 I ggml_metal_init: simdgroup reduction   = true
0.00.054.524 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.524 I ggml_metal_init: has bfloat            = true
0.00.054.524 I ggml_metal_init: use bfloat            = true
0.00.054.525 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.525 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.081.630 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.081.636 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.081.656 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.082.570 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.082.571 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.082.572 I llama_new_context_with_model: graph nodes  = 967
0.00.082.572 I llama_new_context_with_model: graph splits = 2
0.00.082.583 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.741.039 I main: llama threadpool init, n_threads = 4
0.00.741.068 I 
0.00.741.088 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.741.089 I 
0.00.741.233 I sampler seed: 1234
0.00.741.239 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.741.278 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.741.280 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.741.280 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.582.435 I llama_perf_sampler_print:    sampling time =       1.15 ms /    71 runs   (    0.02 ms per token, 61685.49 tokens per second)
0.01.582.436 I llama_perf_context_print:        load time =     732.52 ms
0.01.582.437 I llama_perf_context_print: prompt eval time =      38.56 ms /     7 tokens (    5.51 ms per token,   181.55 tokens per second)
0.01.582.439 I llama_perf_context_print:        eval time =     799.72 ms /    63 runs   (   12.69 ms per token,    78.78 tokens per second)
0.01.582.439 I llama_perf_context_print:       total time =     841.40 ms /    70 tokens
0.01.582.609 I ggml_metal_free: deallocating

real	0m1.596s
user	0m0.107s
sys	0m0.179s
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.074 I main: llama backend init
0.00.000.076 I main: load the model and apply lora adapter, if any
0.00.009.822 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.754 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.758 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.760 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.760 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.761 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.761 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.761 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.762 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.763 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.763 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.763 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.764 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.765 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.765 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.768 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.768 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.769 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.568 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.623 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.338 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.339 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.339 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.340 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.340 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.340 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.025.341 I llama_model_loader: - type  f32:  194 tensors
0.00.025.341 I llama_model_loader: - type q6_K:   98 tensors
0.00.046.568 I llm_load_vocab: special tokens cache size = 25
0.00.052.467 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.470 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.470 I llm_load_print_meta: arch             = gptneox
0.00.052.470 I llm_load_print_meta: vocab type       = BPE
0.00.052.470 I llm_load_print_meta: n_vocab          = 50304
0.00.052.471 I llm_load_print_meta: n_merges         = 50009
0.00.052.471 I llm_load_print_meta: vocab_only       = 0
0.00.052.471 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.471 I llm_load_print_meta: n_embd           = 2048
0.00.052.471 I llm_load_print_meta: n_layer          = 24
0.00.052.474 I llm_load_print_meta: n_head           = 16
0.00.052.474 I llm_load_print_meta: n_head_kv        = 16
0.00.052.474 I llm_load_print_meta: n_rot            = 32
0.00.052.475 I llm_load_print_meta: n_swa            = 0
0.00.052.475 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.475 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.476 I llm_load_print_meta: n_gqa            = 1
0.00.052.477 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.477 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.478 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.478 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.478 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.478 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.479 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.479 I llm_load_print_meta: n_ff             = 8192
0.00.052.479 I llm_load_print_meta: n_expert         = 0
0.00.052.480 I llm_load_print_meta: n_expert_used    = 0
0.00.052.480 I llm_load_print_meta: causal attn      = 1
0.00.052.481 I llm_load_print_meta: pooling type     = 0
0.00.052.484 I llm_load_print_meta: rope type        = 2
0.00.052.484 I llm_load_print_meta: rope scaling     = linear
0.00.052.484 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.485 I llm_load_print_meta: freq_scale_train = 1
0.00.052.485 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.485 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.485 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.485 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.485 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.485 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.486 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.497 I llm_load_print_meta: model type       = 1.4B
0.00.052.498 I llm_load_print_meta: model ftype      = Q6_K
0.00.052.498 I llm_load_print_meta: model params     = 1.41 B
0.00.052.498 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.052.499 I llm_load_print_meta: general.name     = 1.4B
0.00.052.499 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.500 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.500 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.500 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.501 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.501 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.501 I llm_load_print_meta: max token length = 1024
0.00.054.624 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.625 I llm_load_tensors: offloading output layer to GPU
0.00.054.625 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.635 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.054.636 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.055.594 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.594 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.595 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.595 I llama_new_context_with_model: n_batch       = 2048
0.00.055.595 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.595 I llama_new_context_with_model: flash_attn    = 0
0.00.055.596 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.596 I llama_new_context_with_model: freq_scale    = 1
0.00.055.596 I ggml_metal_init: allocating
0.00.055.599 I ggml_metal_init: found device: Apple M4
0.00.055.601 I ggml_metal_init: picking default device: Apple M4
0.00.056.193 I ggml_metal_init: using embedded metal library
0.00.058.204 I ggml_metal_init: GPU name:   Apple M4
0.00.058.206 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.206 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.207 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.207 I ggml_metal_init: simdgroup reduction   = true
0.00.058.208 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.209 I ggml_metal_init: has bfloat            = true
0.00.058.209 I ggml_metal_init: use bfloat            = true
0.00.058.211 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.212 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.086.539 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.549 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.086.570 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.581 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.582 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.582 I llama_new_context_with_model: graph nodes  = 967
0.00.087.583 I llama_new_context_with_model: graph splits = 2
0.00.087.590 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.801.349 I main: llama threadpool init, n_threads = 4
0.00.801.378 I 
0.00.801.395 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.801.396 I 
0.00.801.632 I sampler seed: 1234
0.00.801.635 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.801.646 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.801.646 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.801.647 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.01.674.102 I llama_perf_sampler_print:    sampling time =       1.23 ms /    71 runs   (    0.02 ms per token, 57676.69 tokens per second)
0.01.674.102 I llama_perf_context_print:        load time =     791.52 ms
0.01.674.103 I llama_perf_context_print: prompt eval time =      38.56 ms /     7 tokens (    5.51 ms per token,   181.54 tokens per second)
0.01.674.103 I llama_perf_context_print:        eval time =     830.86 ms /    63 runs   (   13.19 ms per token,    75.83 tokens per second)
0.01.674.104 I llama_perf_context_print:       total time =     872.75 ms /    70 tokens
0.01.674.273 I ggml_metal_free: deallocating

real	0m1.690s
user	0m0.109s
sys	0m0.198s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.519 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.023.300 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.035.815 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.035.823 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.035.826 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.035.828 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.035.828 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.035.829 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.035.829 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.035.830 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.035.831 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.035.832 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.035.832 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.035.833 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.035.834 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.035.834 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.035.837 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.035.841 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.035.842 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.312 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.332 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.053.096 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.053.098 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.053.099 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.053.099 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.053.100 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.053.100 I llama_model_loader: - type  f32:  194 tensors
0.00.053.101 I llama_model_loader: - type  f16:   98 tensors
0.00.082.205 I llm_load_vocab: special tokens cache size = 25
0.00.088.808 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.088.811 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.088.811 I llm_load_print_meta: arch             = gptneox
0.00.088.811 I llm_load_print_meta: vocab type       = BPE
0.00.088.812 I llm_load_print_meta: n_vocab          = 50304
0.00.088.812 I llm_load_print_meta: n_merges         = 50009
0.00.088.812 I llm_load_print_meta: vocab_only       = 0
0.00.088.812 I llm_load_print_meta: n_ctx_train      = 2048
0.00.088.812 I llm_load_print_meta: n_embd           = 2048
0.00.088.812 I llm_load_print_meta: n_layer          = 24
0.00.088.815 I llm_load_print_meta: n_head           = 16
0.00.088.815 I llm_load_print_meta: n_head_kv        = 16
0.00.088.816 I llm_load_print_meta: n_rot            = 32
0.00.088.818 I llm_load_print_meta: n_swa            = 0
0.00.088.818 I llm_load_print_meta: n_embd_head_k    = 128
0.00.088.818 I llm_load_print_meta: n_embd_head_v    = 128
0.00.088.819 I llm_load_print_meta: n_gqa            = 1
0.00.088.820 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.088.820 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.088.821 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.088.821 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.088.821 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.088.821 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.088.821 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.088.822 I llm_load_print_meta: n_ff             = 8192
0.00.088.822 I llm_load_print_meta: n_expert         = 0
0.00.088.823 I llm_load_print_meta: n_expert_used    = 0
0.00.088.823 I llm_load_print_meta: causal attn      = 1
0.00.088.824 I llm_load_print_meta: pooling type     = 0
0.00.088.824 I llm_load_print_meta: rope type        = 2
0.00.088.824 I llm_load_print_meta: rope scaling     = linear
0.00.088.824 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.088.825 I llm_load_print_meta: freq_scale_train = 1
0.00.088.825 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.088.825 I llm_load_print_meta: rope_finetuned   = unknown
0.00.088.825 I llm_load_print_meta: ssm_d_conv       = 0
0.00.088.825 I llm_load_print_meta: ssm_d_inner      = 0
0.00.088.825 I llm_load_print_meta: ssm_d_state      = 0
0.00.088.825 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.088.825 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.088.832 I llm_load_print_meta: model type       = 1.4B
0.00.088.832 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.088.833 I llm_load_print_meta: model params     = 1.41 B
0.00.088.833 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.088.833 I llm_load_print_meta: general.name     = 1.4B
0.00.088.834 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.088.834 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.088.834 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.088.835 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.088.835 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.088.835 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.088.836 I llm_load_print_meta: max token length = 1024
0.00.090.880 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.090.880 I llm_load_tensors: offloading output layer to GPU
0.00.090.880 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.090.885 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.090.885 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.091.983 I llama_new_context_with_model: n_seq_max     = 1
0.00.091.984 I llama_new_context_with_model: n_ctx         = 128
0.00.091.984 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.091.984 I llama_new_context_with_model: n_batch       = 128
0.00.091.985 I llama_new_context_with_model: n_ubatch      = 128
0.00.091.985 I llama_new_context_with_model: flash_attn    = 0
0.00.091.985 I llama_new_context_with_model: freq_base     = 10000.0
0.00.091.985 I llama_new_context_with_model: freq_scale    = 1
0.00.091.986 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.091.986 I ggml_metal_init: allocating
0.00.091.989 I ggml_metal_init: found device: Apple M4
0.00.091.991 I ggml_metal_init: picking default device: Apple M4
0.00.092.575 I ggml_metal_init: using embedded metal library
0.00.094.674 I ggml_metal_init: GPU name:   Apple M4
0.00.094.676 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.094.676 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.094.677 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.094.677 I ggml_metal_init: simdgroup reduction   = true
0.00.094.677 I ggml_metal_init: simdgroup matrix mul. = true
0.00.094.677 I ggml_metal_init: has bfloat            = true
0.00.094.677 I ggml_metal_init: use bfloat            = true
0.00.094.678 I ggml_metal_init: hasUnifiedMemory      = true
0.00.094.678 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.104.254 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.104.257 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.104.271 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.105.210 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.105.211 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.105.211 I llama_new_context_with_model: graph nodes  = 967
0.00.105.211 I llama_new_context_with_model: graph splits = 2
0.00.105.223 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.173.178 I 
0.01.173.227 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.01.173.289 I perplexity: tokenizing the input ..
0.01.186.802 I perplexity: tokenization took 13.512 ms
0.01.186.811 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.307.380 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.308.924 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.308.939 I llama_perf_context_print:        load time =    1149.86 ms
0.01.308.941 I llama_perf_context_print: prompt eval time =     119.61 ms /   128 tokens (    0.93 ms per token,  1070.16 tokens per second)
0.01.308.942 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.308.942 I llama_perf_context_print:       total time =     135.77 ms /   129 tokens
0.01.309.298 I ggml_metal_free: deallocating

real	0m1.497s
user	0m0.120s
sys	0m0.220s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.132 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.670 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.905 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.019.912 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.914 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.019.916 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.916 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.019.917 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.019.917 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.019.918 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.019.919 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.019.919 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.019.919 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.019.920 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.019.920 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.019.921 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.019.922 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.019.923 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.019.923 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.025.805 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.027.448 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.033.367 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.033.369 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.033.370 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.033.370 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.033.371 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.033.371 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.033.372 I llama_model_loader: - type  f32:  194 tensors
0.00.033.372 I llama_model_loader: - type q8_0:   98 tensors
0.00.060.062 I llm_load_vocab: special tokens cache size = 25
0.00.066.544 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.066.547 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.066.548 I llm_load_print_meta: arch             = gptneox
0.00.066.548 I llm_load_print_meta: vocab type       = BPE
0.00.066.548 I llm_load_print_meta: n_vocab          = 50304
0.00.066.548 I llm_load_print_meta: n_merges         = 50009
0.00.066.548 I llm_load_print_meta: vocab_only       = 0
0.00.066.549 I llm_load_print_meta: n_ctx_train      = 2048
0.00.066.549 I llm_load_print_meta: n_embd           = 2048
0.00.066.549 I llm_load_print_meta: n_layer          = 24
0.00.066.551 I llm_load_print_meta: n_head           = 16
0.00.066.552 I llm_load_print_meta: n_head_kv        = 16
0.00.066.552 I llm_load_print_meta: n_rot            = 32
0.00.066.552 I llm_load_print_meta: n_swa            = 0
0.00.066.553 I llm_load_print_meta: n_embd_head_k    = 128
0.00.066.553 I llm_load_print_meta: n_embd_head_v    = 128
0.00.066.553 I llm_load_print_meta: n_gqa            = 1
0.00.066.554 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.066.555 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.066.555 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.066.556 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.066.556 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.066.556 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.066.556 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.066.557 I llm_load_print_meta: n_ff             = 8192
0.00.066.557 I llm_load_print_meta: n_expert         = 0
0.00.066.557 I llm_load_print_meta: n_expert_used    = 0
0.00.066.557 I llm_load_print_meta: causal attn      = 1
0.00.066.557 I llm_load_print_meta: pooling type     = 0
0.00.066.558 I llm_load_print_meta: rope type        = 2
0.00.066.558 I llm_load_print_meta: rope scaling     = linear
0.00.066.558 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.066.558 I llm_load_print_meta: freq_scale_train = 1
0.00.066.559 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.066.559 I llm_load_print_meta: rope_finetuned   = unknown
0.00.066.559 I llm_load_print_meta: ssm_d_conv       = 0
0.00.066.559 I llm_load_print_meta: ssm_d_inner      = 0
0.00.066.559 I llm_load_print_meta: ssm_d_state      = 0
0.00.066.559 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.066.559 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.066.571 I llm_load_print_meta: model type       = 1.4B
0.00.066.571 I llm_load_print_meta: model ftype      = Q8_0
0.00.066.574 I llm_load_print_meta: model params     = 1.41 B
0.00.066.574 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.066.574 I llm_load_print_meta: general.name     = 1.4B
0.00.066.574 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.066.575 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.066.575 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.066.575 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.066.575 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.066.575 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.066.576 I llm_load_print_meta: max token length = 1024
0.00.068.825 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.068.825 I llm_load_tensors: offloading output layer to GPU
0.00.068.825 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.068.835 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.068.836 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.069.788 I llama_new_context_with_model: n_seq_max     = 1
0.00.069.789 I llama_new_context_with_model: n_ctx         = 128
0.00.069.789 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.069.789 I llama_new_context_with_model: n_batch       = 128
0.00.069.790 I llama_new_context_with_model: n_ubatch      = 128
0.00.069.790 I llama_new_context_with_model: flash_attn    = 0
0.00.069.790 I llama_new_context_with_model: freq_base     = 10000.0
0.00.069.790 I llama_new_context_with_model: freq_scale    = 1
0.00.069.791 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.069.791 I ggml_metal_init: allocating
0.00.069.795 I ggml_metal_init: found device: Apple M4
0.00.069.797 I ggml_metal_init: picking default device: Apple M4
0.00.070.357 I ggml_metal_init: using embedded metal library
0.00.072.491 I ggml_metal_init: GPU name:   Apple M4
0.00.072.493 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.072.493 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.072.493 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.072.494 I ggml_metal_init: simdgroup reduction   = true
0.00.072.494 I ggml_metal_init: simdgroup matrix mul. = true
0.00.072.494 I ggml_metal_init: has bfloat            = true
0.00.072.494 I ggml_metal_init: use bfloat            = true
0.00.072.494 I ggml_metal_init: hasUnifiedMemory      = true
0.00.072.496 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.080.693 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.080.697 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.080.710 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.081.584 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.081.585 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.081.586 I llama_new_context_with_model: graph nodes  = 967
0.00.081.586 I llama_new_context_with_model: graph splits = 2
0.00.081.598 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.855.164 I 
0.00.855.204 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.855.239 I perplexity: tokenizing the input ..
0.00.862.565 I perplexity: tokenization took 7.326 ms
0.00.862.568 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.984.408 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.00.985.658 I Final estimate: PPL = 10.1362 +/- 3.22437

0.00.985.737 I llama_perf_context_print:        load time =     843.49 ms
0.00.985.738 I llama_perf_context_print: prompt eval time =     121.62 ms /   128 tokens (    0.95 ms per token,  1052.49 tokens per second)
0.00.985.739 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.985.739 I llama_perf_context_print:       total time =     130.58 ms /   129 tokens
0.00.986.182 I ggml_metal_free: deallocating

real	0m1.003s
user	0m0.091s
sys	0m0.156s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.410 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.426 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.015.430 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.432 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.437 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.438 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.438 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.438 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.439 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.440 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.440 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.440 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.441 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.441 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.441 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.444 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.445 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.445 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.213 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.251 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.021 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.022 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.022 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.023 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.023 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.024 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.024.024 I llama_model_loader: - type  f32:  194 tensors
0.00.024.024 I llama_model_loader: - type q4_0:   97 tensors
0.00.024.025 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.264 I llm_load_vocab: special tokens cache size = 25
0.00.050.351 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.354 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.355 I llm_load_print_meta: arch             = gptneox
0.00.050.355 I llm_load_print_meta: vocab type       = BPE
0.00.050.355 I llm_load_print_meta: n_vocab          = 50304
0.00.050.355 I llm_load_print_meta: n_merges         = 50009
0.00.050.356 I llm_load_print_meta: vocab_only       = 0
0.00.050.356 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.356 I llm_load_print_meta: n_embd           = 2048
0.00.050.356 I llm_load_print_meta: n_layer          = 24
0.00.050.359 I llm_load_print_meta: n_head           = 16
0.00.050.360 I llm_load_print_meta: n_head_kv        = 16
0.00.050.360 I llm_load_print_meta: n_rot            = 32
0.00.050.360 I llm_load_print_meta: n_swa            = 0
0.00.050.361 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.361 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.364 I llm_load_print_meta: n_gqa            = 1
0.00.050.364 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.365 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.366 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.367 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.368 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.368 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.368 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.369 I llm_load_print_meta: n_ff             = 8192
0.00.050.369 I llm_load_print_meta: n_expert         = 0
0.00.050.369 I llm_load_print_meta: n_expert_used    = 0
0.00.050.369 I llm_load_print_meta: causal attn      = 1
0.00.050.369 I llm_load_print_meta: pooling type     = 0
0.00.050.369 I llm_load_print_meta: rope type        = 2
0.00.050.370 I llm_load_print_meta: rope scaling     = linear
0.00.050.370 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.370 I llm_load_print_meta: freq_scale_train = 1
0.00.050.371 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.371 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.371 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.375 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.375 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.375 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.376 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.387 I llm_load_print_meta: model type       = 1.4B
0.00.050.388 I llm_load_print_meta: model ftype      = Q4_0
0.00.050.388 I llm_load_print_meta: model params     = 1.41 B
0.00.050.388 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.050.389 I llm_load_print_meta: general.name     = 1.4B
0.00.050.389 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.389 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.389 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.389 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.390 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.390 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.390 I llm_load_print_meta: max token length = 1024
0.00.052.302 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.302 I llm_load_tensors: offloading output layer to GPU
0.00.052.302 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.312 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.052.313 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.053.283 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.284 I llama_new_context_with_model: n_ctx         = 128
0.00.053.284 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.284 I llama_new_context_with_model: n_batch       = 128
0.00.053.284 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.285 I llama_new_context_with_model: flash_attn    = 0
0.00.053.285 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.285 I llama_new_context_with_model: freq_scale    = 1
0.00.053.286 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.286 I ggml_metal_init: allocating
0.00.053.291 I ggml_metal_init: found device: Apple M4
0.00.053.294 I ggml_metal_init: picking default device: Apple M4
0.00.053.831 I ggml_metal_init: using embedded metal library
0.00.055.773 I ggml_metal_init: GPU name:   Apple M4
0.00.055.774 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.774 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.775 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.775 I ggml_metal_init: simdgroup reduction   = true
0.00.055.775 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.775 I ggml_metal_init: has bfloat            = true
0.00.055.775 I ggml_metal_init: use bfloat            = true
0.00.055.776 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.776 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.866 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.873 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.891 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.783 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.784 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.784 I llama_new_context_with_model: graph nodes  = 967
0.00.065.785 I llama_new_context_with_model: graph splits = 2
0.00.065.797 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.649.139 I 
0.00.649.180 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.649.208 I perplexity: tokenizing the input ..
0.00.657.026 I perplexity: tokenization took 7.817 ms
0.00.657.031 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.779.469 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.781.101 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.781.120 I llama_perf_context_print:        load time =     639.72 ms
0.00.781.121 I llama_perf_context_print: prompt eval time =     122.20 ms /   128 tokens (    0.95 ms per token,  1047.49 tokens per second)
0.00.781.122 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.781.122 I llama_perf_context_print:       total time =     131.99 ms /   129 tokens
0.00.781.467 I ggml_metal_free: deallocating

real	0m0.794s
user	0m0.073s
sys	0m0.115s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.085 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.406 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.479 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.014.483 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.489 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.489 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.490 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.490 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.490 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.493 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.493 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.494 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.494 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.494 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.495 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.498 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.500 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.500 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.500 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.311 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.327 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.079 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.080 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.081 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.081 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.081 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.082 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.023.082 I llama_model_loader: - type  f32:  194 tensors
0.00.023.083 I llama_model_loader: - type q4_1:   97 tensors
0.00.023.083 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.871 I llm_load_vocab: special tokens cache size = 25
0.00.049.849 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.852 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.853 I llm_load_print_meta: arch             = gptneox
0.00.049.853 I llm_load_print_meta: vocab type       = BPE
0.00.049.853 I llm_load_print_meta: n_vocab          = 50304
0.00.049.853 I llm_load_print_meta: n_merges         = 50009
0.00.049.853 I llm_load_print_meta: vocab_only       = 0
0.00.049.854 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.854 I llm_load_print_meta: n_embd           = 2048
0.00.049.854 I llm_load_print_meta: n_layer          = 24
0.00.049.857 I llm_load_print_meta: n_head           = 16
0.00.049.857 I llm_load_print_meta: n_head_kv        = 16
0.00.049.858 I llm_load_print_meta: n_rot            = 32
0.00.049.858 I llm_load_print_meta: n_swa            = 0
0.00.049.858 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.858 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.859 I llm_load_print_meta: n_gqa            = 1
0.00.049.860 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.860 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.861 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.863 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.863 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.864 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.864 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.864 I llm_load_print_meta: n_ff             = 8192
0.00.049.866 I llm_load_print_meta: n_expert         = 0
0.00.049.866 I llm_load_print_meta: n_expert_used    = 0
0.00.049.866 I llm_load_print_meta: causal attn      = 1
0.00.049.866 I llm_load_print_meta: pooling type     = 0
0.00.049.867 I llm_load_print_meta: rope type        = 2
0.00.049.867 I llm_load_print_meta: rope scaling     = linear
0.00.049.867 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.868 I llm_load_print_meta: freq_scale_train = 1
0.00.049.868 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.868 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.868 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.868 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.868 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.869 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.869 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.880 I llm_load_print_meta: model type       = 1.4B
0.00.049.880 I llm_load_print_meta: model ftype      = Q4_1
0.00.049.881 I llm_load_print_meta: model params     = 1.41 B
0.00.049.881 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.049.881 I llm_load_print_meta: general.name     = 1.4B
0.00.049.882 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.882 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.882 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.882 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.884 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.884 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.884 I llm_load_print_meta: max token length = 1024
0.00.051.462 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.463 I llm_load_tensors: offloading output layer to GPU
0.00.051.463 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.472 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.051.474 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.052.309 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.310 I llama_new_context_with_model: n_ctx         = 128
0.00.052.310 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.310 I llama_new_context_with_model: n_batch       = 128
0.00.052.310 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.311 I llama_new_context_with_model: flash_attn    = 0
0.00.052.311 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.311 I llama_new_context_with_model: freq_scale    = 1
0.00.052.312 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.312 I ggml_metal_init: allocating
0.00.052.315 I ggml_metal_init: found device: Apple M4
0.00.052.317 I ggml_metal_init: picking default device: Apple M4
0.00.052.882 I ggml_metal_init: using embedded metal library
0.00.054.808 I ggml_metal_init: GPU name:   Apple M4
0.00.054.809 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.810 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.810 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.810 I ggml_metal_init: simdgroup reduction   = true
0.00.054.810 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.811 I ggml_metal_init: has bfloat            = true
0.00.054.811 I ggml_metal_init: use bfloat            = true
0.00.054.811 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.812 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.060 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.062 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.078 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.950 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.951 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.951 I llama_new_context_with_model: graph nodes  = 967
0.00.064.951 I llama_new_context_with_model: graph splits = 2
0.00.064.963 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.627.308 I 
0.00.627.327 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.627.338 I perplexity: tokenizing the input ..
0.00.634.905 I perplexity: tokenization took 7.566 ms
0.00.634.909 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.757.776 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.759.000 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.759.023 I llama_perf_context_print:        load time =     618.90 ms
0.00.759.024 I llama_perf_context_print: prompt eval time =     122.64 ms /   128 tokens (    0.96 ms per token,  1043.70 tokens per second)
0.00.759.027 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.759.028 I llama_perf_context_print:       total time =     131.72 ms /   129 tokens
0.00.759.441 I ggml_metal_free: deallocating

real	0m0.772s
user	0m0.076s
sys	0m0.117s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.087 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.241 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.480 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.016.484 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.485 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.490 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.490 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.490 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.491 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.492 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.492 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.492 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.493 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.493 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.493 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.494 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.495 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.496 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.496 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.312 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.383 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.174 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.175 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.176 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.176 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.176 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.177 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.025.177 I llama_model_loader: - type  f32:  194 tensors
0.00.025.178 I llama_model_loader: - type q5_0:   97 tensors
0.00.025.178 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.479 I llm_load_vocab: special tokens cache size = 25
0.00.051.375 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.377 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.378 I llm_load_print_meta: arch             = gptneox
0.00.051.378 I llm_load_print_meta: vocab type       = BPE
0.00.051.378 I llm_load_print_meta: n_vocab          = 50304
0.00.051.379 I llm_load_print_meta: n_merges         = 50009
0.00.051.379 I llm_load_print_meta: vocab_only       = 0
0.00.051.379 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.379 I llm_load_print_meta: n_embd           = 2048
0.00.051.379 I llm_load_print_meta: n_layer          = 24
0.00.051.382 I llm_load_print_meta: n_head           = 16
0.00.051.383 I llm_load_print_meta: n_head_kv        = 16
0.00.051.383 I llm_load_print_meta: n_rot            = 32
0.00.051.383 I llm_load_print_meta: n_swa            = 0
0.00.051.383 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.383 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.386 I llm_load_print_meta: n_gqa            = 1
0.00.051.387 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.387 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.388 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.392 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.393 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.393 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.393 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.394 I llm_load_print_meta: n_ff             = 8192
0.00.051.395 I llm_load_print_meta: n_expert         = 0
0.00.051.396 I llm_load_print_meta: n_expert_used    = 0
0.00.051.396 I llm_load_print_meta: causal attn      = 1
0.00.051.396 I llm_load_print_meta: pooling type     = 0
0.00.051.396 I llm_load_print_meta: rope type        = 2
0.00.051.396 I llm_load_print_meta: rope scaling     = linear
0.00.051.397 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.397 I llm_load_print_meta: freq_scale_train = 1
0.00.051.399 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.399 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.399 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.399 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.399 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.399 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.399 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.411 I llm_load_print_meta: model type       = 1.4B
0.00.051.412 I llm_load_print_meta: model ftype      = Q5_0
0.00.051.412 I llm_load_print_meta: model params     = 1.41 B
0.00.051.413 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.051.413 I llm_load_print_meta: general.name     = 1.4B
0.00.051.413 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.413 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.414 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.414 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.414 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.414 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.414 I llm_load_print_meta: max token length = 1024
0.00.053.418 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.419 I llm_load_tensors: offloading output layer to GPU
0.00.053.419 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.429 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.053.430 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.054.397 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.397 I llama_new_context_with_model: n_ctx         = 128
0.00.054.398 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.398 I llama_new_context_with_model: n_batch       = 128
0.00.054.398 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.398 I llama_new_context_with_model: flash_attn    = 0
0.00.054.399 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.399 I llama_new_context_with_model: freq_scale    = 1
0.00.054.399 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.400 I ggml_metal_init: allocating
0.00.054.406 I ggml_metal_init: found device: Apple M4
0.00.054.408 I ggml_metal_init: picking default device: Apple M4
0.00.054.958 I ggml_metal_init: using embedded metal library
0.00.056.881 I ggml_metal_init: GPU name:   Apple M4
0.00.056.883 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.883 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.883 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.884 I ggml_metal_init: simdgroup reduction   = true
0.00.056.884 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.884 I ggml_metal_init: has bfloat            = true
0.00.056.884 I ggml_metal_init: use bfloat            = true
0.00.056.885 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.885 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.059 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.062 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.078 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.952 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.953 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.953 I llama_new_context_with_model: graph nodes  = 967
0.00.066.954 I llama_new_context_with_model: graph splits = 2
0.00.066.966 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.673.464 I 
0.00.673.484 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.673.497 I perplexity: tokenizing the input ..
0.00.681.157 I perplexity: tokenization took 7.66 ms
0.00.681.163 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.815.674 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.816.813 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.816.828 I llama_perf_context_print:        load time =     663.22 ms
0.00.816.829 I llama_perf_context_print: prompt eval time =     134.29 ms /   128 tokens (    1.05 ms per token,   953.18 tokens per second)
0.00.816.829 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.816.830 I llama_perf_context_print:       total time =     143.37 ms /   129 tokens
0.00.817.256 I ggml_metal_free: deallocating

real	0m0.830s
user	0m0.076s
sys	0m0.126s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.093 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.474 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.407 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.014.411 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.417 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.417 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.418 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.418 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.418 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.419 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.419 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.420 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.420 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.420 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.421 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.421 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.423 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.423 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.423 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.158 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.181 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.022.975 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.022.976 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.022.976 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.022.977 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.022.977 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.022.977 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.022.978 I llama_model_loader: - type  f32:  194 tensors
0.00.022.978 I llama_model_loader: - type q5_1:   97 tensors
0.00.022.978 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.211 I llm_load_vocab: special tokens cache size = 25
0.00.049.090 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.093 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.093 I llm_load_print_meta: arch             = gptneox
0.00.049.093 I llm_load_print_meta: vocab type       = BPE
0.00.049.094 I llm_load_print_meta: n_vocab          = 50304
0.00.049.094 I llm_load_print_meta: n_merges         = 50009
0.00.049.094 I llm_load_print_meta: vocab_only       = 0
0.00.049.094 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.094 I llm_load_print_meta: n_embd           = 2048
0.00.049.094 I llm_load_print_meta: n_layer          = 24
0.00.049.097 I llm_load_print_meta: n_head           = 16
0.00.049.098 I llm_load_print_meta: n_head_kv        = 16
0.00.049.098 I llm_load_print_meta: n_rot            = 32
0.00.049.098 I llm_load_print_meta: n_swa            = 0
0.00.049.098 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.098 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.099 I llm_load_print_meta: n_gqa            = 1
0.00.049.105 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.107 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.108 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.108 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.109 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.109 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.109 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.110 I llm_load_print_meta: n_ff             = 8192
0.00.049.110 I llm_load_print_meta: n_expert         = 0
0.00.049.110 I llm_load_print_meta: n_expert_used    = 0
0.00.049.110 I llm_load_print_meta: causal attn      = 1
0.00.049.110 I llm_load_print_meta: pooling type     = 0
0.00.049.111 I llm_load_print_meta: rope type        = 2
0.00.049.114 I llm_load_print_meta: rope scaling     = linear
0.00.049.115 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.115 I llm_load_print_meta: freq_scale_train = 1
0.00.049.115 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.116 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.116 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.116 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.116 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.117 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.117 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.129 I llm_load_print_meta: model type       = 1.4B
0.00.049.130 I llm_load_print_meta: model ftype      = Q5_1
0.00.049.130 I llm_load_print_meta: model params     = 1.41 B
0.00.049.130 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.049.131 I llm_load_print_meta: general.name     = 1.4B
0.00.049.131 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.131 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.131 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.131 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.132 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.133 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.134 I llm_load_print_meta: max token length = 1024
0.00.051.126 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.126 I llm_load_tensors: offloading output layer to GPU
0.00.051.127 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.137 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.051.138 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.052.048 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.049 I llama_new_context_with_model: n_ctx         = 128
0.00.052.049 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.049 I llama_new_context_with_model: n_batch       = 128
0.00.052.049 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.049 I llama_new_context_with_model: flash_attn    = 0
0.00.052.050 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.050 I llama_new_context_with_model: freq_scale    = 1
0.00.052.050 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.051 I ggml_metal_init: allocating
0.00.052.055 I ggml_metal_init: found device: Apple M4
0.00.052.057 I ggml_metal_init: picking default device: Apple M4
0.00.052.589 I ggml_metal_init: using embedded metal library
0.00.054.487 I ggml_metal_init: GPU name:   Apple M4
0.00.054.488 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.488 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.489 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.489 I ggml_metal_init: simdgroup reduction   = true
0.00.054.489 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.489 I ggml_metal_init: has bfloat            = true
0.00.054.489 I ggml_metal_init: use bfloat            = true
0.00.054.490 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.491 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.719 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.723 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.738 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.593 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.594 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.594 I llama_new_context_with_model: graph nodes  = 967
0.00.064.595 I llama_new_context_with_model: graph splits = 2
0.00.064.602 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.697.302 I 
0.00.697.332 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.697.360 I perplexity: tokenizing the input ..
0.00.705.338 I perplexity: tokenization took 7.977 ms
0.00.705.341 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.840.370 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.841.875 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.841.891 I llama_perf_context_print:        load time =     688.83 ms
0.00.841.896 I llama_perf_context_print: prompt eval time =     134.80 ms /   128 tokens (    1.05 ms per token,   949.58 tokens per second)
0.00.841.898 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.841.898 I llama_perf_context_print:       total time =     144.59 ms /   129 tokens
0.00.842.364 I ggml_metal_free: deallocating

real	0m0.855s
user	0m0.074s
sys	0m0.123s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.095 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.226 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.896 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.901 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.902 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.904 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.905 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.905 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.905 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.907 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.907 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.907 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.908 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.908 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.908 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.909 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.910 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.910 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.911 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.743 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.758 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.552 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.553 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.553 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.554 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.554 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.554 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.555 I llama_model_loader: - type  f32:  194 tensors
0.00.024.555 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.555 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.556 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.333 I llm_load_vocab: special tokens cache size = 25
0.00.051.419 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.422 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.423 I llm_load_print_meta: arch             = gptneox
0.00.051.423 I llm_load_print_meta: vocab type       = BPE
0.00.051.423 I llm_load_print_meta: n_vocab          = 50304
0.00.051.423 I llm_load_print_meta: n_merges         = 50009
0.00.051.424 I llm_load_print_meta: vocab_only       = 0
0.00.051.424 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.424 I llm_load_print_meta: n_embd           = 2048
0.00.051.424 I llm_load_print_meta: n_layer          = 24
0.00.051.426 I llm_load_print_meta: n_head           = 16
0.00.051.427 I llm_load_print_meta: n_head_kv        = 16
0.00.051.427 I llm_load_print_meta: n_rot            = 32
0.00.051.428 I llm_load_print_meta: n_swa            = 0
0.00.051.428 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.428 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.429 I llm_load_print_meta: n_gqa            = 1
0.00.051.429 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.433 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.433 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.433 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.434 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.434 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.434 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.435 I llm_load_print_meta: n_ff             = 8192
0.00.051.435 I llm_load_print_meta: n_expert         = 0
0.00.051.435 I llm_load_print_meta: n_expert_used    = 0
0.00.051.437 I llm_load_print_meta: causal attn      = 1
0.00.051.437 I llm_load_print_meta: pooling type     = 0
0.00.051.437 I llm_load_print_meta: rope type        = 2
0.00.051.437 I llm_load_print_meta: rope scaling     = linear
0.00.051.438 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.438 I llm_load_print_meta: freq_scale_train = 1
0.00.051.438 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.438 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.438 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.438 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.439 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.439 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.439 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.445 I llm_load_print_meta: model type       = 1.4B
0.00.051.445 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.051.445 I llm_load_print_meta: model params     = 1.41 B
0.00.051.446 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.051.446 I llm_load_print_meta: general.name     = 1.4B
0.00.051.446 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.446 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.447 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.447 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.447 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.447 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.447 I llm_load_print_meta: max token length = 1024
0.00.052.946 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.947 I llm_load_tensors: offloading output layer to GPU
0.00.052.947 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.951 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.052.952 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.053.787 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.787 I llama_new_context_with_model: n_ctx         = 128
0.00.053.787 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.788 I llama_new_context_with_model: n_batch       = 128
0.00.053.788 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.788 I llama_new_context_with_model: flash_attn    = 0
0.00.053.788 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.789 I llama_new_context_with_model: freq_scale    = 1
0.00.053.789 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.789 I ggml_metal_init: allocating
0.00.053.793 I ggml_metal_init: found device: Apple M4
0.00.053.795 I ggml_metal_init: picking default device: Apple M4
0.00.054.345 I ggml_metal_init: using embedded metal library
0.00.056.233 I ggml_metal_init: GPU name:   Apple M4
0.00.056.235 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.235 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.235 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.236 I ggml_metal_init: simdgroup reduction   = true
0.00.056.236 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.236 I ggml_metal_init: has bfloat            = true
0.00.056.236 I ggml_metal_init: use bfloat            = true
0.00.056.237 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.238 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.062 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.066 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.080 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.939 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.940 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.941 I llama_new_context_with_model: graph nodes  = 967
0.00.065.941 I llama_new_context_with_model: graph splits = 2
0.00.065.952 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.436.146 I 
0.00.436.183 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.436.218 I perplexity: tokenizing the input ..
0.00.444.234 I perplexity: tokenization took 8.017 ms
0.00.444.237 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.576.097 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.577.245 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.577.257 I llama_perf_context_print:        load time =     425.91 ms
0.00.577.258 I llama_perf_context_print: prompt eval time =     131.62 ms /   128 tokens (    1.03 ms per token,   972.50 tokens per second)
0.00.577.259 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.577.260 I llama_perf_context_print:       total time =     141.12 ms /   129 tokens
0.00.577.710 I ggml_metal_free: deallocating

real	0m0.591s
user	0m0.077s
sys	0m0.085s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.084 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.458 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.390 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.014.395 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.396 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.397 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.397 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.397 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.398 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.399 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.399 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.399 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.400 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.400 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.400 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.401 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.403 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.403 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.404 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.141 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.188 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.022.932 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.022.933 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.022.933 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.022.934 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.022.934 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.022.934 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.022.935 I llama_model_loader: - type  f32:  194 tensors
0.00.022.935 I llama_model_loader: - type q3_K:   25 tensors
0.00.022.935 I llama_model_loader: - type q4_K:   71 tensors
0.00.022.935 I llama_model_loader: - type q5_K:    1 tensors
0.00.022.936 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.166 I llm_load_vocab: special tokens cache size = 25
0.00.049.121 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.124 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.124 I llm_load_print_meta: arch             = gptneox
0.00.049.125 I llm_load_print_meta: vocab type       = BPE
0.00.049.125 I llm_load_print_meta: n_vocab          = 50304
0.00.049.125 I llm_load_print_meta: n_merges         = 50009
0.00.049.125 I llm_load_print_meta: vocab_only       = 0
0.00.049.125 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.125 I llm_load_print_meta: n_embd           = 2048
0.00.049.126 I llm_load_print_meta: n_layer          = 24
0.00.049.128 I llm_load_print_meta: n_head           = 16
0.00.049.129 I llm_load_print_meta: n_head_kv        = 16
0.00.049.129 I llm_load_print_meta: n_rot            = 32
0.00.049.131 I llm_load_print_meta: n_swa            = 0
0.00.049.131 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.132 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.132 I llm_load_print_meta: n_gqa            = 1
0.00.049.133 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.134 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.134 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.135 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.135 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.135 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.135 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.136 I llm_load_print_meta: n_ff             = 8192
0.00.049.136 I llm_load_print_meta: n_expert         = 0
0.00.049.137 I llm_load_print_meta: n_expert_used    = 0
0.00.049.137 I llm_load_print_meta: causal attn      = 1
0.00.049.137 I llm_load_print_meta: pooling type     = 0
0.00.049.137 I llm_load_print_meta: rope type        = 2
0.00.049.137 I llm_load_print_meta: rope scaling     = linear
0.00.049.138 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.138 I llm_load_print_meta: freq_scale_train = 1
0.00.049.138 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.138 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.139 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.139 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.139 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.139 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.140 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.151 I llm_load_print_meta: model type       = 1.4B
0.00.049.152 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.049.152 I llm_load_print_meta: model params     = 1.41 B
0.00.049.152 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.049.153 I llm_load_print_meta: general.name     = 1.4B
0.00.049.153 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.153 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.153 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.153 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.154 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.154 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.154 I llm_load_print_meta: max token length = 1024
0.00.051.082 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.082 I llm_load_tensors: offloading output layer to GPU
0.00.051.082 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.092 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.051.093 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.052.056 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.056 I llama_new_context_with_model: n_ctx         = 128
0.00.052.057 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.057 I llama_new_context_with_model: n_batch       = 128
0.00.052.057 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.057 I llama_new_context_with_model: flash_attn    = 0
0.00.052.058 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.058 I llama_new_context_with_model: freq_scale    = 1
0.00.052.058 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.059 I ggml_metal_init: allocating
0.00.052.062 I ggml_metal_init: found device: Apple M4
0.00.052.064 I ggml_metal_init: picking default device: Apple M4
0.00.052.596 I ggml_metal_init: using embedded metal library
0.00.054.489 I ggml_metal_init: GPU name:   Apple M4
0.00.054.490 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.491 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.491 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.491 I ggml_metal_init: simdgroup reduction   = true
0.00.054.492 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.492 I ggml_metal_init: has bfloat            = true
0.00.054.492 I ggml_metal_init: use bfloat            = true
0.00.054.492 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.493 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.671 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.673 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.696 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.583 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.584 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.584 I llama_new_context_with_model: graph nodes  = 967
0.00.064.584 I llama_new_context_with_model: graph splits = 2
0.00.064.592 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.528.769 I 
0.00.528.787 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.528.798 I perplexity: tokenizing the input ..
0.00.536.204 I perplexity: tokenization took 7.406 ms
0.00.536.208 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.668.525 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.669.820 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.669.839 I llama_perf_context_print:        load time =     520.31 ms
0.00.669.840 I llama_perf_context_print: prompt eval time =     132.10 ms /   128 tokens (    1.03 ms per token,   968.98 tokens per second)
0.00.669.841 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.669.842 I llama_perf_context_print:       total time =     141.07 ms /   129 tokens
0.00.670.257 I ggml_metal_free: deallocating

real	0m0.682s
user	0m0.075s
sys	0m0.102s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.091 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.868 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.759 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.015.764 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.765 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.766 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.766 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.766 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.767 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.768 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.768 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.768 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.770 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.770 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.770 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.771 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.774 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.774 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.775 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.620 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.653 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.471 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.472 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.472 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.472 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.473 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.473 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.473 I llama_model_loader: - type  f32:  194 tensors
0.00.024.474 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.474 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.474 I llama_model_loader: - type q6_K:   13 tensors
0.00.045.546 I llm_load_vocab: special tokens cache size = 25
0.00.051.709 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.712 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.712 I llm_load_print_meta: arch             = gptneox
0.00.051.713 I llm_load_print_meta: vocab type       = BPE
0.00.051.713 I llm_load_print_meta: n_vocab          = 50304
0.00.051.713 I llm_load_print_meta: n_merges         = 50009
0.00.051.713 I llm_load_print_meta: vocab_only       = 0
0.00.051.714 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.714 I llm_load_print_meta: n_embd           = 2048
0.00.051.714 I llm_load_print_meta: n_layer          = 24
0.00.051.717 I llm_load_print_meta: n_head           = 16
0.00.051.718 I llm_load_print_meta: n_head_kv        = 16
0.00.051.721 I llm_load_print_meta: n_rot            = 32
0.00.051.721 I llm_load_print_meta: n_swa            = 0
0.00.051.721 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.721 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.722 I llm_load_print_meta: n_gqa            = 1
0.00.051.723 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.723 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.725 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.725 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.726 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.726 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.726 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.727 I llm_load_print_meta: n_ff             = 8192
0.00.051.727 I llm_load_print_meta: n_expert         = 0
0.00.051.727 I llm_load_print_meta: n_expert_used    = 0
0.00.051.727 I llm_load_print_meta: causal attn      = 1
0.00.051.727 I llm_load_print_meta: pooling type     = 0
0.00.051.727 I llm_load_print_meta: rope type        = 2
0.00.051.727 I llm_load_print_meta: rope scaling     = linear
0.00.051.728 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.728 I llm_load_print_meta: freq_scale_train = 1
0.00.051.728 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.728 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.729 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.729 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.729 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.729 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.729 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.741 I llm_load_print_meta: model type       = 1.4B
0.00.051.741 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.051.741 I llm_load_print_meta: model params     = 1.41 B
0.00.051.742 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.051.742 I llm_load_print_meta: general.name     = 1.4B
0.00.051.742 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.742 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.743 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.743 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.743 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.744 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.745 I llm_load_print_meta: max token length = 1024
0.00.053.758 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.759 I llm_load_tensors: offloading output layer to GPU
0.00.053.759 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.769 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.053.770 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.054.735 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.736 I llama_new_context_with_model: n_ctx         = 128
0.00.054.736 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.736 I llama_new_context_with_model: n_batch       = 128
0.00.054.736 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.737 I llama_new_context_with_model: flash_attn    = 0
0.00.054.737 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.737 I llama_new_context_with_model: freq_scale    = 1
0.00.054.738 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.738 I ggml_metal_init: allocating
0.00.054.745 I ggml_metal_init: found device: Apple M4
0.00.054.747 I ggml_metal_init: picking default device: Apple M4
0.00.055.293 I ggml_metal_init: using embedded metal library
0.00.057.311 I ggml_metal_init: GPU name:   Apple M4
0.00.057.312 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.313 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.313 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.313 I ggml_metal_init: simdgroup reduction   = true
0.00.057.313 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.313 I ggml_metal_init: has bfloat            = true
0.00.057.313 I ggml_metal_init: use bfloat            = true
0.00.057.314 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.315 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.383 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.385 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.398 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.067.254 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.067.255 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.067.255 I llama_new_context_with_model: graph nodes  = 967
0.00.067.256 I llama_new_context_with_model: graph splits = 2
0.00.067.268 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.600.840 I 
0.00.600.897 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.600.932 I perplexity: tokenizing the input ..
0.00.608.220 I perplexity: tokenization took 7.288 ms
0.00.608.223 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.741.977 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.743.151 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.743.160 I llama_perf_context_print:        load time =     590.96 ms
0.00.743.162 I llama_perf_context_print: prompt eval time =     133.53 ms /   128 tokens (    1.04 ms per token,   958.62 tokens per second)
0.00.743.162 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.743.163 I llama_perf_context_print:       total time =     142.33 ms /   129 tokens
0.00.743.455 I ggml_metal_free: deallocating

real	0m0.756s
user	0m0.076s
sys	0m0.110s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.380 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.378 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.014.382 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.384 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.385 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.385 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.385 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.385 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.387 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.387 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.387 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.388 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.388 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.388 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.389 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.390 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.390 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.391 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.198 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.218 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.047 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.048 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.049 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.049 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.049 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.050 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.023.050 I llama_model_loader: - type  f32:  194 tensors
0.00.023.051 I llama_model_loader: - type q5_K:   61 tensors
0.00.023.051 I llama_model_loader: - type q6_K:   37 tensors
0.00.043.291 I llm_load_vocab: special tokens cache size = 25
0.00.049.411 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.413 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.413 I llm_load_print_meta: arch             = gptneox
0.00.049.414 I llm_load_print_meta: vocab type       = BPE
0.00.049.414 I llm_load_print_meta: n_vocab          = 50304
0.00.049.414 I llm_load_print_meta: n_merges         = 50009
0.00.049.414 I llm_load_print_meta: vocab_only       = 0
0.00.049.415 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.415 I llm_load_print_meta: n_embd           = 2048
0.00.049.415 I llm_load_print_meta: n_layer          = 24
0.00.049.417 I llm_load_print_meta: n_head           = 16
0.00.049.418 I llm_load_print_meta: n_head_kv        = 16
0.00.049.418 I llm_load_print_meta: n_rot            = 32
0.00.049.419 I llm_load_print_meta: n_swa            = 0
0.00.049.419 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.419 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.420 I llm_load_print_meta: n_gqa            = 1
0.00.049.420 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.421 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.422 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.422 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.422 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.422 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.422 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.424 I llm_load_print_meta: n_ff             = 8192
0.00.049.424 I llm_load_print_meta: n_expert         = 0
0.00.049.425 I llm_load_print_meta: n_expert_used    = 0
0.00.049.425 I llm_load_print_meta: causal attn      = 1
0.00.049.425 I llm_load_print_meta: pooling type     = 0
0.00.049.425 I llm_load_print_meta: rope type        = 2
0.00.049.425 I llm_load_print_meta: rope scaling     = linear
0.00.049.426 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.426 I llm_load_print_meta: freq_scale_train = 1
0.00.049.426 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.426 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.426 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.427 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.428 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.428 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.429 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.439 I llm_load_print_meta: model type       = 1.4B
0.00.049.439 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.049.439 I llm_load_print_meta: model params     = 1.41 B
0.00.049.440 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.049.440 I llm_load_print_meta: general.name     = 1.4B
0.00.049.440 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.440 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.440 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.441 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.441 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.441 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.441 I llm_load_print_meta: max token length = 1024
0.00.051.455 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.456 I llm_load_tensors: offloading output layer to GPU
0.00.051.456 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.466 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.051.467 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.052.436 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.437 I llama_new_context_with_model: n_ctx         = 128
0.00.052.437 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.437 I llama_new_context_with_model: n_batch       = 128
0.00.052.438 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.438 I llama_new_context_with_model: flash_attn    = 0
0.00.052.438 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.438 I llama_new_context_with_model: freq_scale    = 1
0.00.052.439 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.439 I ggml_metal_init: allocating
0.00.052.442 I ggml_metal_init: found device: Apple M4
0.00.052.444 I ggml_metal_init: picking default device: Apple M4
0.00.052.982 I ggml_metal_init: using embedded metal library
0.00.054.901 I ggml_metal_init: GPU name:   Apple M4
0.00.054.902 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.902 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.903 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.903 I ggml_metal_init: simdgroup reduction   = true
0.00.054.903 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.904 I ggml_metal_init: has bfloat            = true
0.00.054.904 I ggml_metal_init: use bfloat            = true
0.00.054.904 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.905 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.957 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.960 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.974 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.927 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.928 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.928 I llama_new_context_with_model: graph nodes  = 967
0.00.064.928 I llama_new_context_with_model: graph splits = 2
0.00.064.941 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.671.930 I 
0.00.671.962 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.671.989 I perplexity: tokenizing the input ..
0.00.679.506 I perplexity: tokenization took 7.516 ms
0.00.679.509 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.820.656 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.821.912 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.821.934 I llama_perf_context_print:        load time =     663.54 ms
0.00.821.936 I llama_perf_context_print: prompt eval time =     140.92 ms /   128 tokens (    1.10 ms per token,   908.30 tokens per second)
0.00.821.937 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.821.937 I llama_perf_context_print:       total time =     150.01 ms /   129 tokens
0.00.822.386 I ggml_metal_free: deallocating

real	0m0.835s
user	0m0.075s
sys	0m0.123s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.093 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.079 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.014 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.017 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.019 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.019 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.020 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.020 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.020 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.021 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.022 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.022 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.022 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.023 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.023 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.023 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.025 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.025 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.025 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.774 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.780 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.531 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.532 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.533 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.533 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.533 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.534 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.534 I llama_model_loader: - type  f32:  194 tensors
0.00.024.535 I llama_model_loader: - type q6_K:   98 tensors
0.00.045.380 I llm_load_vocab: special tokens cache size = 25
0.00.051.411 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.414 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.414 I llm_load_print_meta: arch             = gptneox
0.00.051.414 I llm_load_print_meta: vocab type       = BPE
0.00.051.415 I llm_load_print_meta: n_vocab          = 50304
0.00.051.415 I llm_load_print_meta: n_merges         = 50009
0.00.051.415 I llm_load_print_meta: vocab_only       = 0
0.00.051.415 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.415 I llm_load_print_meta: n_embd           = 2048
0.00.051.416 I llm_load_print_meta: n_layer          = 24
0.00.051.418 I llm_load_print_meta: n_head           = 16
0.00.051.419 I llm_load_print_meta: n_head_kv        = 16
0.00.051.419 I llm_load_print_meta: n_rot            = 32
0.00.051.419 I llm_load_print_meta: n_swa            = 0
0.00.051.421 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.421 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.422 I llm_load_print_meta: n_gqa            = 1
0.00.051.423 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.424 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.424 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.424 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.425 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.425 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.425 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.425 I llm_load_print_meta: n_ff             = 8192
0.00.051.426 I llm_load_print_meta: n_expert         = 0
0.00.051.426 I llm_load_print_meta: n_expert_used    = 0
0.00.051.426 I llm_load_print_meta: causal attn      = 1
0.00.051.426 I llm_load_print_meta: pooling type     = 0
0.00.051.426 I llm_load_print_meta: rope type        = 2
0.00.051.426 I llm_load_print_meta: rope scaling     = linear
0.00.051.431 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.431 I llm_load_print_meta: freq_scale_train = 1
0.00.051.433 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.433 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.433 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.434 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.434 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.434 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.434 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.438 I llm_load_print_meta: model type       = 1.4B
0.00.051.439 I llm_load_print_meta: model ftype      = Q6_K
0.00.051.439 I llm_load_print_meta: model params     = 1.41 B
0.00.051.439 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.051.440 I llm_load_print_meta: general.name     = 1.4B
0.00.051.440 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.440 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.440 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.440 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.441 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.441 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.441 I llm_load_print_meta: max token length = 1024
0.00.052.920 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.920 I llm_load_tensors: offloading output layer to GPU
0.00.052.920 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.924 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.052.925 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.053.731 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.732 I llama_new_context_with_model: n_ctx         = 128
0.00.053.732 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.732 I llama_new_context_with_model: n_batch       = 128
0.00.053.732 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.732 I llama_new_context_with_model: flash_attn    = 0
0.00.053.733 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.733 I llama_new_context_with_model: freq_scale    = 1
0.00.053.733 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.734 I ggml_metal_init: allocating
0.00.053.737 I ggml_metal_init: found device: Apple M4
0.00.053.739 I ggml_metal_init: picking default device: Apple M4
0.00.054.250 I ggml_metal_init: using embedded metal library
0.00.056.154 I ggml_metal_init: GPU name:   Apple M4
0.00.056.155 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.155 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.156 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.156 I ggml_metal_init: simdgroup reduction   = true
0.00.056.156 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.156 I ggml_metal_init: has bfloat            = true
0.00.056.156 I ggml_metal_init: use bfloat            = true
0.00.056.157 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.158 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.142 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.144 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.161 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.991 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.992 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.992 I llama_new_context_with_model: graph nodes  = 967
0.00.065.993 I llama_new_context_with_model: graph splits = 2
0.00.065.999 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.407.710 I 
0.00.407.753 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.407.785 I perplexity: tokenizing the input ..
0.00.415.801 I perplexity: tokenization took 8.02 ms
0.00.415.805 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.555.505 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.556.649 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.556.664 I llama_perf_context_print:        load time =     397.62 ms
0.00.556.665 I llama_perf_context_print: prompt eval time =     139.47 ms /   128 tokens (    1.09 ms per token,   917.73 tokens per second)
0.00.556.666 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.556.667 I llama_perf_context_print:       total time =     148.96 ms /   129 tokens
0.00.557.067 I ggml_metal_free: deallocating

real	0m0.570s
user	0m0.076s
sys	0m0.092s
+ ./bin/llama-imatrix --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.332 I build: 4159 (d9d54e49) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.024.265 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.037.089 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.037.096 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.037.099 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.037.100 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.037.100 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.037.101 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.037.102 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.037.103 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.037.104 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.037.104 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.037.108 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.037.109 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.037.109 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.037.110 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.037.112 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.037.113 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.037.116 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.377 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.101 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.052.641 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.052.643 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.052.644 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.052.644 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.052.644 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.052.645 I llama_model_loader: - type  f32:  194 tensors
0.00.052.645 I llama_model_loader: - type  f16:   98 tensors
0.00.079.986 I llm_load_vocab: special tokens cache size = 25
0.00.086.387 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.086.389 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.086.390 I llm_load_print_meta: arch             = gptneox
0.00.086.390 I llm_load_print_meta: vocab type       = BPE
0.00.086.390 I llm_load_print_meta: n_vocab          = 50304
0.00.086.390 I llm_load_print_meta: n_merges         = 50009
0.00.086.390 I llm_load_print_meta: vocab_only       = 0
0.00.086.391 I llm_load_print_meta: n_ctx_train      = 2048
0.00.086.391 I llm_load_print_meta: n_embd           = 2048
0.00.086.391 I llm_load_print_meta: n_layer          = 24
0.00.086.394 I llm_load_print_meta: n_head           = 16
0.00.086.394 I llm_load_print_meta: n_head_kv        = 16
0.00.086.395 I llm_load_print_meta: n_rot            = 32
0.00.086.395 I llm_load_print_meta: n_swa            = 0
0.00.086.395 I llm_load_print_meta: n_embd_head_k    = 128
0.00.086.397 I llm_load_print_meta: n_embd_head_v    = 128
0.00.086.398 I llm_load_print_meta: n_gqa            = 1
0.00.086.399 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.086.400 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.086.400 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.086.402 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.086.402 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.086.402 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.086.402 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.086.403 I llm_load_print_meta: n_ff             = 8192
0.00.086.403 I llm_load_print_meta: n_expert         = 0
0.00.086.403 I llm_load_print_meta: n_expert_used    = 0
0.00.086.403 I llm_load_print_meta: causal attn      = 1
0.00.086.404 I llm_load_print_meta: pooling type     = 0
0.00.086.404 I llm_load_print_meta: rope type        = 2
0.00.086.404 I llm_load_print_meta: rope scaling     = linear
0.00.086.404 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.086.405 I llm_load_print_meta: freq_scale_train = 1
0.00.086.405 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.086.405 I llm_load_print_meta: rope_finetuned   = unknown
0.00.086.405 I llm_load_print_meta: ssm_d_conv       = 0
0.00.086.406 I llm_load_print_meta: ssm_d_inner      = 0
0.00.086.407 I llm_load_print_meta: ssm_d_state      = 0
0.00.086.407 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.086.407 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.086.419 I llm_load_print_meta: model type       = 1.4B
0.00.086.419 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.086.420 I llm_load_print_meta: model params     = 1.41 B
0.00.086.420 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.086.420 I llm_load_print_meta: general.name     = 1.4B
0.00.086.421 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.086.421 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.086.421 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.086.421 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.086.422 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.086.422 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.086.422 I llm_load_print_meta: max token length = 1024
0.00.088.898 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.088.898 I llm_load_tensors: offloading output layer to GPU
0.00.088.898 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.088.909 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.088.910 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.089.923 I llama_new_context_with_model: n_seq_max     = 1
0.00.089.924 I llama_new_context_with_model: n_ctx         = 128
0.00.089.924 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.089.924 I llama_new_context_with_model: n_batch       = 128
0.00.089.924 I llama_new_context_with_model: n_ubatch      = 128
0.00.089.924 I llama_new_context_with_model: flash_attn    = 0
0.00.089.925 I llama_new_context_with_model: freq_base     = 10000.0
0.00.089.925 I llama_new_context_with_model: freq_scale    = 1
0.00.089.925 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.089.926 I ggml_metal_init: allocating
0.00.089.933 I ggml_metal_init: found device: Apple M4
0.00.089.935 I ggml_metal_init: picking default device: Apple M4
0.00.090.505 I ggml_metal_init: using embedded metal library
0.00.092.568 I ggml_metal_init: GPU name:   Apple M4
0.00.092.570 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.092.570 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.092.571 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.092.571 I ggml_metal_init: simdgroup reduction   = true
0.00.092.571 I ggml_metal_init: simdgroup matrix mul. = true
0.00.092.571 I ggml_metal_init: has bfloat            = true
0.00.092.571 I ggml_metal_init: use bfloat            = true
0.00.092.572 I ggml_metal_init: hasUnifiedMemory      = true
0.00.092.573 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.100.866 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.100.872 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.100.888 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.101.739 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.101.740 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.101.740 I llama_new_context_with_model: graph nodes  = 967
0.00.101.741 I llama_new_context_with_model: graph splits = 2
0.00.101.753 I 
0.00.101.775 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | AVX = 0 | AVX_VNNI = 0 | AVX2 = 0 | AVX512 = 0 | AVX512_VBMI = 0 | AVX512_VNNI = 0 | AVX512_BF16 = 0 | AMX_INT8 = 0 | FMA = 0 | NEON = 1 | SVE = 0 | ARM_FMA = 1 | F16C = 0 | FP16_VA = 1 | RISCV_VECT = 0 | WASM_SIMD = 0 | SSE3 = 0 | SSSE3 = 0 | VSX = 0 | MATMUL_INT8 = 0 | LLAMAFILE = 1 | 
0.00.101.776 I compute_imatrix: tokenizing the input ..
0.00.108.669 I compute_imatrix: tokenization took 6.892 ms
0.00.108.670 I compute_imatrix: computing over 1 chunks with batch_size 128
0.01.612.958 I compute_imatrix: 1.50 seconds per pass - ETA 0.02 minutes
[1]10.1498,
Final estimate: PPL = 10.1498 +/- 3.22650

0.01.615.309 I llama_perf_context_print:        load time =    1588.69 ms
0.01.615.310 I llama_perf_context_print: prompt eval time =    1503.65 ms /   128 tokens (   11.75 ms per token,    85.13 tokens per second)
0.01.615.311 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.615.311 I llama_perf_context_print:       total time =    1591.04 ms /   129 tokens
0.01.615.803 I ggml_metal_free: deallocating

real	0m1.798s
user	0m0.164s
sys	0m0.244s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4159 (d9d54e49)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13b30ae80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13b30b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13b30bb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13b30c0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13b30c690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13b30cc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13b30d1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13b30d7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13b30dd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13b30e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13b30e750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13b30ec50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13b30f770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13b30ff20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13b310730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13b310e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13b311570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13b311c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13b3123b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13b312b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13b3132a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13b3139c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13b3140e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13b314980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13b3150a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13b315360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13b315970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13b3165e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13b316b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13b316de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13b317280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13b317540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13b317dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13b318310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13b3185d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13b318a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13b318f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13b3193b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13b319850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13b319cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13b31a190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13b31a630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13b31aad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13b31af70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13b31b230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13b31b840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13b31be50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13b31c770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13b31cd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13b31d390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13b31d9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13b31dfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13b31e5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13b31ebd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13b31f3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13b31f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13b31fd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13b31ffc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13b3205d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13b320dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13b321080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13b321520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13b3219c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13b321e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13b322300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13b3227a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13b322c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13b3230e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13b323580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13b323a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13b323ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13b324360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13b324800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13b324ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13b325140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13b3255e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13b325a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13b325f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13b3263c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13b326860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13b326d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13b3271a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13b327640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13b327ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13b327f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13b328420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13b3288c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13b328d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13b329200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13b3296a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13b329b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13b329fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13b32a480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13b32a920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13b32adc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13b32b260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13b32b700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13b31c460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13b32bd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13b32c1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13b32c690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13b32cb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13b32cfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13b32d470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13b32d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13b32ddb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13b32e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13b32e6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13b32eb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13b32f030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13b32f4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13b32f970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13b32fe10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13b3302b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13b330750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13b330bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13b331090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13b331530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13b3319d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13b331e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13b332310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13b3327b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13b332c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13b3330f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13b333590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13b333a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13b333ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13b334370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13b334810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13b334cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13b335150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13b3355f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13b335a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13b335f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13b3363d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13b336870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13b336d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13b3371b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13b337650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13b337af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13b337f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13b338430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13b3388d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13b338d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13b339210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13b3396b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13b339b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13b339ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13b33a490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13b33a930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13b33add0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13b33b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13b33b710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13b33bc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13b33c1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13b33c700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13b33cc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13b33cf10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13b33d520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13b33db30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13b33e140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13b33e750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13b33ed60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13b33f550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13b33f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13b33fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13b340330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13b340ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13b341030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13b341580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13b341ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13b342020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13b342570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13b342ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13b343010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13b343560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13b343ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13b344000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13b344550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13b344aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13b344ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13b345540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13b345a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13b345fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13b346530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13b346a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13b346fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13b347520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13b347a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13b347fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13b348510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13b348a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13b348fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13b349500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13b349a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13b349fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13b34a4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13b34aa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13b34af90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13b34b4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13b34ba30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13b34bf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13b34c4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13b34ca20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13b34cf70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13b34d4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13b34da10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13b34df60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13b34e4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13b34ea00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13b34ef50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13b34f4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13b34f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13b34ff40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13b350490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13b3509e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13b350f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13b351480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13b3519d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13b351f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13b352470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13b3529c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13b352f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13b353460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13b353900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13b353da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13b354240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13b3546e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13b354b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13b355020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13b3554c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13b355960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13b355e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13b3562a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13b356740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13b356be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13b357080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13b3575d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13b357cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13b358410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13b358b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13b359250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13b359510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13b359b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13b35a130 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.144.000 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13b34a570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13b34a9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13b34ae50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13b34b2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13b34b730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13b34bba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13b34c010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13b34c480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13b34c8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13b34cd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13b34d1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13b34d7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13b34e0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13b34e820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13b34f000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13b34f6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13b34fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13b3504d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13b350bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13b351540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13b351c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13b352320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13b352a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13b353100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13b3537f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13b353c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13b3540d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13b354540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13b3549b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13b354e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13b355290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13b355700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13b355b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13b355e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13b3562a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13b356710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13b356b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13b356ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13b357460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13b3578d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13b357d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13b3581b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13b358620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13b358a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13b358f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13b359370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13b3597e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13b359c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13b35a0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13b30bf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13b30ca80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13b30b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13b30c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13b30a620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13b30d1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13b30d660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13b30ae80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13b318300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13b3185c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13b318a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13b318ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13b319310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13b319780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13b319bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13b31a060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13b31a4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13b31a940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13b31adb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13b31b220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13b31b690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13b31bb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13b31bf70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13b31c3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13b31c850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13b31ccc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13b31d130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13b31d5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13b31da10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13b31de80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13b31e2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13b31e760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13b31ebd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13b31f040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13b31f4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13b31f920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13b31fd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13b320200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13b320670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13b320ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13b320f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13b3213c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13b321830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13b321ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13b322110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13b322580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13b3229f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13b322e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13b3232d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13b323740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13b323bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13b324020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13b324490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13b324900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13b324d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13b3251e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13b325650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13b325ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13b325f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13b3263a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13b326810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13b326c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13b3270f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13b327560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13b3279d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13b327e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13b3282b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13b328720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13b328b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13b329000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13b329470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13b3298e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13b329d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13b32a1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13b32a630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13b32aaa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13b32af10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13b32b380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13b32b7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13b32bc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13b32c0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13b32c540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13b32c9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13b32ce20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13b32d290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13b32d700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13b32db70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13b32dfe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13b32e450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13b32e8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13b32ed30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13b32f1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13b32f610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13b32fa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13b32fef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13b330360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13b3307d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13b330c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13b3310b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13b331520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13b331990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13b331e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13b332270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13b3326e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13b332b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13b332fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13b333430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13b3338a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13b333d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13b334180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13b3345f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13b334a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13b334ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13b335340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13b3357b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13b335c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13b336090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13b336500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13b336c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13b3370f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13b337560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13b3379d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13b337e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13b3382b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13b338720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13b338b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13b339000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13b339470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13b3398e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13b339d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13b33a1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13b33a630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13b33aaa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13b33af10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13b33b380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13b33b7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13b33bc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13b33c0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13b33c540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13b33c9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13b33ce20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13b33d290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13b33d700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13b33db70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13b33dfe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13b33e450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13b33e8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13b33ed30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13b33f1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13b33f610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13b33fa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13b33fef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13b340360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13b3407d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13b340c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13b3410b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13b341520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13b341990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13b341e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13b342270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13b3426e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13b342b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13b342fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13b343430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13b3438a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13b343d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13b344180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13b3445f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13b344a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13b344ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13b345340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13b3457b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13b345c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13b346090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13b346500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13b346970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13b346de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13b347250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13b3476c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13b347b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13b347fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13b348410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13b348880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13b348cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13b349160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13b3495d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13b349a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13b316cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13b317130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13b317820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13b30e210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13b30e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13b30eff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13b30f460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13b30f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13b30fd40 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13b316f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13b3173e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13b317850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13b317cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13b34a2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13b34a730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13b34aba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13b34b010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13b34b480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13b34b8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13b34bd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13b34c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13b34cc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13b34d3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13b34db90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13b34e280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13b34e970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13b34f060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13b34f750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13b3500d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13b3507c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13b350eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13b3515a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13b351c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13b352380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13b3527f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13b352c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13b3530d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13b353540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13b3539b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13b353e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13b354290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13b354700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13b3549c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13b354e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13b3552a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13b355710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13b355b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13b355ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13b356460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13b3568d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13b356d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13b3571b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13b357620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13b357a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13b357f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13b358370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13b3587e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13b358c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13b3590c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13b359530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13b3599a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13b359e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13b35a280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13b30b030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13b3184b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13b318920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13b318d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13b319200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13b319670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13b319ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13b319f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13b31a3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13b31a830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13b31aca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13b31b110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13b31b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13b31b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13b31be60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13b31c2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13b31c740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13b31cbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13b31d020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13b31d490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13b31d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13b31dd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13b31e1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13b31e650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13b31eac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13b31ef30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13b31f3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13b31f810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13b31fc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13b3200f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13b320560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13b3209d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13b320e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13b3212b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13b321720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13b321b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13b322000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13b322470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13b3228e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13b322d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13b3231c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13b323630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13b323aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13b323f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13b324380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13b3247f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13b324c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13b3250d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13b325540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13b3259b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13b325e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13b326290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13b326700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13b326b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13b326fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13b327450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13b3278c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13b327d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13b3281a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13b328610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13b328a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13b328ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13b329360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13b3297d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13b329c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13b32a0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13b32a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13b32a990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13b32ae00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13b32b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13b32b6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13b32bb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13b32bfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13b32c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13b32c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13b32cd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13b32d180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13b32d5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13b32da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13b32ded0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13b32e340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13b32e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13b32ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13b32f090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13b32f500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13b32f970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13b32fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13b330250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13b3306c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13b330b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13b330fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13b331410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13b331880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13b331cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13b332160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13b3325d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13b332a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13b332eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13b333320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13b333790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13b333c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13b334070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13b3344e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13b334950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13b334dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13b335230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13b3356a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13b335b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13b335f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13b3363f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13b336860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13b336cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13b337140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13b3378c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13b337d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13b3381a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13b338610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13b338a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13b338ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13b339360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13b3397d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13b339c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13b33a0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13b33a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13b33a990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13b33ae00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13b33b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13b33b6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13b33bb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13b33bfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13b33c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13b33c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13b33cd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13b33d180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13b33d5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13b33da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13b33ded0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13b33e340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13b33e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13b33ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13b33f090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13b33f500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13b33f970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13b33fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13b340250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13b3406c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13b340b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13b340fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13b341410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13b341880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13b341cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13b342160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13b3425d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13b342a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13b342eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13b343320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13b343790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13b343c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13b344070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13b3444e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13b344950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13b344dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13b345230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13b3456a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13b345b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13b345f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13b3463f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13b346860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13b346cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13b347140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13b3475b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13b347a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13b347e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13b348300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13b348770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13b348be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13b349050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13b3494c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13b349930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13b30d1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13b30d660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13b30a620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13b30c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13b30b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13b30bf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13b30e490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13b30e9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13b30f0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13b30f530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13b30f9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13b30fe10 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.840s
user	0m0.298s
sys	0m0.298s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4159 (d9d54e49)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x123f0ebe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x123f0f2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x123f0f8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x123f0fe50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x123f10400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x123f109b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x123f10f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x123f11510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x123f11ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x123f11fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x123f124c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x123f129c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x123f134e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x123f13c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x123f144a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x123f14bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x123f152e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x123f15a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x123f16120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x123f168f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x123f17010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x123f17730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x123f17e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x123f186f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x123f18e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x123f190d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x123f196e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x123f1a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x123f1a890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x123f1ab50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x123f1aff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x123f1b2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x123f1bb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x123f1c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x123f1c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x123f1c7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x123f1cc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x123f1d120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x123f1d5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x123f1da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x123f1df00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x123f1e3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x123f1e840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x123f1ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x123f1efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x123f1f5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x123f1fbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x123f204e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x123f20af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x123f21100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x123f21710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x123f21d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x123f22330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x123f22940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x123f23130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x123f235d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x123f23a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x123f23d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x123f24340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x123f24b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x123f24df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x123f25290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x123f25730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x123f25bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x123f26070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x123f26510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x123f269b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x123f26e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x123f272f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x123f27790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x123f27c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x123f280d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x123f28570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x123f28a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x123f28eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x123f29350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x123f297f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x123f29c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x123f2a130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x123f2a5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x123f2aa70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x123f2af10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x123f2b3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x123f2b850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x123f2bcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x123f2c190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x123f2c630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x123f2cad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x123f2cf70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x123f2d410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x123f2d8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x123f2dd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x123f2e1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x123f2e690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x123f2eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x123f2efd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x123f2f470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x123f201d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x123f2fac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x123f2ff60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x123f30400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x123f308a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x123f30d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x123f311e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x123f31680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x123f31b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x123f31fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x123f32460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x123f32900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x123f32da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x123f33240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x123f336e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x123f33b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x123f34020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x123f344c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x123f34960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x123f34e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x123f352a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x123f35740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x123f35be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x123f36080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x123f36520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x123f369c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x123f36e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x123f37300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x123f377a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x123f37c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x123f380e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x123f38580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x123f38a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x123f38ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x123f39360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x123f39800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x123f39ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x123f3a140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x123f3a5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x123f3aa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x123f3af20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x123f3b3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x123f3b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x123f3bd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x123f3c1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x123f3c640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x123f3cae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x123f3cf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x123f3d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x123f3d8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x123f3dd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x123f3e200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x123f3e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x123f3eb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x123f3efe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x123f3f480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x123f3f9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x123f3ff20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x123f40470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x123f409c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x123f40c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x123f41290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x123f418a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x123f41eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x123f424c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x123f42ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x123f432c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x123f43760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x123f43c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x123f440a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x123f44850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x123f44da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x123f452f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x123f45840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x123f45d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x123f462e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x123f46830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x123f46d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x123f472d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x123f47820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x123f47d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x123f482c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x123f48810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x123f48d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x123f492b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x123f49800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x123f49d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x123f4a2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x123f4a7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x123f4ad40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x123f4b290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x123f4b7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x123f4bd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x123f4c280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x123f4c7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x123f4cd20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x123f4d270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x123f4d7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x123f4dd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x123f4e260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x123f4e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x123f4ed00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x123f4f250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x123f4f7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x123f4fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x123f50240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x123f50790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x123f50ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x123f51230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x123f51780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x123f51cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x123f52220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x123f52770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x123f52cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x123f53210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x123f53760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x123f53cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x123f54200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x123f54750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x123f54ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x123f551f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x123f55740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x123f55c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x123f561e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x123f56730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x123f56c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x123f571d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x123f57670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x123f57b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x123f57fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x123f58450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x123f588f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x123f58d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x123f59230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x123f596d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x123f59b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x123f5a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x123f5a4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x123f5a950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x123f5adf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x123f5b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x123f5ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x123f5c180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x123f5c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x123f5cfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x123f5d280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x123f5d890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x123f5dea0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.081.993 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x123e05a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x123e05ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x123e064b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x123e06a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x123e07010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x123e075c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x123e07b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x123e08120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x123e086d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x123e08bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x123e090d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x123e095d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x123e0a0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x123e0a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x123e0b0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x123e0b7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x123e0bef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x123e0c610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x123e0cd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x123e0d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x123e0dc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x123e0e340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x123e0ea60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x123e0f180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x123e0f8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x123e0fb60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x123e10170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x123e10780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x123e10d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x123e11580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x123e11a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x123e11ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x123e12570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x123e12ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x123e12d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x123e13210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x123e136b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x123e13b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x123e13ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x123e14490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x123e14930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x123e14dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x123e15270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x123e15710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x123e159d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x123e15fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x123e165f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x123e16c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x123e17210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x123e17820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x123e17e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x123e18440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x123e18a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x123e19060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x123e19850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x123e19cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x123e1a190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x123e1a450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x123e1aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x123e1b250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x123e1b6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x123e1bb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x123e1c030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x123e1c4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x123e1c970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x123e1ce10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x123e1d2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x123e1d750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x123e1dbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x123e1e090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x123e1e530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x123e1e9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x123e1ee70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x123e1f310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x123e1f7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x123e1fc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x123e200f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x123e20590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x123e20a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x123e20ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x123e21370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x123e21810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x123e21cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x123e22150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x123e225f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x123e22a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x123e22f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x123e233d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x123e23870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x123e23d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x123e241b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x123e24650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x123e24af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x123e24f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x123e25430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x123e258d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x123e25d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x123e26210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x123e266b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x123e26b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x123e26ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x123e27490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x123e27930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x123e27dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x123e28270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x123e28710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x123e28bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x123e29050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x123e294f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x123e29990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x123e29e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x123e2a2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x123e2a770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x123e2ac10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x123e2b0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x123e2b550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x123e2b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x123e2be90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x123e2c330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x123e2c7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x123e2cc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x123e2d110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x123e2d5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x123e2da50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x123e2def0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x123e2e390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x123e2e830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x123e2ecd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x123e2f170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x123e2f610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x123e2fab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x123e2ff50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x123e303f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x123e30890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x123e30d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x123e311d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x123e31670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x123e31b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x123e31fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x123e32450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x123e328f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x123e32d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x123e33230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x123e336d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x123e33b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x123e34010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x123e344b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x123e34950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x123e34df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x123e35290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x123e35730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x123e35bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x123e36070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x123e365c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x123e36b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x123e37060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x123e375b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x123e37870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x123e37e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x123e38490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x123e38aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x123e390b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x123e396c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x123e39eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x123e3a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x123e3a7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x123e3ac90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x123e3b440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x123e3b990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x123e3bee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x123e3c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x123e3c980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x123e3ced0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x123e3d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x123e3d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x123e3dec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x123e3e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x123e3e960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x123e3eeb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x123e3f400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x123e3f950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x123e3fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x123e403f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x123e40940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x123e40e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x123e413e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x123e41930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x123e41e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x123e423d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x123e42920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x123e42e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x123e433c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x123e43910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x123e43e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x123e443b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x123e44900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x123e44e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x123e453a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x123e458f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x123e45e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x123e46390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x123e468e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x123e46e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x123e47380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x123e478d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x123e47e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x123e48370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x123e488c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x123e48e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x123e49360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x123e498b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x123e49e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x123e4a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x123e4a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x123e4adf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x123e4b340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x123e4b890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x123e4bde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x123e4c330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x123e4c880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x123e4cdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x123e4d320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x123e4d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x123e4ddc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x123e4e260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x123e4e700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x123e4eba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x123e4f040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x123e4f4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x123e4f980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x123e4fe20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x123e502c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x123e50760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x123e50c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x123e510a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x123e51540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x123e519e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x123e51f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x123e52650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x123e52d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x123e53490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x123e53bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x123e53e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x123e54480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x123e54a90 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x123f0f8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x123f109a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x123f0fe40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x123f10400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x123f0ebe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x123f4dc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x123f4df40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x123f4e3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x123f4e820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x123f4ec90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x123f4f100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x123f4f570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x123f4fe60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x123f505e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x123f50dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x123f514b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x123f51ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x123f52290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x123f52980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x123f53300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x123f539f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x123f540e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x123f547d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x123f54ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x123f555b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x123f55a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x123f55e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x123f56300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x123f56770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x123f56be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x123f57050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x123f574c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x123f57930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x123f57bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x123f58060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x123f584d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x123f58940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x123f58db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x123f59220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x123f59690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x123f59b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x123f59f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x123f5a3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x123f5a850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x123f5acc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x123f5b130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x123f5b5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x123f5ba10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x123f5be80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x123f5c2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x123f5c760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x123f5cbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x123f5d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x123f5d4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x123f5d920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x123f5dd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x123f1c070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x123f1c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x123f1c950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x123f1cdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x123f1d230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x123f1d6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x123f1db10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x123f1df80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x123f1e3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x123f1e860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x123f1ecd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x123f1f140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x123f1f5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x123f1fa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x123f1fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x123f20300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x123f20770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x123f20be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x123f21050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x123f214c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x123f21930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x123f21da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x123f22210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x123f22680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x123f22af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x123f22f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x123f233d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x123f23840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x123f23cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x123f24120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x123f24590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x123f24a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x123f24e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x123f252e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x123f25750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x123f25bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x123f26030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x123f264a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x123f26910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x123f26d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x123f271f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x123f27660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x123f27ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x123f27f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x123f283b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x123f28820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x123f28c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x123f29100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x123f29570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x123f299e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x123f29e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x123f2a2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x123f2a730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x123f2aba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x123f2b010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x123f2b480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x123f2b8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x123f2bd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x123f2c1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x123f2c640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x123f2cab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x123f2cf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x123f2d390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x123f2d800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x123f2dc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x123f2e0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x123f2e550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x123f2e9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x123f2ee30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x123f2f2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x123f2f710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x123f2fb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x123f2fff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x123f30460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x123f308d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x123f30d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x123f311b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x123f31620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x123f31a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x123f31f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x123f32370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x123f327e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x123f32c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x123f330c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x123f33530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x123f339a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x123f33e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x123f34280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x123f346f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x123f34b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x123f34fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x123f35440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x123f358b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x123f35d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x123f36190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x123f36600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x123f36a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x123f36ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x123f37350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x123f377c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x123f37c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x123f380a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x123f38510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x123f38980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x123f38df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x123f39260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x123f396d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x123f39b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x123f39fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x123f3a420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x123f3a890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x123f3b010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x123f3b480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x123f3b8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x123f3bd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x123f3c1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x123f3c640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x123f3cab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x123f3cf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x123f3d390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x123f3d800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x123f3dc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x123f3e0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x123f3e550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x123f3e9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x123f3ee30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x123f3f2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x123f3f710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x123f3fb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x123f3fff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x123f40460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x123f408d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x123f40d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x123f411b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x123f41620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x123f41a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x123f41f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x123f42370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x123f427e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x123f42c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x123f430c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x123f43530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x123f439a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x123f43e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x123f44280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x123f446f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x123f44b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x123f44fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x123f45440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x123f458b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x123f45d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x123f46190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x123f46600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x123f46a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x123f46ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x123f47350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x123f477c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x123f47c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x123f480a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x123f48510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x123f48980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x123f48df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x123f49260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x123f496d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x123f49b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x123f49fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x123f4a420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x123f4a890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x123f4ad00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x123f4b170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x123f4b5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x123f4ba50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x123f4bec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x123f4c330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x123f4c7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x123f4cc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x123f4d080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x123f4d4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x123f1a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x123f1acf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x123f1b160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x123f1b5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x123f11f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x123f12670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x123f12d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x123f13450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x123f138c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x123f13d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x123f141a0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Our old friend, Zorro." "He


second run: The quick brown fox jumps over the lazy Dog." "Our old friend, Zorro." "He


single seq run: The quick brown fox jumps over the lazy Dog." "Our old friend, Zorro." "He

real	0m0.938s
user	0m0.237s
sys	0m0.130s
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
