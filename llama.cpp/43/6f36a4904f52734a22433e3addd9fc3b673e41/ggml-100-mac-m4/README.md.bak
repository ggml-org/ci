### ctest_debug

Runs ctest in debug mode
- status: 0
```
+ ctest --output-on-failure -L main -E test-opt
Test project /Users/ggml/work/llama.cpp/build-ci-debug
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.32 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    1.78 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.23 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.68 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.43 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.33 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    1.44 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.07 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.33 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.07 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.99 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.33 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.33 sec
      Start 14: test-tokenizer-1-llama-spm
14/27 Test #14: test-tokenizer-1-llama-spm ........   Passed    1.04 sec
      Start 15: test-log
15/27 Test #15: test-log ..........................   Passed    0.25 sec
      Start 16: test-arg-parser
16/27 Test #16: test-arg-parser ...................   Passed    0.29 sec
      Start 17: test-sampling
17/27 Test #17: test-sampling .....................   Passed    2.14 sec
      Start 18: test-chat-template
18/27 Test #18: test-chat-template ................   Passed    0.19 sec
      Start 19: test-grammar-parser
19/27 Test #19: test-grammar-parser ...............   Passed    0.18 sec
      Start 20: test-grammar-integration
20/27 Test #20: test-grammar-integration ..........   Passed    0.23 sec
      Start 21: test-llama-grammar
21/27 Test #21: test-llama-grammar ................   Passed    0.18 sec
      Start 22: test-backend-ops
22/27 Test #22: test-backend-ops ..................   Passed  173.35 sec
      Start 25: test-barrier
23/27 Test #25: test-barrier ......................   Passed    0.88 sec
      Start 26: test-quantize-fns
24/27 Test #26: test-quantize-fns .................   Passed   25.78 sec
      Start 27: test-quantize-perf
25/27 Test #27: test-quantize-perf ................   Passed    0.33 sec
      Start 28: test-rope
26/27 Test #28: test-rope .........................   Passed    0.20 sec
      Start 29: test-json-schema-to-grammar
27/27 Test #29: test-json-schema-to-grammar .......   Passed    2.20 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    = 215.57 sec*proc (27 tests)

Total Test time (real) = 215.58 sec

real	3m35.727s
user	7m24.331s
sys	0m5.965s
```

### ctest_release

Runs ctest in release mode
- status: 0
```
+ ctest --output-on-failure -L main
Test project /Users/ggml/work/llama.cpp/build-ci-release
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.25 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    0.30 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.04 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.11 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.07 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.06 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    0.22 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.03 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.06 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.03 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.15 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.06 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.06 sec
      Start 14: test-tokenizer-1-llama-spm
14/27 Test #14: test-tokenizer-1-llama-spm ........   Passed    0.30 sec
      Start 15: test-log
15/27 Test #15: test-log ..........................   Passed    0.19 sec
      Start 16: test-arg-parser
16/27 Test #16: test-arg-parser ...................   Passed    0.35 sec
      Start 17: test-sampling
17/27 Test #17: test-sampling .....................   Passed    0.92 sec
      Start 18: test-chat-template
18/27 Test #18: test-chat-template ................   Passed    0.17 sec
      Start 19: test-grammar-parser
19/27 Test #19: test-grammar-parser ...............   Passed    0.17 sec
      Start 20: test-grammar-integration
20/27 Test #20: test-grammar-integration ..........   Passed    0.17 sec
      Start 21: test-llama-grammar
21/27 Test #21: test-llama-grammar ................   Passed    0.17 sec
      Start 22: test-backend-ops
22/27 Test #22: test-backend-ops ..................   Passed   28.40 sec
      Start 25: test-barrier
23/27 Test #25: test-barrier ......................   Passed    0.27 sec
      Start 26: test-quantize-fns
24/27 Test #26: test-quantize-fns .................   Passed   14.05 sec
      Start 27: test-quantize-perf
25/27 Test #27: test-quantize-perf ................   Passed    0.21 sec
      Start 28: test-rope
26/27 Test #28: test-rope .........................   Passed    0.19 sec
      Start 29: test-json-schema-to-grammar
27/27 Test #29: test-json-schema-to-grammar .......   Passed    2.10 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    =  50.09 sec*proc (27 tests)

Total Test time (real) =  50.10 sec

real	0m50.133s
user	1m9.812s
sys	0m5.087s
```
### embd_bge_small

BGE Small (BERT):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-f16.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.092 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.015.250 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.941 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.018.947 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.950 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.018.950 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.951 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.018.952 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.018.952 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.018.954 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.018.954 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.018.955 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.018.955 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.018.956 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.018.958 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.018.959 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.018.960 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.018.960 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.018.960 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.018.961 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.018.961 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.023.555 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.024.757 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.759 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.024.760 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.024.760 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.024.761 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.024.761 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.024.762 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.024.763 I llama_model_loader: - type  f32:  124 tensors
0.00.024.763 I llama_model_loader: - type  f16:   73 tensors
0.00.028.995 I llm_load_vocab: special tokens cache size = 5
0.00.031.157 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.031.162 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.031.162 I llm_load_print_meta: arch             = bert
0.00.031.163 I llm_load_print_meta: vocab type       = WPM
0.00.031.163 I llm_load_print_meta: n_vocab          = 30522
0.00.031.163 I llm_load_print_meta: n_merges         = 0
0.00.031.163 I llm_load_print_meta: vocab_only       = 0
0.00.031.164 I llm_load_print_meta: n_ctx_train      = 512
0.00.031.164 I llm_load_print_meta: n_embd           = 384
0.00.031.166 I llm_load_print_meta: n_layer          = 12
0.00.031.169 I llm_load_print_meta: n_head           = 12
0.00.031.170 I llm_load_print_meta: n_head_kv        = 12
0.00.031.173 I llm_load_print_meta: n_rot            = 32
0.00.031.173 I llm_load_print_meta: n_swa            = 0
0.00.031.173 I llm_load_print_meta: n_embd_head_k    = 32
0.00.031.173 I llm_load_print_meta: n_embd_head_v    = 32
0.00.031.174 I llm_load_print_meta: n_gqa            = 1
0.00.031.175 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.031.176 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.031.177 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.031.177 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.031.178 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.031.178 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.031.178 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.031.179 I llm_load_print_meta: n_ff             = 1536
0.00.031.179 I llm_load_print_meta: n_expert         = 0
0.00.031.179 I llm_load_print_meta: n_expert_used    = 0
0.00.031.180 I llm_load_print_meta: causal attn      = 0
0.00.031.180 I llm_load_print_meta: pooling type     = 2
0.00.031.180 I llm_load_print_meta: rope type        = 2
0.00.031.180 I llm_load_print_meta: rope scaling     = linear
0.00.031.181 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.031.181 I llm_load_print_meta: freq_scale_train = 1
0.00.031.181 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.031.182 I llm_load_print_meta: rope_finetuned   = unknown
0.00.031.182 I llm_load_print_meta: ssm_d_conv       = 0
0.00.031.182 I llm_load_print_meta: ssm_d_inner      = 0
0.00.031.184 I llm_load_print_meta: ssm_d_state      = 0
0.00.031.185 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.031.185 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.031.198 I llm_load_print_meta: model type       = 33M
0.00.031.198 I llm_load_print_meta: model ftype      = F16
0.00.031.199 I llm_load_print_meta: model params     = 33.21 M
0.00.031.200 I llm_load_print_meta: model size       = 63.84 MiB (16.12 BPW) 
0.00.031.200 I llm_load_print_meta: general.name     = Bge Small
0.00.031.201 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.031.201 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.031.201 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.031.202 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.031.202 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.031.202 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.031.204 I llm_load_print_meta: max token length = 21
0.00.033.157 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.033.158 I llm_load_tensors: offloading output layer to GPU
0.00.033.158 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.033.182 I llm_load_tensors: Metal_Mapped model buffer size =    40.73 MiB
0.00.033.184 I llm_load_tensors:   CPU_Mapped model buffer size =    23.11 MiB
................................................
0.00.033.719 I llama_new_context_with_model: n_seq_max     = 1
0.00.033.720 I llama_new_context_with_model: n_ctx         = 512
0.00.033.720 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.033.721 I llama_new_context_with_model: n_batch       = 2048
0.00.033.721 I llama_new_context_with_model: n_ubatch      = 2048
0.00.033.721 I llama_new_context_with_model: flash_attn    = 0
0.00.033.722 I llama_new_context_with_model: freq_base     = 10000.0
0.00.033.722 I llama_new_context_with_model: freq_scale    = 1
0.00.033.722 I ggml_metal_init: allocating
0.00.033.726 I ggml_metal_init: found device: Apple M4
0.00.033.729 I ggml_metal_init: picking default device: Apple M4
0.00.034.487 I ggml_metal_init: using embedded metal library
0.00.038.030 I ggml_metal_init: GPU name:   Apple M4
0.00.038.032 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.038.033 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.038.033 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.038.034 I ggml_metal_init: simdgroup reduction   = true
0.00.038.034 I ggml_metal_init: simdgroup matrix mul. = true
0.00.038.034 I ggml_metal_init: has bfloat            = true
0.00.038.034 I ggml_metal_init: use bfloat            = true
0.00.038.035 I ggml_metal_init: hasUnifiedMemory      = true
0.00.038.035 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.048.986 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.048.988 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.048.989 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.049.849 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.049.850 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.049.851 I llama_new_context_with_model: graph nodes  = 429
0.00.049.851 I llama_new_context_with_model: graph splits = 2
0.00.049.874 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.060.157 I 
0.00.060.181 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.060.816 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.043984 -0.019895  0.007670 -0.000838  0.001372 -0.037036  0.109436  0.042589  0.092046 -0.015918  0.006773 -0.035692 -0.017889  0.015040  0.018126  0.015860 -0.011308  0.010431 -0.085223 -0.008454  0.091368 -0.017067 -0.060328 -0.024484  0.027524  0.076059  0.027984 -0.014564  0.017645 -0.033268 -0.037874 -0.019012  0.068670 -0.009845 -0.025030  0.072346 -0.046570  0.011026 -0.050252  0.047693  0.032387 -0.011761  0.022055  0.049645  0.010465  0.005795 -0.028860  0.008933 -0.018507 -0.051466 -0.046036  0.030497 -0.035418  0.054204 -0.069650  0.044238  0.029786  0.046305  0.073410 -0.042580  0.076109  0.038851 -0.181182  0.082503  0.042250 -0.064549 -0.060097 -0.017853  0.006472  0.005873  0.017196 -0.026615  0.064578  0.112612  0.035159 -0.067416  0.027073 -0.067295 -0.033493 -0.033219  0.033252  0.013523 -0.003346 -0.037473 -0.052055  0.055155 -0.001982 -0.038276  0.064447  0.028824 -0.043334 -0.029236 -0.039462  0.036315  0.008379 -0.015481 -0.036573  0.018130  0.028600  0.342831 -0.044484  0.056114  0.017624 -0.020867 -0.066808  0.000146 -0.037885 -0.030063 -0.008541 -0.021595  0.000548 -0.003219  0.004020  0.018908 -0.008548  0.025835  0.049433  0.000091  0.050920 -0.042479 -0.031884  0.023606  0.030691 -0.023148 -0.046271 -0.079278  0.115198  0.046757  0.027829 -0.040710  0.067777 -0.022955  0.010332 -0.032937 -0.018305  0.043844  0.024268  0.052413  0.007469  0.008905  0.011244 -0.074655 -0.065561 -0.026750 -0.041192 -0.023884  0.026710  0.006912  0.027741  0.052873 -0.036673  0.057707 -0.000170  0.031764 -0.019760 -0.022083  0.041053 -0.058903  0.019619  0.043144  0.043582  0.041593 -0.022527  0.027037 -0.021833  0.005430 -0.041317 -0.001239  0.024452  0.002088  0.044333 -0.022745  0.043662  0.064763  0.055430  0.037060 -0.000919  0.046111  0.045790 -0.008487  0.063057 -0.073235 -0.011935  0.032107  0.023957  0.014725 -0.033688  0.001083 -0.015827 -0.019002  0.047872  0.110842  0.028428  0.031366 -0.013288 -0.057499  0.006644  0.005140 -0.012262 -0.051443 -0.000965 -0.017642 -0.019440 -0.040937  0.009209 -0.057957  0.050961  0.052340 -0.009617 -0.040259 -0.014075 -0.024877 -0.017251  0.006302  0.006588 -0.026919  0.015600  0.030760  0.002578  0.023206 -0.022199 -0.098557 -0.051105 -0.278031 -0.014994 -0.061553 -0.027218  0.017666 -0.010939 -0.017077  0.035055  0.046994 -0.015432  0.015232 -0.025477  0.047844 -0.005949 -0.000749 -0.061008 -0.068946 -0.060377 -0.035942  0.043319 -0.055047  0.015075  0.000537 -0.058175 -0.010439  0.012643  0.151495  0.127111 -0.013622  0.041993 -0.025672  0.014026 -0.001037 -0.150469  0.044857  0.005320 -0.036274 -0.029801 -0.020192 -0.034891  0.010235  0.033548 -0.048178 -0.051795 -0.017463 -0.023492  0.047349  0.052076 -0.016783 -0.055452  0.025836 -0.005707  0.010710  0.038705  0.008191 -0.009764 -0.105779 -0.027430 -0.096101  0.025068 -0.011260  0.092355  0.056101  0.003758  0.027791  0.002092 -0.051085 -0.039890 -0.013542 -0.044956 -0.015335  0.002910 -0.043498 -0.077951  0.065217 -0.006840 -0.001630 -0.014642  0.071560  0.023714 -0.037180  0.009175  0.001562 -0.032268  0.015468  0.037880  0.000337 -0.053207  0.021321 -0.039829  0.000031  0.013400  0.019798 -0.057879  0.006473 -0.049531 -0.267858  0.039156 -0.067972  0.038248 -0.012333  0.041485 -0.016117  0.052383 -0.071363  0.011369  0.024719 -0.007232  0.082087  0.028535 -0.021504  0.040494 -0.004570 -0.074594 -0.014749  0.020037  0.002304  0.023148  0.197212 -0.043222 -0.025983 -0.004959 -0.019278  0.074258  0.001716 -0.031979 -0.036599 -0.045082  0.000547 -0.011560  0.018126 -0.029461 -0.008463  0.006419  0.050799 -0.014959  0.006176  0.026096 -0.030809  0.048055  0.114093 -0.040826 -0.011457  0.005419 -0.003599  0.025154 -0.059142  0.013753 -0.010399  0.038709  0.051449  0.035413  0.035031 -0.017027  0.026360 -0.014490 -0.050032  0.003219  0.054121  0.039723 -0.039127 

0.00.065.471 I llama_perf_context_print:        load time =      44.90 ms
0.00.065.473 I llama_perf_context_print: prompt eval time =       4.55 ms /     9 tokens (    0.51 ms per token,  1975.85 tokens per second)
0.00.065.474 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.065.474 I llama_perf_context_print:       total time =       5.32 ms /    10 tokens
0.00.065.596 I ggml_metal_free: deallocating

real	0m0.248s
user	0m0.059s
sys	0m0.030s
```
- q8_0:
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-q8_0.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.040 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.147 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.011.163 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.011.166 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.011.168 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.011.168 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.011.169 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.011.169 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.011.169 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.011.170 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.011.170 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.011.171 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.011.171 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.011.171 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.011.173 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.011.174 I llama_model_loader: - kv  11:                          general.file_type u32              = 7
0.00.011.174 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.011.174 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.011.174 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.011.175 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.011.175 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.013.725 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.014.375 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.014.376 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.014.376 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.014.377 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.014.377 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.014.377 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.014.378 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.014.378 I llama_model_loader: - type  f32:  124 tensors
0.00.014.378 I llama_model_loader: - type q8_0:   73 tensors
0.00.016.859 I llm_load_vocab: special tokens cache size = 5
0.00.018.118 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.018.121 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.018.121 I llm_load_print_meta: arch             = bert
0.00.018.122 I llm_load_print_meta: vocab type       = WPM
0.00.018.122 I llm_load_print_meta: n_vocab          = 30522
0.00.018.122 I llm_load_print_meta: n_merges         = 0
0.00.018.122 I llm_load_print_meta: vocab_only       = 0
0.00.018.122 I llm_load_print_meta: n_ctx_train      = 512
0.00.018.123 I llm_load_print_meta: n_embd           = 384
0.00.018.123 I llm_load_print_meta: n_layer          = 12
0.00.018.125 I llm_load_print_meta: n_head           = 12
0.00.018.126 I llm_load_print_meta: n_head_kv        = 12
0.00.018.126 I llm_load_print_meta: n_rot            = 32
0.00.018.126 I llm_load_print_meta: n_swa            = 0
0.00.018.126 I llm_load_print_meta: n_embd_head_k    = 32
0.00.018.126 I llm_load_print_meta: n_embd_head_v    = 32
0.00.018.127 I llm_load_print_meta: n_gqa            = 1
0.00.018.128 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.018.128 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.018.129 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.018.129 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.018.129 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.018.129 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.018.130 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.018.130 I llm_load_print_meta: n_ff             = 1536
0.00.018.131 I llm_load_print_meta: n_expert         = 0
0.00.018.131 I llm_load_print_meta: n_expert_used    = 0
0.00.018.131 I llm_load_print_meta: causal attn      = 0
0.00.018.131 I llm_load_print_meta: pooling type     = 2
0.00.018.131 I llm_load_print_meta: rope type        = 2
0.00.018.132 I llm_load_print_meta: rope scaling     = linear
0.00.018.132 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.018.132 I llm_load_print_meta: freq_scale_train = 1
0.00.018.133 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.018.133 I llm_load_print_meta: rope_finetuned   = unknown
0.00.018.133 I llm_load_print_meta: ssm_d_conv       = 0
0.00.018.133 I llm_load_print_meta: ssm_d_inner      = 0
0.00.018.133 I llm_load_print_meta: ssm_d_state      = 0
0.00.018.134 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.018.134 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.018.140 I llm_load_print_meta: model type       = 33M
0.00.018.141 I llm_load_print_meta: model ftype      = Q8_0
0.00.018.141 I llm_load_print_meta: model params     = 33.21 M
0.00.018.142 I llm_load_print_meta: model size       = 34.38 MiB (8.68 BPW) 
0.00.018.144 I llm_load_print_meta: general.name     = Bge Small
0.00.018.144 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.018.144 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.018.144 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.018.145 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.018.145 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.018.145 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.018.146 I llm_load_print_meta: max token length = 21
0.00.019.477 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.019.477 I llm_load_tensors: offloading output layer to GPU
0.00.019.477 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.019.484 I llm_load_tensors: Metal_Mapped model buffer size =    21.75 MiB
0.00.019.485 I llm_load_tensors:   CPU_Mapped model buffer size =    12.63 MiB
................................................
0.00.019.834 I llama_new_context_with_model: n_seq_max     = 1
0.00.019.834 I llama_new_context_with_model: n_ctx         = 512
0.00.019.834 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.019.835 I llama_new_context_with_model: n_batch       = 2048
0.00.019.835 I llama_new_context_with_model: n_ubatch      = 2048
0.00.019.835 I llama_new_context_with_model: flash_attn    = 0
0.00.019.835 I llama_new_context_with_model: freq_base     = 10000.0
0.00.019.836 I llama_new_context_with_model: freq_scale    = 1
0.00.019.836 I ggml_metal_init: allocating
0.00.019.839 I ggml_metal_init: found device: Apple M4
0.00.019.842 I ggml_metal_init: picking default device: Apple M4
0.00.020.359 I ggml_metal_init: using embedded metal library
0.00.022.400 I ggml_metal_init: GPU name:   Apple M4
0.00.022.402 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.022.402 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.022.403 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.022.403 I ggml_metal_init: simdgroup reduction   = true
0.00.022.403 I ggml_metal_init: simdgroup matrix mul. = true
0.00.022.403 I ggml_metal_init: has bfloat            = true
0.00.022.403 I ggml_metal_init: use bfloat            = true
0.00.022.404 I ggml_metal_init: hasUnifiedMemory      = true
0.00.022.404 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.031.213 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.031.215 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.031.217 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.031.784 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.031.785 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.031.785 I llama_new_context_with_model: graph nodes  = 429
0.00.031.785 I llama_new_context_with_model: graph splits = 2
0.00.031.793 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.036.002 I 
0.00.036.025 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.036.564 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.044994 -0.019858  0.007986 -0.001410  0.001531 -0.036276  0.109404  0.043235  0.092836 -0.015201  0.005971 -0.036330 -0.018159  0.015015  0.017667  0.014510 -0.011792  0.011812 -0.084764 -0.008081  0.091650 -0.017638 -0.061084 -0.025066  0.026879  0.076180  0.028256 -0.014273  0.017420 -0.033553 -0.037520 -0.018280  0.068843 -0.010129 -0.024896  0.071968 -0.046406  0.011471 -0.050333  0.048931  0.032317 -0.012107  0.021812  0.049796  0.010366  0.005264 -0.028665  0.008581 -0.018508 -0.052358 -0.046410  0.029426 -0.034989  0.053289 -0.069849  0.043767  0.029291  0.046759  0.073664 -0.043090  0.075213  0.038641 -0.180496  0.081648  0.043389 -0.065615 -0.059878 -0.017387  0.006913  0.005155  0.017165 -0.026679  0.064347  0.112564  0.034871 -0.067783  0.027124 -0.066989 -0.034296 -0.033344  0.033189  0.014325 -0.004253 -0.036945 -0.052008  0.054151 -0.001715 -0.038112  0.063016  0.028668 -0.041665 -0.028879 -0.039263  0.036879  0.007718 -0.015657 -0.036270  0.018699  0.029792  0.344948 -0.043880  0.056487  0.018022 -0.021448 -0.065281  0.000253 -0.037910 -0.029663 -0.008828 -0.020643  0.001162 -0.003510  0.003091  0.018576 -0.009637  0.025316  0.049298 -0.000937  0.051568 -0.042363 -0.031550  0.023315  0.030044 -0.023267 -0.045483 -0.079644  0.114489  0.047503  0.027208 -0.041477  0.067717 -0.022845  0.010232 -0.033486 -0.017199  0.044319  0.022956  0.052194  0.008122  0.008112  0.009951 -0.074643 -0.065035 -0.025938 -0.040806 -0.024533  0.027409  0.006078  0.027693  0.052243 -0.036587  0.058682  0.001467  0.032191 -0.019964 -0.021840  0.041805 -0.058801  0.019348  0.042626  0.043999  0.040911 -0.021909  0.028025 -0.022801  0.005520 -0.041266 -0.000085  0.024325  0.001532  0.044802 -0.022888  0.043056  0.065030  0.056292  0.037666 -0.001004  0.047521  0.045624 -0.008614  0.062270 -0.073313 -0.011718  0.032708  0.023348  0.014650 -0.033924  0.001158 -0.015872 -0.018974  0.047982  0.110740  0.029177  0.030881 -0.012325 -0.057836  0.006939  0.004378 -0.011864 -0.051754 -0.003018 -0.017766 -0.020051 -0.041018  0.009118 -0.058568  0.050632  0.051795 -0.008968 -0.040668 -0.014765 -0.024320 -0.015980  0.005823  0.007147 -0.027335  0.016275  0.030734  0.002342  0.023167 -0.022169 -0.098059 -0.050901 -0.277240 -0.015100 -0.061566 -0.026219  0.017141 -0.010285 -0.017522  0.034725  0.047897 -0.016594  0.015489 -0.024132  0.048613 -0.004993 -0.000001 -0.060860 -0.068346 -0.059622 -0.036157  0.043605 -0.056353  0.014713  0.000292 -0.058627 -0.010995  0.012274  0.151597  0.127025 -0.012582  0.042765 -0.025227  0.013629 -0.000381 -0.150686  0.043974  0.004714 -0.036955 -0.029586 -0.019853 -0.034063  0.009522  0.034004 -0.048909 -0.051765 -0.017243 -0.025080  0.047588  0.050981 -0.017553 -0.056746  0.024054 -0.006285  0.011003  0.038719  0.008083 -0.008595 -0.106361 -0.027365 -0.096966  0.025294 -0.011096  0.091579  0.056180  0.004494  0.028066  0.001727 -0.051388 -0.039497 -0.013817 -0.045907 -0.015238  0.002920 -0.043938 -0.077716  0.066102 -0.006195 -0.000885 -0.013768  0.071562  0.023826 -0.036363  0.007848  0.001487 -0.032916  0.016336  0.037378  0.000625 -0.052389  0.021549 -0.039695 -0.000026  0.013496  0.020436 -0.057513  0.005900 -0.049906 -0.267546  0.038686 -0.067509  0.037450 -0.011471  0.041547 -0.015904  0.051347 -0.072313  0.012571  0.024808 -0.007420  0.082069  0.028175 -0.021956  0.040736 -0.003945 -0.074192 -0.014923  0.020417  0.002644  0.023207  0.197144 -0.043068 -0.025876 -0.004886 -0.018582  0.073936  0.001341 -0.031663 -0.037140 -0.044262  0.000049 -0.010741  0.018225 -0.028045 -0.008828  0.006047  0.050183 -0.015017  0.007037  0.025894 -0.030628  0.048075  0.112795 -0.039982 -0.011695  0.005039 -0.002800  0.025072 -0.059720  0.014182 -0.010019  0.038100  0.051088  0.034726  0.035947 -0.017035  0.027243 -0.015391 -0.051195  0.003744  0.053928  0.040014 -0.039140 

0.00.041.024 I llama_perf_context_print:        load time =      26.85 ms
0.00.041.026 I llama_perf_context_print: prompt eval time =       4.32 ms /     9 tokens (    0.48 ms per token,  2085.75 tokens per second)
0.00.041.026 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.041.027 I llama_perf_context_print:       total time =       5.02 ms /    10 tokens
0.00.041.212 I ggml_metal_free: deallocating

real	0m0.055s
user	0m0.029s
sys	0m0.015s
```
### rerank_tiny

Rerank Tiny (Jina):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/rerank-tiny/ggml-model-f16.gguf -p 'what is panda?</s></s>hi\nwhat is panda?</s></s>it'\''s a bear\nwhat is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.' -ngl 99 -c 0 --pooling rank --embd-normalize -1 --verbose-prompt
0.00.000.159 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.021.901 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.032.492 I llama_model_loader: loaded meta data with 29 key-value pairs and 70 tensors from ../models-mnt/rerank-tiny/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.032.498 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.032.500 I llama_model_loader: - kv   0:                       general.architecture str              = jina-bert-v2
0.00.032.502 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.032.503 I llama_model_loader: - kv   2:                               general.name str              = Jina Bert Implementation
0.00.032.503 I llama_model_loader: - kv   3:                       general.organization str              = Jinaai
0.00.032.504 I llama_model_loader: - kv   4:                         general.size_label str              = 33M
0.00.032.505 I llama_model_loader: - kv   5:                   jina-bert-v2.block_count u32              = 4
0.00.032.506 I llama_model_loader: - kv   6:                jina-bert-v2.context_length u32              = 8192
0.00.032.507 I llama_model_loader: - kv   7:              jina-bert-v2.embedding_length u32              = 384
0.00.032.507 I llama_model_loader: - kv   8:           jina-bert-v2.feed_forward_length u32              = 1536
0.00.032.508 I llama_model_loader: - kv   9:          jina-bert-v2.attention.head_count u32              = 12
0.00.032.511 I llama_model_loader: - kv  10:  jina-bert-v2.attention.layer_norm_epsilon f32              = 0.000000
0.00.032.512 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.032.513 I llama_model_loader: - kv  12:              jina-bert-v2.attention.causal bool             = false
0.00.032.513 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.032.514 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = jina-v1-en
0.00.040.060 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,61056]   = ["<s>", "<pad>", "</s>", "<unk>", "<m...
0.00.042.067 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,61056]   = [3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, ...
0.00.046.813 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,39382]   = ["t h", "i n", "a n", "e r", "th e", ...
0.00.046.815 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.046.815 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 2
0.00.046.816 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 3
0.00.046.816 I llama_model_loader: - kv  21:          tokenizer.ggml.seperator_token_id u32              = 2
0.00.046.816 I llama_model_loader: - kv  22:            tokenizer.ggml.padding_token_id u32              = 1
0.00.046.817 I llama_model_loader: - kv  23:                tokenizer.ggml.cls_token_id u32              = 0
0.00.046.817 I llama_model_loader: - kv  24:               tokenizer.ggml.mask_token_id u32              = 4
0.00.046.817 I llama_model_loader: - kv  25:            tokenizer.ggml.token_type_count u32              = 2
0.00.046.818 I llama_model_loader: - kv  26:               tokenizer.ggml.add_bos_token bool             = true
0.00.046.818 I llama_model_loader: - kv  27:               tokenizer.ggml.add_eos_token bool             = true
0.00.046.819 I llama_model_loader: - kv  28:               general.quantization_version u32              = 2
0.00.046.819 I llama_model_loader: - type  f32:   41 tensors
0.00.046.822 I llama_model_loader: - type  f16:   29 tensors
0.00.065.568 W llm_load_vocab: empty token at index 5
0.00.070.374 W llm_load_vocab: model vocab missing newline token, using special_pad_id instead
0.00.071.734 W llm_load_vocab: special_eos_id is not in special_eog_ids - the tokenizer config may be incorrect
0.00.071.760 I llm_load_vocab: special tokens cache size = 5
0.00.329.114 I llm_load_vocab: token to piece cache size = 1.5060 MB
0.00.329.120 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.329.120 I llm_load_print_meta: arch             = jina-bert-v2
0.00.329.121 I llm_load_print_meta: vocab type       = BPE
0.00.329.121 I llm_load_print_meta: n_vocab          = 61056
0.00.329.121 I llm_load_print_meta: n_merges         = 39382
0.00.329.122 I llm_load_print_meta: vocab_only       = 0
0.00.329.122 I llm_load_print_meta: n_ctx_train      = 8192
0.00.329.122 I llm_load_print_meta: n_embd           = 384
0.00.329.122 I llm_load_print_meta: n_layer          = 4
0.00.329.130 I llm_load_print_meta: n_head           = 12
0.00.329.131 I llm_load_print_meta: n_head_kv        = 12
0.00.329.131 I llm_load_print_meta: n_rot            = 32
0.00.329.131 I llm_load_print_meta: n_swa            = 0
0.00.329.132 I llm_load_print_meta: n_embd_head_k    = 32
0.00.329.132 I llm_load_print_meta: n_embd_head_v    = 32
0.00.329.132 I llm_load_print_meta: n_gqa            = 1
0.00.329.133 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.329.135 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.329.136 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.329.137 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.329.137 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.329.138 I llm_load_print_meta: f_max_alibi_bias = 8.0e+00
0.00.329.138 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.329.139 I llm_load_print_meta: n_ff             = 1536
0.00.329.139 I llm_load_print_meta: n_expert         = 0
0.00.329.139 I llm_load_print_meta: n_expert_used    = 0
0.00.329.139 I llm_load_print_meta: causal attn      = 0
0.00.329.140 I llm_load_print_meta: pooling type     = -1
0.00.329.140 I llm_load_print_meta: rope type        = -1
0.00.329.140 I llm_load_print_meta: rope scaling     = linear
0.00.329.140 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.329.140 I llm_load_print_meta: freq_scale_train = 1
0.00.329.141 I llm_load_print_meta: n_ctx_orig_yarn  = 8192
0.00.329.141 I llm_load_print_meta: rope_finetuned   = unknown
0.00.329.144 I llm_load_print_meta: ssm_d_conv       = 0
0.00.329.144 I llm_load_print_meta: ssm_d_inner      = 0
0.00.329.144 I llm_load_print_meta: ssm_d_state      = 0
0.00.329.144 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.329.144 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.329.168 I llm_load_print_meta: model type       = 33M
0.00.329.169 I llm_load_print_meta: model ftype      = F16
0.00.329.169 I llm_load_print_meta: model params     = 32.90 M
0.00.329.170 I llm_load_print_meta: model size       = 62.78 MiB (16.01 BPW) 
0.00.329.170 I llm_load_print_meta: general.name     = Jina Bert Implementation
0.00.329.170 I llm_load_print_meta: BOS token        = 0 '<s>'
0.00.329.170 I llm_load_print_meta: EOS token        = 2 '</s>'
0.00.329.171 I llm_load_print_meta: UNK token        = 3 '<unk>'
0.00.329.171 I llm_load_print_meta: SEP token        = 2 '</s>'
0.00.329.171 I llm_load_print_meta: PAD token        = 1 '<pad>'
0.00.329.171 I llm_load_print_meta: CLS token        = 0 '<s>'
0.00.329.171 I llm_load_print_meta: MASK token       = 4 '<mask>'
0.00.329.171 I llm_load_print_meta: EOG token        = 2 '</s>'
0.00.329.172 I llm_load_print_meta: max token length = 45
0.00.330.464 I llm_load_tensors: offloading 4 repeating layers to GPU
0.00.330.464 I llm_load_tensors: offloading output layer to GPU
0.00.330.465 I llm_load_tensors: offloaded 5/5 layers to GPU
0.00.330.487 I llm_load_tensors: Metal_Mapped model buffer size =    18.06 MiB
0.00.330.488 I llm_load_tensors:   CPU_Mapped model buffer size =    44.72 MiB
....................
0.00.331.448 I llama_new_context_with_model: n_seq_max     = 1
0.00.331.449 I llama_new_context_with_model: n_ctx         = 8192
0.00.331.450 I llama_new_context_with_model: n_ctx_per_seq = 8192
0.00.331.450 I llama_new_context_with_model: n_batch       = 2048
0.00.331.450 I llama_new_context_with_model: n_ubatch      = 2048
0.00.331.450 I llama_new_context_with_model: flash_attn    = 0
0.00.331.450 I llama_new_context_with_model: freq_base     = 10000.0
0.00.331.451 I llama_new_context_with_model: freq_scale    = 1
0.00.331.451 I ggml_metal_init: allocating
0.00.331.454 I ggml_metal_init: found device: Apple M4
0.00.331.456 I ggml_metal_init: picking default device: Apple M4
0.00.332.496 I ggml_metal_init: using embedded metal library
0.00.335.089 I ggml_metal_init: GPU name:   Apple M4
0.00.335.090 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.335.091 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.335.091 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.335.091 I ggml_metal_init: simdgroup reduction   = true
0.00.335.091 I ggml_metal_init: simdgroup matrix mul. = true
0.00.335.091 I ggml_metal_init: has bfloat            = true
0.00.335.092 I ggml_metal_init: use bfloat            = true
0.00.335.092 I ggml_metal_init: hasUnifiedMemory      = true
0.00.335.093 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.345.485 I llama_kv_cache_init:      Metal KV buffer size =    48.00 MiB
0.00.345.487 I llama_new_context_with_model: KV self size  =   48.00 MiB, K (f16):   24.00 MiB, V (f16):   24.00 MiB
0.00.345.488 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.346.100 I llama_new_context_with_model:      Metal compute buffer size =   220.01 MiB
0.00.346.101 I llama_new_context_with_model:        CPU compute buffer size =    22.02 MiB
0.00.346.102 I llama_new_context_with_model: graph nodes  = 154
0.00.346.102 I llama_new_context_with_model: graph splits = 2
0.00.346.120 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.356.614 I 
0.00.356.647 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.356.802 I main: prompt 0: 'what is panda?</s></s>hi'
0.00.356.802 I main: number of tokens in prompt = 9
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 23233 -> 'hi'
     2 -> '</s>'


0.00.356.805 I main: prompt 1: 'what is panda?</s></s>it's a bear'
0.00.356.805 I main: number of tokens in prompt = 13
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21153 -> 'it'
    37 -> '''
    87 -> 's'
    69 -> 'a'
 25706 -> 'bear'
     2 -> '</s>'


0.00.356.809 I main: prompt 2: 'what is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.'
0.00.356.809 I main: number of tokens in prompt = 40
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21215 -> 'he'
 28390 -> 'giant'
 49990 -> 'panda'
    38 -> '('
 21163 -> 'il'
 26237 -> 'uro'
 21223 -> 'po'
 23179 -> 'da'
 36906 -> 'melan'
 26791 -> 'ole'
    89 -> 'u'
 21402 -> 'ca'
 21686 -> '),'
 23314 -> 'sometimes'
 22517 -> 'called'
    69 -> 'a'
 49990 -> 'panda'
 25706 -> 'bear'
 21142 -> 'or'
 22810 -> 'simply'
 49990 -> 'panda'
    42 -> ','
 21152 -> 'is'
    69 -> 'a'
 25706 -> 'bear'
 25677 -> 'species'
 28930 -> 'ende'
 22024 -> 'mic'
 21148 -> 'to'
    76 -> 'h'
 22344 -> 'ina'
    44 -> '.'
     2 -> '</s>'


0.00.357.370 I batch_decode: n_tokens = 62, n_seq = 3

rerank score 0:    0.023
rerank score 1:    0.024
rerank score 2:    0.199

0.00.361.116 I llama_perf_context_print:        load time =     334.70 ms
0.00.361.117 I llama_perf_context_print: prompt eval time =       3.73 ms /    62 tokens (    0.06 ms per token, 16599.73 tokens per second)
0.00.361.118 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.361.119 I llama_perf_context_print:       total time =       4.50 ms /    63 tokens
0.00.361.332 I ggml_metal_free: deallocating

real	0m1.052s
user	0m0.338s
sys	0m0.043s
  - rerank score 0 @ 0.023 OK
  - rerank score 1 @ 0.024 OK
  - rerank score 2 @ 0.199 OK
```
### pythia_1_4b

Pythia 1.4B:
- status: 0
- perplexity:
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
- imatrix:
```
Final estimate: PPL = 10.1498 +/- 3.22650
```
- f16: 
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.133 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.243 I main: llama backend init
0.00.000.248 I main: load the model and apply lora adapter, if any
0.00.027.125 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.038.387 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.038.406 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.038.411 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.038.412 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.038.413 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.038.414 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.038.414 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.038.421 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.038.422 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.038.422 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.038.423 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.038.424 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.038.424 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.038.425 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.038.429 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.038.430 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.038.434 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.048.377 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.050.782 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.058.964 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.058.966 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.058.967 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.058.968 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.058.968 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.058.969 I llama_model_loader: - type  f32:  194 tensors
0.00.058.969 I llama_model_loader: - type  f16:   98 tensors
0.00.089.659 I llm_load_vocab: special tokens cache size = 25
0.00.096.433 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.096.436 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.096.436 I llm_load_print_meta: arch             = gptneox
0.00.096.436 I llm_load_print_meta: vocab type       = BPE
0.00.096.437 I llm_load_print_meta: n_vocab          = 50304
0.00.096.437 I llm_load_print_meta: n_merges         = 50009
0.00.096.437 I llm_load_print_meta: vocab_only       = 0
0.00.096.437 I llm_load_print_meta: n_ctx_train      = 2048
0.00.096.437 I llm_load_print_meta: n_embd           = 2048
0.00.096.437 I llm_load_print_meta: n_layer          = 24
0.00.096.440 I llm_load_print_meta: n_head           = 16
0.00.096.441 I llm_load_print_meta: n_head_kv        = 16
0.00.096.441 I llm_load_print_meta: n_rot            = 32
0.00.096.441 I llm_load_print_meta: n_swa            = 0
0.00.096.442 I llm_load_print_meta: n_embd_head_k    = 128
0.00.096.442 I llm_load_print_meta: n_embd_head_v    = 128
0.00.096.442 I llm_load_print_meta: n_gqa            = 1
0.00.096.443 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.096.444 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.096.444 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.096.449 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.096.449 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.096.449 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.096.449 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.096.450 I llm_load_print_meta: n_ff             = 8192
0.00.096.450 I llm_load_print_meta: n_expert         = 0
0.00.096.450 I llm_load_print_meta: n_expert_used    = 0
0.00.096.450 I llm_load_print_meta: causal attn      = 1
0.00.096.450 I llm_load_print_meta: pooling type     = 0
0.00.096.450 I llm_load_print_meta: rope type        = 2
0.00.096.451 I llm_load_print_meta: rope scaling     = linear
0.00.096.451 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.096.451 I llm_load_print_meta: freq_scale_train = 1
0.00.096.451 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.096.451 I llm_load_print_meta: rope_finetuned   = unknown
0.00.096.452 I llm_load_print_meta: ssm_d_conv       = 0
0.00.096.452 I llm_load_print_meta: ssm_d_inner      = 0
0.00.096.452 I llm_load_print_meta: ssm_d_state      = 0
0.00.096.452 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.096.452 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.096.464 I llm_load_print_meta: model type       = 1.4B
0.00.096.465 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.096.465 I llm_load_print_meta: model params     = 1.41 B
0.00.096.466 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.096.466 I llm_load_print_meta: general.name     = 1.4B
0.00.096.466 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.096.466 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.096.466 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.096.467 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.096.467 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.096.467 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.096.467 I llm_load_print_meta: max token length = 1024
0.00.099.067 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.099.067 I llm_load_tensors: offloading output layer to GPU
0.00.099.067 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.099.084 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.099.085 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.100.000 I llama_new_context_with_model: n_seq_max     = 1
0.00.100.001 I llama_new_context_with_model: n_ctx         = 2048
0.00.100.001 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.100.001 I llama_new_context_with_model: n_batch       = 2048
0.00.100.002 I llama_new_context_with_model: n_ubatch      = 512
0.00.100.002 I llama_new_context_with_model: flash_attn    = 0
0.00.100.002 I llama_new_context_with_model: freq_base     = 10000.0
0.00.100.002 I llama_new_context_with_model: freq_scale    = 1
0.00.100.003 I ggml_metal_init: allocating
0.00.100.006 I ggml_metal_init: found device: Apple M4
0.00.100.008 I ggml_metal_init: picking default device: Apple M4
0.00.100.634 I ggml_metal_init: using embedded metal library
0.00.110.434 I ggml_metal_init: GPU name:   Apple M4
0.00.110.435 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.110.436 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.110.436 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.110.436 I ggml_metal_init: simdgroup reduction   = true
0.00.110.436 I ggml_metal_init: simdgroup matrix mul. = true
0.00.110.436 I ggml_metal_init: has bfloat            = true
0.00.110.437 I ggml_metal_init: use bfloat            = true
0.00.110.437 I ggml_metal_init: hasUnifiedMemory      = true
0.00.110.437 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.144.917 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.144.922 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.144.939 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.145.859 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.145.860 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.145.860 I llama_new_context_with_model: graph nodes  = 967
0.00.145.860 I llama_new_context_with_model: graph splits = 2
0.00.145.882 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.221.898 I main: llama threadpool init, n_threads = 4
0.00.221.928 I 
0.00.221.965 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.221.967 I 
0.00.222.049 I sampler seed: 1234
0.00.222.053 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.222.087 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.222.088 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.222.088 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling depressed, and I've had a hard time getting out of bed. I think the only thing I

0.02.070.525 I llama_perf_sampler_print:    sampling time =       1.29 ms /    71 runs   (    0.02 ms per token, 55081.46 tokens per second)
0.02.070.526 I llama_perf_context_print:        load time =     194.76 ms
0.02.070.527 I llama_perf_context_print: prompt eval time =      37.52 ms /     7 tokens (    5.36 ms per token,   186.54 tokens per second)
0.02.070.527 I llama_perf_context_print:        eval time =    1807.90 ms /    63 runs   (   28.70 ms per token,    34.85 tokens per second)
0.02.070.528 I llama_perf_context_print:       total time =    1848.63 ms /    70 tokens
0.02.070.716 I ggml_metal_free: deallocating

real	0m2.356s
user	0m0.144s
sys	0m0.095s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.595 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.022.815 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.034.880 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.034.884 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.034.886 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.034.887 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.034.887 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.034.888 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.034.888 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.034.889 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.034.889 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.034.889 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.034.890 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.034.890 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.034.891 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.034.891 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.034.893 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.034.893 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.034.894 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.042.602 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.044.403 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.050.883 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.050.885 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.050.885 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.050.886 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.050.886 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.050.887 I llama_model_loader: - type  f32:  194 tensors
0.00.050.887 I llama_model_loader: - type  f16:   98 tensors
0.00.077.963 I llm_load_vocab: special tokens cache size = 25
0.00.083.944 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.083.947 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.083.947 I llm_load_print_meta: arch             = gptneox
0.00.083.948 I llm_load_print_meta: vocab type       = BPE
0.00.083.948 I llm_load_print_meta: n_vocab          = 50304
0.00.083.948 I llm_load_print_meta: n_merges         = 50009
0.00.083.948 I llm_load_print_meta: vocab_only       = 0
0.00.083.948 I llm_load_print_meta: n_ctx_train      = 2048
0.00.083.948 I llm_load_print_meta: n_embd           = 2048
0.00.083.949 I llm_load_print_meta: n_layer          = 24
0.00.083.952 I llm_load_print_meta: n_head           = 16
0.00.083.953 I llm_load_print_meta: n_head_kv        = 16
0.00.083.953 I llm_load_print_meta: n_rot            = 32
0.00.083.953 I llm_load_print_meta: n_swa            = 0
0.00.083.953 I llm_load_print_meta: n_embd_head_k    = 128
0.00.083.956 I llm_load_print_meta: n_embd_head_v    = 128
0.00.083.957 I llm_load_print_meta: n_gqa            = 1
0.00.083.957 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.083.958 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.083.959 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.083.959 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.083.959 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.083.960 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.083.960 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.083.960 I llm_load_print_meta: n_ff             = 8192
0.00.083.961 I llm_load_print_meta: n_expert         = 0
0.00.083.961 I llm_load_print_meta: n_expert_used    = 0
0.00.083.961 I llm_load_print_meta: causal attn      = 1
0.00.083.961 I llm_load_print_meta: pooling type     = 0
0.00.083.961 I llm_load_print_meta: rope type        = 2
0.00.083.961 I llm_load_print_meta: rope scaling     = linear
0.00.083.963 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.083.964 I llm_load_print_meta: freq_scale_train = 1
0.00.083.964 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.083.964 I llm_load_print_meta: rope_finetuned   = unknown
0.00.083.964 I llm_load_print_meta: ssm_d_conv       = 0
0.00.083.964 I llm_load_print_meta: ssm_d_inner      = 0
0.00.083.964 I llm_load_print_meta: ssm_d_state      = 0
0.00.083.964 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.083.965 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.083.977 I llm_load_print_meta: model type       = 1.4B
0.00.083.977 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.083.978 I llm_load_print_meta: model params     = 1.41 B
0.00.083.978 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.083.978 I llm_load_print_meta: general.name     = 1.4B
0.00.083.979 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.083.979 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.083.979 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.083.979 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.083.979 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.083.980 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.083.980 I llm_load_print_meta: max token length = 1024
0.00.086.412 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.086.413 I llm_load_tensors: offloading output layer to GPU
0.00.086.413 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.086.423 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.086.424 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.087.368 I llama_new_context_with_model: n_seq_max     = 1
0.00.087.369 I llama_new_context_with_model: n_ctx         = 128
0.00.087.369 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.087.369 I llama_new_context_with_model: n_batch       = 128
0.00.087.369 I llama_new_context_with_model: n_ubatch      = 128
0.00.087.369 I llama_new_context_with_model: flash_attn    = 0
0.00.087.370 I llama_new_context_with_model: freq_base     = 10000.0
0.00.087.370 I llama_new_context_with_model: freq_scale    = 1
0.00.087.370 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.087.371 I ggml_metal_init: allocating
0.00.087.377 I ggml_metal_init: found device: Apple M4
0.00.087.379 I ggml_metal_init: picking default device: Apple M4
0.00.087.923 I ggml_metal_init: using embedded metal library
0.00.089.877 I ggml_metal_init: GPU name:   Apple M4
0.00.089.878 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.089.878 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.089.879 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.089.879 I ggml_metal_init: simdgroup reduction   = true
0.00.089.879 I ggml_metal_init: simdgroup matrix mul. = true
0.00.089.879 I ggml_metal_init: has bfloat            = true
0.00.089.879 I ggml_metal_init: use bfloat            = true
0.00.089.879 I ggml_metal_init: hasUnifiedMemory      = true
0.00.089.881 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.100.103 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.100.105 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.100.119 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.100.964 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.100.965 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.100.966 I llama_new_context_with_model: graph nodes  = 967
0.00.100.966 I llama_new_context_with_model: graph splits = 2
0.00.100.978 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.913.445 I 
0.00.913.481 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.913.486 I perplexity: tokenizing the input ..
0.00.926.468 I perplexity: tokenization took 12.979 ms
0.00.926.482 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.047.383 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.049.207 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.049.254 I llama_perf_context_print:        load time =     890.62 ms
0.01.049.255 I llama_perf_context_print: prompt eval time =     120.03 ms /   128 tokens (    0.94 ms per token,  1066.43 tokens per second)
0.01.049.256 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.049.256 I llama_perf_context_print:       total time =     135.81 ms /   129 tokens
0.01.049.846 I ggml_metal_free: deallocating

real	0m1.245s
user	0m0.120s
sys	0m0.204s
```
- q8_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.071 I main: llama backend init
0.00.000.074 I main: load the model and apply lora adapter, if any
0.00.009.818 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.024.280 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.024.286 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.024.287 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.024.292 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.024.293 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.024.293 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.024.294 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.024.295 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.024.296 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.024.297 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.024.297 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.024.297 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.024.298 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.024.298 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.024.299 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.024.302 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.024.302 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.028.330 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.029.495 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.033.566 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.033.568 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.033.568 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.033.569 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.033.569 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.033.569 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.033.570 I llama_model_loader: - type  f32:  194 tensors
0.00.033.571 I llama_model_loader: - type q8_0:   98 tensors
0.00.056.580 I llm_load_vocab: special tokens cache size = 25
0.00.062.535 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.062.539 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.062.540 I llm_load_print_meta: arch             = gptneox
0.00.062.540 I llm_load_print_meta: vocab type       = BPE
0.00.062.540 I llm_load_print_meta: n_vocab          = 50304
0.00.062.541 I llm_load_print_meta: n_merges         = 50009
0.00.062.541 I llm_load_print_meta: vocab_only       = 0
0.00.062.541 I llm_load_print_meta: n_ctx_train      = 2048
0.00.062.542 I llm_load_print_meta: n_embd           = 2048
0.00.062.542 I llm_load_print_meta: n_layer          = 24
0.00.062.547 I llm_load_print_meta: n_head           = 16
0.00.062.548 I llm_load_print_meta: n_head_kv        = 16
0.00.062.548 I llm_load_print_meta: n_rot            = 32
0.00.062.549 I llm_load_print_meta: n_swa            = 0
0.00.062.549 I llm_load_print_meta: n_embd_head_k    = 128
0.00.062.549 I llm_load_print_meta: n_embd_head_v    = 128
0.00.062.551 I llm_load_print_meta: n_gqa            = 1
0.00.062.552 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.062.553 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.062.553 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.062.554 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.062.554 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.062.554 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.062.555 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.062.555 I llm_load_print_meta: n_ff             = 8192
0.00.062.555 I llm_load_print_meta: n_expert         = 0
0.00.062.556 I llm_load_print_meta: n_expert_used    = 0
0.00.062.556 I llm_load_print_meta: causal attn      = 1
0.00.062.556 I llm_load_print_meta: pooling type     = 0
0.00.062.557 I llm_load_print_meta: rope type        = 2
0.00.062.557 I llm_load_print_meta: rope scaling     = linear
0.00.062.558 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.062.558 I llm_load_print_meta: freq_scale_train = 1
0.00.062.558 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.062.558 I llm_load_print_meta: rope_finetuned   = unknown
0.00.062.559 I llm_load_print_meta: ssm_d_conv       = 0
0.00.062.559 I llm_load_print_meta: ssm_d_inner      = 0
0.00.062.559 I llm_load_print_meta: ssm_d_state      = 0
0.00.062.559 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.062.559 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.062.573 I llm_load_print_meta: model type       = 1.4B
0.00.062.573 I llm_load_print_meta: model ftype      = Q8_0
0.00.062.574 I llm_load_print_meta: model params     = 1.41 B
0.00.062.574 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.062.574 I llm_load_print_meta: general.name     = 1.4B
0.00.062.575 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.062.575 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.062.575 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.062.575 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.062.575 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.062.576 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.062.576 I llm_load_print_meta: max token length = 1024
0.00.065.055 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.065.055 I llm_load_tensors: offloading output layer to GPU
0.00.065.055 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.065.066 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.065.067 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.066.026 I llama_new_context_with_model: n_seq_max     = 1
0.00.066.027 I llama_new_context_with_model: n_ctx         = 2048
0.00.066.027 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.066.027 I llama_new_context_with_model: n_batch       = 2048
0.00.066.027 I llama_new_context_with_model: n_ubatch      = 512
0.00.066.028 I llama_new_context_with_model: flash_attn    = 0
0.00.066.028 I llama_new_context_with_model: freq_base     = 10000.0
0.00.066.028 I llama_new_context_with_model: freq_scale    = 1
0.00.066.029 I ggml_metal_init: allocating
0.00.066.032 I ggml_metal_init: found device: Apple M4
0.00.066.034 I ggml_metal_init: picking default device: Apple M4
0.00.066.685 I ggml_metal_init: using embedded metal library
0.00.068.833 I ggml_metal_init: GPU name:   Apple M4
0.00.068.835 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.068.835 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.068.835 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.068.836 I ggml_metal_init: simdgroup reduction   = true
0.00.068.836 I ggml_metal_init: simdgroup matrix mul. = true
0.00.068.836 I ggml_metal_init: has bfloat            = true
0.00.068.836 I ggml_metal_init: use bfloat            = true
0.00.068.837 I ggml_metal_init: hasUnifiedMemory      = true
0.00.068.837 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.105.002 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.105.015 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.105.043 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.106.114 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.106.117 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.106.117 I llama_new_context_with_model: graph nodes  = 967
0.00.106.118 I llama_new_context_with_model: graph splits = 2
0.00.106.129 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.225.046 I main: llama threadpool init, n_threads = 4
0.01.225.079 I 
0.01.225.107 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.01.225.107 I 
0.01.225.339 I sampler seed: 1234
0.01.225.344 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.225.360 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.225.361 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.225.361 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.357.239 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58726.22 tokens per second)
0.02.357.240 I llama_perf_context_print:        load time =    1215.23 ms
0.02.357.241 I llama_perf_context_print: prompt eval time =      33.59 ms /     7 tokens (    4.80 ms per token,   208.38 tokens per second)
0.02.357.242 I llama_perf_context_print:        eval time =    1095.24 ms /    63 runs   (   17.38 ms per token,    57.52 tokens per second)
0.02.357.242 I llama_perf_context_print:       total time =    1132.19 ms /    70 tokens
0.02.357.404 I ggml_metal_free: deallocating

real	0m2.377s
user	0m0.115s
sys	0m0.230s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.114 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.949 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.017.249 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.017.254 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.017.255 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.017.256 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.017.256 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.017.257 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.017.257 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.017.258 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.017.258 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.017.259 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.017.259 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.017.259 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.017.260 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.017.260 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.017.262 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.017.262 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.017.262 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.627 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.096 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.029.472 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.029.474 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.029.474 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.029.475 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.029.475 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.029.475 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.029.476 I llama_model_loader: - type  f32:  194 tensors
0.00.029.476 I llama_model_loader: - type q8_0:   98 tensors
0.00.052.604 I llm_load_vocab: special tokens cache size = 25
0.00.058.539 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.058.542 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.058.542 I llm_load_print_meta: arch             = gptneox
0.00.058.542 I llm_load_print_meta: vocab type       = BPE
0.00.058.542 I llm_load_print_meta: n_vocab          = 50304
0.00.058.543 I llm_load_print_meta: n_merges         = 50009
0.00.058.543 I llm_load_print_meta: vocab_only       = 0
0.00.058.543 I llm_load_print_meta: n_ctx_train      = 2048
0.00.058.543 I llm_load_print_meta: n_embd           = 2048
0.00.058.543 I llm_load_print_meta: n_layer          = 24
0.00.058.547 I llm_load_print_meta: n_head           = 16
0.00.058.548 I llm_load_print_meta: n_head_kv        = 16
0.00.058.548 I llm_load_print_meta: n_rot            = 32
0.00.058.548 I llm_load_print_meta: n_swa            = 0
0.00.058.548 I llm_load_print_meta: n_embd_head_k    = 128
0.00.058.549 I llm_load_print_meta: n_embd_head_v    = 128
0.00.058.549 I llm_load_print_meta: n_gqa            = 1
0.00.058.550 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.058.551 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.058.554 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.058.554 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.058.554 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.058.554 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.058.554 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.058.555 I llm_load_print_meta: n_ff             = 8192
0.00.058.555 I llm_load_print_meta: n_expert         = 0
0.00.058.555 I llm_load_print_meta: n_expert_used    = 0
0.00.058.556 I llm_load_print_meta: causal attn      = 1
0.00.058.556 I llm_load_print_meta: pooling type     = 0
0.00.058.556 I llm_load_print_meta: rope type        = 2
0.00.058.556 I llm_load_print_meta: rope scaling     = linear
0.00.058.558 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.058.558 I llm_load_print_meta: freq_scale_train = 1
0.00.058.558 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.058.559 I llm_load_print_meta: rope_finetuned   = unknown
0.00.058.559 I llm_load_print_meta: ssm_d_conv       = 0
0.00.058.559 I llm_load_print_meta: ssm_d_inner      = 0
0.00.058.559 I llm_load_print_meta: ssm_d_state      = 0
0.00.058.559 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.058.559 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.058.571 I llm_load_print_meta: model type       = 1.4B
0.00.058.571 I llm_load_print_meta: model ftype      = Q8_0
0.00.058.572 I llm_load_print_meta: model params     = 1.41 B
0.00.058.572 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.058.572 I llm_load_print_meta: general.name     = 1.4B
0.00.058.573 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.058.573 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.058.573 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.058.575 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.058.575 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.058.575 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.058.575 I llm_load_print_meta: max token length = 1024
0.00.060.106 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.060.106 I llm_load_tensors: offloading output layer to GPU
0.00.060.106 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.060.115 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.060.117 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.060.945 I llama_new_context_with_model: n_seq_max     = 1
0.00.060.946 I llama_new_context_with_model: n_ctx         = 128
0.00.060.946 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.060.947 I llama_new_context_with_model: n_batch       = 128
0.00.060.947 I llama_new_context_with_model: n_ubatch      = 128
0.00.060.947 I llama_new_context_with_model: flash_attn    = 0
0.00.060.947 I llama_new_context_with_model: freq_base     = 10000.0
0.00.060.948 I llama_new_context_with_model: freq_scale    = 1
0.00.060.948 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.060.948 I ggml_metal_init: allocating
0.00.060.953 I ggml_metal_init: found device: Apple M4
0.00.060.956 I ggml_metal_init: picking default device: Apple M4
0.00.061.494 I ggml_metal_init: using embedded metal library
0.00.063.461 I ggml_metal_init: GPU name:   Apple M4
0.00.063.462 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.063.462 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.063.463 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.063.463 I ggml_metal_init: simdgroup reduction   = true
0.00.063.463 I ggml_metal_init: simdgroup matrix mul. = true
0.00.063.463 I ggml_metal_init: has bfloat            = true
0.00.063.463 I ggml_metal_init: use bfloat            = true
0.00.063.464 I ggml_metal_init: hasUnifiedMemory      = true
0.00.063.464 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.071.498 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.071.500 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.071.514 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.072.425 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.072.426 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.072.427 I llama_new_context_with_model: graph nodes  = 967
0.00.072.427 I llama_new_context_with_model: graph splits = 2
0.00.072.439 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.794.280 I 
0.00.794.305 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.794.336 I perplexity: tokenizing the input ..
0.00.802.460 I perplexity: tokenization took 8.122 ms
0.00.802.464 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.923.916 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.00.925.063 I Final estimate: PPL = 10.1362 +/- 3.22437

0.00.925.088 I llama_perf_context_print:        load time =     784.33 ms
0.00.925.090 I llama_perf_context_print: prompt eval time =     121.20 ms /   128 tokens (    0.95 ms per token,  1056.15 tokens per second)
0.00.925.090 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.925.091 I llama_perf_context_print:       total time =     130.81 ms /   129 tokens
0.00.925.495 I ggml_metal_free: deallocating

real	0m0.942s
user	0m0.086s
sys	0m0.149s
```
- q4_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.074 I main: llama backend init
0.00.000.077 I main: load the model and apply lora adapter, if any
0.00.017.022 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.039.170 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.039.177 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.039.179 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.039.180 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.039.180 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.039.180 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.039.181 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.039.182 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.039.182 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.039.182 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.039.183 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.039.183 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.039.183 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.039.184 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.039.187 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.039.188 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.039.188 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.018 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.045.272 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.050.605 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.050.606 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.050.607 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.050.607 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.050.608 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.050.608 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.050.609 I llama_model_loader: - type  f32:  194 tensors
0.00.050.609 I llama_model_loader: - type q4_0:   97 tensors
0.00.050.609 I llama_model_loader: - type q6_K:    1 tensors
0.00.083.179 I llm_load_vocab: special tokens cache size = 25
0.00.093.608 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.093.612 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.093.612 I llm_load_print_meta: arch             = gptneox
0.00.093.613 I llm_load_print_meta: vocab type       = BPE
0.00.093.613 I llm_load_print_meta: n_vocab          = 50304
0.00.093.613 I llm_load_print_meta: n_merges         = 50009
0.00.093.614 I llm_load_print_meta: vocab_only       = 0
0.00.093.614 I llm_load_print_meta: n_ctx_train      = 2048
0.00.093.617 I llm_load_print_meta: n_embd           = 2048
0.00.093.617 I llm_load_print_meta: n_layer          = 24
0.00.093.622 I llm_load_print_meta: n_head           = 16
0.00.093.625 I llm_load_print_meta: n_head_kv        = 16
0.00.093.625 I llm_load_print_meta: n_rot            = 32
0.00.093.625 I llm_load_print_meta: n_swa            = 0
0.00.093.625 I llm_load_print_meta: n_embd_head_k    = 128
0.00.093.626 I llm_load_print_meta: n_embd_head_v    = 128
0.00.093.628 I llm_load_print_meta: n_gqa            = 1
0.00.093.629 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.093.630 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.093.631 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.093.631 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.093.631 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.093.631 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.093.632 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.093.632 I llm_load_print_meta: n_ff             = 8192
0.00.093.633 I llm_load_print_meta: n_expert         = 0
0.00.093.633 I llm_load_print_meta: n_expert_used    = 0
0.00.093.635 I llm_load_print_meta: causal attn      = 1
0.00.093.636 I llm_load_print_meta: pooling type     = 0
0.00.093.636 I llm_load_print_meta: rope type        = 2
0.00.093.637 I llm_load_print_meta: rope scaling     = linear
0.00.093.637 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.093.637 I llm_load_print_meta: freq_scale_train = 1
0.00.093.638 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.093.638 I llm_load_print_meta: rope_finetuned   = unknown
0.00.093.638 I llm_load_print_meta: ssm_d_conv       = 0
0.00.093.638 I llm_load_print_meta: ssm_d_inner      = 0
0.00.093.638 I llm_load_print_meta: ssm_d_state      = 0
0.00.093.639 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.093.639 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.093.652 I llm_load_print_meta: model type       = 1.4B
0.00.093.652 I llm_load_print_meta: model ftype      = Q4_0
0.00.093.653 I llm_load_print_meta: model params     = 1.41 B
0.00.093.654 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.093.654 I llm_load_print_meta: general.name     = 1.4B
0.00.093.654 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.093.655 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.093.656 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.093.656 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.093.657 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.093.657 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.093.657 I llm_load_print_meta: max token length = 1024
0.00.096.502 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.096.502 I llm_load_tensors: offloading output layer to GPU
0.00.096.503 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.096.513 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.096.515 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.097.893 I llama_new_context_with_model: n_seq_max     = 1
0.00.097.894 I llama_new_context_with_model: n_ctx         = 2048
0.00.097.894 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.097.894 I llama_new_context_with_model: n_batch       = 2048
0.00.097.895 I llama_new_context_with_model: n_ubatch      = 512
0.00.097.895 I llama_new_context_with_model: flash_attn    = 0
0.00.097.895 I llama_new_context_with_model: freq_base     = 10000.0
0.00.097.896 I llama_new_context_with_model: freq_scale    = 1
0.00.097.896 I ggml_metal_init: allocating
0.00.097.904 I ggml_metal_init: found device: Apple M4
0.00.097.907 I ggml_metal_init: picking default device: Apple M4
0.00.098.744 I ggml_metal_init: using embedded metal library
0.00.101.739 I ggml_metal_init: GPU name:   Apple M4
0.00.101.741 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.101.742 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.101.742 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.101.743 I ggml_metal_init: simdgroup reduction   = true
0.00.101.743 I ggml_metal_init: simdgroup matrix mul. = true
0.00.101.743 I ggml_metal_init: has bfloat            = true
0.00.101.745 I ggml_metal_init: use bfloat            = true
0.00.101.747 I ggml_metal_init: hasUnifiedMemory      = true
0.00.101.748 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.138.515 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.138.528 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.138.552 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.139.547 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.139.549 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.139.549 I llama_new_context_with_model: graph nodes  = 967
0.00.139.549 I llama_new_context_with_model: graph splits = 2
0.00.139.565 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.754.704 I main: llama threadpool init, n_threads = 4
0.00.754.782 I 
0.00.754.848 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.754.849 I 
0.00.755.366 I sampler seed: 1234
0.00.755.373 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.755.477 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.755.491 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.755.491 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.437.609 I llama_perf_sampler_print:    sampling time =       1.22 ms /    71 runs   (    0.02 ms per token, 58340.18 tokens per second)
0.01.437.609 I llama_perf_context_print:        load time =     737.67 ms
0.01.437.611 I llama_perf_context_print: prompt eval time =      38.86 ms /     7 tokens (    5.55 ms per token,   180.16 tokens per second)
0.01.437.611 I llama_perf_context_print:        eval time =     640.23 ms /    63 runs   (   10.16 ms per token,    98.40 tokens per second)
0.01.437.612 I llama_perf_context_print:       total time =     682.91 ms /    70 tokens
0.01.437.784 I ggml_metal_free: deallocating

real	0m1.463s
user	0m0.137s
sys	0m0.183s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.081 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.692 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.508 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.015.513 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.514 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.515 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.515 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.516 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.516 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.517 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.517 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.517 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.518 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.518 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.518 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.520 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.522 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.523 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.523 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.654 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.760 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.827 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.828 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.828 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.829 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.829 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.829 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.024.830 I llama_model_loader: - type  f32:  194 tensors
0.00.024.830 I llama_model_loader: - type q4_0:   97 tensors
0.00.024.830 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.975 I llm_load_vocab: special tokens cache size = 25
0.00.050.988 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.990 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.991 I llm_load_print_meta: arch             = gptneox
0.00.050.991 I llm_load_print_meta: vocab type       = BPE
0.00.050.991 I llm_load_print_meta: n_vocab          = 50304
0.00.050.992 I llm_load_print_meta: n_merges         = 50009
0.00.050.992 I llm_load_print_meta: vocab_only       = 0
0.00.050.992 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.992 I llm_load_print_meta: n_embd           = 2048
0.00.050.992 I llm_load_print_meta: n_layer          = 24
0.00.050.995 I llm_load_print_meta: n_head           = 16
0.00.050.996 I llm_load_print_meta: n_head_kv        = 16
0.00.050.996 I llm_load_print_meta: n_rot            = 32
0.00.050.996 I llm_load_print_meta: n_swa            = 0
0.00.050.996 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.996 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.998 I llm_load_print_meta: n_gqa            = 1
0.00.050.999 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.999 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.002 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.002 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.002 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.002 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.002 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.003 I llm_load_print_meta: n_ff             = 8192
0.00.051.003 I llm_load_print_meta: n_expert         = 0
0.00.051.003 I llm_load_print_meta: n_expert_used    = 0
0.00.051.004 I llm_load_print_meta: causal attn      = 1
0.00.051.004 I llm_load_print_meta: pooling type     = 0
0.00.051.004 I llm_load_print_meta: rope type        = 2
0.00.051.004 I llm_load_print_meta: rope scaling     = linear
0.00.051.004 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.005 I llm_load_print_meta: freq_scale_train = 1
0.00.051.005 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.005 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.006 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.006 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.006 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.006 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.006 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.018 I llm_load_print_meta: model type       = 1.4B
0.00.051.018 I llm_load_print_meta: model ftype      = Q4_0
0.00.051.019 I llm_load_print_meta: model params     = 1.41 B
0.00.051.019 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.051.019 I llm_load_print_meta: general.name     = 1.4B
0.00.051.019 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.020 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.020 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.020 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.021 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.021 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.021 I llm_load_print_meta: max token length = 1024
0.00.052.970 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.970 I llm_load_tensors: offloading output layer to GPU
0.00.052.971 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.981 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.052.982 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.053.857 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.857 I llama_new_context_with_model: n_ctx         = 128
0.00.053.858 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.858 I llama_new_context_with_model: n_batch       = 128
0.00.053.858 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.858 I llama_new_context_with_model: flash_attn    = 0
0.00.053.858 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.859 I llama_new_context_with_model: freq_scale    = 1
0.00.053.859 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.859 I ggml_metal_init: allocating
0.00.053.864 I ggml_metal_init: found device: Apple M4
0.00.053.867 I ggml_metal_init: picking default device: Apple M4
0.00.054.404 I ggml_metal_init: using embedded metal library
0.00.056.355 I ggml_metal_init: GPU name:   Apple M4
0.00.056.357 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.357 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.358 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.358 I ggml_metal_init: simdgroup reduction   = true
0.00.056.358 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.358 I ggml_metal_init: has bfloat            = true
0.00.056.358 I ggml_metal_init: use bfloat            = true
0.00.056.359 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.360 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.398 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.400 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.413 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.260 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.261 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.261 I llama_new_context_with_model: graph nodes  = 967
0.00.066.261 I llama_new_context_with_model: graph splits = 2
0.00.066.274 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.623.856 I 
0.00.623.888 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.623.893 I perplexity: tokenizing the input ..
0.00.631.944 I perplexity: tokenization took 8.048 ms
0.00.631.947 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.754.421 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.755.600 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.755.620 I llama_perf_context_print:        load time =     614.16 ms
0.00.755.621 I llama_perf_context_print: prompt eval time =     122.25 ms /   128 tokens (    0.96 ms per token,  1047.04 tokens per second)
0.00.755.622 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.755.622 I llama_perf_context_print:       total time =     131.77 ms /   129 tokens
0.00.755.921 I ggml_metal_free: deallocating

real	0m0.772s
user	0m0.077s
sys	0m0.113s
```
- q4_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.046 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.072 I main: llama backend init
0.00.000.074 I main: load the model and apply lora adapter, if any
0.00.012.149 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.029.893 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.029.898 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.029.900 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.029.900 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.029.902 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.029.902 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.029.903 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.029.904 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.029.904 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.029.904 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.029.905 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.029.905 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.029.906 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.029.906 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.029.909 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.029.909 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.029.909 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.035.399 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.037.012 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.043.264 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.043.266 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.043.266 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.043.266 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.043.267 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.043.267 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.043.268 I llama_model_loader: - type  f32:  194 tensors
0.00.043.268 I llama_model_loader: - type q4_1:   97 tensors
0.00.043.269 I llama_model_loader: - type q6_K:    1 tensors
0.00.081.293 I llm_load_vocab: special tokens cache size = 25
0.00.090.834 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.090.838 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.090.838 I llm_load_print_meta: arch             = gptneox
0.00.090.839 I llm_load_print_meta: vocab type       = BPE
0.00.090.839 I llm_load_print_meta: n_vocab          = 50304
0.00.090.839 I llm_load_print_meta: n_merges         = 50009
0.00.090.839 I llm_load_print_meta: vocab_only       = 0
0.00.090.839 I llm_load_print_meta: n_ctx_train      = 2048
0.00.090.840 I llm_load_print_meta: n_embd           = 2048
0.00.090.840 I llm_load_print_meta: n_layer          = 24
0.00.090.843 I llm_load_print_meta: n_head           = 16
0.00.090.844 I llm_load_print_meta: n_head_kv        = 16
0.00.090.844 I llm_load_print_meta: n_rot            = 32
0.00.090.845 I llm_load_print_meta: n_swa            = 0
0.00.090.845 I llm_load_print_meta: n_embd_head_k    = 128
0.00.090.845 I llm_load_print_meta: n_embd_head_v    = 128
0.00.090.846 I llm_load_print_meta: n_gqa            = 1
0.00.090.847 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.090.847 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.090.848 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.090.850 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.090.851 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.090.851 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.090.853 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.090.854 I llm_load_print_meta: n_ff             = 8192
0.00.090.854 I llm_load_print_meta: n_expert         = 0
0.00.090.854 I llm_load_print_meta: n_expert_used    = 0
0.00.090.854 I llm_load_print_meta: causal attn      = 1
0.00.090.856 I llm_load_print_meta: pooling type     = 0
0.00.090.856 I llm_load_print_meta: rope type        = 2
0.00.090.856 I llm_load_print_meta: rope scaling     = linear
0.00.090.857 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.090.857 I llm_load_print_meta: freq_scale_train = 1
0.00.090.857 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.090.857 I llm_load_print_meta: rope_finetuned   = unknown
0.00.090.858 I llm_load_print_meta: ssm_d_conv       = 0
0.00.090.858 I llm_load_print_meta: ssm_d_inner      = 0
0.00.090.858 I llm_load_print_meta: ssm_d_state      = 0
0.00.090.858 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.090.858 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.090.871 I llm_load_print_meta: model type       = 1.4B
0.00.090.871 I llm_load_print_meta: model ftype      = Q4_1
0.00.090.872 I llm_load_print_meta: model params     = 1.41 B
0.00.090.872 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.090.874 I llm_load_print_meta: general.name     = 1.4B
0.00.090.874 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.090.875 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.090.875 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.090.875 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.090.875 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.090.876 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.090.876 I llm_load_print_meta: max token length = 1024
0.00.093.423 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.093.423 I llm_load_tensors: offloading output layer to GPU
0.00.093.423 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.093.434 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.093.435 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.094.690 I llama_new_context_with_model: n_seq_max     = 1
0.00.094.691 I llama_new_context_with_model: n_ctx         = 2048
0.00.094.691 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.094.691 I llama_new_context_with_model: n_batch       = 2048
0.00.094.692 I llama_new_context_with_model: n_ubatch      = 512
0.00.094.692 I llama_new_context_with_model: flash_attn    = 0
0.00.094.692 I llama_new_context_with_model: freq_base     = 10000.0
0.00.094.692 I llama_new_context_with_model: freq_scale    = 1
0.00.094.693 I ggml_metal_init: allocating
0.00.094.696 I ggml_metal_init: found device: Apple M4
0.00.094.699 I ggml_metal_init: picking default device: Apple M4
0.00.095.459 I ggml_metal_init: using embedded metal library
0.00.098.096 I ggml_metal_init: GPU name:   Apple M4
0.00.098.098 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.098.099 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.098.099 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.098.099 I ggml_metal_init: simdgroup reduction   = true
0.00.098.100 I ggml_metal_init: simdgroup matrix mul. = true
0.00.098.100 I ggml_metal_init: has bfloat            = true
0.00.098.100 I ggml_metal_init: use bfloat            = true
0.00.098.100 I ggml_metal_init: hasUnifiedMemory      = true
0.00.098.101 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.131.111 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.131.119 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.131.137 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.132.197 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.132.199 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.132.199 I llama_new_context_with_model: graph nodes  = 967
0.00.132.199 I llama_new_context_with_model: graph splits = 2
0.00.132.213 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.824.397 I main: llama threadpool init, n_threads = 4
0.00.824.497 I 
0.00.824.556 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.824.556 I 
0.00.825.084 I sampler seed: 1234
0.00.825.092 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.825.178 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.825.184 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.825.185 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.559.389 I llama_perf_sampler_print:    sampling time =       1.17 ms /    71 runs   (    0.02 ms per token, 60891.94 tokens per second)
0.01.559.390 I llama_perf_context_print:        load time =     812.24 ms
0.01.559.391 I llama_perf_context_print: prompt eval time =      41.86 ms /     7 tokens (    5.98 ms per token,   167.23 tokens per second)
0.01.559.391 I llama_perf_context_print:        eval time =     689.45 ms /    63 runs   (   10.94 ms per token,    91.38 tokens per second)
0.01.559.392 I llama_perf_context_print:       total time =     735.00 ms /    70 tokens
0.01.559.582 I ggml_metal_free: deallocating

real	0m1.599s
user	0m0.147s
sys	0m0.185s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.082 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.514 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.437 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.014.441 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.443 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.444 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.444 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.444 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.445 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.445 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.446 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.446 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.446 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.447 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.447 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.447 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.449 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.449 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.450 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.534 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.658 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.769 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.770 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.771 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.771 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.771 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.771 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.023.772 I llama_model_loader: - type  f32:  194 tensors
0.00.023.772 I llama_model_loader: - type q4_1:   97 tensors
0.00.023.773 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.563 I llm_load_vocab: special tokens cache size = 25
0.00.050.328 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.331 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.331 I llm_load_print_meta: arch             = gptneox
0.00.050.332 I llm_load_print_meta: vocab type       = BPE
0.00.050.332 I llm_load_print_meta: n_vocab          = 50304
0.00.050.332 I llm_load_print_meta: n_merges         = 50009
0.00.050.332 I llm_load_print_meta: vocab_only       = 0
0.00.050.332 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.332 I llm_load_print_meta: n_embd           = 2048
0.00.050.333 I llm_load_print_meta: n_layer          = 24
0.00.050.335 I llm_load_print_meta: n_head           = 16
0.00.050.336 I llm_load_print_meta: n_head_kv        = 16
0.00.050.336 I llm_load_print_meta: n_rot            = 32
0.00.050.336 I llm_load_print_meta: n_swa            = 0
0.00.050.339 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.339 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.340 I llm_load_print_meta: n_gqa            = 1
0.00.050.341 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.341 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.342 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.342 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.342 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.343 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.343 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.343 I llm_load_print_meta: n_ff             = 8192
0.00.050.344 I llm_load_print_meta: n_expert         = 0
0.00.050.344 I llm_load_print_meta: n_expert_used    = 0
0.00.050.344 I llm_load_print_meta: causal attn      = 1
0.00.050.344 I llm_load_print_meta: pooling type     = 0
0.00.050.344 I llm_load_print_meta: rope type        = 2
0.00.050.344 I llm_load_print_meta: rope scaling     = linear
0.00.050.345 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.345 I llm_load_print_meta: freq_scale_train = 1
0.00.050.345 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.345 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.346 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.346 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.346 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.346 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.346 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.358 I llm_load_print_meta: model type       = 1.4B
0.00.050.358 I llm_load_print_meta: model ftype      = Q4_1
0.00.050.358 I llm_load_print_meta: model params     = 1.41 B
0.00.050.359 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.050.359 I llm_load_print_meta: general.name     = 1.4B
0.00.050.359 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.359 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.359 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.360 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.360 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.360 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.360 I llm_load_print_meta: max token length = 1024
0.00.052.360 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.360 I llm_load_tensors: offloading output layer to GPU
0.00.052.360 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.370 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.052.371 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.053.236 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.237 I llama_new_context_with_model: n_ctx         = 128
0.00.053.237 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.237 I llama_new_context_with_model: n_batch       = 128
0.00.053.237 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.237 I llama_new_context_with_model: flash_attn    = 0
0.00.053.238 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.238 I llama_new_context_with_model: freq_scale    = 1
0.00.053.238 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.239 I ggml_metal_init: allocating
0.00.053.245 I ggml_metal_init: found device: Apple M4
0.00.053.247 I ggml_metal_init: picking default device: Apple M4
0.00.053.785 I ggml_metal_init: using embedded metal library
0.00.055.741 I ggml_metal_init: GPU name:   Apple M4
0.00.055.742 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.742 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.743 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.743 I ggml_metal_init: simdgroup reduction   = true
0.00.055.743 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.743 I ggml_metal_init: has bfloat            = true
0.00.055.743 I ggml_metal_init: use bfloat            = true
0.00.055.744 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.745 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.780 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.785 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.799 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.700 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.701 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.702 I llama_new_context_with_model: graph nodes  = 967
0.00.065.702 I llama_new_context_with_model: graph splits = 2
0.00.065.714 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.655.049 I 
0.00.655.084 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.655.092 I perplexity: tokenizing the input ..
0.00.662.767 I perplexity: tokenization took 7.672 ms
0.00.662.770 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.784.849 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.785.965 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.785.988 I llama_perf_context_print:        load time =     646.53 ms
0.00.785.991 I llama_perf_context_print: prompt eval time =     121.86 ms /   128 tokens (    0.95 ms per token,  1050.43 tokens per second)
0.00.785.992 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.785.992 I llama_perf_context_print:       total time =     130.94 ms /   129 tokens
0.00.786.409 I ggml_metal_free: deallocating

real	0m0.799s
user	0m0.078s
sys	0m0.114s
```
- q5_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.067 I main: llama backend init
0.00.000.070 I main: load the model and apply lora adapter, if any
0.00.009.346 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.024.448 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.024.452 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.024.453 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.024.460 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.024.460 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.024.461 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.024.461 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.024.462 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.024.462 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.024.462 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.024.463 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.024.463 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.024.464 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.024.464 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.024.465 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.024.466 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.024.466 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.028.658 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.029.807 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.034.025 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.034.026 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.034.026 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.034.027 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.034.027 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.034.027 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.034.028 I llama_model_loader: - type  f32:  194 tensors
0.00.034.028 I llama_model_loader: - type q5_0:   97 tensors
0.00.034.028 I llama_model_loader: - type q6_K:    1 tensors
0.00.057.001 I llm_load_vocab: special tokens cache size = 25
0.00.063.109 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.063.111 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.063.112 I llm_load_print_meta: arch             = gptneox
0.00.063.112 I llm_load_print_meta: vocab type       = BPE
0.00.063.112 I llm_load_print_meta: n_vocab          = 50304
0.00.063.112 I llm_load_print_meta: n_merges         = 50009
0.00.063.113 I llm_load_print_meta: vocab_only       = 0
0.00.063.113 I llm_load_print_meta: n_ctx_train      = 2048
0.00.063.113 I llm_load_print_meta: n_embd           = 2048
0.00.063.113 I llm_load_print_meta: n_layer          = 24
0.00.063.115 I llm_load_print_meta: n_head           = 16
0.00.063.116 I llm_load_print_meta: n_head_kv        = 16
0.00.063.116 I llm_load_print_meta: n_rot            = 32
0.00.063.117 I llm_load_print_meta: n_swa            = 0
0.00.063.117 I llm_load_print_meta: n_embd_head_k    = 128
0.00.063.118 I llm_load_print_meta: n_embd_head_v    = 128
0.00.063.119 I llm_load_print_meta: n_gqa            = 1
0.00.063.119 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.063.120 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.063.121 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.063.121 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.063.121 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.063.121 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.063.122 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.063.122 I llm_load_print_meta: n_ff             = 8192
0.00.063.122 I llm_load_print_meta: n_expert         = 0
0.00.063.123 I llm_load_print_meta: n_expert_used    = 0
0.00.063.123 I llm_load_print_meta: causal attn      = 1
0.00.063.123 I llm_load_print_meta: pooling type     = 0
0.00.063.123 I llm_load_print_meta: rope type        = 2
0.00.063.123 I llm_load_print_meta: rope scaling     = linear
0.00.063.124 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.063.124 I llm_load_print_meta: freq_scale_train = 1
0.00.063.126 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.063.126 I llm_load_print_meta: rope_finetuned   = unknown
0.00.063.126 I llm_load_print_meta: ssm_d_conv       = 0
0.00.063.126 I llm_load_print_meta: ssm_d_inner      = 0
0.00.063.126 I llm_load_print_meta: ssm_d_state      = 0
0.00.063.127 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.063.127 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.063.138 I llm_load_print_meta: model type       = 1.4B
0.00.063.139 I llm_load_print_meta: model ftype      = Q5_0
0.00.063.139 I llm_load_print_meta: model params     = 1.41 B
0.00.063.140 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.063.140 I llm_load_print_meta: general.name     = 1.4B
0.00.063.140 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.063.140 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.063.140 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.063.141 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.063.141 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.063.141 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.063.141 I llm_load_print_meta: max token length = 1024
0.00.064.972 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.064.972 I llm_load_tensors: offloading output layer to GPU
0.00.064.972 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.064.976 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.064.977 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.065.956 I llama_new_context_with_model: n_seq_max     = 1
0.00.065.957 I llama_new_context_with_model: n_ctx         = 2048
0.00.065.957 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.065.957 I llama_new_context_with_model: n_batch       = 2048
0.00.065.958 I llama_new_context_with_model: n_ubatch      = 512
0.00.065.958 I llama_new_context_with_model: flash_attn    = 0
0.00.065.958 I llama_new_context_with_model: freq_base     = 10000.0
0.00.065.958 I llama_new_context_with_model: freq_scale    = 1
0.00.065.959 I ggml_metal_init: allocating
0.00.065.965 I ggml_metal_init: found device: Apple M4
0.00.065.967 I ggml_metal_init: picking default device: Apple M4
0.00.066.520 I ggml_metal_init: using embedded metal library
0.00.068.492 I ggml_metal_init: GPU name:   Apple M4
0.00.068.494 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.068.494 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.068.494 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.068.494 I ggml_metal_init: simdgroup reduction   = true
0.00.068.495 I ggml_metal_init: simdgroup matrix mul. = true
0.00.068.495 I ggml_metal_init: has bfloat            = true
0.00.068.495 I ggml_metal_init: use bfloat            = true
0.00.068.495 I ggml_metal_init: hasUnifiedMemory      = true
0.00.068.496 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.097.695 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.097.700 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.097.718 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.098.728 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.098.730 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.098.730 I llama_new_context_with_model: graph nodes  = 967
0.00.098.730 I llama_new_context_with_model: graph splits = 2
0.00.098.739 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.866.317 I main: llama threadpool init, n_threads = 4
0.00.866.352 I 
0.00.866.384 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.866.385 I 
0.00.866.534 I sampler seed: 1234
0.00.866.539 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.866.578 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.866.581 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.866.581 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.654.282 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59513.83 tokens per second)
0.01.654.282 I llama_perf_context_print:        load time =     856.97 ms
0.01.654.283 I llama_perf_context_print: prompt eval time =      36.58 ms /     7 tokens (    5.23 ms per token,   191.36 tokens per second)
0.01.654.284 I llama_perf_context_print:        eval time =     748.08 ms /    63 runs   (   11.87 ms per token,    84.22 tokens per second)
0.01.654.285 I llama_perf_context_print:       total time =     787.97 ms /    70 tokens
0.01.654.456 I ggml_metal_free: deallocating

real	0m1.670s
user	0m0.112s
sys	0m0.158s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.080 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.012.954 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.737 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.018.742 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.744 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.744 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.745 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.745 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.745 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.746 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.746 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.746 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.747 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.747 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.747 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.748 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.749 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.750 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.750 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.615 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.023.696 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.027.524 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.027.525 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.027.525 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.027.526 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.027.526 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.027.526 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.027.527 I llama_model_loader: - type  f32:  194 tensors
0.00.027.527 I llama_model_loader: - type q5_0:   97 tensors
0.00.027.527 I llama_model_loader: - type q6_K:    1 tensors
0.00.047.467 I llm_load_vocab: special tokens cache size = 25
0.00.053.454 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.053.457 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.053.457 I llm_load_print_meta: arch             = gptneox
0.00.053.457 I llm_load_print_meta: vocab type       = BPE
0.00.053.458 I llm_load_print_meta: n_vocab          = 50304
0.00.053.458 I llm_load_print_meta: n_merges         = 50009
0.00.053.458 I llm_load_print_meta: vocab_only       = 0
0.00.053.458 I llm_load_print_meta: n_ctx_train      = 2048
0.00.053.458 I llm_load_print_meta: n_embd           = 2048
0.00.053.458 I llm_load_print_meta: n_layer          = 24
0.00.053.461 I llm_load_print_meta: n_head           = 16
0.00.053.462 I llm_load_print_meta: n_head_kv        = 16
0.00.053.462 I llm_load_print_meta: n_rot            = 32
0.00.053.462 I llm_load_print_meta: n_swa            = 0
0.00.053.463 I llm_load_print_meta: n_embd_head_k    = 128
0.00.053.463 I llm_load_print_meta: n_embd_head_v    = 128
0.00.053.463 I llm_load_print_meta: n_gqa            = 1
0.00.053.464 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.053.466 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.053.466 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.053.467 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.053.467 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.053.469 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.053.469 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.053.470 I llm_load_print_meta: n_ff             = 8192
0.00.053.470 I llm_load_print_meta: n_expert         = 0
0.00.053.470 I llm_load_print_meta: n_expert_used    = 0
0.00.053.470 I llm_load_print_meta: causal attn      = 1
0.00.053.470 I llm_load_print_meta: pooling type     = 0
0.00.053.470 I llm_load_print_meta: rope type        = 2
0.00.053.471 I llm_load_print_meta: rope scaling     = linear
0.00.053.471 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.053.471 I llm_load_print_meta: freq_scale_train = 1
0.00.053.471 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.053.472 I llm_load_print_meta: rope_finetuned   = unknown
0.00.053.472 I llm_load_print_meta: ssm_d_conv       = 0
0.00.053.472 I llm_load_print_meta: ssm_d_inner      = 0
0.00.053.472 I llm_load_print_meta: ssm_d_state      = 0
0.00.053.472 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.053.472 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.053.485 I llm_load_print_meta: model type       = 1.4B
0.00.053.485 I llm_load_print_meta: model ftype      = Q5_0
0.00.053.485 I llm_load_print_meta: model params     = 1.41 B
0.00.053.486 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.053.486 I llm_load_print_meta: general.name     = 1.4B
0.00.053.487 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.053.487 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.053.487 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.053.487 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.053.488 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.053.488 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.053.488 I llm_load_print_meta: max token length = 1024
0.00.055.399 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.055.399 I llm_load_tensors: offloading output layer to GPU
0.00.055.399 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.055.409 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.055.410 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.056.287 I llama_new_context_with_model: n_seq_max     = 1
0.00.056.287 I llama_new_context_with_model: n_ctx         = 128
0.00.056.287 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.056.288 I llama_new_context_with_model: n_batch       = 128
0.00.056.288 I llama_new_context_with_model: n_ubatch      = 128
0.00.056.288 I llama_new_context_with_model: flash_attn    = 0
0.00.056.288 I llama_new_context_with_model: freq_base     = 10000.0
0.00.056.289 I llama_new_context_with_model: freq_scale    = 1
0.00.056.289 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.056.289 I ggml_metal_init: allocating
0.00.056.292 I ggml_metal_init: found device: Apple M4
0.00.056.294 I ggml_metal_init: picking default device: Apple M4
0.00.056.818 I ggml_metal_init: using embedded metal library
0.00.058.765 I ggml_metal_init: GPU name:   Apple M4
0.00.058.767 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.767 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.768 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.768 I ggml_metal_init: simdgroup reduction   = true
0.00.058.768 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.768 I ggml_metal_init: has bfloat            = true
0.00.058.768 I ggml_metal_init: use bfloat            = true
0.00.058.769 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.769 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.685 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.687 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.700 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.594 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.595 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.596 I llama_new_context_with_model: graph nodes  = 967
0.00.068.596 I llama_new_context_with_model: graph splits = 2
0.00.068.608 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.699.492 I 
0.00.699.532 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.699.537 I perplexity: tokenizing the input ..
0.00.707.219 I perplexity: tokenization took 7.681 ms
0.00.707.222 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.841.565 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.842.701 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.842.726 I llama_perf_context_print:        load time =     686.53 ms
0.00.842.727 I llama_perf_context_print: prompt eval time =     134.12 ms /   128 tokens (    1.05 ms per token,   954.39 tokens per second)
0.00.842.728 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.842.729 I llama_perf_context_print:       total time =     143.24 ms /   129 tokens
0.00.843.178 I ggml_metal_free: deallocating

real	0m0.859s
user	0m0.076s
sys	0m0.127s
```
- q5_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.044 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.075 I main: llama backend init
0.00.000.077 I main: load the model and apply lora adapter, if any
0.00.009.856 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.701 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.016.705 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.707 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.707 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.707 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.708 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.708 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.709 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.709 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.710 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.710 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.710 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.711 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.713 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.716 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.717 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.717 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.809 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.925 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.988 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.990 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.990 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.990 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.991 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.991 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.025.991 I llama_model_loader: - type  f32:  194 tensors
0.00.025.992 I llama_model_loader: - type q5_1:   97 tensors
0.00.025.992 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.294 I llm_load_vocab: special tokens cache size = 25
0.00.052.138 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.140 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.141 I llm_load_print_meta: arch             = gptneox
0.00.052.141 I llm_load_print_meta: vocab type       = BPE
0.00.052.141 I llm_load_print_meta: n_vocab          = 50304
0.00.052.142 I llm_load_print_meta: n_merges         = 50009
0.00.052.142 I llm_load_print_meta: vocab_only       = 0
0.00.052.142 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.142 I llm_load_print_meta: n_embd           = 2048
0.00.052.142 I llm_load_print_meta: n_layer          = 24
0.00.052.145 I llm_load_print_meta: n_head           = 16
0.00.052.146 I llm_load_print_meta: n_head_kv        = 16
0.00.052.146 I llm_load_print_meta: n_rot            = 32
0.00.052.146 I llm_load_print_meta: n_swa            = 0
0.00.052.148 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.148 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.149 I llm_load_print_meta: n_gqa            = 1
0.00.052.150 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.151 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.151 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.152 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.152 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.152 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.152 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.153 I llm_load_print_meta: n_ff             = 8192
0.00.052.153 I llm_load_print_meta: n_expert         = 0
0.00.052.153 I llm_load_print_meta: n_expert_used    = 0
0.00.052.155 I llm_load_print_meta: causal attn      = 1
0.00.052.156 I llm_load_print_meta: pooling type     = 0
0.00.052.156 I llm_load_print_meta: rope type        = 2
0.00.052.156 I llm_load_print_meta: rope scaling     = linear
0.00.052.157 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.157 I llm_load_print_meta: freq_scale_train = 1
0.00.052.157 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.157 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.158 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.158 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.158 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.163 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.163 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.175 I llm_load_print_meta: model type       = 1.4B
0.00.052.175 I llm_load_print_meta: model ftype      = Q5_1
0.00.052.176 I llm_load_print_meta: model params     = 1.41 B
0.00.052.176 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.052.177 I llm_load_print_meta: general.name     = 1.4B
0.00.052.177 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.177 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.177 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.177 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.178 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.178 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.178 I llm_load_print_meta: max token length = 1024
0.00.054.195 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.196 I llm_load_tensors: offloading output layer to GPU
0.00.054.196 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.206 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.054.207 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.055.115 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.116 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.116 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.117 I llama_new_context_with_model: n_batch       = 2048
0.00.055.117 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.117 I llama_new_context_with_model: flash_attn    = 0
0.00.055.117 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.118 I llama_new_context_with_model: freq_scale    = 1
0.00.055.118 I ggml_metal_init: allocating
0.00.055.125 I ggml_metal_init: found device: Apple M4
0.00.055.128 I ggml_metal_init: picking default device: Apple M4
0.00.055.685 I ggml_metal_init: using embedded metal library
0.00.057.665 I ggml_metal_init: GPU name:   Apple M4
0.00.057.666 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.667 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.667 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.667 I ggml_metal_init: simdgroup reduction   = true
0.00.057.669 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.669 I ggml_metal_init: has bfloat            = true
0.00.057.669 I ggml_metal_init: use bfloat            = true
0.00.057.669 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.670 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.541 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.546 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.565 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.599 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.600 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.600 I llama_new_context_with_model: graph nodes  = 967
0.00.086.601 I llama_new_context_with_model: graph splits = 2
0.00.086.608 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.801.051 I main: llama threadpool init, n_threads = 4
0.00.801.089 I 
0.00.801.117 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.801.117 I 
0.00.801.336 I sampler seed: 1234
0.00.801.341 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.801.366 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.801.366 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.801.366 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, literature and art.

If one's life is not happy, one can have no other way but

0.01.638.758 I llama_perf_sampler_print:    sampling time =       1.25 ms /    71 runs   (    0.02 ms per token, 56618.82 tokens per second)
0.01.638.758 I llama_perf_context_print:        load time =     791.19 ms
0.01.638.759 I llama_perf_context_print: prompt eval time =      40.41 ms /     7 tokens (    5.77 ms per token,   173.22 tokens per second)
0.01.638.760 I llama_perf_context_print:        eval time =     793.92 ms /    63 runs   (   12.60 ms per token,    79.35 tokens per second)
0.01.638.760 I llama_perf_context_print:       total time =     837.71 ms /    70 tokens
0.01.638.942 I ggml_metal_free: deallocating

real	0m1.659s
user	0m0.110s
sys	0m0.169s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.727 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.615 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.014.619 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.621 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.621 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.622 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.622 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.622 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.623 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.623 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.624 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.624 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.624 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.625 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.625 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.627 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.628 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.628 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.712 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.753 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.819 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.821 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.821 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.821 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.822 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.822 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.023.823 I llama_model_loader: - type  f32:  194 tensors
0.00.023.823 I llama_model_loader: - type q5_1:   97 tensors
0.00.023.823 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.813 I llm_load_vocab: special tokens cache size = 25
0.00.049.764 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.767 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.767 I llm_load_print_meta: arch             = gptneox
0.00.049.767 I llm_load_print_meta: vocab type       = BPE
0.00.049.768 I llm_load_print_meta: n_vocab          = 50304
0.00.049.768 I llm_load_print_meta: n_merges         = 50009
0.00.049.768 I llm_load_print_meta: vocab_only       = 0
0.00.049.768 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.769 I llm_load_print_meta: n_embd           = 2048
0.00.049.769 I llm_load_print_meta: n_layer          = 24
0.00.049.771 I llm_load_print_meta: n_head           = 16
0.00.049.772 I llm_load_print_meta: n_head_kv        = 16
0.00.049.772 I llm_load_print_meta: n_rot            = 32
0.00.049.773 I llm_load_print_meta: n_swa            = 0
0.00.049.773 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.774 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.775 I llm_load_print_meta: n_gqa            = 1
0.00.049.775 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.776 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.777 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.777 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.777 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.777 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.778 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.778 I llm_load_print_meta: n_ff             = 8192
0.00.049.779 I llm_load_print_meta: n_expert         = 0
0.00.049.779 I llm_load_print_meta: n_expert_used    = 0
0.00.049.779 I llm_load_print_meta: causal attn      = 1
0.00.049.779 I llm_load_print_meta: pooling type     = 0
0.00.049.779 I llm_load_print_meta: rope type        = 2
0.00.049.780 I llm_load_print_meta: rope scaling     = linear
0.00.049.780 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.780 I llm_load_print_meta: freq_scale_train = 1
0.00.049.781 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.781 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.781 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.783 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.783 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.783 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.784 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.791 I llm_load_print_meta: model type       = 1.4B
0.00.049.791 I llm_load_print_meta: model ftype      = Q5_1
0.00.049.791 I llm_load_print_meta: model params     = 1.41 B
0.00.049.792 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.049.792 I llm_load_print_meta: general.name     = 1.4B
0.00.049.792 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.792 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.792 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.793 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.793 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.794 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.794 I llm_load_print_meta: max token length = 1024
0.00.051.553 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.553 I llm_load_tensors: offloading output layer to GPU
0.00.051.554 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.558 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.051.559 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.052.448 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.449 I llama_new_context_with_model: n_ctx         = 128
0.00.052.449 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.449 I llama_new_context_with_model: n_batch       = 128
0.00.052.449 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.449 I llama_new_context_with_model: flash_attn    = 0
0.00.052.450 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.450 I llama_new_context_with_model: freq_scale    = 1
0.00.052.450 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.451 I ggml_metal_init: allocating
0.00.052.454 I ggml_metal_init: found device: Apple M4
0.00.052.456 I ggml_metal_init: picking default device: Apple M4
0.00.052.971 I ggml_metal_init: using embedded metal library
0.00.054.903 I ggml_metal_init: GPU name:   Apple M4
0.00.054.904 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.905 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.905 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.905 I ggml_metal_init: simdgroup reduction   = true
0.00.054.905 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.905 I ggml_metal_init: has bfloat            = true
0.00.054.906 I ggml_metal_init: use bfloat            = true
0.00.054.906 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.906 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.741 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.743 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.756 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.610 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.611 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.611 I llama_new_context_with_model: graph nodes  = 967
0.00.064.611 I llama_new_context_with_model: graph splits = 2
0.00.064.619 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.734.711 I 
0.00.734.741 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.734.746 I perplexity: tokenizing the input ..
0.00.742.484 I perplexity: tokenization took 7.736 ms
0.00.742.489 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.877.441 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.878.693 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.878.722 I llama_perf_context_print:        load time =     725.98 ms
0.00.878.723 I llama_perf_context_print: prompt eval time =     134.73 ms /   128 tokens (    1.05 ms per token,   950.03 tokens per second)
0.00.878.724 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.878.724 I llama_perf_context_print:       total time =     144.01 ms /   129 tokens
0.00.879.131 I ggml_metal_free: deallocating

real	0m0.893s
user	0m0.076s
sys	0m0.120s
```
- q2_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.067 I main: llama backend init
0.00.000.069 I main: load the model and apply lora adapter, if any
0.00.009.654 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.291 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.296 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.297 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.298 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.298 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.298 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.299 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.300 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.300 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.300 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.301 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.301 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.301 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.302 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.303 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.303 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.304 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.408 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.478 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.685 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.686 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.686 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.687 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.687 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.687 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.688 I llama_model_loader: - type  f32:  194 tensors
0.00.024.688 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.688 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.689 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.882 I llm_load_vocab: special tokens cache size = 25
0.00.050.587 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.590 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.590 I llm_load_print_meta: arch             = gptneox
0.00.050.591 I llm_load_print_meta: vocab type       = BPE
0.00.050.591 I llm_load_print_meta: n_vocab          = 50304
0.00.050.591 I llm_load_print_meta: n_merges         = 50009
0.00.050.591 I llm_load_print_meta: vocab_only       = 0
0.00.050.591 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.592 I llm_load_print_meta: n_embd           = 2048
0.00.050.592 I llm_load_print_meta: n_layer          = 24
0.00.050.595 I llm_load_print_meta: n_head           = 16
0.00.050.595 I llm_load_print_meta: n_head_kv        = 16
0.00.050.596 I llm_load_print_meta: n_rot            = 32
0.00.050.596 I llm_load_print_meta: n_swa            = 0
0.00.050.596 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.597 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.598 I llm_load_print_meta: n_gqa            = 1
0.00.050.599 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.600 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.600 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.600 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.602 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.602 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.602 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.603 I llm_load_print_meta: n_ff             = 8192
0.00.050.603 I llm_load_print_meta: n_expert         = 0
0.00.050.605 I llm_load_print_meta: n_expert_used    = 0
0.00.050.606 I llm_load_print_meta: causal attn      = 1
0.00.050.606 I llm_load_print_meta: pooling type     = 0
0.00.050.606 I llm_load_print_meta: rope type        = 2
0.00.050.607 I llm_load_print_meta: rope scaling     = linear
0.00.050.607 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.607 I llm_load_print_meta: freq_scale_train = 1
0.00.050.608 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.608 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.608 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.608 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.608 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.608 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.608 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.621 I llm_load_print_meta: model type       = 1.4B
0.00.050.621 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.050.621 I llm_load_print_meta: model params     = 1.41 B
0.00.050.622 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.050.622 I llm_load_print_meta: general.name     = 1.4B
0.00.050.622 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.622 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.623 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.623 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.624 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.624 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.624 I llm_load_print_meta: max token length = 1024
0.00.052.486 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.486 I llm_load_tensors: offloading output layer to GPU
0.00.052.487 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.496 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.052.497 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.053.407 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.408 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.408 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.408 I llama_new_context_with_model: n_batch       = 2048
0.00.053.408 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.408 I llama_new_context_with_model: flash_attn    = 0
0.00.053.409 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.409 I llama_new_context_with_model: freq_scale    = 1
0.00.053.409 I ggml_metal_init: allocating
0.00.053.417 I ggml_metal_init: found device: Apple M4
0.00.053.421 I ggml_metal_init: picking default device: Apple M4
0.00.053.975 I ggml_metal_init: using embedded metal library
0.00.055.943 I ggml_metal_init: GPU name:   Apple M4
0.00.055.944 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.945 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.945 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.945 I ggml_metal_init: simdgroup reduction   = true
0.00.055.945 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.947 I ggml_metal_init: has bfloat            = true
0.00.055.947 I ggml_metal_init: use bfloat            = true
0.00.055.947 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.949 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.083.991 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.083.998 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.084.017 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.085.045 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.085.046 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.085.047 I llama_new_context_with_model: graph nodes  = 967
0.00.085.047 I llama_new_context_with_model: graph splits = 2
0.00.085.061 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.473.093 I main: llama threadpool init, n_threads = 4
0.00.473.130 I 
0.00.473.157 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.473.157 I 
0.00.473.303 I sampler seed: 1234
0.00.473.308 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.473.321 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.473.321 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.473.321 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.153.397 I llama_perf_sampler_print:    sampling time =       1.18 ms /    71 runs   (    0.02 ms per token, 60271.65 tokens per second)
0.01.153.398 I llama_perf_context_print:        load time =     463.44 ms
0.01.153.399 I llama_perf_context_print: prompt eval time =      35.70 ms /     7 tokens (    5.10 ms per token,   196.09 tokens per second)
0.01.153.400 I llama_perf_context_print:        eval time =     641.40 ms /    63 runs   (   10.18 ms per token,    98.22 tokens per second)
0.01.153.400 I llama_perf_context_print:       total time =     680.31 ms /    70 tokens
0.01.153.581 I ggml_metal_free: deallocating

real	0m1.175s
user	0m0.108s
sys	0m0.106s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.081 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.011.619 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.211 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.019.215 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.216 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.019.217 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.217 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.019.217 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.019.218 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.019.219 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.019.219 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.019.219 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.019.220 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.019.220 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.019.220 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.019.221 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.019.222 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.019.223 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.019.223 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.268 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.024.396 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.615 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.028.616 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.616 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.617 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.617 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.617 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.028.618 I llama_model_loader: - type  f32:  194 tensors
0.00.028.618 I llama_model_loader: - type q2_K:   49 tensors
0.00.028.619 I llama_model_loader: - type q3_K:   48 tensors
0.00.028.619 I llama_model_loader: - type q6_K:    1 tensors
0.00.048.335 I llm_load_vocab: special tokens cache size = 25
0.00.053.990 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.053.995 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.053.995 I llm_load_print_meta: arch             = gptneox
0.00.053.995 I llm_load_print_meta: vocab type       = BPE
0.00.053.996 I llm_load_print_meta: n_vocab          = 50304
0.00.054.001 I llm_load_print_meta: n_merges         = 50009
0.00.054.001 I llm_load_print_meta: vocab_only       = 0
0.00.054.002 I llm_load_print_meta: n_ctx_train      = 2048
0.00.054.002 I llm_load_print_meta: n_embd           = 2048
0.00.054.002 I llm_load_print_meta: n_layer          = 24
0.00.054.005 I llm_load_print_meta: n_head           = 16
0.00.054.006 I llm_load_print_meta: n_head_kv        = 16
0.00.054.006 I llm_load_print_meta: n_rot            = 32
0.00.054.008 I llm_load_print_meta: n_swa            = 0
0.00.054.008 I llm_load_print_meta: n_embd_head_k    = 128
0.00.054.008 I llm_load_print_meta: n_embd_head_v    = 128
0.00.054.009 I llm_load_print_meta: n_gqa            = 1
0.00.054.010 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.054.010 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.054.011 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.054.011 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.054.011 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.054.012 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.054.012 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.054.012 I llm_load_print_meta: n_ff             = 8192
0.00.054.013 I llm_load_print_meta: n_expert         = 0
0.00.054.013 I llm_load_print_meta: n_expert_used    = 0
0.00.054.013 I llm_load_print_meta: causal attn      = 1
0.00.054.013 I llm_load_print_meta: pooling type     = 0
0.00.054.013 I llm_load_print_meta: rope type        = 2
0.00.054.013 I llm_load_print_meta: rope scaling     = linear
0.00.054.014 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.054.014 I llm_load_print_meta: freq_scale_train = 1
0.00.054.014 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.054.014 I llm_load_print_meta: rope_finetuned   = unknown
0.00.054.015 I llm_load_print_meta: ssm_d_conv       = 0
0.00.054.015 I llm_load_print_meta: ssm_d_inner      = 0
0.00.054.015 I llm_load_print_meta: ssm_d_state      = 0
0.00.054.015 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.054.015 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.054.027 I llm_load_print_meta: model type       = 1.4B
0.00.054.027 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.054.028 I llm_load_print_meta: model params     = 1.41 B
0.00.054.028 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.054.029 I llm_load_print_meta: general.name     = 1.4B
0.00.054.029 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.054.029 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.054.029 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.054.029 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.054.029 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.054.031 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.054.031 I llm_load_print_meta: max token length = 1024
0.00.055.897 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.055.897 I llm_load_tensors: offloading output layer to GPU
0.00.055.898 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.055.908 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.055.909 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.056.809 I llama_new_context_with_model: n_seq_max     = 1
0.00.056.810 I llama_new_context_with_model: n_ctx         = 128
0.00.056.810 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.056.810 I llama_new_context_with_model: n_batch       = 128
0.00.056.810 I llama_new_context_with_model: n_ubatch      = 128
0.00.056.811 I llama_new_context_with_model: flash_attn    = 0
0.00.056.811 I llama_new_context_with_model: freq_base     = 10000.0
0.00.056.811 I llama_new_context_with_model: freq_scale    = 1
0.00.056.812 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.056.812 I ggml_metal_init: allocating
0.00.056.815 I ggml_metal_init: found device: Apple M4
0.00.056.817 I ggml_metal_init: picking default device: Apple M4
0.00.057.359 I ggml_metal_init: using embedded metal library
0.00.059.308 I ggml_metal_init: GPU name:   Apple M4
0.00.059.309 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.059.310 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.059.310 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.059.310 I ggml_metal_init: simdgroup reduction   = true
0.00.059.310 I ggml_metal_init: simdgroup matrix mul. = true
0.00.059.311 I ggml_metal_init: has bfloat            = true
0.00.059.311 I ggml_metal_init: use bfloat            = true
0.00.059.311 I ggml_metal_init: hasUnifiedMemory      = true
0.00.059.311 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.718 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.720 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.734 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.628 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.630 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.630 I llama_new_context_with_model: graph nodes  = 967
0.00.068.630 I llama_new_context_with_model: graph splits = 2
0.00.068.643 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.443.353 I 
0.00.443.422 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.443.435 I perplexity: tokenizing the input ..
0.00.451.551 I perplexity: tokenization took 8.117 ms
0.00.451.559 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.583.676 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.584.824 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.584.845 I llama_perf_context_print:        load time =     431.73 ms
0.00.584.846 I llama_perf_context_print: prompt eval time =     131.88 ms /   128 tokens (    1.03 ms per token,   970.57 tokens per second)
0.00.584.847 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.584.848 I llama_perf_context_print:       total time =     141.50 ms /   129 tokens
0.00.585.240 I ggml_metal_free: deallocating

real	0m0.600s
user	0m0.076s
sys	0m0.079s
```
- q3_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.037 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.070 I main: load the model and apply lora adapter, if any
0.00.009.035 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.524 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.014.529 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.531 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.531 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.532 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.532 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.532 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.533 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.533 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.534 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.534 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.535 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.535 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.535 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.536 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.537 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.537 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.459 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.588 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.593 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.595 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.595 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.595 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.595 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.596 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.023.596 I llama_model_loader: - type  f32:  194 tensors
0.00.023.597 I llama_model_loader: - type q3_K:   25 tensors
0.00.023.597 I llama_model_loader: - type q4_K:   71 tensors
0.00.023.597 I llama_model_loader: - type q5_K:    1 tensors
0.00.023.597 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.684 I llm_load_vocab: special tokens cache size = 25
0.00.050.601 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.604 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.604 I llm_load_print_meta: arch             = gptneox
0.00.050.605 I llm_load_print_meta: vocab type       = BPE
0.00.050.605 I llm_load_print_meta: n_vocab          = 50304
0.00.050.605 I llm_load_print_meta: n_merges         = 50009
0.00.050.605 I llm_load_print_meta: vocab_only       = 0
0.00.050.606 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.606 I llm_load_print_meta: n_embd           = 2048
0.00.050.606 I llm_load_print_meta: n_layer          = 24
0.00.050.611 I llm_load_print_meta: n_head           = 16
0.00.050.612 I llm_load_print_meta: n_head_kv        = 16
0.00.050.613 I llm_load_print_meta: n_rot            = 32
0.00.050.613 I llm_load_print_meta: n_swa            = 0
0.00.050.613 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.613 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.614 I llm_load_print_meta: n_gqa            = 1
0.00.050.615 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.615 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.616 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.616 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.617 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.617 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.617 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.618 I llm_load_print_meta: n_ff             = 8192
0.00.050.618 I llm_load_print_meta: n_expert         = 0
0.00.050.618 I llm_load_print_meta: n_expert_used    = 0
0.00.050.618 I llm_load_print_meta: causal attn      = 1
0.00.050.618 I llm_load_print_meta: pooling type     = 0
0.00.050.618 I llm_load_print_meta: rope type        = 2
0.00.050.619 I llm_load_print_meta: rope scaling     = linear
0.00.050.620 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.620 I llm_load_print_meta: freq_scale_train = 1
0.00.050.620 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.620 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.621 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.621 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.621 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.621 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.623 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.635 I llm_load_print_meta: model type       = 1.4B
0.00.050.635 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.050.636 I llm_load_print_meta: model params     = 1.41 B
0.00.050.636 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.050.636 I llm_load_print_meta: general.name     = 1.4B
0.00.050.637 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.637 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.637 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.637 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.637 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.638 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.638 I llm_load_print_meta: max token length = 1024
0.00.052.545 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.545 I llm_load_tensors: offloading output layer to GPU
0.00.052.546 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.556 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.052.557 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.053.540 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.540 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.541 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.541 I llama_new_context_with_model: n_batch       = 2048
0.00.053.541 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.541 I llama_new_context_with_model: flash_attn    = 0
0.00.053.542 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.542 I llama_new_context_with_model: freq_scale    = 1
0.00.053.542 I ggml_metal_init: allocating
0.00.053.547 I ggml_metal_init: found device: Apple M4
0.00.053.550 I ggml_metal_init: picking default device: Apple M4
0.00.054.118 I ggml_metal_init: using embedded metal library
0.00.056.018 I ggml_metal_init: GPU name:   Apple M4
0.00.056.020 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.020 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.021 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.021 I ggml_metal_init: simdgroup reduction   = true
0.00.056.021 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.021 I ggml_metal_init: has bfloat            = true
0.00.056.021 I ggml_metal_init: use bfloat            = true
0.00.056.021 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.022 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.082.655 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.082.663 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.082.685 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.083.665 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.083.666 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.083.666 I llama_new_context_with_model: graph nodes  = 967
0.00.083.666 I llama_new_context_with_model: graph splits = 2
0.00.083.680 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.541.251 I main: llama threadpool init, n_threads = 4
0.00.541.289 I 
0.00.541.331 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.541.332 I 
0.00.541.473 I sampler seed: 1234
0.00.541.478 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.541.511 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.541.514 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.541.515 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do that is most useful to my fellow men?'"

-Albert Einstein

"The way

0.01.285.357 I llama_perf_sampler_print:    sampling time =       1.22 ms /    71 runs   (    0.02 ms per token, 58196.72 tokens per second)
0.01.285.358 I llama_perf_context_print:        load time =     532.21 ms
0.01.285.359 I llama_perf_context_print: prompt eval time =      35.55 ms /     7 tokens (    5.08 ms per token,   196.91 tokens per second)
0.01.285.359 I llama_perf_context_print:        eval time =     705.17 ms /    63 runs   (   11.19 ms per token,    89.34 tokens per second)
0.01.285.360 I llama_perf_context_print:       total time =     744.11 ms /    70 tokens
0.01.285.531 I ggml_metal_free: deallocating

real	0m1.302s
user	0m0.108s
sys	0m0.124s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.082 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.270 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.013.817 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.013.822 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.013.823 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.013.824 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.013.824 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.013.824 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.013.825 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.013.825 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.013.826 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.013.826 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.013.826 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.013.827 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.013.827 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.013.828 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.013.829 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.013.830 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.013.830 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.017.629 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.018.678 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.022.459 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.022.460 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.022.460 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.022.460 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.022.461 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.022.461 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.022.461 I llama_model_loader: - type  f32:  194 tensors
0.00.022.462 I llama_model_loader: - type q3_K:   25 tensors
0.00.022.462 I llama_model_loader: - type q4_K:   71 tensors
0.00.022.462 I llama_model_loader: - type q5_K:    1 tensors
0.00.022.462 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.367 I llm_load_vocab: special tokens cache size = 25
0.00.049.201 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.204 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.204 I llm_load_print_meta: arch             = gptneox
0.00.049.204 I llm_load_print_meta: vocab type       = BPE
0.00.049.205 I llm_load_print_meta: n_vocab          = 50304
0.00.049.205 I llm_load_print_meta: n_merges         = 50009
0.00.049.205 I llm_load_print_meta: vocab_only       = 0
0.00.049.205 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.205 I llm_load_print_meta: n_embd           = 2048
0.00.049.205 I llm_load_print_meta: n_layer          = 24
0.00.049.208 I llm_load_print_meta: n_head           = 16
0.00.049.209 I llm_load_print_meta: n_head_kv        = 16
0.00.049.209 I llm_load_print_meta: n_rot            = 32
0.00.049.209 I llm_load_print_meta: n_swa            = 0
0.00.049.209 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.210 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.210 I llm_load_print_meta: n_gqa            = 1
0.00.049.211 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.212 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.212 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.213 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.213 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.213 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.213 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.214 I llm_load_print_meta: n_ff             = 8192
0.00.049.214 I llm_load_print_meta: n_expert         = 0
0.00.049.214 I llm_load_print_meta: n_expert_used    = 0
0.00.049.214 I llm_load_print_meta: causal attn      = 1
0.00.049.214 I llm_load_print_meta: pooling type     = 0
0.00.049.214 I llm_load_print_meta: rope type        = 2
0.00.049.215 I llm_load_print_meta: rope scaling     = linear
0.00.049.215 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.215 I llm_load_print_meta: freq_scale_train = 1
0.00.049.215 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.216 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.216 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.216 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.216 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.216 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.216 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.230 I llm_load_print_meta: model type       = 1.4B
0.00.049.231 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.049.231 I llm_load_print_meta: model params     = 1.41 B
0.00.049.232 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.049.232 I llm_load_print_meta: general.name     = 1.4B
0.00.049.232 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.232 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.232 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.232 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.233 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.233 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.233 I llm_load_print_meta: max token length = 1024
0.00.051.195 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.195 I llm_load_tensors: offloading output layer to GPU
0.00.051.195 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.205 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.051.206 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.052.172 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.172 I llama_new_context_with_model: n_ctx         = 128
0.00.052.172 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.173 I llama_new_context_with_model: n_batch       = 128
0.00.052.173 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.173 I llama_new_context_with_model: flash_attn    = 0
0.00.052.173 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.174 I llama_new_context_with_model: freq_scale    = 1
0.00.052.174 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.174 I ggml_metal_init: allocating
0.00.052.180 I ggml_metal_init: found device: Apple M4
0.00.052.182 I ggml_metal_init: picking default device: Apple M4
0.00.052.720 I ggml_metal_init: using embedded metal library
0.00.054.674 I ggml_metal_init: GPU name:   Apple M4
0.00.054.675 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.675 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.676 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.677 I ggml_metal_init: simdgroup reduction   = true
0.00.054.677 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.677 I ggml_metal_init: has bfloat            = true
0.00.054.677 I ggml_metal_init: use bfloat            = true
0.00.054.678 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.680 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.713 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.715 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.739 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.553 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.554 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.555 I llama_new_context_with_model: graph nodes  = 967
0.00.064.555 I llama_new_context_with_model: graph splits = 2
0.00.064.562 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.494.676 I 
0.00.494.720 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.494.735 I perplexity: tokenizing the input ..
0.00.502.382 I perplexity: tokenization took 7.645 ms
0.00.502.385 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.634.059 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.635.214 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.635.238 I llama_perf_context_print:        load time =     486.40 ms
0.00.635.239 I llama_perf_context_print: prompt eval time =     131.45 ms /   128 tokens (    1.03 ms per token,   973.76 tokens per second)
0.00.635.240 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.635.240 I llama_perf_context_print:       total time =     140.56 ms /   129 tokens
0.00.635.783 I ggml_metal_free: deallocating

real	0m0.648s
user	0m0.077s
sys	0m0.096s
```
- q4_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.009.491 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.673 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.015.678 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.679 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.680 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.680 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.680 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.685 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.686 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.686 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.687 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.687 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.687 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.688 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.690 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.692 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.692 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.693 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.698 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.755 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.762 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.764 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.764 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.764 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.764 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.765 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.765 I llama_model_loader: - type  f32:  194 tensors
0.00.024.766 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.766 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.766 I llama_model_loader: - type q6_K:   13 tensors
0.00.045.075 I llm_load_vocab: special tokens cache size = 25
0.00.051.002 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.004 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.005 I llm_load_print_meta: arch             = gptneox
0.00.051.005 I llm_load_print_meta: vocab type       = BPE
0.00.051.005 I llm_load_print_meta: n_vocab          = 50304
0.00.051.006 I llm_load_print_meta: n_merges         = 50009
0.00.051.006 I llm_load_print_meta: vocab_only       = 0
0.00.051.006 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.006 I llm_load_print_meta: n_embd           = 2048
0.00.051.006 I llm_load_print_meta: n_layer          = 24
0.00.051.009 I llm_load_print_meta: n_head           = 16
0.00.051.010 I llm_load_print_meta: n_head_kv        = 16
0.00.051.010 I llm_load_print_meta: n_rot            = 32
0.00.051.010 I llm_load_print_meta: n_swa            = 0
0.00.051.011 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.011 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.012 I llm_load_print_meta: n_gqa            = 1
0.00.051.012 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.013 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.014 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.014 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.014 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.014 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.014 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.015 I llm_load_print_meta: n_ff             = 8192
0.00.051.015 I llm_load_print_meta: n_expert         = 0
0.00.051.017 I llm_load_print_meta: n_expert_used    = 0
0.00.051.018 I llm_load_print_meta: causal attn      = 1
0.00.051.018 I llm_load_print_meta: pooling type     = 0
0.00.051.019 I llm_load_print_meta: rope type        = 2
0.00.051.019 I llm_load_print_meta: rope scaling     = linear
0.00.051.019 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.020 I llm_load_print_meta: freq_scale_train = 1
0.00.051.020 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.020 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.020 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.020 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.020 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.021 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.021 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.033 I llm_load_print_meta: model type       = 1.4B
0.00.051.033 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.051.033 I llm_load_print_meta: model params     = 1.41 B
0.00.051.034 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.051.034 I llm_load_print_meta: general.name     = 1.4B
0.00.051.034 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.034 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.035 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.035 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.037 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.037 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.037 I llm_load_print_meta: max token length = 1024
0.00.053.002 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.002 I llm_load_tensors: offloading output layer to GPU
0.00.053.002 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.013 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.053.014 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.053.904 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.905 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.905 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.905 I llama_new_context_with_model: n_batch       = 2048
0.00.053.905 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.905 I llama_new_context_with_model: flash_attn    = 0
0.00.053.906 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.906 I llama_new_context_with_model: freq_scale    = 1
0.00.053.906 I ggml_metal_init: allocating
0.00.053.910 I ggml_metal_init: found device: Apple M4
0.00.053.912 I ggml_metal_init: picking default device: Apple M4
0.00.054.461 I ggml_metal_init: using embedded metal library
0.00.056.374 I ggml_metal_init: GPU name:   Apple M4
0.00.056.376 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.376 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.377 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.378 I ggml_metal_init: simdgroup reduction   = true
0.00.056.378 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.378 I ggml_metal_init: has bfloat            = true
0.00.056.378 I ggml_metal_init: use bfloat            = true
0.00.056.379 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.379 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.082.952 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.082.960 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.082.978 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.084.059 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.084.060 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.084.061 I llama_new_context_with_model: graph nodes  = 967
0.00.084.061 I llama_new_context_with_model: graph splits = 2
0.00.084.069 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.634.252 I main: llama threadpool init, n_threads = 4
0.00.634.289 I 
0.00.634.314 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.634.314 I 
0.00.634.543 I sampler seed: 1234
0.00.634.548 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.634.563 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.634.563 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.634.565 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the greatest power to create the future we want to see. I believe that we are in a wonderful time when people from all over the world are coming together to create a better world. I believe that we are going

0.01.386.647 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58629.23 tokens per second)
0.01.386.647 I llama_perf_context_print:        load time =     624.76 ms
0.01.386.649 I llama_perf_context_print: prompt eval time =      38.91 ms /     7 tokens (    5.56 ms per token,   179.88 tokens per second)
0.01.386.649 I llama_perf_context_print:        eval time =     710.18 ms /    63 runs   (   11.27 ms per token,    88.71 tokens per second)
0.01.386.650 I llama_perf_context_print:       total time =     752.40 ms /    70 tokens
0.01.386.829 I ggml_metal_free: deallocating

real	0m1.406s
user	0m0.109s
sys	0m0.146s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.084 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.329 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.039 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.015.044 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.050 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.050 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.051 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.051 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.051 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.054 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.054 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.054 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.055 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.055 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.055 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.056 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.057 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.057 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.058 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.932 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.966 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.846 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.847 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.847 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.847 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.848 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.848 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.023.848 I llama_model_loader: - type  f32:  194 tensors
0.00.023.849 I llama_model_loader: - type q4_K:   61 tensors
0.00.023.849 I llama_model_loader: - type q5_K:   24 tensors
0.00.023.849 I llama_model_loader: - type q6_K:   13 tensors
0.00.043.814 I llm_load_vocab: special tokens cache size = 25
0.00.049.604 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.607 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.607 I llm_load_print_meta: arch             = gptneox
0.00.049.608 I llm_load_print_meta: vocab type       = BPE
0.00.049.608 I llm_load_print_meta: n_vocab          = 50304
0.00.049.608 I llm_load_print_meta: n_merges         = 50009
0.00.049.609 I llm_load_print_meta: vocab_only       = 0
0.00.049.609 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.609 I llm_load_print_meta: n_embd           = 2048
0.00.049.609 I llm_load_print_meta: n_layer          = 24
0.00.049.611 I llm_load_print_meta: n_head           = 16
0.00.049.612 I llm_load_print_meta: n_head_kv        = 16
0.00.049.613 I llm_load_print_meta: n_rot            = 32
0.00.049.613 I llm_load_print_meta: n_swa            = 0
0.00.049.613 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.613 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.614 I llm_load_print_meta: n_gqa            = 1
0.00.049.615 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.617 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.618 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.618 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.618 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.618 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.619 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.619 I llm_load_print_meta: n_ff             = 8192
0.00.049.619 I llm_load_print_meta: n_expert         = 0
0.00.049.619 I llm_load_print_meta: n_expert_used    = 0
0.00.049.620 I llm_load_print_meta: causal attn      = 1
0.00.049.622 I llm_load_print_meta: pooling type     = 0
0.00.049.622 I llm_load_print_meta: rope type        = 2
0.00.049.622 I llm_load_print_meta: rope scaling     = linear
0.00.049.622 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.623 I llm_load_print_meta: freq_scale_train = 1
0.00.049.623 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.623 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.623 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.623 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.623 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.623 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.624 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.635 I llm_load_print_meta: model type       = 1.4B
0.00.049.636 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.049.636 I llm_load_print_meta: model params     = 1.41 B
0.00.049.636 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.049.637 I llm_load_print_meta: general.name     = 1.4B
0.00.049.637 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.638 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.638 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.638 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.638 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.638 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.638 I llm_load_print_meta: max token length = 1024
0.00.051.150 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.150 I llm_load_tensors: offloading output layer to GPU
0.00.051.151 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.160 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.051.161 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.051.985 I llama_new_context_with_model: n_seq_max     = 1
0.00.051.986 I llama_new_context_with_model: n_ctx         = 128
0.00.051.986 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.051.987 I llama_new_context_with_model: n_batch       = 128
0.00.051.987 I llama_new_context_with_model: n_ubatch      = 128
0.00.051.987 I llama_new_context_with_model: flash_attn    = 0
0.00.051.987 I llama_new_context_with_model: freq_base     = 10000.0
0.00.051.988 I llama_new_context_with_model: freq_scale    = 1
0.00.051.988 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.051.988 I ggml_metal_init: allocating
0.00.051.991 I ggml_metal_init: found device: Apple M4
0.00.051.993 I ggml_metal_init: picking default device: Apple M4
0.00.052.500 I ggml_metal_init: using embedded metal library
0.00.054.494 I ggml_metal_init: GPU name:   Apple M4
0.00.054.495 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.496 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.496 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.496 I ggml_metal_init: simdgroup reduction   = true
0.00.054.496 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.497 I ggml_metal_init: has bfloat            = true
0.00.054.497 I ggml_metal_init: use bfloat            = true
0.00.054.497 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.498 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.416 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.421 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.435 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.337 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.338 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.339 I llama_new_context_with_model: graph nodes  = 967
0.00.064.339 I llama_new_context_with_model: graph splits = 2
0.00.064.352 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.591.474 I 
0.00.591.508 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.591.513 I perplexity: tokenizing the input ..
0.00.599.292 I perplexity: tokenization took 7.776 ms
0.00.599.298 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.733.170 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.734.315 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.734.338 I llama_perf_context_print:        load time =     582.14 ms
0.00.734.340 I llama_perf_context_print: prompt eval time =     133.65 ms /   128 tokens (    1.04 ms per token,   957.76 tokens per second)
0.00.734.341 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.734.341 I llama_perf_context_print:       total time =     142.87 ms /   129 tokens
0.00.734.666 I ggml_metal_free: deallocating

real	0m0.751s
user	0m0.076s
sys	0m0.116s
```
- q5_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.008.671 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.129 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.015.134 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.135 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.136 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.136 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.137 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.137 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.138 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.138 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.139 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.139 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.139 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.140 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.140 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.142 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.143 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.143 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.022 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.017 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.875 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.876 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.876 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.877 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.877 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.877 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.023.878 I llama_model_loader: - type  f32:  194 tensors
0.00.023.878 I llama_model_loader: - type q5_K:   61 tensors
0.00.023.878 I llama_model_loader: - type q6_K:   37 tensors
0.00.044.704 I llm_load_vocab: special tokens cache size = 25
0.00.050.720 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.723 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.723 I llm_load_print_meta: arch             = gptneox
0.00.050.724 I llm_load_print_meta: vocab type       = BPE
0.00.050.724 I llm_load_print_meta: n_vocab          = 50304
0.00.050.724 I llm_load_print_meta: n_merges         = 50009
0.00.050.724 I llm_load_print_meta: vocab_only       = 0
0.00.050.725 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.725 I llm_load_print_meta: n_embd           = 2048
0.00.050.725 I llm_load_print_meta: n_layer          = 24
0.00.050.728 I llm_load_print_meta: n_head           = 16
0.00.050.731 I llm_load_print_meta: n_head_kv        = 16
0.00.050.732 I llm_load_print_meta: n_rot            = 32
0.00.050.732 I llm_load_print_meta: n_swa            = 0
0.00.050.732 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.732 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.733 I llm_load_print_meta: n_gqa            = 1
0.00.050.733 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.734 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.735 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.735 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.735 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.735 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.735 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.742 I llm_load_print_meta: n_ff             = 8192
0.00.050.744 I llm_load_print_meta: n_expert         = 0
0.00.050.744 I llm_load_print_meta: n_expert_used    = 0
0.00.050.746 I llm_load_print_meta: causal attn      = 1
0.00.050.747 I llm_load_print_meta: pooling type     = 0
0.00.050.747 I llm_load_print_meta: rope type        = 2
0.00.050.747 I llm_load_print_meta: rope scaling     = linear
0.00.050.748 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.748 I llm_load_print_meta: freq_scale_train = 1
0.00.050.748 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.749 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.749 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.749 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.749 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.749 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.749 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.762 I llm_load_print_meta: model type       = 1.4B
0.00.050.762 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.050.763 I llm_load_print_meta: model params     = 1.41 B
0.00.050.763 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.050.765 I llm_load_print_meta: general.name     = 1.4B
0.00.050.765 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.766 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.766 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.766 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.766 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.767 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.767 I llm_load_print_meta: max token length = 1024
0.00.052.292 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.292 I llm_load_tensors: offloading output layer to GPU
0.00.052.292 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.301 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.052.302 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.053.128 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.129 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.130 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.130 I llama_new_context_with_model: n_batch       = 2048
0.00.053.130 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.130 I llama_new_context_with_model: flash_attn    = 0
0.00.053.131 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.131 I llama_new_context_with_model: freq_scale    = 1
0.00.053.131 I ggml_metal_init: allocating
0.00.053.138 I ggml_metal_init: found device: Apple M4
0.00.053.141 I ggml_metal_init: picking default device: Apple M4
0.00.053.710 I ggml_metal_init: using embedded metal library
0.00.055.650 I ggml_metal_init: GPU name:   Apple M4
0.00.055.651 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.653 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.653 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.654 I ggml_metal_init: simdgroup reduction   = true
0.00.055.654 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.654 I ggml_metal_init: has bfloat            = true
0.00.055.654 I ggml_metal_init: use bfloat            = true
0.00.055.654 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.655 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.082.946 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.082.951 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.082.970 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.083.945 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.083.947 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.083.947 I llama_new_context_with_model: graph nodes  = 967
0.00.083.947 I llama_new_context_with_model: graph splits = 2
0.00.083.961 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.710.235 I main: llama threadpool init, n_threads = 4
0.00.710.283 I 
0.00.710.307 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.710.307 I 
0.00.710.545 I sampler seed: 1234
0.00.710.549 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.710.596 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.710.614 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.710.614 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.549.383 I llama_perf_sampler_print:    sampling time =       1.21 ms /    71 runs   (    0.02 ms per token, 58629.23 tokens per second)
0.01.549.383 I llama_perf_context_print:        load time =     701.56 ms
0.01.549.384 I llama_perf_context_print: prompt eval time =      38.68 ms /     7 tokens (    5.53 ms per token,   180.99 tokens per second)
0.01.549.385 I llama_perf_context_print:        eval time =     797.06 ms /    63 runs   (   12.65 ms per token,    79.04 tokens per second)
0.01.549.385 I llama_perf_context_print:       total time =     839.15 ms /    70 tokens
0.01.549.558 I ggml_metal_free: deallocating

real	0m1.567s
user	0m0.110s
sys	0m0.164s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.080 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.390 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.204 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.014.209 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.211 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.212 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.212 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.212 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.213 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.213 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.214 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.214 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.215 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.215 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.215 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.216 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.217 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.218 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.218 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.248 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.288 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.371 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.372 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.372 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.373 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.373 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.373 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.023.374 I llama_model_loader: - type  f32:  194 tensors
0.00.023.374 I llama_model_loader: - type q5_K:   61 tensors
0.00.023.374 I llama_model_loader: - type q6_K:   37 tensors
0.00.043.996 I llm_load_vocab: special tokens cache size = 25
0.00.049.921 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.924 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.924 I llm_load_print_meta: arch             = gptneox
0.00.049.925 I llm_load_print_meta: vocab type       = BPE
0.00.049.925 I llm_load_print_meta: n_vocab          = 50304
0.00.049.925 I llm_load_print_meta: n_merges         = 50009
0.00.049.925 I llm_load_print_meta: vocab_only       = 0
0.00.049.925 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.926 I llm_load_print_meta: n_embd           = 2048
0.00.049.926 I llm_load_print_meta: n_layer          = 24
0.00.049.928 I llm_load_print_meta: n_head           = 16
0.00.049.929 I llm_load_print_meta: n_head_kv        = 16
0.00.049.931 I llm_load_print_meta: n_rot            = 32
0.00.049.931 I llm_load_print_meta: n_swa            = 0
0.00.049.932 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.932 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.932 I llm_load_print_meta: n_gqa            = 1
0.00.049.933 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.934 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.934 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.935 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.935 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.935 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.935 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.936 I llm_load_print_meta: n_ff             = 8192
0.00.049.936 I llm_load_print_meta: n_expert         = 0
0.00.049.936 I llm_load_print_meta: n_expert_used    = 0
0.00.049.937 I llm_load_print_meta: causal attn      = 1
0.00.049.937 I llm_load_print_meta: pooling type     = 0
0.00.049.937 I llm_load_print_meta: rope type        = 2
0.00.049.937 I llm_load_print_meta: rope scaling     = linear
0.00.049.938 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.938 I llm_load_print_meta: freq_scale_train = 1
0.00.049.938 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.938 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.938 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.939 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.939 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.939 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.939 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.951 I llm_load_print_meta: model type       = 1.4B
0.00.049.952 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.049.952 I llm_load_print_meta: model params     = 1.41 B
0.00.049.952 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.049.953 I llm_load_print_meta: general.name     = 1.4B
0.00.049.953 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.953 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.953 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.953 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.953 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.954 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.954 I llm_load_print_meta: max token length = 1024
0.00.051.553 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.553 I llm_load_tensors: offloading output layer to GPU
0.00.051.554 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.563 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.051.564 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.052.435 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.436 I llama_new_context_with_model: n_ctx         = 128
0.00.052.436 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.436 I llama_new_context_with_model: n_batch       = 128
0.00.052.436 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.436 I llama_new_context_with_model: flash_attn    = 0
0.00.052.437 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.437 I llama_new_context_with_model: freq_scale    = 1
0.00.052.437 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.438 I ggml_metal_init: allocating
0.00.052.441 I ggml_metal_init: found device: Apple M4
0.00.052.443 I ggml_metal_init: picking default device: Apple M4
0.00.052.993 I ggml_metal_init: using embedded metal library
0.00.054.917 I ggml_metal_init: GPU name:   Apple M4
0.00.054.918 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.919 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.919 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.919 I ggml_metal_init: simdgroup reduction   = true
0.00.054.919 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.919 I ggml_metal_init: has bfloat            = true
0.00.054.920 I ggml_metal_init: use bfloat            = true
0.00.054.920 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.921 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.849 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.853 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.868 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.743 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.744 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.744 I llama_new_context_with_model: graph nodes  = 967
0.00.064.744 I llama_new_context_with_model: graph splits = 2
0.00.064.757 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.680.084 I 
0.00.680.193 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.680.239 I perplexity: tokenizing the input ..
0.00.696.463 I perplexity: tokenization took 16.216 ms
0.00.696.484 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.841.262 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.846.206 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.846.277 I llama_perf_context_print:        load time =     671.68 ms
0.00.846.279 I llama_perf_context_print: prompt eval time =     143.86 ms /   128 tokens (    1.12 ms per token,   889.78 tokens per second)
0.00.846.281 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.846.282 I llama_perf_context_print:       total time =     166.20 ms /   129 tokens
0.00.847.687 I ggml_metal_free: deallocating

real	0m0.877s
user	0m0.118s
sys	0m0.141s
```
- q6_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.070 I main: load the model and apply lora adapter, if any
0.00.009.838 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.637 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.642 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.643 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.648 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.648 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.648 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.649 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.650 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.650 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.650 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.651 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.651 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.651 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.652 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.653 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.653 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.653 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.703 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.829 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.885 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.886 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.886 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.887 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.887 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.887 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.025.888 I llama_model_loader: - type  f32:  194 tensors
0.00.025.888 I llama_model_loader: - type q6_K:   98 tensors
0.00.045.980 I llm_load_vocab: special tokens cache size = 25
0.00.051.915 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.918 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.918 I llm_load_print_meta: arch             = gptneox
0.00.051.918 I llm_load_print_meta: vocab type       = BPE
0.00.051.919 I llm_load_print_meta: n_vocab          = 50304
0.00.051.919 I llm_load_print_meta: n_merges         = 50009
0.00.051.919 I llm_load_print_meta: vocab_only       = 0
0.00.051.919 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.919 I llm_load_print_meta: n_embd           = 2048
0.00.051.919 I llm_load_print_meta: n_layer          = 24
0.00.051.923 I llm_load_print_meta: n_head           = 16
0.00.051.923 I llm_load_print_meta: n_head_kv        = 16
0.00.051.924 I llm_load_print_meta: n_rot            = 32
0.00.051.924 I llm_load_print_meta: n_swa            = 0
0.00.051.924 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.924 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.925 I llm_load_print_meta: n_gqa            = 1
0.00.051.926 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.926 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.929 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.929 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.929 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.929 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.930 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.932 I llm_load_print_meta: n_ff             = 8192
0.00.051.932 I llm_load_print_meta: n_expert         = 0
0.00.051.932 I llm_load_print_meta: n_expert_used    = 0
0.00.051.932 I llm_load_print_meta: causal attn      = 1
0.00.051.933 I llm_load_print_meta: pooling type     = 0
0.00.051.933 I llm_load_print_meta: rope type        = 2
0.00.051.933 I llm_load_print_meta: rope scaling     = linear
0.00.051.933 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.934 I llm_load_print_meta: freq_scale_train = 1
0.00.051.934 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.935 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.935 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.936 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.936 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.936 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.936 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.948 I llm_load_print_meta: model type       = 1.4B
0.00.051.948 I llm_load_print_meta: model ftype      = Q6_K
0.00.051.949 I llm_load_print_meta: model params     = 1.41 B
0.00.051.949 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.051.949 I llm_load_print_meta: general.name     = 1.4B
0.00.051.950 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.950 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.950 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.951 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.951 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.952 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.952 I llm_load_print_meta: max token length = 1024
0.00.053.984 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.984 I llm_load_tensors: offloading output layer to GPU
0.00.053.984 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.994 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.053.995 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.054.972 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.973 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.973 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.974 I llama_new_context_with_model: n_batch       = 2048
0.00.054.974 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.974 I llama_new_context_with_model: flash_attn    = 0
0.00.054.974 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.975 I llama_new_context_with_model: freq_scale    = 1
0.00.054.975 I ggml_metal_init: allocating
0.00.054.978 I ggml_metal_init: found device: Apple M4
0.00.054.980 I ggml_metal_init: picking default device: Apple M4
0.00.055.518 I ggml_metal_init: using embedded metal library
0.00.057.439 I ggml_metal_init: GPU name:   Apple M4
0.00.057.440 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.441 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.441 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.441 I ggml_metal_init: simdgroup reduction   = true
0.00.057.441 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.442 I ggml_metal_init: has bfloat            = true
0.00.057.442 I ggml_metal_init: use bfloat            = true
0.00.057.442 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.443 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.086.177 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.182 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.086.201 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.298 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.300 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.300 I llama_new_context_with_model: graph nodes  = 967
0.00.087.301 I llama_new_context_with_model: graph splits = 2
0.00.087.314 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.760.388 I main: llama threadpool init, n_threads = 4
0.00.760.424 I 
0.00.760.451 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.760.452 I 
0.00.760.716 I sampler seed: 1234
0.00.760.720 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.760.751 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.760.752 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.760.752 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.01.625.786 I llama_perf_sampler_print:    sampling time =       1.17 ms /    71 runs   (    0.02 ms per token, 60477.00 tokens per second)
0.01.625.786 I llama_perf_context_print:        load time =     750.55 ms
0.01.625.787 I llama_perf_context_print: prompt eval time =      38.45 ms /     7 tokens (    5.49 ms per token,   182.06 tokens per second)
0.01.625.788 I llama_perf_context_print:        eval time =     823.62 ms /    63 runs   (   13.07 ms per token,    76.49 tokens per second)
0.01.625.791 I llama_perf_context_print:       total time =     865.40 ms /    70 tokens
0.01.625.968 I ggml_metal_free: deallocating

real	0m1.646s
user	0m0.109s
sys	0m0.169s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.178 I build: 4216 (436f36a4) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.016.556 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.026.449 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.026.455 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.026.457 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.026.457 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.026.458 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.026.458 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.026.459 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.026.459 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.026.460 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.026.460 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.026.461 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.026.461 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.026.461 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.026.462 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.026.463 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.026.464 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.026.464 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.032.626 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.034.130 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.039.487 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.039.488 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.039.489 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.039.489 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.039.489 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.039.490 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.039.490 I llama_model_loader: - type  f32:  194 tensors
0.00.039.491 I llama_model_loader: - type q6_K:   98 tensors
0.00.063.052 I llm_load_vocab: special tokens cache size = 25
0.00.068.909 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.068.911 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.068.912 I llm_load_print_meta: arch             = gptneox
0.00.068.912 I llm_load_print_meta: vocab type       = BPE
0.00.068.912 I llm_load_print_meta: n_vocab          = 50304
0.00.068.912 I llm_load_print_meta: n_merges         = 50009
0.00.068.912 I llm_load_print_meta: vocab_only       = 0
0.00.068.913 I llm_load_print_meta: n_ctx_train      = 2048
0.00.068.913 I llm_load_print_meta: n_embd           = 2048
0.00.068.913 I llm_load_print_meta: n_layer          = 24
0.00.068.916 I llm_load_print_meta: n_head           = 16
0.00.068.918 I llm_load_print_meta: n_head_kv        = 16
0.00.068.918 I llm_load_print_meta: n_rot            = 32
0.00.068.918 I llm_load_print_meta: n_swa            = 0
0.00.068.918 I llm_load_print_meta: n_embd_head_k    = 128
0.00.068.918 I llm_load_print_meta: n_embd_head_v    = 128
0.00.068.919 I llm_load_print_meta: n_gqa            = 1
0.00.068.920 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.068.921 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.068.921 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.068.922 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.068.922 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.068.922 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.068.922 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.068.923 I llm_load_print_meta: n_ff             = 8192
0.00.068.923 I llm_load_print_meta: n_expert         = 0
0.00.068.923 I llm_load_print_meta: n_expert_used    = 0
0.00.068.923 I llm_load_print_meta: causal attn      = 1
0.00.068.923 I llm_load_print_meta: pooling type     = 0
0.00.068.923 I llm_load_print_meta: rope type        = 2
0.00.068.924 I llm_load_print_meta: rope scaling     = linear
0.00.068.924 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.068.926 I llm_load_print_meta: freq_scale_train = 1
0.00.068.926 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.068.926 I llm_load_print_meta: rope_finetuned   = unknown
0.00.068.926 I llm_load_print_meta: ssm_d_conv       = 0
0.00.068.926 I llm_load_print_meta: ssm_d_inner      = 0
0.00.068.927 I llm_load_print_meta: ssm_d_state      = 0
0.00.068.927 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.068.927 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.068.933 I llm_load_print_meta: model type       = 1.4B
0.00.068.934 I llm_load_print_meta: model ftype      = Q6_K
0.00.068.938 I llm_load_print_meta: model params     = 1.41 B
0.00.068.938 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.068.939 I llm_load_print_meta: general.name     = 1.4B
0.00.068.940 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.068.940 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.068.940 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.068.940 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.068.940 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.068.941 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.068.941 I llm_load_print_meta: max token length = 1024
0.00.070.756 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.070.756 I llm_load_tensors: offloading output layer to GPU
0.00.070.756 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.070.761 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.070.762 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.071.817 I llama_new_context_with_model: n_seq_max     = 1
0.00.071.818 I llama_new_context_with_model: n_ctx         = 128
0.00.071.818 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.071.818 I llama_new_context_with_model: n_batch       = 128
0.00.071.818 I llama_new_context_with_model: n_ubatch      = 128
0.00.071.818 I llama_new_context_with_model: flash_attn    = 0
0.00.071.819 I llama_new_context_with_model: freq_base     = 10000.0
0.00.071.819 I llama_new_context_with_model: freq_scale    = 1
0.00.071.819 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.071.820 I ggml_metal_init: allocating
0.00.071.823 I ggml_metal_init: found device: Apple M4
0.00.071.827 I ggml_metal_init: picking default device: Apple M4
0.00.072.388 I ggml_metal_init: using embedded metal library
0.00.074.297 I ggml_metal_init: GPU name:   Apple M4
0.00.074.298 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.074.299 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.074.299 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.074.299 I ggml_metal_init: simdgroup reduction   = true
0.00.074.299 I ggml_metal_init: simdgroup matrix mul. = true
0.00.074.299 I ggml_metal_init: has bfloat            = true
0.00.074.299 I ggml_metal_init: use bfloat            = true
0.00.074.301 I ggml_metal_init: hasUnifiedMemory      = true
0.00.074.301 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.083.330 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.083.335 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.083.349 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.084.269 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.084.270 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.084.270 I llama_new_context_with_model: graph nodes  = 967
0.00.084.271 I llama_new_context_with_model: graph splits = 2
0.00.084.283 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.224.583 I 
0.00.224.616 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | AARCH64_REPACK = 1 | 
0.00.224.620 I perplexity: tokenizing the input ..
0.00.233.578 I perplexity: tokenization took 8.956 ms
0.00.233.581 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.374.244 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.375.381 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.375.426 I llama_perf_context_print:        load time =     208.02 ms
0.00.375.427 I llama_perf_context_print: prompt eval time =     140.40 ms /   128 tokens (    1.10 ms per token,   911.68 tokens per second)
0.00.375.428 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.375.429 I llama_perf_context_print:       total time =     150.84 ms /   129 tokens
0.00.375.953 I ggml_metal_free: deallocating

real	0m0.402s
user	0m0.096s
sys	0m0.054s
```
- save-load-state: 
```
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4216 (436f36a4)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13c30b5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13c30bcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13c30c2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13c30c850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13c30ce00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13c30d3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13c30d960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13c30df10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13c30e4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13c30e9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13c30eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13c30f3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13c30fee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13c310690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13c310ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13c3115c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13c311ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13c312400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13c312b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13c3132f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13c313a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13c314130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13c314850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13c3150f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13c315810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13c315ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13c3160e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13c316d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13c317290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13c317550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13c3179f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13c317cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13c318540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13c318a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13c318d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13c3191e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13c319680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13c319b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13c319fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13c31a460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13c31a900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13c31ada0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13c31b240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13c31b6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13c31b9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13c31bfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13c31c5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13c31cee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13c31d4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13c31db00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13c31e110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13c31e720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13c31ed30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13c31f340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13c31fb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13c31ffd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13c320470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13c320730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13c320d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13c321530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13c3217f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13c321c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13c322130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13c3225d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13c322a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13c322f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13c3233b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13c323850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13c323cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13c324190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13c324630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13c324ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13c324f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13c325410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13c3258b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13c325d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13c3261f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13c326690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13c326b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13c326fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13c327470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13c327910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13c327db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13c328250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13c3286f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13c328b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13c329030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13c3294d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13c329970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13c329e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13c32a2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13c32a750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13c32abf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13c32b090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13c32b530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13c32b9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13c32be70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13c31cbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13c32c4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13c32c960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13c32ce00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13c32d2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13c32d740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13c32dbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13c32e080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13c32e520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13c32e9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13c32ee60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13c32f300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13c32f7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13c32fc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13c3300e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13c330580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13c330a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13c330ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13c331360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13c331800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13c331ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13c332140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13c3325e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13c332a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13c332f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13c3333c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13c333860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13c333d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13c3341a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13c334640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13c334ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13c334f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13c335420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13c3358c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13c335d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13c336200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13c3366a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13c336b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13c336fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13c337480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13c337920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13c337dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13c338260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13c338700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13c338ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13c339040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13c3394e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13c339980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13c339e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13c33a2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13c33a760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13c33ac00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13c33b0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13c33b540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13c33b9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13c33be80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13c33c3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13c33c920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13c33ce70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13c33d3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13c33d680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13c33dc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13c33e2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13c33e8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13c33eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13c33f4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13c33fcc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13c340160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13c340600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13c340aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13c341250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13c3417a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13c341cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13c342240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13c342790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13c342ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13c343230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13c343780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13c343cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13c344220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13c344770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13c344cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13c345210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13c345760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13c345cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13c346200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13c346750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13c346ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13c3471f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13c347740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13c347c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13c3481e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13c348730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13c348c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13c3491d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13c349720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13c349c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13c34a1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13c34a710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13c34ac60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13c34b1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13c34b700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13c34bc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13c34c1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13c34c6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13c34cc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13c34d190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13c34d6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13c34dc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13c34e180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13c34e6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13c34ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13c34f170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13c34f6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13c34fc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13c350160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13c3506b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13c350c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13c351150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13c3516a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13c351bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13c352140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13c352690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13c352be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13c353130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13c353680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13c353bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13c354070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13c354510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13c3549b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13c354e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13c3552f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13c355790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13c355c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13c3560d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13c356570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13c356a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13c356eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13c357350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13c3577f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13c357d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13c358460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13c358b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13c3592a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13c3599c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13c359c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13c35a290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13c35a8a0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.150.338 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13c30fbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13c310050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13c3104c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13c310930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13c310da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13c311210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13c311680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13c311af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13c311f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13c3123d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13c312840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13c312cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13c3135a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13c313d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13c314500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13c314bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13c3152e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13c3159d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13c3160c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13c316a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13c317130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13c317820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13c317f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13c318600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13c318cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13c319160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13c3195d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13c319a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13c319eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13c31a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13c31a790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13c31ac00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13c31b070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13c31b330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13c31b7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13c31bc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13c31c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13c31c4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13c31c960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13c31cdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13c31d240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13c31d6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13c31db20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13c31df90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13c31e400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13c31e870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13c31ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13c31f150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13c31f5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13c31fa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13c31fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13c320310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13c320780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13c320bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13c321060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13c3214d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13c321940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13c321db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13c322220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13c322690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13c322b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13c322f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13c3233e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13c323850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13c323cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13c324130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13c3245a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13c324a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13c324e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13c3252f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13c325760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13c325bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13c326040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13c3264b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13c326920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13c326d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13c327200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13c327670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13c327ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13c327f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13c3283c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13c328830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13c328ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13c329110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13c329580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13c3299f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13c329e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13c32a2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13c32a740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13c32abb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13c32b020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13c32b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13c32b900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13c32bd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13c32c1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13c32c650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13c32cac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13c32cf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13c32d3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13c32d810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13c32dc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13c32e0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13c32e560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13c32e9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13c32ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13c32f2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13c32f720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13c32fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13c330000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13c330470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13c3308e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13c330d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13c3311c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13c331630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13c331aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13c331f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13c332380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13c3327f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13c332c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13c3330d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13c333540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13c3339b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13c333e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13c334290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13c334700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13c334b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13c334fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13c335450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13c3358c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13c335d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13c3361a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13c336610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13c336a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13c336ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13c337360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13c3377d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13c337c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13c3380b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13c338520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13c338990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13c338e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13c339270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13c3396e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13c339b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13c339fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13c33a430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13c33a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13c33ad10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13c33b180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13c33b5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13c33ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13c33bed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13c33c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13c33c7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13c33cc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13c33d090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13c33d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13c33d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13c33dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13c33e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13c33e6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13c33eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13c33efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13c33f410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13c33f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13c33fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13c340160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13c3408e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13c340d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13c3411c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13c341630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13c341aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13c341f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13c342380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13c3427f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13c342c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13c3430d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13c343540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13c3439b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13c343e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13c344290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13c344700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13c344b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13c344fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13c345450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13c3458c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13c345d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13c3461a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13c346610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13c346a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13c346ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13c347360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13c3477d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13c347c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13c3480b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13c348520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13c348990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13c348e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13c349270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13c3496e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13c349b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13c349fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13c34a430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13c34a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13c34ad10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13c34b180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13c34b5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13c34ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13c34bed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13c34c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13c34c7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13c34cc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13c34d090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13c34d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13c34d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13c34dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13c34e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13c34e6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13c34eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13c34efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13c34f410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13c34f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13c34fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13c350160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13c3505d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13c350a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13c350eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13c351320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13c351790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13c351c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13c352070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13c3524e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13c352950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13c352dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13c353230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13c3536a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13c353b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13c353f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13c354670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13c354d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13c355450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13c355b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13c355fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13c356420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13c356890 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x13c30fbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x13c310050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x13c3104c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x13c310930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x13c310da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x13c311210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13c311680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13c311af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x13c311f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x13c3123d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x13c312840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13c312cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13c3135a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13c313d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13c314500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13c314bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13c3152e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13c3159d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13c3160c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13c316a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13c317130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13c317820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x13c317f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x13c318600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x13c318cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x13c319160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x13c3195d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x13c319a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x13c319eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x13c31a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x13c31a790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x13c31ac00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x13c31b070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x13c31b330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x13c31b7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x13c31bc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x13c31c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x13c31c4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x13c31c960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x13c31cdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x13c31d240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x13c31d6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x13c31db20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x13c31df90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x13c31e400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x13c31e870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x13c31ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x13c31f150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x13c31f5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x13c31fa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x13c31fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x13c320310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x13c320780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x13c320bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x13c321060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x13c3214d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x13c321940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x13c321db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13c322220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13c322690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13c322b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13c322f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13c3233e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13c323850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13c323cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13c324130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13c3245a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13c324a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13c324e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13c3252f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13c325760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13c325bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13c326040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x13c3264b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x13c326920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13c326d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13c327200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13c327670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13c327ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13c327f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13c3283c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13c328830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13c328ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13c329110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13c329580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13c3299f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13c329e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13c32a2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13c32a740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13c32abb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13c32b020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13c32b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13c32b900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13c32bd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13c32c1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13c32c650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13c32cac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x13c32cf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x13c32d3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x13c32d810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x13c32dc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x13c32e0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x13c32e560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x13c32e9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x13c32ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x13c32f2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x13c32f720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x13c32fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x13c330000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x13c330470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x13c3308e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x13c330d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x13c3311c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x13c331630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x13c331aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x13c331f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x13c332380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x13c3327f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x13c332c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x13c3330d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x13c333540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x13c3339b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x13c333e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x13c334290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x13c334700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x13c334b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x13c334fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x13c335450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x13c3358c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x13c335d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x13c3361a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x13c336610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x13c336a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13c336ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13c337360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13c3377d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13c337c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13c3380b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13c338520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13c338990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13c338e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13c339270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13c3396e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13c339b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13c339fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13c33a430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13c33a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13c33ad10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13c33b180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13c33b5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13c33ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13c33bed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13c33c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13c33c7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13c33cc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x13c33d090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x13c33d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x13c33d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x13c33dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x13c33e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x13c33e6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x13c33eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x13c33efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x13c33f410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x13c33f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x13c33fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x13c340160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x13c3408e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x13c340d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x13c3411c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x13c341630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x13c341aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x13c341f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x13c342380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x13c3427f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x13c342c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x13c3430d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x13c343540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x13c3439b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x13c343e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x13c344290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x13c344700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x13c344b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x13c344fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x13c345450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x13c3458c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x13c345d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13c3461a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13c346610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13c346a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13c346ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13c347360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13c3477d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13c347c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13c3480b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13c348520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13c348990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13c348e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13c349270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13c3496e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13c349b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13c349fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13c34a430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13c34a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13c34ad10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13c34b180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13c34b5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13c34ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x13c34bed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x13c34c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x13c34c7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x13c34cc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x13c34d090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x13c34d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x13c34d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x13c34dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x13c34e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x13c34e6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x13c34eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x13c34efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x13c34f410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x13c34f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x13c34fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x13c350160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x13c3505d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x13c350a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x13c350eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x13c351320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x13c351790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x13c351c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x13c352070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x13c3524e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x13c352950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x13c352dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x13c353230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x13c3536a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x13c353b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x13c353f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x13c354670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x13c354d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13c355450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13c355b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13c355fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13c356420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13c356890 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.860s
user	0m0.287s
sys	0m0.306s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4216 (436f36a4)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x156f10240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x156f10970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x156f10f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x156f114d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x156f11a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x156f12030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x156f125e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x156f12b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x156f13140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x156f13640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x156f13b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x156f14040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x156f14b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x156f15310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x156f15b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x156f16240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x156f16960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x156f17080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x156f177a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x156f17f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x156f18690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x156f18db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x156f194d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x156f19d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x156f1a490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x156f1a750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x156f1ad60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x156f1b9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x156f1bf10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x156f1c1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x156f1c670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x156f1c930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x156f1d1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x156f1d700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x156f1d9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x156f1de60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x156f1e300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x156f1e7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x156f1ec40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x156f1f0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x156f1f580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x156f1fa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x156f1fec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x156f20360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x156f20620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x156f20c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x156f21240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x156f21b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x156f22170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x156f22780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x156f22d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x156f233a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x156f239b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x156f23fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x156f247b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x156f24c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x156f250f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x156f253b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x156f259c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x156f261b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x156f26470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x156f26910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x156f26db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x156f27250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x156f276f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x156f27b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x156f28030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x156f284d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x156f28970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x156f28e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x156f292b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x156f29750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x156f29bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x156f2a090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x156f2a530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x156f2a9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x156f2ae70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x156f2b310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x156f2b7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x156f2bc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x156f2c0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x156f2c590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x156f2ca30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x156f2ced0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x156f2d370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x156f2d810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x156f2dcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x156f2e150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x156f2e5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x156f2ea90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x156f2ef30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x156f2f3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x156f2f870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x156f2fd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x156f301b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x156f30650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x156f30af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x156f21850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x156f31140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x156f315e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x156f31a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x156f31f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x156f323c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x156f32860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x156f32d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x156f331a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x156f33640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x156f33ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x156f33f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x156f34420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x156f348c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x156f34d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x156f35200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x156f356a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x156f35b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x156f35fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x156f36480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x156f36920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x156f36dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x156f37260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x156f37700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x156f37ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x156f38040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x156f384e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x156f38980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x156f38e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x156f392c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x156f39760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x156f39c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x156f3a0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x156f3a540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x156f3a9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x156f3ae80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x156f3b320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x156f3b7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x156f3bc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x156f3c100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x156f3c5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x156f3ca40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x156f3cee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x156f3d380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x156f3d820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x156f3dcc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x156f3e160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x156f3e600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x156f3eaa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x156f3ef40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x156f3f3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x156f3f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x156f3fd20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x156f401c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x156f40660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x156f40b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x156f41050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x156f415a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x156f41af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x156f42040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x156f42300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x156f42910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x156f42f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x156f43530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x156f43b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x156f44150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x156f44940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x156f44de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x156f45280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x156f45720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x156f45ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x156f46420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x156f46970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x156f46ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x156f47410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x156f47960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x156f47eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x156f48400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x156f48950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x156f48ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x156f493f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x156f49940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x156f49e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x156f4a3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x156f4a930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x156f4ae80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x156f4b3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x156f4b920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x156f4be70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x156f4c3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x156f4c910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x156f4ce60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x156f4d3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x156f4d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x156f4de50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x156f4e3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x156f4e8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x156f4ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x156f4f390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x156f4f8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x156f4fe30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x156f50380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x156f508d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x156f50e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x156f51370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x156f518c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x156f51e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x156f52360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x156f528b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x156f52e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x156f53350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x156f538a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x156f53df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x156f54340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x156f54890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x156f54de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x156f55330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x156f55880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x156f55dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x156f56320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x156f56870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x156f56dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x156f57310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x156f57860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x156f57db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x156f58300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x156f58850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x156f58cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x156f59190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x156f59630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x156f59ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x156f59f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x156f5a410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x156f5a8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x156f5ad50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x156f5b1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x156f5b690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x156f5bb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x156f5bfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x156f5c470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x156f5c9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x156f5d0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x156f5d800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x156f5df20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x156f5e640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x156f5e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x156f5ef10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x156f5f520 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.082.182 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x108304bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x108305040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x1083054b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x108305920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x108305d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x108306200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x108306670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x108306ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x108306f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x1083073c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x108307830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x108307f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x108308a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x1083091f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x108309a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x10830a120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x10830a840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x10830af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x10830b680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x10830bdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x10830c4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x10830cbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x10830d310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x10830da30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x10830e150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x10830e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x10830e6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x10830eb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x10830efb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x10830f420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x10830f890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x10830fdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x108310230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x1083104f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x108310960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x108310dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x108311240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x1083116b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x108311b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x108311f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x108312400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x108312870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x108312ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x108313150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x1083135c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x108313a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x108313ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x108314310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x108314780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x108314bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x108315060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x1083154d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x108315940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x108315db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x108316220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x108316690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x108316c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x108317100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x108317570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x1083179e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x108317e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x1083182c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x108318730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x108318ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x108319010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x108319480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x1083198f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x108319d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x10831a1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x10831a640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x10831aab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x10831af20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x10831b390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x10831b800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x10831bc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x10831c0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x10831c550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x10831c9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x10831ce30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x10831d2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x10831d710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x10831db80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x10831dff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x10831e460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x10831e8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x10831ed40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x10831f1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x10831f620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x10831fa90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x10831ff00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x108320370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x1083207e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x108320c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x1083210c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x108321530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x1083219a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x108321e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x108322280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x1083226f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x108322b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x108322fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x108323440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x1083238b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x108323d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x108324190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x108324600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x108324a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x108324ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x108325350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x1083257c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x108325c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x1083260a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x108326510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x108326980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x108326df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x108327260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x1083276d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x108327b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x108327fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x108328420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x108328890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x108328d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x108329170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x1083295e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x108329a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x108329ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x10832a330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x10832a7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x10832ac10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x10832b080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x10832b4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x10832b960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x10832bdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x10832c240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x10832c6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x10832cb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x10832cf90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x10832d400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x10832d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x10832dce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x10832e150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x10832e5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x10832ea30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x10832eea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x10832f310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x10832f780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x10832fbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x108330060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x1083304d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x108330940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x108330db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x108331220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x108331690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x108331b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x108331f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x1083323e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x108332850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x108332cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x108333130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x1083335a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x108333a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x108333e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x1083342f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x108334760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x108334bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x108335040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x1083354b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x108336040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x108336300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x1083365c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x108336a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x108336ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x108337310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x108337780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x108337bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x108338060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x1083384d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x108338940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x108338db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x108339220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x108339690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x108339b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x108339f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x10833a3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x10833a850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x10833acc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x10833b130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x10833b5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x10833ba10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x10833be80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x10833c2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x10833c760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x10833cbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x10833d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x10833d4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x10833d920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x10833dd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x10833e200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x10833e670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x10833eae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x10833ef50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x10833f3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x10833f830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x10833fca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x108340110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x108340580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x1083409f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x108340e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x1083412d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x108341740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x108341bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x108342020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x108342490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x108342900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x108342d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x1083431e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x108343650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x108343ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x108343f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x1083443a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x108344810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x108344c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x1083450f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x108345560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x1083459d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x108345e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x1083462b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x108346720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x108346b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x108347000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x108347470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x1083478e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x108347d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x1083481c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x108348630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x108348aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x108348f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x108349380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x108349ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x10834a5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x10834ad00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x10834b420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x10834b6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x10834b9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x10834be10 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x158004520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x158004990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x158004e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x158005270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x1580056e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x158005b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x158005fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x158006430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x1580068a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x158006d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x158007180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x158007870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x158008390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x158008b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x158009350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x158009a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x15800a190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x15800a8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x15800afd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x15800b700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x15800be20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x15800c540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x15800cc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x15800d380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x15800daa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x15800dd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x15800e020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x15800e490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x15800e900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x15800ed70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x15800f1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x15800f710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x15800fb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x15800fe40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x1580102b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x158010720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x158010b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x158011000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x158011470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x1580118e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x158011d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x1580121c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x158012630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x158012aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x158012f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x158013380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x1580137f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x158013c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x1580140d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x158014540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x1580149b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x158014e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x158015290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x158015700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x158015b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x158015fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x158016550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x158016a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x158016ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x158017330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x1580177a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x158017c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x158018080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x1580184f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x158018960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x158018dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x158019240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x1580196b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x158019b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x158019f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x15801a400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x15801a870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x15801ace0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x15801b150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x15801b5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x15801ba30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x15801bea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x15801c310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x15801c780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x15801cbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x15801d060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x15801d4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x15801d940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x15801ddb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x15801e220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x15801e690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x15801eb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x15801ef70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x15801f3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x15801f850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x15801fcc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x158020130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x1580205a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x158020a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x158020e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x1580212f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x158021760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x158021bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x158022040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x1580224b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x158022920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x158022d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x158023200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x158023670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x158023ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x158023f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x1580243c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x158024830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x158024ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x158025110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x158025580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x1580259f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x158025e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x1580262d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x158026740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x158026bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x158027020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x158027490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x158027900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x158027d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x1580281e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x158028650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x158028ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x158028f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x1580293a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x158029810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x158029c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x15802a0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x15802a560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x15802a9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x15802ae40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x15802b2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x15802b720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x15802bb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x15802c000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x15802c470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x15802c8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x15802cd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x15802d1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x15802d630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x15802daa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x15802df10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x15802e380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x15802e7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x15802ec60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x15802f0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x15802f540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x15802f9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x15802fe20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x158030290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x158030700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x158030b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x158030fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x158031450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x1580318c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x158031d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x1580321a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x158032610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x158032a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x158032ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x158033360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x1580337d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x158033c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x1580340b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x158034520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x158034990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x158034e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x158035990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x158035c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x158035f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x158036380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x1580367f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x158036c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x1580370d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x158037540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x1580379b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x158037e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x158038290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x158038700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x158038b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x158038fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x158039450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x1580398c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x158039d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x15803a1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x15803a610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x15803aa80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x15803aef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x15803b360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x15803b7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x15803bc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x15803c0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x15803c520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x15803c990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x15803ce00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x15803d270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x15803d6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x15803db50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x15803dfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x15803e430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x15803e8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x15803ed10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x15803f180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x15803f5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x15803fa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x15803fed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x158040340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x1580407b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x158040c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x158041090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x158041500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x158041970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x158041de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x158042250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x1580426c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x158042b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x158042fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x158043410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x158043880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x158043cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x158044160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x1580445d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x158044a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x158044eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x158045320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x158045790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x158045c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x158046070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x1580464e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x158046950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x158046dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x158047230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x1580476a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x158047b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x158047f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x1580483f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x158048860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x158048cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x158049810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x158049f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x15804a650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x15804ad70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x15804b030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x15804b2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x15804b760 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


second run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


single seq run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this

real	0m0.920s
user	0m0.238s
sys	0m0.135s
```
### ctest_with_model_debug

Runs ctest with model files in debug mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-debug
    Start 23: test-model-load-cancel
1/2 Test #23: test-model-load-cancel ...........   Passed    0.54 sec
    Start 24: test-autorelease
2/2 Test #24: test-autorelease .................   Passed    0.58 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   1.12 sec*proc (2 tests)

Total Test time (real) =   1.13 sec
        1.15 real         0.73 user         0.05 sys
```
### ctest_with_model_release

Runs ctest with model files in release mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-release
    Start 23: test-model-load-cancel
1/2 Test #23: test-model-load-cancel ...........   Passed    0.25 sec
    Start 24: test-autorelease
2/2 Test #24: test-autorelease .................   Passed    0.26 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   0.51 sec*proc (2 tests)

Total Test time (real) =   0.51 sec
        0.52 real         0.14 user         0.04 sys
```
