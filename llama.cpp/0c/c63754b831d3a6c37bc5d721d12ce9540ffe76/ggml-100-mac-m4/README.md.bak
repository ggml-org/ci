### ctest_debug

Runs ctest in debug mode
- status: 0
```
+ ctest --output-on-failure -L main -E test-opt
Test project /Users/ggml/work/llama.cpp/build-ci-debug
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.33 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    1.81 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.24 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.70 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.43 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.33 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    1.48 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.07 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.34 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.07 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    1.01 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.33 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.33 sec
      Start 14: test-tokenizer-1-llama-spm
14/27 Test #14: test-tokenizer-1-llama-spm ........   Passed    1.05 sec
      Start 15: test-log
15/27 Test #15: test-log ..........................   Passed    0.23 sec
      Start 16: test-arg-parser
16/27 Test #16: test-arg-parser ...................   Passed    0.38 sec
      Start 17: test-sampling
17/27 Test #17: test-sampling .....................   Passed    2.24 sec
      Start 18: test-chat-template
18/27 Test #18: test-chat-template ................   Passed    0.18 sec
      Start 19: test-grammar-parser
19/27 Test #19: test-grammar-parser ...............   Passed    0.18 sec
      Start 20: test-grammar-integration
20/27 Test #20: test-grammar-integration ..........   Passed    0.24 sec
      Start 21: test-llama-grammar
21/27 Test #21: test-llama-grammar ................   Passed    0.18 sec
      Start 22: test-backend-ops
22/27 Test #22: test-backend-ops ..................   Passed  175.82 sec
      Start 25: test-barrier
23/27 Test #25: test-barrier ......................   Passed    1.07 sec
      Start 26: test-quantize-fns
24/27 Test #26: test-quantize-fns .................   Passed   26.21 sec
      Start 27: test-quantize-perf
25/27 Test #27: test-quantize-perf ................   Passed    0.33 sec
      Start 28: test-rope
26/27 Test #28: test-rope .........................   Passed    0.20 sec
      Start 29: test-json-schema-to-grammar
27/27 Test #29: test-json-schema-to-grammar .......   Passed    2.20 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    = 218.97 sec*proc (27 tests)

Total Test time (real) = 218.98 sec

real	3m39.034s
user	7m29.103s
sys	0m5.664s
```

### ctest_release

Runs ctest in release mode
- status: 0
```
+ ctest --output-on-failure -L main
Test project /Users/ggml/work/llama.cpp/build-ci-release
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.26 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    0.30 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.04 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.12 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.07 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.06 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    0.22 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.03 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.06 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.03 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.15 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.06 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.06 sec
      Start 14: test-tokenizer-1-llama-spm
14/27 Test #14: test-tokenizer-1-llama-spm ........   Passed    0.38 sec
      Start 15: test-log
15/27 Test #15: test-log ..........................   Passed    0.48 sec
      Start 16: test-arg-parser
16/27 Test #16: test-arg-parser ...................   Passed    0.26 sec
      Start 17: test-sampling
17/27 Test #17: test-sampling .....................   Passed    0.91 sec
      Start 18: test-chat-template
18/27 Test #18: test-chat-template ................   Passed    0.20 sec
      Start 19: test-grammar-parser
19/27 Test #19: test-grammar-parser ...............   Passed    0.17 sec
      Start 20: test-grammar-integration
20/27 Test #20: test-grammar-integration ..........   Passed    0.17 sec
      Start 21: test-llama-grammar
21/27 Test #21: test-llama-grammar ................   Passed    0.16 sec
      Start 22: test-backend-ops
22/27 Test #22: test-backend-ops ..................   Passed   28.66 sec
      Start 25: test-barrier
23/27 Test #25: test-barrier ......................   Passed    0.27 sec
      Start 26: test-quantize-fns
24/27 Test #26: test-quantize-fns .................   Passed   14.03 sec
      Start 27: test-quantize-perf
25/27 Test #27: test-quantize-perf ................   Passed    0.25 sec
      Start 28: test-rope
26/27 Test #28: test-rope .........................   Passed    0.19 sec
      Start 29: test-json-schema-to-grammar
27/27 Test #29: test-json-schema-to-grammar .......   Passed    2.11 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    =  50.70 sec*proc (27 tests)

Total Test time (real) =  50.71 sec

real	0m50.721s
user	1m11.540s
sys	0m4.972s
```
### embd_bge_small

BGE Small (BERT):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-f16.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.121 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.018.158 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.022.297 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.022.303 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.022.306 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.022.307 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.022.307 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.022.308 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.022.309 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.022.311 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.022.311 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.022.312 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.022.312 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.022.313 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.022.317 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.022.317 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.022.318 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.022.321 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.022.322 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.022.322 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.022.323 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.026.925 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.028.128 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.130 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.028.131 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.028.131 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.028.132 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.028.132 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.028.132 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.028.133 I llama_model_loader: - type  f32:  124 tensors
0.00.028.134 I llama_model_loader: - type  f16:   73 tensors
0.00.032.608 I llm_load_vocab: special tokens cache size = 5
0.00.034.837 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.034.841 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.034.842 I llm_load_print_meta: arch             = bert
0.00.034.842 I llm_load_print_meta: vocab type       = WPM
0.00.034.843 I llm_load_print_meta: n_vocab          = 30522
0.00.034.843 I llm_load_print_meta: n_merges         = 0
0.00.034.843 I llm_load_print_meta: vocab_only       = 0
0.00.034.843 I llm_load_print_meta: n_ctx_train      = 512
0.00.034.844 I llm_load_print_meta: n_embd           = 384
0.00.034.844 I llm_load_print_meta: n_layer          = 12
0.00.034.847 I llm_load_print_meta: n_head           = 12
0.00.034.848 I llm_load_print_meta: n_head_kv        = 12
0.00.034.848 I llm_load_print_meta: n_rot            = 32
0.00.034.848 I llm_load_print_meta: n_swa            = 0
0.00.034.848 I llm_load_print_meta: n_embd_head_k    = 32
0.00.034.849 I llm_load_print_meta: n_embd_head_v    = 32
0.00.034.849 I llm_load_print_meta: n_gqa            = 1
0.00.034.850 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.034.851 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.034.852 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.034.853 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.034.853 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.034.853 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.034.853 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.034.854 I llm_load_print_meta: n_ff             = 1536
0.00.034.854 I llm_load_print_meta: n_expert         = 0
0.00.034.855 I llm_load_print_meta: n_expert_used    = 0
0.00.034.855 I llm_load_print_meta: causal attn      = 0
0.00.034.855 I llm_load_print_meta: pooling type     = 2
0.00.034.855 I llm_load_print_meta: rope type        = 2
0.00.034.866 I llm_load_print_meta: rope scaling     = linear
0.00.034.868 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.034.869 I llm_load_print_meta: freq_scale_train = 1
0.00.034.869 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.034.870 I llm_load_print_meta: rope_finetuned   = unknown
0.00.034.870 I llm_load_print_meta: ssm_d_conv       = 0
0.00.034.870 I llm_load_print_meta: ssm_d_inner      = 0
0.00.034.870 I llm_load_print_meta: ssm_d_state      = 0
0.00.034.870 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.034.872 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.034.887 I llm_load_print_meta: model type       = 33M
0.00.034.888 I llm_load_print_meta: model ftype      = F16
0.00.034.888 I llm_load_print_meta: model params     = 33.21 M
0.00.034.889 I llm_load_print_meta: model size       = 63.84 MiB (16.12 BPW) 
0.00.034.889 I llm_load_print_meta: general.name     = Bge Small
0.00.034.890 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.034.890 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.034.891 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.034.891 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.034.891 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.034.892 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.034.892 I llm_load_print_meta: max token length = 21
0.00.037.004 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.037.005 I llm_load_tensors: offloading output layer to GPU
0.00.037.006 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.037.031 I llm_load_tensors: Metal_Mapped model buffer size =    40.73 MiB
0.00.037.033 I llm_load_tensors:   CPU_Mapped model buffer size =    23.11 MiB
................................................
0.00.037.660 I llama_new_context_with_model: n_seq_max     = 1
0.00.037.662 I llama_new_context_with_model: n_ctx         = 512
0.00.037.662 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.037.663 I llama_new_context_with_model: n_batch       = 2048
0.00.037.663 I llama_new_context_with_model: n_ubatch      = 2048
0.00.037.663 I llama_new_context_with_model: flash_attn    = 0
0.00.037.664 I llama_new_context_with_model: freq_base     = 10000.0
0.00.037.664 I llama_new_context_with_model: freq_scale    = 1
0.00.037.665 I ggml_metal_init: allocating
0.00.037.677 I ggml_metal_init: found device: Apple M4
0.00.037.680 I ggml_metal_init: picking default device: Apple M4
0.00.038.498 I ggml_metal_init: using embedded metal library
0.00.041.890 I ggml_metal_init: GPU name:   Apple M4
0.00.041.892 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.041.893 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.041.893 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.041.894 I ggml_metal_init: simdgroup reduction   = true
0.00.041.894 I ggml_metal_init: simdgroup matrix mul. = true
0.00.041.894 I ggml_metal_init: has bfloat            = true
0.00.041.894 I ggml_metal_init: use bfloat            = true
0.00.041.895 I ggml_metal_init: hasUnifiedMemory      = true
0.00.041.896 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.053.220 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.053.223 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.053.224 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.054.097 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.054.099 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.054.099 I llama_new_context_with_model: graph nodes  = 429
0.00.054.100 I llama_new_context_with_model: graph splits = 2
0.00.054.123 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.060.879 I 
0.00.060.898 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.061.564 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.043984 -0.019895  0.007670 -0.000838  0.001372 -0.037036  0.109436  0.042589  0.092046 -0.015918  0.006773 -0.035692 -0.017889  0.015040  0.018126  0.015860 -0.011308  0.010431 -0.085223 -0.008454  0.091368 -0.017067 -0.060328 -0.024484  0.027524  0.076059  0.027984 -0.014564  0.017645 -0.033268 -0.037874 -0.019012  0.068670 -0.009845 -0.025030  0.072346 -0.046570  0.011026 -0.050252  0.047693  0.032387 -0.011761  0.022055  0.049645  0.010465  0.005795 -0.028860  0.008933 -0.018507 -0.051466 -0.046036  0.030497 -0.035418  0.054204 -0.069650  0.044238  0.029786  0.046305  0.073410 -0.042580  0.076109  0.038851 -0.181182  0.082503  0.042250 -0.064549 -0.060097 -0.017853  0.006472  0.005873  0.017196 -0.026615  0.064578  0.112612  0.035159 -0.067416  0.027073 -0.067295 -0.033493 -0.033219  0.033252  0.013523 -0.003346 -0.037473 -0.052055  0.055155 -0.001982 -0.038276  0.064447  0.028824 -0.043334 -0.029236 -0.039462  0.036315  0.008379 -0.015481 -0.036573  0.018130  0.028600  0.342831 -0.044484  0.056114  0.017624 -0.020867 -0.066808  0.000146 -0.037885 -0.030063 -0.008541 -0.021595  0.000548 -0.003219  0.004020  0.018908 -0.008548  0.025835  0.049433  0.000091  0.050920 -0.042479 -0.031884  0.023606  0.030691 -0.023148 -0.046271 -0.079278  0.115198  0.046757  0.027829 -0.040710  0.067777 -0.022955  0.010332 -0.032937 -0.018305  0.043844  0.024268  0.052413  0.007469  0.008905  0.011244 -0.074655 -0.065561 -0.026750 -0.041192 -0.023884  0.026710  0.006912  0.027741  0.052873 -0.036673  0.057707 -0.000170  0.031764 -0.019760 -0.022083  0.041053 -0.058903  0.019619  0.043144  0.043582  0.041593 -0.022527  0.027037 -0.021833  0.005430 -0.041317 -0.001239  0.024452  0.002088  0.044333 -0.022745  0.043662  0.064763  0.055430  0.037060 -0.000919  0.046111  0.045790 -0.008487  0.063057 -0.073235 -0.011935  0.032107  0.023957  0.014725 -0.033688  0.001083 -0.015827 -0.019002  0.047872  0.110842  0.028428  0.031366 -0.013288 -0.057499  0.006644  0.005140 -0.012262 -0.051443 -0.000965 -0.017642 -0.019440 -0.040937  0.009209 -0.057957  0.050961  0.052340 -0.009617 -0.040259 -0.014075 -0.024877 -0.017251  0.006302  0.006588 -0.026919  0.015600  0.030760  0.002578  0.023206 -0.022199 -0.098557 -0.051105 -0.278031 -0.014994 -0.061553 -0.027218  0.017666 -0.010939 -0.017077  0.035055  0.046994 -0.015432  0.015232 -0.025477  0.047844 -0.005949 -0.000749 -0.061008 -0.068946 -0.060377 -0.035942  0.043319 -0.055047  0.015075  0.000537 -0.058175 -0.010439  0.012643  0.151495  0.127111 -0.013622  0.041993 -0.025672  0.014026 -0.001037 -0.150469  0.044857  0.005320 -0.036274 -0.029801 -0.020192 -0.034891  0.010235  0.033548 -0.048178 -0.051795 -0.017463 -0.023492  0.047349  0.052076 -0.016783 -0.055452  0.025836 -0.005707  0.010710  0.038705  0.008191 -0.009764 -0.105779 -0.027430 -0.096101  0.025068 -0.011260  0.092355  0.056101  0.003758  0.027791  0.002092 -0.051085 -0.039890 -0.013542 -0.044956 -0.015335  0.002910 -0.043498 -0.077951  0.065217 -0.006840 -0.001630 -0.014642  0.071560  0.023714 -0.037180  0.009175  0.001562 -0.032268  0.015468  0.037880  0.000337 -0.053207  0.021321 -0.039829  0.000031  0.013400  0.019798 -0.057879  0.006473 -0.049531 -0.267858  0.039156 -0.067972  0.038248 -0.012333  0.041485 -0.016117  0.052383 -0.071363  0.011369  0.024719 -0.007232  0.082087  0.028535 -0.021504  0.040494 -0.004570 -0.074594 -0.014749  0.020037  0.002304  0.023148  0.197212 -0.043222 -0.025983 -0.004959 -0.019278  0.074258  0.001716 -0.031979 -0.036599 -0.045082  0.000547 -0.011560  0.018126 -0.029461 -0.008463  0.006419  0.050799 -0.014959  0.006176  0.026096 -0.030809  0.048055  0.114093 -0.040826 -0.011457  0.005419 -0.003599  0.025154 -0.059142  0.013753 -0.010399  0.038709  0.051449  0.035413  0.035031 -0.017027  0.026360 -0.014490 -0.050032  0.003219  0.054121  0.039723 -0.039127 

0.00.066.742 I llama_perf_context_print:        load time =      42.72 ms
0.00.066.743 I llama_perf_context_print: prompt eval time =       5.04 ms /     9 tokens (    0.56 ms per token,  1786.07 tokens per second)
0.00.066.744 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.066.744 I llama_perf_context_print:       total time =       5.86 ms /    10 tokens
0.00.066.868 I ggml_metal_free: deallocating

real	0m0.246s
user	0m0.048s
sys	0m0.029s
```
- q8_0:
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-q8_0.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.036 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.746 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.010.787 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.010.791 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.010.792 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.010.793 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.010.793 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.010.793 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.010.793 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.010.794 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.010.795 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.010.795 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.010.795 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.010.796 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.010.797 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.010.798 I llama_model_loader: - kv  11:                          general.file_type u32              = 7
0.00.010.798 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.010.798 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.010.799 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.010.799 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.010.799 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.013.236 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.013.932 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.013.933 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.013.933 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.013.933 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.013.934 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.013.934 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.013.934 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.013.935 I llama_model_loader: - type  f32:  124 tensors
0.00.013.935 I llama_model_loader: - type q8_0:   73 tensors
0.00.016.307 I llm_load_vocab: special tokens cache size = 5
0.00.017.584 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.017.586 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.017.586 I llm_load_print_meta: arch             = bert
0.00.017.586 I llm_load_print_meta: vocab type       = WPM
0.00.017.587 I llm_load_print_meta: n_vocab          = 30522
0.00.017.587 I llm_load_print_meta: n_merges         = 0
0.00.017.587 I llm_load_print_meta: vocab_only       = 0
0.00.017.587 I llm_load_print_meta: n_ctx_train      = 512
0.00.017.587 I llm_load_print_meta: n_embd           = 384
0.00.017.587 I llm_load_print_meta: n_layer          = 12
0.00.017.589 I llm_load_print_meta: n_head           = 12
0.00.017.589 I llm_load_print_meta: n_head_kv        = 12
0.00.017.590 I llm_load_print_meta: n_rot            = 32
0.00.017.590 I llm_load_print_meta: n_swa            = 0
0.00.017.590 I llm_load_print_meta: n_embd_head_k    = 32
0.00.017.590 I llm_load_print_meta: n_embd_head_v    = 32
0.00.017.591 I llm_load_print_meta: n_gqa            = 1
0.00.017.591 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.017.592 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.017.592 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.017.593 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.017.593 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.017.593 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.017.593 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.017.593 I llm_load_print_meta: n_ff             = 1536
0.00.017.594 I llm_load_print_meta: n_expert         = 0
0.00.017.594 I llm_load_print_meta: n_expert_used    = 0
0.00.017.594 I llm_load_print_meta: causal attn      = 0
0.00.017.594 I llm_load_print_meta: pooling type     = 2
0.00.017.594 I llm_load_print_meta: rope type        = 2
0.00.017.594 I llm_load_print_meta: rope scaling     = linear
0.00.017.595 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.017.595 I llm_load_print_meta: freq_scale_train = 1
0.00.017.595 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.017.595 I llm_load_print_meta: rope_finetuned   = unknown
0.00.017.595 I llm_load_print_meta: ssm_d_conv       = 0
0.00.017.596 I llm_load_print_meta: ssm_d_inner      = 0
0.00.017.596 I llm_load_print_meta: ssm_d_state      = 0
0.00.017.596 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.017.596 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.017.601 I llm_load_print_meta: model type       = 33M
0.00.017.602 I llm_load_print_meta: model ftype      = Q8_0
0.00.017.602 I llm_load_print_meta: model params     = 33.21 M
0.00.017.602 I llm_load_print_meta: model size       = 34.38 MiB (8.68 BPW) 
0.00.017.603 I llm_load_print_meta: general.name     = Bge Small
0.00.017.603 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.017.603 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.017.604 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.017.604 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.017.605 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.017.605 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.017.605 I llm_load_print_meta: max token length = 21
0.00.018.734 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.018.734 I llm_load_tensors: offloading output layer to GPU
0.00.018.734 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.018.741 I llm_load_tensors: Metal_Mapped model buffer size =    21.75 MiB
0.00.018.742 I llm_load_tensors:   CPU_Mapped model buffer size =    12.63 MiB
................................................
0.00.019.085 I llama_new_context_with_model: n_seq_max     = 1
0.00.019.086 I llama_new_context_with_model: n_ctx         = 512
0.00.019.086 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.019.086 I llama_new_context_with_model: n_batch       = 2048
0.00.019.086 I llama_new_context_with_model: n_ubatch      = 2048
0.00.019.087 I llama_new_context_with_model: flash_attn    = 0
0.00.019.087 I llama_new_context_with_model: freq_base     = 10000.0
0.00.019.087 I llama_new_context_with_model: freq_scale    = 1
0.00.019.088 I ggml_metal_init: allocating
0.00.019.093 I ggml_metal_init: found device: Apple M4
0.00.019.095 I ggml_metal_init: picking default device: Apple M4
0.00.019.551 I ggml_metal_init: using embedded metal library
0.00.021.591 I ggml_metal_init: GPU name:   Apple M4
0.00.021.593 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.021.593 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.021.594 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.021.594 I ggml_metal_init: simdgroup reduction   = true
0.00.021.594 I ggml_metal_init: simdgroup matrix mul. = true
0.00.021.594 I ggml_metal_init: has bfloat            = true
0.00.021.594 I ggml_metal_init: use bfloat            = true
0.00.021.595 I ggml_metal_init: hasUnifiedMemory      = true
0.00.021.595 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.029.820 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.029.822 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.029.823 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.030.414 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.030.415 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.030.416 I llama_new_context_with_model: graph nodes  = 429
0.00.030.416 I llama_new_context_with_model: graph splits = 2
0.00.030.428 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.035.523 I 
0.00.035.534 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.036.045 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.044994 -0.019858  0.007986 -0.001410  0.001531 -0.036276  0.109404  0.043235  0.092836 -0.015201  0.005971 -0.036330 -0.018159  0.015015  0.017667  0.014510 -0.011792  0.011812 -0.084764 -0.008081  0.091650 -0.017638 -0.061084 -0.025066  0.026879  0.076180  0.028256 -0.014273  0.017420 -0.033553 -0.037520 -0.018280  0.068843 -0.010129 -0.024896  0.071968 -0.046406  0.011471 -0.050333  0.048931  0.032317 -0.012107  0.021812  0.049796  0.010366  0.005264 -0.028665  0.008581 -0.018508 -0.052358 -0.046410  0.029426 -0.034989  0.053289 -0.069849  0.043767  0.029291  0.046759  0.073664 -0.043090  0.075213  0.038641 -0.180496  0.081648  0.043389 -0.065615 -0.059878 -0.017387  0.006913  0.005155  0.017165 -0.026679  0.064347  0.112564  0.034871 -0.067783  0.027124 -0.066989 -0.034296 -0.033344  0.033189  0.014325 -0.004253 -0.036945 -0.052008  0.054151 -0.001715 -0.038112  0.063016  0.028668 -0.041665 -0.028879 -0.039263  0.036879  0.007718 -0.015657 -0.036270  0.018699  0.029792  0.344948 -0.043880  0.056487  0.018022 -0.021448 -0.065281  0.000253 -0.037910 -0.029663 -0.008828 -0.020643  0.001162 -0.003510  0.003091  0.018576 -0.009637  0.025316  0.049298 -0.000937  0.051568 -0.042363 -0.031550  0.023315  0.030044 -0.023267 -0.045483 -0.079644  0.114489  0.047503  0.027208 -0.041477  0.067717 -0.022845  0.010232 -0.033486 -0.017199  0.044319  0.022956  0.052194  0.008122  0.008112  0.009951 -0.074643 -0.065035 -0.025938 -0.040806 -0.024533  0.027409  0.006078  0.027693  0.052243 -0.036587  0.058682  0.001467  0.032191 -0.019964 -0.021840  0.041805 -0.058801  0.019348  0.042626  0.043999  0.040911 -0.021909  0.028025 -0.022801  0.005520 -0.041266 -0.000085  0.024325  0.001532  0.044802 -0.022888  0.043056  0.065030  0.056292  0.037666 -0.001004  0.047521  0.045624 -0.008614  0.062270 -0.073313 -0.011718  0.032708  0.023348  0.014650 -0.033924  0.001158 -0.015872 -0.018974  0.047982  0.110740  0.029177  0.030881 -0.012325 -0.057836  0.006939  0.004378 -0.011864 -0.051754 -0.003018 -0.017766 -0.020051 -0.041018  0.009118 -0.058568  0.050632  0.051795 -0.008968 -0.040668 -0.014765 -0.024320 -0.015980  0.005823  0.007147 -0.027335  0.016275  0.030734  0.002342  0.023167 -0.022169 -0.098059 -0.050901 -0.277240 -0.015100 -0.061566 -0.026219  0.017141 -0.010285 -0.017522  0.034725  0.047897 -0.016594  0.015489 -0.024132  0.048613 -0.004993 -0.000001 -0.060860 -0.068346 -0.059622 -0.036157  0.043605 -0.056353  0.014713  0.000292 -0.058627 -0.010995  0.012274  0.151597  0.127025 -0.012582  0.042765 -0.025227  0.013629 -0.000381 -0.150686  0.043974  0.004714 -0.036955 -0.029586 -0.019853 -0.034063  0.009522  0.034004 -0.048909 -0.051765 -0.017243 -0.025080  0.047588  0.050981 -0.017553 -0.056746  0.024054 -0.006285  0.011003  0.038719  0.008083 -0.008595 -0.106361 -0.027365 -0.096966  0.025294 -0.011096  0.091579  0.056180  0.004494  0.028066  0.001727 -0.051388 -0.039497 -0.013817 -0.045907 -0.015238  0.002920 -0.043938 -0.077716  0.066102 -0.006195 -0.000885 -0.013768  0.071562  0.023826 -0.036363  0.007848  0.001487 -0.032916  0.016336  0.037378  0.000625 -0.052389  0.021549 -0.039695 -0.000026  0.013496  0.020436 -0.057513  0.005900 -0.049906 -0.267546  0.038686 -0.067509  0.037450 -0.011471  0.041547 -0.015904  0.051347 -0.072313  0.012571  0.024808 -0.007420  0.082069  0.028175 -0.021956  0.040736 -0.003945 -0.074192 -0.014923  0.020417  0.002644  0.023207  0.197144 -0.043068 -0.025876 -0.004886 -0.018582  0.073936  0.001341 -0.031663 -0.037140 -0.044262  0.000049 -0.010741  0.018225 -0.028045 -0.008828  0.006047  0.050183 -0.015017  0.007037  0.025894 -0.030628  0.048075  0.112795 -0.039982 -0.011695  0.005039 -0.002800  0.025072 -0.059720  0.014182 -0.010019  0.038100  0.051088  0.034726  0.035947 -0.017035  0.027243 -0.015391 -0.051195  0.003744  0.053928  0.040014 -0.039140 

0.00.040.900 I llama_perf_context_print:        load time =      26.77 ms
0.00.040.901 I llama_perf_context_print: prompt eval time =       4.74 ms /     9 tokens (    0.53 ms per token,  1899.94 tokens per second)
0.00.040.901 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.040.902 I llama_perf_context_print:       total time =       5.38 ms /    10 tokens
0.00.041.011 I ggml_metal_free: deallocating

real	0m0.053s
user	0m0.028s
sys	0m0.014s
```
### rerank_tiny

Rerank Tiny (Jina):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/rerank-tiny/ggml-model-f16.gguf -p 'what is panda?</s></s>hi\nwhat is panda?</s></s>it'\''s a bear\nwhat is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.' -ngl 99 -c 0 --pooling rank --embd-normalize -1 --verbose-prompt
0.00.000.164 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.022.230 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.031.931 I llama_model_loader: loaded meta data with 29 key-value pairs and 70 tensors from ../models-mnt/rerank-tiny/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.031.935 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.031.938 I llama_model_loader: - kv   0:                       general.architecture str              = jina-bert-v2
0.00.031.938 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.031.942 I llama_model_loader: - kv   2:                               general.name str              = Jina Bert Implementation
0.00.031.942 I llama_model_loader: - kv   3:                       general.organization str              = Jinaai
0.00.031.943 I llama_model_loader: - kv   4:                         general.size_label str              = 33M
0.00.031.944 I llama_model_loader: - kv   5:                   jina-bert-v2.block_count u32              = 4
0.00.031.945 I llama_model_loader: - kv   6:                jina-bert-v2.context_length u32              = 8192
0.00.031.945 I llama_model_loader: - kv   7:              jina-bert-v2.embedding_length u32              = 384
0.00.031.946 I llama_model_loader: - kv   8:           jina-bert-v2.feed_forward_length u32              = 1536
0.00.031.946 I llama_model_loader: - kv   9:          jina-bert-v2.attention.head_count u32              = 12
0.00.031.950 I llama_model_loader: - kv  10:  jina-bert-v2.attention.layer_norm_epsilon f32              = 0.000000
0.00.031.950 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.031.951 I llama_model_loader: - kv  12:              jina-bert-v2.attention.causal bool             = false
0.00.031.951 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.031.952 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = jina-v1-en
0.00.039.641 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,61056]   = ["<s>", "<pad>", "</s>", "<unk>", "<m...
0.00.041.882 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,61056]   = [3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, ...
0.00.046.287 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,39382]   = ["t h", "i n", "a n", "e r", "th e", ...
0.00.046.288 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.046.289 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 2
0.00.046.289 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 3
0.00.046.290 I llama_model_loader: - kv  21:          tokenizer.ggml.seperator_token_id u32              = 2
0.00.046.290 I llama_model_loader: - kv  22:            tokenizer.ggml.padding_token_id u32              = 1
0.00.046.290 I llama_model_loader: - kv  23:                tokenizer.ggml.cls_token_id u32              = 0
0.00.046.291 I llama_model_loader: - kv  24:               tokenizer.ggml.mask_token_id u32              = 4
0.00.046.291 I llama_model_loader: - kv  25:            tokenizer.ggml.token_type_count u32              = 2
0.00.046.291 I llama_model_loader: - kv  26:               tokenizer.ggml.add_bos_token bool             = true
0.00.046.292 I llama_model_loader: - kv  27:               tokenizer.ggml.add_eos_token bool             = true
0.00.046.292 I llama_model_loader: - kv  28:               general.quantization_version u32              = 2
0.00.046.293 I llama_model_loader: - type  f32:   41 tensors
0.00.046.293 I llama_model_loader: - type  f16:   29 tensors
0.00.064.003 W llm_load_vocab: empty token at index 5
0.00.068.506 W llm_load_vocab: model vocab missing newline token, using special_pad_id instead
0.00.069.841 W llm_load_vocab: special_eos_id is not in special_eog_ids - the tokenizer config may be incorrect
0.00.069.866 I llm_load_vocab: special tokens cache size = 5
0.00.312.331 I llm_load_vocab: token to piece cache size = 1.5060 MB
0.00.312.337 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.312.337 I llm_load_print_meta: arch             = jina-bert-v2
0.00.312.338 I llm_load_print_meta: vocab type       = BPE
0.00.312.338 I llm_load_print_meta: n_vocab          = 61056
0.00.312.339 I llm_load_print_meta: n_merges         = 39382
0.00.312.339 I llm_load_print_meta: vocab_only       = 0
0.00.312.342 I llm_load_print_meta: n_ctx_train      = 8192
0.00.312.342 I llm_load_print_meta: n_embd           = 384
0.00.312.342 I llm_load_print_meta: n_layer          = 4
0.00.312.350 I llm_load_print_meta: n_head           = 12
0.00.312.351 I llm_load_print_meta: n_head_kv        = 12
0.00.312.351 I llm_load_print_meta: n_rot            = 32
0.00.312.357 I llm_load_print_meta: n_swa            = 0
0.00.312.357 I llm_load_print_meta: n_embd_head_k    = 32
0.00.312.357 I llm_load_print_meta: n_embd_head_v    = 32
0.00.312.357 I llm_load_print_meta: n_gqa            = 1
0.00.312.359 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.312.360 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.312.360 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.312.363 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.312.363 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.312.363 I llm_load_print_meta: f_max_alibi_bias = 8.0e+00
0.00.312.365 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.312.365 I llm_load_print_meta: n_ff             = 1536
0.00.312.365 I llm_load_print_meta: n_expert         = 0
0.00.312.366 I llm_load_print_meta: n_expert_used    = 0
0.00.312.366 I llm_load_print_meta: causal attn      = 0
0.00.312.366 I llm_load_print_meta: pooling type     = -1
0.00.312.366 I llm_load_print_meta: rope type        = -1
0.00.312.366 I llm_load_print_meta: rope scaling     = linear
0.00.312.366 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.312.367 I llm_load_print_meta: freq_scale_train = 1
0.00.312.367 I llm_load_print_meta: n_ctx_orig_yarn  = 8192
0.00.312.368 I llm_load_print_meta: rope_finetuned   = unknown
0.00.312.368 I llm_load_print_meta: ssm_d_conv       = 0
0.00.312.368 I llm_load_print_meta: ssm_d_inner      = 0
0.00.312.368 I llm_load_print_meta: ssm_d_state      = 0
0.00.312.369 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.312.369 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.312.394 I llm_load_print_meta: model type       = 33M
0.00.312.395 I llm_load_print_meta: model ftype      = F16
0.00.312.395 I llm_load_print_meta: model params     = 32.90 M
0.00.312.396 I llm_load_print_meta: model size       = 62.78 MiB (16.01 BPW) 
0.00.312.396 I llm_load_print_meta: general.name     = Jina Bert Implementation
0.00.312.397 I llm_load_print_meta: BOS token        = 0 '<s>'
0.00.312.397 I llm_load_print_meta: EOS token        = 2 '</s>'
0.00.312.397 I llm_load_print_meta: UNK token        = 3 '<unk>'
0.00.312.397 I llm_load_print_meta: SEP token        = 2 '</s>'
0.00.312.397 I llm_load_print_meta: PAD token        = 1 '<pad>'
0.00.312.398 I llm_load_print_meta: CLS token        = 0 '<s>'
0.00.312.398 I llm_load_print_meta: MASK token       = 4 '<mask>'
0.00.312.398 I llm_load_print_meta: EOG token        = 2 '</s>'
0.00.312.399 I llm_load_print_meta: max token length = 45
0.00.313.391 I llm_load_tensors: offloading 4 repeating layers to GPU
0.00.313.392 I llm_load_tensors: offloading output layer to GPU
0.00.313.392 I llm_load_tensors: offloaded 5/5 layers to GPU
0.00.313.412 I llm_load_tensors: Metal_Mapped model buffer size =    18.06 MiB
0.00.313.413 I llm_load_tensors:   CPU_Mapped model buffer size =    44.72 MiB
....................
0.00.314.188 I llama_new_context_with_model: n_seq_max     = 1
0.00.314.190 I llama_new_context_with_model: n_ctx         = 8192
0.00.314.190 I llama_new_context_with_model: n_ctx_per_seq = 8192
0.00.314.190 I llama_new_context_with_model: n_batch       = 2048
0.00.314.190 I llama_new_context_with_model: n_ubatch      = 2048
0.00.314.191 I llama_new_context_with_model: flash_attn    = 0
0.00.314.191 I llama_new_context_with_model: freq_base     = 10000.0
0.00.314.191 I llama_new_context_with_model: freq_scale    = 1
0.00.314.192 I ggml_metal_init: allocating
0.00.314.195 I ggml_metal_init: found device: Apple M4
0.00.314.197 I ggml_metal_init: picking default device: Apple M4
0.00.315.171 I ggml_metal_init: using embedded metal library
0.00.317.604 I ggml_metal_init: GPU name:   Apple M4
0.00.317.606 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.317.606 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.317.607 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.317.607 I ggml_metal_init: simdgroup reduction   = true
0.00.317.607 I ggml_metal_init: simdgroup matrix mul. = true
0.00.317.607 I ggml_metal_init: has bfloat            = true
0.00.317.607 I ggml_metal_init: use bfloat            = true
0.00.317.608 I ggml_metal_init: hasUnifiedMemory      = true
0.00.317.609 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.327.960 I llama_kv_cache_init:      Metal KV buffer size =    48.00 MiB
0.00.327.963 I llama_new_context_with_model: KV self size  =   48.00 MiB, K (f16):   24.00 MiB, V (f16):   24.00 MiB
0.00.327.965 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.328.504 I llama_new_context_with_model:      Metal compute buffer size =   220.01 MiB
0.00.328.505 I llama_new_context_with_model:        CPU compute buffer size =    22.02 MiB
0.00.328.506 I llama_new_context_with_model: graph nodes  = 154
0.00.328.506 I llama_new_context_with_model: graph splits = 2
0.00.328.523 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.340.049 I 
0.00.340.067 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.340.216 I main: prompt 0: 'what is panda?</s></s>hi'
0.00.340.217 I main: number of tokens in prompt = 9
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 23233 -> 'hi'
     2 -> '</s>'


0.00.340.219 I main: prompt 1: 'what is panda?</s></s>it's a bear'
0.00.340.219 I main: number of tokens in prompt = 13
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21153 -> 'it'
    37 -> '''
    87 -> 's'
    69 -> 'a'
 25706 -> 'bear'
     2 -> '</s>'


0.00.340.221 I main: prompt 2: 'what is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.'
0.00.340.221 I main: number of tokens in prompt = 40
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21215 -> 'he'
 28390 -> 'giant'
 49990 -> 'panda'
    38 -> '('
 21163 -> 'il'
 26237 -> 'uro'
 21223 -> 'po'
 23179 -> 'da'
 36906 -> 'melan'
 26791 -> 'ole'
    89 -> 'u'
 21402 -> 'ca'
 21686 -> '),'
 23314 -> 'sometimes'
 22517 -> 'called'
    69 -> 'a'
 49990 -> 'panda'
 25706 -> 'bear'
 21142 -> 'or'
 22810 -> 'simply'
 49990 -> 'panda'
    42 -> ','
 21152 -> 'is'
    69 -> 'a'
 25706 -> 'bear'
 25677 -> 'species'
 28930 -> 'ende'
 22024 -> 'mic'
 21148 -> 'to'
    76 -> 'h'
 22344 -> 'ina'
    44 -> '.'
     2 -> '</s>'


0.00.340.750 I batch_decode: n_tokens = 62, n_seq = 3

rerank score 0:    0.023
rerank score 1:    0.024
rerank score 2:    0.199

0.00.344.463 I llama_perf_context_print:        load time =     317.81 ms
0.00.344.464 I llama_perf_context_print: prompt eval time =       3.71 ms /    62 tokens (    0.06 ms per token, 16734.14 tokens per second)
0.00.344.465 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.344.466 I llama_perf_context_print:       total time =       4.41 ms /    63 tokens
0.00.344.675 I ggml_metal_free: deallocating

real	0m1.314s
user	0m0.321s
sys	0m0.043s
  - rerank score 0 @ 0.023 OK
  - rerank score 1 @ 0.024 OK
  - rerank score 2 @ 0.199 OK
```
### pythia_1_4b

Pythia 1.4B:
- status: 0
- perplexity:
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
- imatrix:
```
Final estimate: PPL = 10.1498 +/- 3.22650
```
- f16: 
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.168 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.300 I main: llama backend init
0.00.000.326 I main: load the model and apply lora adapter, if any
0.00.038.541 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.051.690 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.051.702 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.051.714 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.051.715 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.051.715 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.051.716 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.051.716 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.051.718 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.051.719 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.051.720 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.051.720 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.051.721 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.051.722 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.051.722 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.051.725 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.051.726 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.051.726 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.059.791 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.061.867 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.068.436 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.068.438 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.068.439 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.068.439 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.068.440 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.068.441 I llama_model_loader: - type  f32:  194 tensors
0.00.068.441 I llama_model_loader: - type  f16:   98 tensors
0.00.097.032 I llm_load_vocab: special tokens cache size = 25
0.00.103.644 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.103.646 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.103.647 I llm_load_print_meta: arch             = gptneox
0.00.103.647 I llm_load_print_meta: vocab type       = BPE
0.00.103.647 I llm_load_print_meta: n_vocab          = 50304
0.00.103.647 I llm_load_print_meta: n_merges         = 50009
0.00.103.647 I llm_load_print_meta: vocab_only       = 0
0.00.103.648 I llm_load_print_meta: n_ctx_train      = 2048
0.00.103.648 I llm_load_print_meta: n_embd           = 2048
0.00.103.648 I llm_load_print_meta: n_layer          = 24
0.00.103.650 I llm_load_print_meta: n_head           = 16
0.00.103.651 I llm_load_print_meta: n_head_kv        = 16
0.00.103.651 I llm_load_print_meta: n_rot            = 32
0.00.103.651 I llm_load_print_meta: n_swa            = 0
0.00.103.652 I llm_load_print_meta: n_embd_head_k    = 128
0.00.103.652 I llm_load_print_meta: n_embd_head_v    = 128
0.00.103.652 I llm_load_print_meta: n_gqa            = 1
0.00.103.653 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.103.654 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.103.654 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.103.654 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.103.655 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.103.655 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.103.658 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.103.659 I llm_load_print_meta: n_ff             = 8192
0.00.103.659 I llm_load_print_meta: n_expert         = 0
0.00.103.659 I llm_load_print_meta: n_expert_used    = 0
0.00.103.659 I llm_load_print_meta: causal attn      = 1
0.00.103.660 I llm_load_print_meta: pooling type     = 0
0.00.103.661 I llm_load_print_meta: rope type        = 2
0.00.103.662 I llm_load_print_meta: rope scaling     = linear
0.00.103.663 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.103.663 I llm_load_print_meta: freq_scale_train = 1
0.00.103.663 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.103.663 I llm_load_print_meta: rope_finetuned   = unknown
0.00.103.663 I llm_load_print_meta: ssm_d_conv       = 0
0.00.103.663 I llm_load_print_meta: ssm_d_inner      = 0
0.00.103.664 I llm_load_print_meta: ssm_d_state      = 0
0.00.103.664 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.103.664 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.103.676 I llm_load_print_meta: model type       = 1.4B
0.00.103.676 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.103.677 I llm_load_print_meta: model params     = 1.41 B
0.00.103.677 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.103.677 I llm_load_print_meta: general.name     = 1.4B
0.00.103.677 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.103.677 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.103.678 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.103.678 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.103.678 I llm_load_print_meta: LF token         = 128 ''
0.00.103.678 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.103.678 I llm_load_print_meta: max token length = 1024
0.00.106.197 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.106.197 I llm_load_tensors: offloading output layer to GPU
0.00.106.197 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.106.214 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.106.215 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.107.134 I llama_new_context_with_model: n_seq_max     = 1
0.00.107.135 I llama_new_context_with_model: n_ctx         = 2048
0.00.107.135 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.107.135 I llama_new_context_with_model: n_batch       = 2048
0.00.107.135 I llama_new_context_with_model: n_ubatch      = 512
0.00.107.136 I llama_new_context_with_model: flash_attn    = 0
0.00.107.136 I llama_new_context_with_model: freq_base     = 10000.0
0.00.107.136 I llama_new_context_with_model: freq_scale    = 1
0.00.107.137 I ggml_metal_init: allocating
0.00.107.143 I ggml_metal_init: found device: Apple M4
0.00.107.145 I ggml_metal_init: picking default device: Apple M4
0.00.107.744 I ggml_metal_init: using embedded metal library
0.00.114.850 I ggml_metal_init: GPU name:   Apple M4
0.00.114.852 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.114.852 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.114.853 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.114.853 I ggml_metal_init: simdgroup reduction   = true
0.00.114.853 I ggml_metal_init: simdgroup matrix mul. = true
0.00.114.853 I ggml_metal_init: has bfloat            = true
0.00.114.854 I ggml_metal_init: use bfloat            = true
0.00.114.854 I ggml_metal_init: hasUnifiedMemory      = true
0.00.114.855 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.150.079 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.150.084 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.150.102 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.150.990 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.150.991 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.150.991 I llama_new_context_with_model: graph nodes  = 967
0.00.150.991 I llama_new_context_with_model: graph splits = 2
0.00.151.021 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.224.389 I main: llama threadpool init, n_threads = 4
0.00.224.449 I 
0.00.224.465 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.224.465 I 
0.00.224.543 I sampler seed: 1234
0.00.224.547 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.224.569 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.224.571 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.224.571 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling depressed, and I've had a hard time getting out of bed. I think the only thing I

0.02.078.303 I llama_perf_sampler_print:    sampling time =       1.33 ms /    71 runs   (    0.02 ms per token, 53423.63 tokens per second)
0.02.078.304 I llama_perf_context_print:        load time =     185.83 ms
0.02.078.305 I llama_perf_context_print: prompt eval time =      37.63 ms /     7 tokens (    5.38 ms per token,   186.01 tokens per second)
0.02.078.306 I llama_perf_context_print:        eval time =    1813.07 ms /    63 runs   (   28.78 ms per token,    34.75 tokens per second)
0.02.078.306 I llama_perf_context_print:       total time =    1853.92 ms /    70 tokens
0.02.078.475 I ggml_metal_free: deallocating

real	0m2.444s
user	0m0.142s
sys	0m0.096s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.619 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.024.709 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.037.550 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.037.557 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.037.560 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.037.561 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.037.562 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.037.562 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.037.563 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.037.564 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.037.565 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.037.566 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.037.567 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.037.567 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.037.568 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.037.568 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.037.571 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.037.572 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.037.572 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.862 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.745 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.053.200 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.053.202 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.053.203 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.053.204 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.053.204 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.053.204 I llama_model_loader: - type  f32:  194 tensors
0.00.053.205 I llama_model_loader: - type  f16:   98 tensors
0.00.079.762 I llm_load_vocab: special tokens cache size = 25
0.00.086.280 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.086.283 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.086.283 I llm_load_print_meta: arch             = gptneox
0.00.086.284 I llm_load_print_meta: vocab type       = BPE
0.00.086.284 I llm_load_print_meta: n_vocab          = 50304
0.00.086.284 I llm_load_print_meta: n_merges         = 50009
0.00.086.284 I llm_load_print_meta: vocab_only       = 0
0.00.086.284 I llm_load_print_meta: n_ctx_train      = 2048
0.00.086.285 I llm_load_print_meta: n_embd           = 2048
0.00.086.285 I llm_load_print_meta: n_layer          = 24
0.00.086.287 I llm_load_print_meta: n_head           = 16
0.00.086.288 I llm_load_print_meta: n_head_kv        = 16
0.00.086.288 I llm_load_print_meta: n_rot            = 32
0.00.086.288 I llm_load_print_meta: n_swa            = 0
0.00.086.289 I llm_load_print_meta: n_embd_head_k    = 128
0.00.086.289 I llm_load_print_meta: n_embd_head_v    = 128
0.00.086.289 I llm_load_print_meta: n_gqa            = 1
0.00.086.290 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.086.291 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.086.291 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.086.292 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.086.292 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.086.292 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.086.292 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.086.293 I llm_load_print_meta: n_ff             = 8192
0.00.086.293 I llm_load_print_meta: n_expert         = 0
0.00.086.293 I llm_load_print_meta: n_expert_used    = 0
0.00.086.293 I llm_load_print_meta: causal attn      = 1
0.00.086.293 I llm_load_print_meta: pooling type     = 0
0.00.086.294 I llm_load_print_meta: rope type        = 2
0.00.086.294 I llm_load_print_meta: rope scaling     = linear
0.00.086.294 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.086.294 I llm_load_print_meta: freq_scale_train = 1
0.00.086.295 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.086.295 I llm_load_print_meta: rope_finetuned   = unknown
0.00.086.295 I llm_load_print_meta: ssm_d_conv       = 0
0.00.086.295 I llm_load_print_meta: ssm_d_inner      = 0
0.00.086.295 I llm_load_print_meta: ssm_d_state      = 0
0.00.086.298 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.086.298 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.086.310 I llm_load_print_meta: model type       = 1.4B
0.00.086.310 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.086.311 I llm_load_print_meta: model params     = 1.41 B
0.00.086.311 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.086.311 I llm_load_print_meta: general.name     = 1.4B
0.00.086.311 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.086.312 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.086.312 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.086.312 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.086.312 I llm_load_print_meta: LF token         = 128 ''
0.00.086.312 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.086.312 I llm_load_print_meta: max token length = 1024
0.00.088.851 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.088.852 I llm_load_tensors: offloading output layer to GPU
0.00.088.852 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.088.862 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.088.863 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.089.813 I llama_new_context_with_model: n_seq_max     = 1
0.00.089.813 I llama_new_context_with_model: n_ctx         = 128
0.00.089.814 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.089.814 I llama_new_context_with_model: n_batch       = 128
0.00.089.814 I llama_new_context_with_model: n_ubatch      = 128
0.00.089.814 I llama_new_context_with_model: flash_attn    = 0
0.00.089.815 I llama_new_context_with_model: freq_base     = 10000.0
0.00.089.815 I llama_new_context_with_model: freq_scale    = 1
0.00.089.815 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.089.816 I ggml_metal_init: allocating
0.00.089.818 I ggml_metal_init: found device: Apple M4
0.00.089.820 I ggml_metal_init: picking default device: Apple M4
0.00.090.378 I ggml_metal_init: using embedded metal library
0.00.092.414 I ggml_metal_init: GPU name:   Apple M4
0.00.092.415 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.092.415 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.092.416 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.092.416 I ggml_metal_init: simdgroup reduction   = true
0.00.092.416 I ggml_metal_init: simdgroup matrix mul. = true
0.00.092.416 I ggml_metal_init: has bfloat            = true
0.00.092.417 I ggml_metal_init: use bfloat            = true
0.00.092.417 I ggml_metal_init: hasUnifiedMemory      = true
0.00.092.419 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.102.140 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.102.142 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.102.158 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.103.088 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.103.089 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.103.089 I llama_new_context_with_model: graph nodes  = 967
0.00.103.090 I llama_new_context_with_model: graph splits = 2
0.00.103.102 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.893.935 I 
0.00.893.960 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.893.963 I perplexity: tokenizing the input ..
0.00.906.984 I perplexity: tokenization took 13.018 ms
0.00.907.027 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.039.891 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.041.664 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.041.685 I llama_perf_context_print:        load time =     869.22 ms
0.01.041.687 I llama_perf_context_print: prompt eval time =     131.93 ms /   128 tokens (    1.03 ms per token,   970.23 tokens per second)
0.01.041.691 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.041.691 I llama_perf_context_print:       total time =     147.75 ms /   129 tokens
0.01.042.253 I ggml_metal_free: deallocating

real	0m1.233s
user	0m0.120s
sys	0m0.194s
```
- q8_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.045 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.075 I main: llama backend init
0.00.000.082 I main: load the model and apply lora adapter, if any
0.00.009.810 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.023.419 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.023.424 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.023.426 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.023.426 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.023.427 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.023.427 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.023.427 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.023.429 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.023.429 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.023.429 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.023.430 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.023.430 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.023.430 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.023.431 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.023.432 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.023.433 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.023.433 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.027.278 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.028.390 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.032.386 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.032.388 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.032.389 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.032.389 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.032.389 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.032.389 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.032.390 I llama_model_loader: - type  f32:  194 tensors
0.00.032.390 I llama_model_loader: - type q8_0:   98 tensors
0.00.053.976 I llm_load_vocab: special tokens cache size = 25
0.00.060.076 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.060.079 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.060.080 I llm_load_print_meta: arch             = gptneox
0.00.060.080 I llm_load_print_meta: vocab type       = BPE
0.00.060.080 I llm_load_print_meta: n_vocab          = 50304
0.00.060.081 I llm_load_print_meta: n_merges         = 50009
0.00.060.081 I llm_load_print_meta: vocab_only       = 0
0.00.060.081 I llm_load_print_meta: n_ctx_train      = 2048
0.00.060.081 I llm_load_print_meta: n_embd           = 2048
0.00.060.085 I llm_load_print_meta: n_layer          = 24
0.00.060.090 I llm_load_print_meta: n_head           = 16
0.00.060.091 I llm_load_print_meta: n_head_kv        = 16
0.00.060.091 I llm_load_print_meta: n_rot            = 32
0.00.060.091 I llm_load_print_meta: n_swa            = 0
0.00.060.092 I llm_load_print_meta: n_embd_head_k    = 128
0.00.060.093 I llm_load_print_meta: n_embd_head_v    = 128
0.00.060.094 I llm_load_print_meta: n_gqa            = 1
0.00.060.095 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.060.096 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.060.097 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.060.097 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.060.097 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.060.097 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.060.097 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.060.098 I llm_load_print_meta: n_ff             = 8192
0.00.060.098 I llm_load_print_meta: n_expert         = 0
0.00.060.098 I llm_load_print_meta: n_expert_used    = 0
0.00.060.099 I llm_load_print_meta: causal attn      = 1
0.00.060.100 I llm_load_print_meta: pooling type     = 0
0.00.060.100 I llm_load_print_meta: rope type        = 2
0.00.060.100 I llm_load_print_meta: rope scaling     = linear
0.00.060.101 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.060.101 I llm_load_print_meta: freq_scale_train = 1
0.00.060.101 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.060.101 I llm_load_print_meta: rope_finetuned   = unknown
0.00.060.101 I llm_load_print_meta: ssm_d_conv       = 0
0.00.060.102 I llm_load_print_meta: ssm_d_inner      = 0
0.00.060.102 I llm_load_print_meta: ssm_d_state      = 0
0.00.060.102 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.060.102 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.060.115 I llm_load_print_meta: model type       = 1.4B
0.00.060.115 I llm_load_print_meta: model ftype      = Q8_0
0.00.060.116 I llm_load_print_meta: model params     = 1.41 B
0.00.060.116 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.060.116 I llm_load_print_meta: general.name     = 1.4B
0.00.060.117 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.060.117 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.060.117 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.060.117 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.060.117 I llm_load_print_meta: LF token         = 128 ''
0.00.060.118 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.060.118 I llm_load_print_meta: max token length = 1024
0.00.062.522 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.062.522 I llm_load_tensors: offloading output layer to GPU
0.00.062.523 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.062.533 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.062.534 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.063.493 I llama_new_context_with_model: n_seq_max     = 1
0.00.063.493 I llama_new_context_with_model: n_ctx         = 2048
0.00.063.494 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.063.494 I llama_new_context_with_model: n_batch       = 2048
0.00.063.494 I llama_new_context_with_model: n_ubatch      = 512
0.00.063.494 I llama_new_context_with_model: flash_attn    = 0
0.00.063.495 I llama_new_context_with_model: freq_base     = 10000.0
0.00.063.495 I llama_new_context_with_model: freq_scale    = 1
0.00.063.495 I ggml_metal_init: allocating
0.00.063.498 I ggml_metal_init: found device: Apple M4
0.00.063.501 I ggml_metal_init: picking default device: Apple M4
0.00.064.165 I ggml_metal_init: using embedded metal library
0.00.066.298 I ggml_metal_init: GPU name:   Apple M4
0.00.066.299 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.066.300 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.066.300 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.066.301 I ggml_metal_init: simdgroup reduction   = true
0.00.066.301 I ggml_metal_init: simdgroup matrix mul. = true
0.00.066.301 I ggml_metal_init: has bfloat            = true
0.00.066.301 I ggml_metal_init: use bfloat            = true
0.00.066.302 I ggml_metal_init: hasUnifiedMemory      = true
0.00.066.302 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.100.309 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.100.316 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.100.337 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.101.472 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.101.473 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.101.474 I llama_new_context_with_model: graph nodes  = 967
0.00.101.474 I llama_new_context_with_model: graph splits = 2
0.00.101.498 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.390.500 I main: llama threadpool init, n_threads = 4
0.01.390.558 I 
0.01.390.599 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.01.390.600 I 
0.01.391.092 I sampler seed: 1234
0.01.391.099 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.391.160 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.391.166 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.391.166 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.493.929 I llama_perf_sampler_print:    sampling time =       1.31 ms /    71 runs   (    0.02 ms per token, 54281.35 tokens per second)
0.02.493.930 I llama_perf_context_print:        load time =    1380.68 ms
0.02.493.931 I llama_perf_context_print: prompt eval time =      42.04 ms /     7 tokens (    6.01 ms per token,   166.50 tokens per second)
0.02.493.931 I llama_perf_context_print:        eval time =    1057.71 ms /    63 runs   (   16.79 ms per token,    59.56 tokens per second)
0.02.493.932 I llama_perf_context_print:       total time =    1103.43 ms /    70 tokens
0.02.494.122 I ggml_metal_free: deallocating

real	0m2.510s
user	0m0.120s
sys	0m0.243s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.125 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.919 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.604 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.018.609 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.612 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.613 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.613 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.614 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.614 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.615 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.617 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.617 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.618 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.618 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.618 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.619 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.622 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.622 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.623 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.608 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.025.038 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.030.107 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.030.109 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.030.109 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.030.110 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.030.110 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.030.110 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.030.111 I llama_model_loader: - type  f32:  194 tensors
0.00.030.112 I llama_model_loader: - type q8_0:   98 tensors
0.00.055.480 I llm_load_vocab: special tokens cache size = 25
0.00.061.664 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.061.667 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.061.667 I llm_load_print_meta: arch             = gptneox
0.00.061.667 I llm_load_print_meta: vocab type       = BPE
0.00.061.668 I llm_load_print_meta: n_vocab          = 50304
0.00.061.668 I llm_load_print_meta: n_merges         = 50009
0.00.061.668 I llm_load_print_meta: vocab_only       = 0
0.00.061.668 I llm_load_print_meta: n_ctx_train      = 2048
0.00.061.668 I llm_load_print_meta: n_embd           = 2048
0.00.061.668 I llm_load_print_meta: n_layer          = 24
0.00.061.672 I llm_load_print_meta: n_head           = 16
0.00.061.673 I llm_load_print_meta: n_head_kv        = 16
0.00.061.673 I llm_load_print_meta: n_rot            = 32
0.00.061.673 I llm_load_print_meta: n_swa            = 0
0.00.061.673 I llm_load_print_meta: n_embd_head_k    = 128
0.00.061.674 I llm_load_print_meta: n_embd_head_v    = 128
0.00.061.674 I llm_load_print_meta: n_gqa            = 1
0.00.061.675 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.061.677 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.061.678 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.061.678 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.061.678 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.061.678 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.061.679 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.061.679 I llm_load_print_meta: n_ff             = 8192
0.00.061.679 I llm_load_print_meta: n_expert         = 0
0.00.061.680 I llm_load_print_meta: n_expert_used    = 0
0.00.061.680 I llm_load_print_meta: causal attn      = 1
0.00.061.680 I llm_load_print_meta: pooling type     = 0
0.00.061.680 I llm_load_print_meta: rope type        = 2
0.00.061.680 I llm_load_print_meta: rope scaling     = linear
0.00.061.680 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.061.681 I llm_load_print_meta: freq_scale_train = 1
0.00.061.681 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.061.681 I llm_load_print_meta: rope_finetuned   = unknown
0.00.061.681 I llm_load_print_meta: ssm_d_conv       = 0
0.00.061.681 I llm_load_print_meta: ssm_d_inner      = 0
0.00.061.681 I llm_load_print_meta: ssm_d_state      = 0
0.00.061.682 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.061.683 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.061.695 I llm_load_print_meta: model type       = 1.4B
0.00.061.695 I llm_load_print_meta: model ftype      = Q8_0
0.00.061.695 I llm_load_print_meta: model params     = 1.41 B
0.00.061.696 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.061.696 I llm_load_print_meta: general.name     = 1.4B
0.00.061.696 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.061.697 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.061.697 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.061.697 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.061.697 I llm_load_print_meta: LF token         = 128 ''
0.00.061.697 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.061.698 I llm_load_print_meta: max token length = 1024
0.00.064.045 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.064.046 I llm_load_tensors: offloading output layer to GPU
0.00.064.046 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.064.056 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.064.057 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.065.073 I llama_new_context_with_model: n_seq_max     = 1
0.00.065.074 I llama_new_context_with_model: n_ctx         = 128
0.00.065.074 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.065.074 I llama_new_context_with_model: n_batch       = 128
0.00.065.074 I llama_new_context_with_model: n_ubatch      = 128
0.00.065.074 I llama_new_context_with_model: flash_attn    = 0
0.00.065.075 I llama_new_context_with_model: freq_base     = 10000.0
0.00.065.075 I llama_new_context_with_model: freq_scale    = 1
0.00.065.076 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.065.076 I ggml_metal_init: allocating
0.00.065.082 I ggml_metal_init: found device: Apple M4
0.00.065.084 I ggml_metal_init: picking default device: Apple M4
0.00.065.699 I ggml_metal_init: using embedded metal library
0.00.068.006 I ggml_metal_init: GPU name:   Apple M4
0.00.068.008 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.068.008 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.068.009 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.068.009 I ggml_metal_init: simdgroup reduction   = true
0.00.068.009 I ggml_metal_init: simdgroup matrix mul. = true
0.00.068.009 I ggml_metal_init: has bfloat            = true
0.00.068.009 I ggml_metal_init: use bfloat            = true
0.00.068.010 I ggml_metal_init: hasUnifiedMemory      = true
0.00.068.010 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.077.739 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.077.743 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.077.759 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.078.777 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.078.778 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.078.778 I llama_new_context_with_model: graph nodes  = 967
0.00.078.779 I llama_new_context_with_model: graph splits = 2
0.00.078.793 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.856.900 I 
0.00.856.918 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.856.921 I perplexity: tokenizing the input ..
0.00.865.056 I perplexity: tokenization took 8.134 ms
0.00.865.068 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.986.559 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.00.988.140 I Final estimate: PPL = 10.1362 +/- 3.22437

0.00.988.155 I llama_perf_context_print:        load time =     845.98 ms
0.00.988.158 I llama_perf_context_print: prompt eval time =     121.25 ms /   128 tokens (    0.95 ms per token,  1055.63 tokens per second)
0.00.988.160 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.988.160 I llama_perf_context_print:       total time =     131.25 ms /   129 tokens
0.00.988.553 I ggml_metal_free: deallocating

real	0m1.004s
user	0m0.087s
sys	0m0.147s
```
- q4_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.042 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.072 I main: llama backend init
0.00.000.078 I main: load the model and apply lora adapter, if any
0.00.010.582 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.882 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.016.886 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.888 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.888 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.888 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.889 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.889 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.890 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.891 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.891 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.892 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.892 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.893 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.893 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.895 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.895 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.895 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.706 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.719 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.455 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.025.457 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.457 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.457 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.457 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.458 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.025.458 I llama_model_loader: - type  f32:  194 tensors
0.00.025.459 I llama_model_loader: - type q4_0:   97 tensors
0.00.025.459 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.771 I llm_load_vocab: special tokens cache size = 25
0.00.052.024 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.027 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.028 I llm_load_print_meta: arch             = gptneox
0.00.052.028 I llm_load_print_meta: vocab type       = BPE
0.00.052.028 I llm_load_print_meta: n_vocab          = 50304
0.00.052.029 I llm_load_print_meta: n_merges         = 50009
0.00.052.029 I llm_load_print_meta: vocab_only       = 0
0.00.052.029 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.029 I llm_load_print_meta: n_embd           = 2048
0.00.052.029 I llm_load_print_meta: n_layer          = 24
0.00.052.033 I llm_load_print_meta: n_head           = 16
0.00.052.033 I llm_load_print_meta: n_head_kv        = 16
0.00.052.035 I llm_load_print_meta: n_rot            = 32
0.00.052.035 I llm_load_print_meta: n_swa            = 0
0.00.052.035 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.035 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.036 I llm_load_print_meta: n_gqa            = 1
0.00.052.037 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.038 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.038 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.039 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.039 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.039 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.039 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.040 I llm_load_print_meta: n_ff             = 8192
0.00.052.040 I llm_load_print_meta: n_expert         = 0
0.00.052.040 I llm_load_print_meta: n_expert_used    = 0
0.00.052.041 I llm_load_print_meta: causal attn      = 1
0.00.052.041 I llm_load_print_meta: pooling type     = 0
0.00.052.041 I llm_load_print_meta: rope type        = 2
0.00.052.041 I llm_load_print_meta: rope scaling     = linear
0.00.052.041 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.042 I llm_load_print_meta: freq_scale_train = 1
0.00.052.042 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.042 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.042 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.043 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.043 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.043 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.043 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.055 I llm_load_print_meta: model type       = 1.4B
0.00.052.055 I llm_load_print_meta: model ftype      = Q4_0
0.00.052.056 I llm_load_print_meta: model params     = 1.41 B
0.00.052.056 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.052.056 I llm_load_print_meta: general.name     = 1.4B
0.00.052.056 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.057 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.057 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.057 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.057 I llm_load_print_meta: LF token         = 128 ''
0.00.052.057 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.058 I llm_load_print_meta: max token length = 1024
0.00.053.806 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.806 I llm_load_tensors: offloading output layer to GPU
0.00.053.807 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.817 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.053.818 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.054.677 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.677 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.678 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.678 I llama_new_context_with_model: n_batch       = 2048
0.00.054.678 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.678 I llama_new_context_with_model: flash_attn    = 0
0.00.054.679 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.679 I llama_new_context_with_model: freq_scale    = 1
0.00.054.679 I ggml_metal_init: allocating
0.00.054.682 I ggml_metal_init: found device: Apple M4
0.00.054.684 I ggml_metal_init: picking default device: Apple M4
0.00.055.341 I ggml_metal_init: using embedded metal library
0.00.057.431 I ggml_metal_init: GPU name:   Apple M4
0.00.057.433 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.433 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.434 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.434 I ggml_metal_init: simdgroup reduction   = true
0.00.057.434 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.434 I ggml_metal_init: has bfloat            = true
0.00.057.434 I ggml_metal_init: use bfloat            = true
0.00.057.435 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.435 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.087.529 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.087.540 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.087.565 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.088.685 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.088.687 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.088.687 I llama_new_context_with_model: graph nodes  = 967
0.00.088.687 I llama_new_context_with_model: graph splits = 2
0.00.088.711 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.648.985 I main: llama threadpool init, n_threads = 4
0.00.649.026 I 
0.00.649.064 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.649.066 I 
0.00.649.309 I sampler seed: 1234
0.00.649.314 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.649.358 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.649.360 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.649.360 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.327.088 I llama_perf_sampler_print:    sampling time =       1.27 ms /    71 runs   (    0.02 ms per token, 55817.61 tokens per second)
0.01.327.089 I llama_perf_context_print:        load time =     638.39 ms
0.01.327.090 I llama_perf_context_print: prompt eval time =      32.77 ms /     7 tokens (    4.68 ms per token,   213.58 tokens per second)
0.01.327.091 I llama_perf_context_print:        eval time =     641.85 ms /    63 runs   (   10.19 ms per token,    98.15 tokens per second)
0.01.327.091 I llama_perf_context_print:       total time =     678.11 ms /    70 tokens
0.01.327.275 I ggml_metal_free: deallocating

real	0m1.346s
user	0m0.109s
sys	0m0.153s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.084 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.754 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.479 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.015.483 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.485 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.486 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.486 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.486 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.487 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.487 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.488 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.488 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.489 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.490 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.490 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.491 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.492 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.492 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.493 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.333 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.536 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.697 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.024.698 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.698 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.699 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.699 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.699 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.024.700 I llama_model_loader: - type  f32:  194 tensors
0.00.024.700 I llama_model_loader: - type q4_0:   97 tensors
0.00.024.700 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.891 I llm_load_vocab: special tokens cache size = 25
0.00.051.060 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.063 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.063 I llm_load_print_meta: arch             = gptneox
0.00.051.063 I llm_load_print_meta: vocab type       = BPE
0.00.051.064 I llm_load_print_meta: n_vocab          = 50304
0.00.051.064 I llm_load_print_meta: n_merges         = 50009
0.00.051.064 I llm_load_print_meta: vocab_only       = 0
0.00.051.064 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.064 I llm_load_print_meta: n_embd           = 2048
0.00.051.065 I llm_load_print_meta: n_layer          = 24
0.00.051.067 I llm_load_print_meta: n_head           = 16
0.00.051.068 I llm_load_print_meta: n_head_kv        = 16
0.00.051.068 I llm_load_print_meta: n_rot            = 32
0.00.051.068 I llm_load_print_meta: n_swa            = 0
0.00.051.068 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.068 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.069 I llm_load_print_meta: n_gqa            = 1
0.00.051.070 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.071 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.071 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.071 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.072 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.072 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.072 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.073 I llm_load_print_meta: n_ff             = 8192
0.00.051.073 I llm_load_print_meta: n_expert         = 0
0.00.051.073 I llm_load_print_meta: n_expert_used    = 0
0.00.051.073 I llm_load_print_meta: causal attn      = 1
0.00.051.074 I llm_load_print_meta: pooling type     = 0
0.00.051.074 I llm_load_print_meta: rope type        = 2
0.00.051.074 I llm_load_print_meta: rope scaling     = linear
0.00.051.074 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.076 I llm_load_print_meta: freq_scale_train = 1
0.00.051.076 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.077 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.077 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.077 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.077 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.077 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.077 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.088 I llm_load_print_meta: model type       = 1.4B
0.00.051.088 I llm_load_print_meta: model ftype      = Q4_0
0.00.051.089 I llm_load_print_meta: model params     = 1.41 B
0.00.051.089 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.051.089 I llm_load_print_meta: general.name     = 1.4B
0.00.051.089 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.090 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.095 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.096 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.096 I llm_load_print_meta: LF token         = 128 ''
0.00.051.098 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.098 I llm_load_print_meta: max token length = 1024
0.00.052.600 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.600 I llm_load_tensors: offloading output layer to GPU
0.00.052.600 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.609 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.052.611 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.053.439 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.439 I llama_new_context_with_model: n_ctx         = 128
0.00.053.440 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.440 I llama_new_context_with_model: n_batch       = 128
0.00.053.440 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.440 I llama_new_context_with_model: flash_attn    = 0
0.00.053.441 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.441 I llama_new_context_with_model: freq_scale    = 1
0.00.053.441 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.442 I ggml_metal_init: allocating
0.00.053.445 I ggml_metal_init: found device: Apple M4
0.00.053.447 I ggml_metal_init: picking default device: Apple M4
0.00.053.974 I ggml_metal_init: using embedded metal library
0.00.055.908 I ggml_metal_init: GPU name:   Apple M4
0.00.055.910 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.910 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.911 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.911 I ggml_metal_init: simdgroup reduction   = true
0.00.055.911 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.911 I ggml_metal_init: has bfloat            = true
0.00.055.911 I ggml_metal_init: use bfloat            = true
0.00.055.912 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.912 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.266 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.268 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.282 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.144 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.145 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.146 I llama_new_context_with_model: graph nodes  = 967
0.00.066.146 I llama_new_context_with_model: graph splits = 2
0.00.066.161 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.591.451 I 
0.00.591.475 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.591.486 I perplexity: tokenizing the input ..
0.00.599.313 I perplexity: tokenization took 7.823 ms
0.00.599.324 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.721.948 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.723.182 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.723.198 I llama_perf_context_print:        load time =     581.69 ms
0.00.723.199 I llama_perf_context_print: prompt eval time =     122.40 ms /   128 tokens (    0.96 ms per token,  1045.76 tokens per second)
0.00.723.200 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.723.201 I llama_perf_context_print:       total time =     131.75 ms /   129 tokens
0.00.723.624 I ggml_metal_free: deallocating

real	0m0.740s
user	0m0.077s
sys	0m0.111s
```
- q4_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.071 I main: llama backend init
0.00.000.077 I main: load the model and apply lora adapter, if any
0.00.013.244 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.020.047 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.020.051 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.020.052 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.020.054 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.020.056 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.020.056 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.020.057 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.020.062 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.020.062 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.020.062 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.020.063 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.020.063 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.020.063 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.020.064 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.020.065 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.020.065 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.020.066 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.023.982 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.025.084 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.028.970 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.028.971 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.028.971 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.028.971 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.028.972 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.028.972 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.028.973 I llama_model_loader: - type  f32:  194 tensors
0.00.028.973 I llama_model_loader: - type q4_1:   97 tensors
0.00.028.973 I llama_model_loader: - type q6_K:    1 tensors
0.00.049.525 I llm_load_vocab: special tokens cache size = 25
0.00.055.612 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.055.615 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.055.615 I llm_load_print_meta: arch             = gptneox
0.00.055.615 I llm_load_print_meta: vocab type       = BPE
0.00.055.616 I llm_load_print_meta: n_vocab          = 50304
0.00.055.616 I llm_load_print_meta: n_merges         = 50009
0.00.055.616 I llm_load_print_meta: vocab_only       = 0
0.00.055.616 I llm_load_print_meta: n_ctx_train      = 2048
0.00.055.616 I llm_load_print_meta: n_embd           = 2048
0.00.055.616 I llm_load_print_meta: n_layer          = 24
0.00.055.619 I llm_load_print_meta: n_head           = 16
0.00.055.620 I llm_load_print_meta: n_head_kv        = 16
0.00.055.620 I llm_load_print_meta: n_rot            = 32
0.00.055.620 I llm_load_print_meta: n_swa            = 0
0.00.055.621 I llm_load_print_meta: n_embd_head_k    = 128
0.00.055.621 I llm_load_print_meta: n_embd_head_v    = 128
0.00.055.621 I llm_load_print_meta: n_gqa            = 1
0.00.055.622 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.055.623 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.055.623 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.055.624 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.055.624 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.055.624 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.055.624 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.055.625 I llm_load_print_meta: n_ff             = 8192
0.00.055.625 I llm_load_print_meta: n_expert         = 0
0.00.055.625 I llm_load_print_meta: n_expert_used    = 0
0.00.055.625 I llm_load_print_meta: causal attn      = 1
0.00.055.626 I llm_load_print_meta: pooling type     = 0
0.00.055.626 I llm_load_print_meta: rope type        = 2
0.00.055.626 I llm_load_print_meta: rope scaling     = linear
0.00.055.628 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.055.629 I llm_load_print_meta: freq_scale_train = 1
0.00.055.629 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.055.629 I llm_load_print_meta: rope_finetuned   = unknown
0.00.055.629 I llm_load_print_meta: ssm_d_conv       = 0
0.00.055.630 I llm_load_print_meta: ssm_d_inner      = 0
0.00.055.630 I llm_load_print_meta: ssm_d_state      = 0
0.00.055.630 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.055.630 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.055.642 I llm_load_print_meta: model type       = 1.4B
0.00.055.642 I llm_load_print_meta: model ftype      = Q4_1
0.00.055.642 I llm_load_print_meta: model params     = 1.41 B
0.00.055.643 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.055.643 I llm_load_print_meta: general.name     = 1.4B
0.00.055.643 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.055.643 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.055.643 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.055.644 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.055.644 I llm_load_print_meta: LF token         = 128 ''
0.00.055.644 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.055.644 I llm_load_print_meta: max token length = 1024
0.00.057.644 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.057.644 I llm_load_tensors: offloading output layer to GPU
0.00.057.645 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.057.654 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.057.655 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.058.603 I llama_new_context_with_model: n_seq_max     = 1
0.00.058.604 I llama_new_context_with_model: n_ctx         = 2048
0.00.058.604 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.058.604 I llama_new_context_with_model: n_batch       = 2048
0.00.058.604 I llama_new_context_with_model: n_ubatch      = 512
0.00.058.605 I llama_new_context_with_model: flash_attn    = 0
0.00.058.605 I llama_new_context_with_model: freq_base     = 10000.0
0.00.058.605 I llama_new_context_with_model: freq_scale    = 1
0.00.058.606 I ggml_metal_init: allocating
0.00.058.612 I ggml_metal_init: found device: Apple M4
0.00.058.614 I ggml_metal_init: picking default device: Apple M4
0.00.059.146 I ggml_metal_init: using embedded metal library
0.00.061.123 I ggml_metal_init: GPU name:   Apple M4
0.00.061.124 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.061.125 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.061.125 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.061.125 I ggml_metal_init: simdgroup reduction   = true
0.00.061.125 I ggml_metal_init: simdgroup matrix mul. = true
0.00.061.126 I ggml_metal_init: has bfloat            = true
0.00.061.126 I ggml_metal_init: use bfloat            = true
0.00.061.126 I ggml_metal_init: hasUnifiedMemory      = true
0.00.061.127 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.088.651 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.088.660 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.088.679 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.089.767 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.089.768 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.089.769 I llama_new_context_with_model: graph nodes  = 967
0.00.089.769 I llama_new_context_with_model: graph splits = 2
0.00.089.791 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.699.493 I main: llama threadpool init, n_threads = 4
0.00.699.536 I 
0.00.699.561 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.699.561 I 
0.00.699.790 I sampler seed: 1234
0.00.699.795 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.699.841 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.699.843 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.699.843 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.433.017 I llama_perf_sampler_print:    sampling time =       1.15 ms /    71 runs   (    0.02 ms per token, 62008.73 tokens per second)
0.01.433.018 I llama_perf_context_print:        load time =     686.24 ms
0.01.433.018 I llama_perf_context_print: prompt eval time =      40.47 ms /     7 tokens (    5.78 ms per token,   172.96 tokens per second)
0.01.433.019 I llama_perf_context_print:        eval time =     689.76 ms /    63 runs   (   10.95 ms per token,    91.34 tokens per second)
0.01.433.019 I llama_perf_context_print:       total time =     733.53 ms /    70 tokens
0.01.433.194 I ggml_metal_free: deallocating

real	0m1.451s
user	0m0.109s
sys	0m0.149s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.088 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.906 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.772 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.014.776 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.778 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.778 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.779 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.779 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.779 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.780 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.781 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.781 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.781 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.781 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.782 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.782 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.784 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.784 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.784 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.679 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.761 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.648 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.023.649 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.649 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.649 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.650 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.650 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.023.650 I llama_model_loader: - type  f32:  194 tensors
0.00.023.651 I llama_model_loader: - type q4_1:   97 tensors
0.00.023.651 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.059 I llm_load_vocab: special tokens cache size = 25
0.00.050.130 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.135 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.138 I llm_load_print_meta: arch             = gptneox
0.00.050.138 I llm_load_print_meta: vocab type       = BPE
0.00.050.139 I llm_load_print_meta: n_vocab          = 50304
0.00.050.139 I llm_load_print_meta: n_merges         = 50009
0.00.050.139 I llm_load_print_meta: vocab_only       = 0
0.00.050.139 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.139 I llm_load_print_meta: n_embd           = 2048
0.00.050.140 I llm_load_print_meta: n_layer          = 24
0.00.050.142 I llm_load_print_meta: n_head           = 16
0.00.050.144 I llm_load_print_meta: n_head_kv        = 16
0.00.050.144 I llm_load_print_meta: n_rot            = 32
0.00.050.145 I llm_load_print_meta: n_swa            = 0
0.00.050.145 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.145 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.146 I llm_load_print_meta: n_gqa            = 1
0.00.050.157 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.172 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.175 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.175 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.175 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.175 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.176 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.178 I llm_load_print_meta: n_ff             = 8192
0.00.050.179 I llm_load_print_meta: n_expert         = 0
0.00.050.179 I llm_load_print_meta: n_expert_used    = 0
0.00.050.179 I llm_load_print_meta: causal attn      = 1
0.00.050.179 I llm_load_print_meta: pooling type     = 0
0.00.050.179 I llm_load_print_meta: rope type        = 2
0.00.050.179 I llm_load_print_meta: rope scaling     = linear
0.00.050.180 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.180 I llm_load_print_meta: freq_scale_train = 1
0.00.050.180 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.180 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.180 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.181 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.181 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.181 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.181 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.188 I llm_load_print_meta: model type       = 1.4B
0.00.050.188 I llm_load_print_meta: model ftype      = Q4_1
0.00.050.189 I llm_load_print_meta: model params     = 1.41 B
0.00.050.189 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.050.189 I llm_load_print_meta: general.name     = 1.4B
0.00.050.189 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.190 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.190 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.190 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.190 I llm_load_print_meta: LF token         = 128 ''
0.00.050.193 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.193 I llm_load_print_meta: max token length = 1024
0.00.052.185 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.185 I llm_load_tensors: offloading output layer to GPU
0.00.052.185 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.195 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.052.196 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.053.208 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.209 I llama_new_context_with_model: n_ctx         = 128
0.00.053.209 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.209 I llama_new_context_with_model: n_batch       = 128
0.00.053.210 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.210 I llama_new_context_with_model: flash_attn    = 0
0.00.053.210 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.210 I llama_new_context_with_model: freq_scale    = 1
0.00.053.211 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.211 I ggml_metal_init: allocating
0.00.053.218 I ggml_metal_init: found device: Apple M4
0.00.053.220 I ggml_metal_init: picking default device: Apple M4
0.00.053.807 I ggml_metal_init: using embedded metal library
0.00.055.741 I ggml_metal_init: GPU name:   Apple M4
0.00.055.742 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.743 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.745 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.745 I ggml_metal_init: simdgroup reduction   = true
0.00.055.745 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.745 I ggml_metal_init: has bfloat            = true
0.00.055.745 I ggml_metal_init: use bfloat            = true
0.00.055.746 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.747 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.959 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.961 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.975 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.915 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.917 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.917 I llama_new_context_with_model: graph nodes  = 967
0.00.065.917 I llama_new_context_with_model: graph splits = 2
0.00.065.929 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.632.828 I 
0.00.632.847 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.632.849 I perplexity: tokenizing the input ..
0.00.640.679 I perplexity: tokenization took 7.829 ms
0.00.640.693 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.763.904 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.765.119 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.765.141 I llama_perf_context_print:        load time =     623.92 ms
0.00.765.142 I llama_perf_context_print: prompt eval time =     122.96 ms /   128 tokens (    0.96 ms per token,  1040.96 tokens per second)
0.00.765.143 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.765.143 I llama_perf_context_print:       total time =     132.31 ms /   129 tokens
0.00.765.535 I ggml_metal_free: deallocating

real	0m0.779s
user	0m0.076s
sys	0m0.106s
```
- q5_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.044 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.076 I main: llama backend init
0.00.000.082 I main: load the model and apply lora adapter, if any
0.00.010.170 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.796 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.016.800 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.802 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.802 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.802 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.803 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.803 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.804 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.804 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.805 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.805 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.805 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.806 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.806 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.810 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.811 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.815 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.723 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.782 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.607 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.025.608 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.609 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.609 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.609 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.610 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.025.610 I llama_model_loader: - type  f32:  194 tensors
0.00.025.611 I llama_model_loader: - type q5_0:   97 tensors
0.00.025.611 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.172 I llm_load_vocab: special tokens cache size = 25
0.00.052.400 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.403 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.403 I llm_load_print_meta: arch             = gptneox
0.00.052.403 I llm_load_print_meta: vocab type       = BPE
0.00.052.404 I llm_load_print_meta: n_vocab          = 50304
0.00.052.404 I llm_load_print_meta: n_merges         = 50009
0.00.052.404 I llm_load_print_meta: vocab_only       = 0
0.00.052.404 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.404 I llm_load_print_meta: n_embd           = 2048
0.00.052.405 I llm_load_print_meta: n_layer          = 24
0.00.052.407 I llm_load_print_meta: n_head           = 16
0.00.052.408 I llm_load_print_meta: n_head_kv        = 16
0.00.052.408 I llm_load_print_meta: n_rot            = 32
0.00.052.409 I llm_load_print_meta: n_swa            = 0
0.00.052.409 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.409 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.410 I llm_load_print_meta: n_gqa            = 1
0.00.052.410 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.413 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.413 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.415 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.415 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.415 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.416 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.416 I llm_load_print_meta: n_ff             = 8192
0.00.052.417 I llm_load_print_meta: n_expert         = 0
0.00.052.417 I llm_load_print_meta: n_expert_used    = 0
0.00.052.418 I llm_load_print_meta: causal attn      = 1
0.00.052.419 I llm_load_print_meta: pooling type     = 0
0.00.052.419 I llm_load_print_meta: rope type        = 2
0.00.052.420 I llm_load_print_meta: rope scaling     = linear
0.00.052.420 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.420 I llm_load_print_meta: freq_scale_train = 1
0.00.052.420 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.421 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.421 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.421 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.421 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.421 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.421 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.433 I llm_load_print_meta: model type       = 1.4B
0.00.052.434 I llm_load_print_meta: model ftype      = Q5_0
0.00.052.434 I llm_load_print_meta: model params     = 1.41 B
0.00.052.435 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.052.435 I llm_load_print_meta: general.name     = 1.4B
0.00.052.435 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.436 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.436 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.436 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.436 I llm_load_print_meta: LF token         = 128 ''
0.00.052.436 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.438 I llm_load_print_meta: max token length = 1024
0.00.054.380 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.381 I llm_load_tensors: offloading output layer to GPU
0.00.054.381 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.391 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.054.391 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.055.289 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.290 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.290 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.290 I llama_new_context_with_model: n_batch       = 2048
0.00.055.290 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.291 I llama_new_context_with_model: flash_attn    = 0
0.00.055.291 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.291 I llama_new_context_with_model: freq_scale    = 1
0.00.055.292 I ggml_metal_init: allocating
0.00.055.298 I ggml_metal_init: found device: Apple M4
0.00.055.301 I ggml_metal_init: picking default device: Apple M4
0.00.055.845 I ggml_metal_init: using embedded metal library
0.00.057.839 I ggml_metal_init: GPU name:   Apple M4
0.00.057.841 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.841 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.842 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.842 I ggml_metal_init: simdgroup reduction   = true
0.00.057.842 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.842 I ggml_metal_init: has bfloat            = true
0.00.057.842 I ggml_metal_init: use bfloat            = true
0.00.057.843 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.845 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.677 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.686 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.704 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.722 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.723 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.724 I llama_new_context_with_model: graph nodes  = 967
0.00.086.724 I llama_new_context_with_model: graph splits = 2
0.00.086.747 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.719.294 I main: llama threadpool init, n_threads = 4
0.00.719.335 I 
0.00.719.358 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.719.358 I 
0.00.719.588 I sampler seed: 1234
0.00.719.592 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.719.603 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.719.604 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.719.604 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.512.235 I llama_perf_sampler_print:    sampling time =       1.20 ms /    71 runs   (    0.02 ms per token, 59364.55 tokens per second)
0.01.512.236 I llama_perf_context_print:        load time =     709.12 ms
0.01.512.237 I llama_perf_context_print: prompt eval time =      40.26 ms /     7 tokens (    5.75 ms per token,   173.87 tokens per second)
0.01.512.238 I llama_perf_context_print:        eval time =     749.30 ms /    63 runs   (   11.89 ms per token,    84.08 tokens per second)
0.01.512.238 I llama_perf_context_print:       total time =     792.94 ms /    70 tokens
0.01.512.416 I ggml_metal_free: deallocating

real	0m1.531s
user	0m0.109s
sys	0m0.160s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.092 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.883 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.739 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.015.744 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.746 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.746 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.747 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.747 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.747 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.748 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.748 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.749 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.749 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.749 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.750 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.750 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.752 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.752 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.752 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.555 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.579 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.453 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.024.454 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.454 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.455 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.455 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.455 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.024.456 I llama_model_loader: - type  f32:  194 tensors
0.00.024.456 I llama_model_loader: - type q5_0:   97 tensors
0.00.024.456 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.445 I llm_load_vocab: special tokens cache size = 25
0.00.051.665 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.668 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.668 I llm_load_print_meta: arch             = gptneox
0.00.051.668 I llm_load_print_meta: vocab type       = BPE
0.00.051.668 I llm_load_print_meta: n_vocab          = 50304
0.00.051.669 I llm_load_print_meta: n_merges         = 50009
0.00.051.669 I llm_load_print_meta: vocab_only       = 0
0.00.051.669 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.669 I llm_load_print_meta: n_embd           = 2048
0.00.051.669 I llm_load_print_meta: n_layer          = 24
0.00.051.672 I llm_load_print_meta: n_head           = 16
0.00.051.673 I llm_load_print_meta: n_head_kv        = 16
0.00.051.673 I llm_load_print_meta: n_rot            = 32
0.00.051.673 I llm_load_print_meta: n_swa            = 0
0.00.051.673 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.673 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.675 I llm_load_print_meta: n_gqa            = 1
0.00.051.676 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.677 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.677 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.678 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.678 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.678 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.678 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.679 I llm_load_print_meta: n_ff             = 8192
0.00.051.679 I llm_load_print_meta: n_expert         = 0
0.00.051.679 I llm_load_print_meta: n_expert_used    = 0
0.00.051.679 I llm_load_print_meta: causal attn      = 1
0.00.051.680 I llm_load_print_meta: pooling type     = 0
0.00.051.680 I llm_load_print_meta: rope type        = 2
0.00.051.680 I llm_load_print_meta: rope scaling     = linear
0.00.051.682 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.682 I llm_load_print_meta: freq_scale_train = 1
0.00.051.683 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.683 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.683 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.683 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.683 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.683 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.683 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.695 I llm_load_print_meta: model type       = 1.4B
0.00.051.695 I llm_load_print_meta: model ftype      = Q5_0
0.00.051.696 I llm_load_print_meta: model params     = 1.41 B
0.00.051.697 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.051.697 I llm_load_print_meta: general.name     = 1.4B
0.00.051.697 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.697 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.697 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.698 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.698 I llm_load_print_meta: LF token         = 128 ''
0.00.051.698 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.698 I llm_load_print_meta: max token length = 1024
0.00.053.267 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.268 I llm_load_tensors: offloading output layer to GPU
0.00.053.268 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.277 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.053.278 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.054.117 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.118 I llama_new_context_with_model: n_ctx         = 128
0.00.054.118 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.118 I llama_new_context_with_model: n_batch       = 128
0.00.054.118 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.118 I llama_new_context_with_model: flash_attn    = 0
0.00.054.119 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.119 I llama_new_context_with_model: freq_scale    = 1
0.00.054.119 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.120 I ggml_metal_init: allocating
0.00.054.126 I ggml_metal_init: found device: Apple M4
0.00.054.130 I ggml_metal_init: picking default device: Apple M4
0.00.054.665 I ggml_metal_init: using embedded metal library
0.00.056.578 I ggml_metal_init: GPU name:   Apple M4
0.00.056.580 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.580 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.581 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.581 I ggml_metal_init: simdgroup reduction   = true
0.00.056.581 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.581 I ggml_metal_init: has bfloat            = true
0.00.056.581 I ggml_metal_init: use bfloat            = true
0.00.056.582 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.582 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.522 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.525 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.539 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.431 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.433 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.433 I llama_new_context_with_model: graph nodes  = 967
0.00.066.433 I llama_new_context_with_model: graph splits = 2
0.00.066.445 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.673.048 I 
0.00.673.070 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.673.074 I perplexity: tokenizing the input ..
0.00.680.729 I perplexity: tokenization took 7.654 ms
0.00.680.740 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.815.615 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.816.857 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.816.878 I llama_perf_context_print:        load time =     663.16 ms
0.00.816.879 I llama_perf_context_print: prompt eval time =     134.65 ms /   128 tokens (    1.05 ms per token,   950.61 tokens per second)
0.00.816.880 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.816.880 I llama_perf_context_print:       total time =     143.83 ms /   129 tokens
0.00.817.338 I ggml_metal_free: deallocating

real	0m0.834s
user	0m0.077s
sys	0m0.125s
```
- q5_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.043 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.073 I main: llama backend init
0.00.000.079 I main: load the model and apply lora adapter, if any
0.00.010.047 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.689 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.016.693 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.695 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.699 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.699 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.700 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.700 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.702 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.703 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.703 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.703 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.704 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.704 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.707 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.709 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.709 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.710 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.651 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.724 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.620 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.025.621 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.622 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.622 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.622 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.622 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.025.623 I llama_model_loader: - type  f32:  194 tensors
0.00.025.623 I llama_model_loader: - type q5_1:   97 tensors
0.00.025.624 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.828 I llm_load_vocab: special tokens cache size = 25
0.00.052.964 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.967 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.967 I llm_load_print_meta: arch             = gptneox
0.00.052.967 I llm_load_print_meta: vocab type       = BPE
0.00.052.968 I llm_load_print_meta: n_vocab          = 50304
0.00.052.968 I llm_load_print_meta: n_merges         = 50009
0.00.052.968 I llm_load_print_meta: vocab_only       = 0
0.00.052.968 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.968 I llm_load_print_meta: n_embd           = 2048
0.00.052.969 I llm_load_print_meta: n_layer          = 24
0.00.052.971 I llm_load_print_meta: n_head           = 16
0.00.052.972 I llm_load_print_meta: n_head_kv        = 16
0.00.052.972 I llm_load_print_meta: n_rot            = 32
0.00.052.973 I llm_load_print_meta: n_swa            = 0
0.00.052.973 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.973 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.974 I llm_load_print_meta: n_gqa            = 1
0.00.052.975 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.976 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.976 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.976 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.977 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.977 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.977 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.978 I llm_load_print_meta: n_ff             = 8192
0.00.052.978 I llm_load_print_meta: n_expert         = 0
0.00.052.978 I llm_load_print_meta: n_expert_used    = 0
0.00.052.978 I llm_load_print_meta: causal attn      = 1
0.00.052.978 I llm_load_print_meta: pooling type     = 0
0.00.052.978 I llm_load_print_meta: rope type        = 2
0.00.052.979 I llm_load_print_meta: rope scaling     = linear
0.00.052.979 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.979 I llm_load_print_meta: freq_scale_train = 1
0.00.052.980 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.980 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.980 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.980 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.980 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.980 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.981 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.992 I llm_load_print_meta: model type       = 1.4B
0.00.052.992 I llm_load_print_meta: model ftype      = Q5_1
0.00.052.993 I llm_load_print_meta: model params     = 1.41 B
0.00.052.993 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.052.993 I llm_load_print_meta: general.name     = 1.4B
0.00.052.994 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.994 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.994 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.994 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.994 I llm_load_print_meta: LF token         = 128 ''
0.00.052.995 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.995 I llm_load_print_meta: max token length = 1024
0.00.054.657 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.657 I llm_load_tensors: offloading output layer to GPU
0.00.054.657 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.667 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.054.668 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.055.565 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.566 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.567 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.567 I llama_new_context_with_model: n_batch       = 2048
0.00.055.567 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.567 I llama_new_context_with_model: flash_attn    = 0
0.00.055.568 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.568 I llama_new_context_with_model: freq_scale    = 1
0.00.055.568 I ggml_metal_init: allocating
0.00.055.572 I ggml_metal_init: found device: Apple M4
0.00.055.574 I ggml_metal_init: picking default device: Apple M4
0.00.056.162 I ggml_metal_init: using embedded metal library
0.00.058.141 I ggml_metal_init: GPU name:   Apple M4
0.00.058.143 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.143 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.144 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.144 I ggml_metal_init: simdgroup reduction   = true
0.00.058.144 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.144 I ggml_metal_init: has bfloat            = true
0.00.058.144 I ggml_metal_init: use bfloat            = true
0.00.058.145 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.145 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.086.991 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.997 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.087.014 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.913 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.915 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.915 I llama_new_context_with_model: graph nodes  = 967
0.00.087.915 I llama_new_context_with_model: graph splits = 2
0.00.087.926 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.742.059 I main: llama threadpool init, n_threads = 4
0.00.742.103 I 
0.00.742.130 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.742.130 I 
0.00.742.299 I sampler seed: 1234
0.00.742.305 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.742.315 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.742.315 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.742.315 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, literature and art.

If one's life is not happy, one can have no other way but

0.01.601.060 I llama_perf_sampler_print:    sampling time =       1.22 ms /    71 runs   (    0.02 ms per token, 58149.06 tokens per second)
0.01.601.061 I llama_perf_context_print:        load time =     732.00 ms
0.01.601.062 I llama_perf_context_print: prompt eval time =      36.70 ms /     7 tokens (    5.24 ms per token,   190.71 tokens per second)
0.01.601.063 I llama_perf_context_print:        eval time =     819.01 ms /    63 runs   (   13.00 ms per token,    76.92 tokens per second)
0.01.601.063 I llama_perf_context_print:       total time =     859.01 ms /    70 tokens
0.01.601.232 I ggml_metal_free: deallocating

real	0m1.621s
user	0m0.111s
sys	0m0.170s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.090 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.727 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.406 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.014.410 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.411 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.412 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.412 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.412 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.413 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.413 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.414 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.414 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.414 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.415 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.415 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.415 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.417 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.417 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.417 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.183 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.228 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.046 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.023.047 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.047 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.048 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.048 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.048 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.023.049 I llama_model_loader: - type  f32:  194 tensors
0.00.023.049 I llama_model_loader: - type q5_1:   97 tensors
0.00.023.049 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.304 I llm_load_vocab: special tokens cache size = 25
0.00.049.449 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.453 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.453 I llm_load_print_meta: arch             = gptneox
0.00.049.454 I llm_load_print_meta: vocab type       = BPE
0.00.049.454 I llm_load_print_meta: n_vocab          = 50304
0.00.049.454 I llm_load_print_meta: n_merges         = 50009
0.00.049.454 I llm_load_print_meta: vocab_only       = 0
0.00.049.455 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.456 I llm_load_print_meta: n_embd           = 2048
0.00.049.456 I llm_load_print_meta: n_layer          = 24
0.00.049.459 I llm_load_print_meta: n_head           = 16
0.00.049.460 I llm_load_print_meta: n_head_kv        = 16
0.00.049.460 I llm_load_print_meta: n_rot            = 32
0.00.049.460 I llm_load_print_meta: n_swa            = 0
0.00.049.460 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.460 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.461 I llm_load_print_meta: n_gqa            = 1
0.00.049.462 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.462 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.463 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.464 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.464 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.465 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.465 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.465 I llm_load_print_meta: n_ff             = 8192
0.00.049.466 I llm_load_print_meta: n_expert         = 0
0.00.049.467 I llm_load_print_meta: n_expert_used    = 0
0.00.049.467 I llm_load_print_meta: causal attn      = 1
0.00.049.467 I llm_load_print_meta: pooling type     = 0
0.00.049.467 I llm_load_print_meta: rope type        = 2
0.00.049.468 I llm_load_print_meta: rope scaling     = linear
0.00.049.468 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.468 I llm_load_print_meta: freq_scale_train = 1
0.00.049.469 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.469 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.469 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.469 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.469 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.469 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.469 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.476 I llm_load_print_meta: model type       = 1.4B
0.00.049.477 I llm_load_print_meta: model ftype      = Q5_1
0.00.049.477 I llm_load_print_meta: model params     = 1.41 B
0.00.049.477 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.049.477 I llm_load_print_meta: general.name     = 1.4B
0.00.049.478 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.478 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.478 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.478 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.478 I llm_load_print_meta: LF token         = 128 ''
0.00.049.479 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.479 I llm_load_print_meta: max token length = 1024
0.00.051.280 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.280 I llm_load_tensors: offloading output layer to GPU
0.00.051.280 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.285 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.051.285 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.052.336 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.337 I llama_new_context_with_model: n_ctx         = 128
0.00.052.337 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.338 I llama_new_context_with_model: n_batch       = 128
0.00.052.338 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.338 I llama_new_context_with_model: flash_attn    = 0
0.00.052.338 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.339 I llama_new_context_with_model: freq_scale    = 1
0.00.052.339 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.339 I ggml_metal_init: allocating
0.00.052.345 I ggml_metal_init: found device: Apple M4
0.00.052.348 I ggml_metal_init: picking default device: Apple M4
0.00.052.918 I ggml_metal_init: using embedded metal library
0.00.054.851 I ggml_metal_init: GPU name:   Apple M4
0.00.054.852 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.054.852 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.054.853 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.054.853 I ggml_metal_init: simdgroup reduction   = true
0.00.054.853 I ggml_metal_init: simdgroup matrix mul. = true
0.00.054.853 I ggml_metal_init: has bfloat            = true
0.00.054.853 I ggml_metal_init: use bfloat            = true
0.00.054.854 I ggml_metal_init: hasUnifiedMemory      = true
0.00.054.854 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.847 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.849 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.865 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.064.718 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.064.720 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.064.720 I llama_new_context_with_model: graph nodes  = 967
0.00.064.720 I llama_new_context_with_model: graph splits = 2
0.00.064.733 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.625.877 I 
0.00.625.901 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.625.906 I perplexity: tokenizing the input ..
0.00.633.753 I perplexity: tokenization took 7.846 ms
0.00.633.764 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.768.920 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.770.142 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.770.155 I llama_perf_context_print:        load time =     617.15 ms
0.00.770.156 I llama_perf_context_print: prompt eval time =     134.91 ms /   128 tokens (    1.05 ms per token,   948.75 tokens per second)
0.00.770.157 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.770.157 I llama_perf_context_print:       total time =     144.28 ms /   129 tokens
0.00.770.674 I ggml_metal_free: deallocating

real	0m0.784s
user	0m0.076s
sys	0m0.120s
```
- q2_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.041 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.071 I main: llama backend init
0.00.000.078 I main: load the model and apply lora adapter, if any
0.00.009.707 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.359 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.364 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.366 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.366 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.367 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.367 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.367 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.368 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.368 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.369 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.369 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.369 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.370 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.370 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.372 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.372 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.372 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.285 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.367 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.195 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.024.196 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.196 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.196 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.197 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.197 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.197 I llama_model_loader: - type  f32:  194 tensors
0.00.024.198 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.198 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.198 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.030 I llm_load_vocab: special tokens cache size = 25
0.00.051.139 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.141 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.142 I llm_load_print_meta: arch             = gptneox
0.00.051.142 I llm_load_print_meta: vocab type       = BPE
0.00.051.142 I llm_load_print_meta: n_vocab          = 50304
0.00.051.143 I llm_load_print_meta: n_merges         = 50009
0.00.051.143 I llm_load_print_meta: vocab_only       = 0
0.00.051.143 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.143 I llm_load_print_meta: n_embd           = 2048
0.00.051.143 I llm_load_print_meta: n_layer          = 24
0.00.051.145 I llm_load_print_meta: n_head           = 16
0.00.051.146 I llm_load_print_meta: n_head_kv        = 16
0.00.051.146 I llm_load_print_meta: n_rot            = 32
0.00.051.147 I llm_load_print_meta: n_swa            = 0
0.00.051.147 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.147 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.148 I llm_load_print_meta: n_gqa            = 1
0.00.051.148 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.149 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.150 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.150 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.151 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.151 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.151 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.152 I llm_load_print_meta: n_ff             = 8192
0.00.051.152 I llm_load_print_meta: n_expert         = 0
0.00.051.152 I llm_load_print_meta: n_expert_used    = 0
0.00.051.152 I llm_load_print_meta: causal attn      = 1
0.00.051.152 I llm_load_print_meta: pooling type     = 0
0.00.051.152 I llm_load_print_meta: rope type        = 2
0.00.051.152 I llm_load_print_meta: rope scaling     = linear
0.00.051.153 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.153 I llm_load_print_meta: freq_scale_train = 1
0.00.051.153 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.153 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.154 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.154 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.154 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.154 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.154 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.161 I llm_load_print_meta: model type       = 1.4B
0.00.051.161 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.051.161 I llm_load_print_meta: model params     = 1.41 B
0.00.051.162 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.051.162 I llm_load_print_meta: general.name     = 1.4B
0.00.051.163 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.163 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.163 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.163 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.163 I llm_load_print_meta: LF token         = 128 ''
0.00.051.164 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.164 I llm_load_print_meta: max token length = 1024
0.00.052.672 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.672 I llm_load_tensors: offloading output layer to GPU
0.00.052.673 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.677 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.052.678 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.053.547 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.548 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.548 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.548 I llama_new_context_with_model: n_batch       = 2048
0.00.053.548 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.549 I llama_new_context_with_model: flash_attn    = 0
0.00.053.549 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.549 I llama_new_context_with_model: freq_scale    = 1
0.00.053.550 I ggml_metal_init: allocating
0.00.053.556 I ggml_metal_init: found device: Apple M4
0.00.053.558 I ggml_metal_init: picking default device: Apple M4
0.00.054.108 I ggml_metal_init: using embedded metal library
0.00.056.024 I ggml_metal_init: GPU name:   Apple M4
0.00.056.025 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.026 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.026 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.026 I ggml_metal_init: simdgroup reduction   = true
0.00.056.026 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.026 I ggml_metal_init: has bfloat            = true
0.00.056.027 I ggml_metal_init: use bfloat            = true
0.00.056.027 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.028 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.083.495 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.083.503 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.083.528 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.084.524 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.084.525 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.084.526 I llama_new_context_with_model: graph nodes  = 967
0.00.084.526 I llama_new_context_with_model: graph splits = 2
0.00.084.548 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.442.350 I main: llama threadpool init, n_threads = 4
0.00.442.389 I 
0.00.442.406 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.442.406 I 
0.00.442.660 I sampler seed: 1234
0.00.442.666 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.442.696 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.442.698 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.442.698 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.122.017 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59663.87 tokens per second)
0.01.122.018 I llama_perf_context_print:        load time =     432.64 ms
0.01.122.019 I llama_perf_context_print: prompt eval time =      35.83 ms /     7 tokens (    5.12 ms per token,   195.35 tokens per second)
0.01.122.019 I llama_perf_context_print:        eval time =     640.47 ms /    63 runs   (   10.17 ms per token,    98.36 tokens per second)
0.01.122.020 I llama_perf_context_print:       total time =     679.67 ms /    70 tokens
0.01.122.199 I ggml_metal_free: deallocating

real	0m1.142s
user	0m0.109s
sys	0m0.110s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.100 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.619 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.201 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.206 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.208 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.208 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.208 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.209 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.209 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.210 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.210 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.210 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.211 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.211 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.211 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.212 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.215 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.215 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.215 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.102 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.150 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.011 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.024.012 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.013 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.013 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.013 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.014 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.014 I llama_model_loader: - type  f32:  194 tensors
0.00.024.015 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.015 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.015 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.901 I llm_load_vocab: special tokens cache size = 25
0.00.051.120 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.123 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.123 I llm_load_print_meta: arch             = gptneox
0.00.051.124 I llm_load_print_meta: vocab type       = BPE
0.00.051.124 I llm_load_print_meta: n_vocab          = 50304
0.00.051.124 I llm_load_print_meta: n_merges         = 50009
0.00.051.124 I llm_load_print_meta: vocab_only       = 0
0.00.051.124 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.125 I llm_load_print_meta: n_embd           = 2048
0.00.051.125 I llm_load_print_meta: n_layer          = 24
0.00.051.127 I llm_load_print_meta: n_head           = 16
0.00.051.128 I llm_load_print_meta: n_head_kv        = 16
0.00.051.128 I llm_load_print_meta: n_rot            = 32
0.00.051.128 I llm_load_print_meta: n_swa            = 0
0.00.051.129 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.129 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.130 I llm_load_print_meta: n_gqa            = 1
0.00.051.130 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.131 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.132 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.132 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.132 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.134 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.134 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.135 I llm_load_print_meta: n_ff             = 8192
0.00.051.135 I llm_load_print_meta: n_expert         = 0
0.00.051.135 I llm_load_print_meta: n_expert_used    = 0
0.00.051.135 I llm_load_print_meta: causal attn      = 1
0.00.051.135 I llm_load_print_meta: pooling type     = 0
0.00.051.136 I llm_load_print_meta: rope type        = 2
0.00.051.136 I llm_load_print_meta: rope scaling     = linear
0.00.051.138 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.138 I llm_load_print_meta: freq_scale_train = 1
0.00.051.138 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.139 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.139 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.139 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.139 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.139 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.139 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.145 I llm_load_print_meta: model type       = 1.4B
0.00.051.146 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.051.146 I llm_load_print_meta: model params     = 1.41 B
0.00.051.147 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.051.147 I llm_load_print_meta: general.name     = 1.4B
0.00.051.147 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.147 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.147 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.148 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.148 I llm_load_print_meta: LF token         = 128 ''
0.00.051.148 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.149 I llm_load_print_meta: max token length = 1024
0.00.052.653 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.653 I llm_load_tensors: offloading output layer to GPU
0.00.052.654 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.658 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.052.658 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.053.504 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.505 I llama_new_context_with_model: n_ctx         = 128
0.00.053.505 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.505 I llama_new_context_with_model: n_batch       = 128
0.00.053.506 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.506 I llama_new_context_with_model: flash_attn    = 0
0.00.053.506 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.507 I llama_new_context_with_model: freq_scale    = 1
0.00.053.507 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.508 I ggml_metal_init: allocating
0.00.053.513 I ggml_metal_init: found device: Apple M4
0.00.053.516 I ggml_metal_init: picking default device: Apple M4
0.00.054.040 I ggml_metal_init: using embedded metal library
0.00.055.960 I ggml_metal_init: GPU name:   Apple M4
0.00.055.961 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.962 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.962 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.962 I ggml_metal_init: simdgroup reduction   = true
0.00.055.962 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.962 I ggml_metal_init: has bfloat            = true
0.00.055.963 I ggml_metal_init: use bfloat            = true
0.00.055.963 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.964 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.100 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.104 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.130 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.977 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.978 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.979 I llama_new_context_with_model: graph nodes  = 967
0.00.065.979 I llama_new_context_with_model: graph splits = 2
0.00.065.991 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.399.902 I 
0.00.399.941 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.399.951 I perplexity: tokenizing the input ..
0.00.407.912 I perplexity: tokenization took 7.962 ms
0.00.407.924 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.539.926 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.541.441 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.541.453 I llama_perf_context_print:        load time =     390.28 ms
0.00.541.454 I llama_perf_context_print: prompt eval time =     131.77 ms /   128 tokens (    1.03 ms per token,   971.36 tokens per second)
0.00.541.455 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.541.456 I llama_perf_context_print:       total time =     141.55 ms /   129 tokens
0.00.541.962 I ggml_metal_free: deallocating

real	0m0.558s
user	0m0.076s
sys	0m0.078s
```
- q3_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.043 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.074 I main: llama backend init
0.00.000.080 I main: load the model and apply lora adapter, if any
0.00.009.744 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.213 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.016.218 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.220 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.220 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.225 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.226 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.226 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.227 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.227 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.227 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.228 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.228 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.228 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.229 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.232 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.232 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.232 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.084 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.153 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.993 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.024.994 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.995 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.995 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.995 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.996 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.024.996 I llama_model_loader: - type  f32:  194 tensors
0.00.024.997 I llama_model_loader: - type q3_K:   25 tensors
0.00.024.997 I llama_model_loader: - type q4_K:   71 tensors
0.00.024.997 I llama_model_loader: - type q5_K:    1 tensors
0.00.024.997 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.375 I llm_load_vocab: special tokens cache size = 25
0.00.051.527 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.529 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.530 I llm_load_print_meta: arch             = gptneox
0.00.051.530 I llm_load_print_meta: vocab type       = BPE
0.00.051.531 I llm_load_print_meta: n_vocab          = 50304
0.00.051.531 I llm_load_print_meta: n_merges         = 50009
0.00.051.531 I llm_load_print_meta: vocab_only       = 0
0.00.051.531 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.531 I llm_load_print_meta: n_embd           = 2048
0.00.051.531 I llm_load_print_meta: n_layer          = 24
0.00.051.535 I llm_load_print_meta: n_head           = 16
0.00.051.535 I llm_load_print_meta: n_head_kv        = 16
0.00.051.536 I llm_load_print_meta: n_rot            = 32
0.00.051.536 I llm_load_print_meta: n_swa            = 0
0.00.051.536 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.536 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.537 I llm_load_print_meta: n_gqa            = 1
0.00.051.538 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.540 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.540 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.543 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.543 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.543 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.544 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.544 I llm_load_print_meta: n_ff             = 8192
0.00.051.545 I llm_load_print_meta: n_expert         = 0
0.00.051.545 I llm_load_print_meta: n_expert_used    = 0
0.00.051.545 I llm_load_print_meta: causal attn      = 1
0.00.051.545 I llm_load_print_meta: pooling type     = 0
0.00.051.545 I llm_load_print_meta: rope type        = 2
0.00.051.545 I llm_load_print_meta: rope scaling     = linear
0.00.051.546 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.546 I llm_load_print_meta: freq_scale_train = 1
0.00.051.546 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.547 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.547 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.547 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.547 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.547 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.547 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.559 I llm_load_print_meta: model type       = 1.4B
0.00.051.559 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.051.560 I llm_load_print_meta: model params     = 1.41 B
0.00.051.560 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.051.560 I llm_load_print_meta: general.name     = 1.4B
0.00.051.561 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.561 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.561 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.561 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.561 I llm_load_print_meta: LF token         = 128 ''
0.00.051.562 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.562 I llm_load_print_meta: max token length = 1024
0.00.053.537 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.537 I llm_load_tensors: offloading output layer to GPU
0.00.053.537 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.547 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.053.549 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.054.566 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.566 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.566 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.567 I llama_new_context_with_model: n_batch       = 2048
0.00.054.567 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.567 I llama_new_context_with_model: flash_attn    = 0
0.00.054.569 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.569 I llama_new_context_with_model: freq_scale    = 1
0.00.054.569 I ggml_metal_init: allocating
0.00.054.572 I ggml_metal_init: found device: Apple M4
0.00.054.574 I ggml_metal_init: picking default device: Apple M4
0.00.055.124 I ggml_metal_init: using embedded metal library
0.00.057.045 I ggml_metal_init: GPU name:   Apple M4
0.00.057.046 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.047 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.047 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.047 I ggml_metal_init: simdgroup reduction   = true
0.00.057.047 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.047 I ggml_metal_init: has bfloat            = true
0.00.057.047 I ggml_metal_init: use bfloat            = true
0.00.057.048 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.048 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.084.353 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.084.358 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.084.377 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.085.320 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.085.321 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.085.321 I llama_new_context_with_model: graph nodes  = 967
0.00.085.322 I llama_new_context_with_model: graph splits = 2
0.00.085.334 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.549.518 I main: llama threadpool init, n_threads = 4
0.00.549.552 I 
0.00.549.578 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.549.579 I 
0.00.549.796 I sampler seed: 1234
0.00.549.800 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.549.811 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.549.811 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.549.811 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do that is most useful to my fellow men?'"

-Albert Einstein

"The way

0.01.298.749 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57073.95 tokens per second)
0.01.298.750 I llama_perf_context_print:        load time =     539.77 ms
0.01.298.750 I llama_perf_context_print: prompt eval time =      41.24 ms /     7 tokens (    5.89 ms per token,   169.74 tokens per second)
0.01.298.751 I llama_perf_context_print:        eval time =     704.48 ms /    63 runs   (   11.18 ms per token,    89.43 tokens per second)
0.01.298.752 I llama_perf_context_print:       total time =     749.23 ms /    70 tokens
0.01.298.932 I ggml_metal_free: deallocating

real	0m1.315s
user	0m0.109s
sys	0m0.129s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.086 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.491 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.338 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.014.343 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.345 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.345 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.345 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.346 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.346 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.347 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.348 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.349 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.349 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.349 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.350 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.350 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.351 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.352 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.352 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.212 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.318 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.138 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.023.139 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.139 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.140 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.140 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.140 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.023.141 I llama_model_loader: - type  f32:  194 tensors
0.00.023.141 I llama_model_loader: - type q3_K:   25 tensors
0.00.023.141 I llama_model_loader: - type q4_K:   71 tensors
0.00.023.142 I llama_model_loader: - type q5_K:    1 tensors
0.00.023.142 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.323 I llm_load_vocab: special tokens cache size = 25
0.00.049.127 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.129 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.130 I llm_load_print_meta: arch             = gptneox
0.00.049.130 I llm_load_print_meta: vocab type       = BPE
0.00.049.130 I llm_load_print_meta: n_vocab          = 50304
0.00.049.131 I llm_load_print_meta: n_merges         = 50009
0.00.049.131 I llm_load_print_meta: vocab_only       = 0
0.00.049.131 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.131 I llm_load_print_meta: n_embd           = 2048
0.00.049.131 I llm_load_print_meta: n_layer          = 24
0.00.049.134 I llm_load_print_meta: n_head           = 16
0.00.049.134 I llm_load_print_meta: n_head_kv        = 16
0.00.049.135 I llm_load_print_meta: n_rot            = 32
0.00.049.135 I llm_load_print_meta: n_swa            = 0
0.00.049.136 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.136 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.137 I llm_load_print_meta: n_gqa            = 1
0.00.049.137 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.138 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.139 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.139 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.139 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.139 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.140 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.140 I llm_load_print_meta: n_ff             = 8192
0.00.049.141 I llm_load_print_meta: n_expert         = 0
0.00.049.141 I llm_load_print_meta: n_expert_used    = 0
0.00.049.141 I llm_load_print_meta: causal attn      = 1
0.00.049.141 I llm_load_print_meta: pooling type     = 0
0.00.049.141 I llm_load_print_meta: rope type        = 2
0.00.049.141 I llm_load_print_meta: rope scaling     = linear
0.00.049.142 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.142 I llm_load_print_meta: freq_scale_train = 1
0.00.049.142 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.142 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.143 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.143 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.143 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.143 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.143 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.154 I llm_load_print_meta: model type       = 1.4B
0.00.049.156 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.049.156 I llm_load_print_meta: model params     = 1.41 B
0.00.049.157 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.049.157 I llm_load_print_meta: general.name     = 1.4B
0.00.049.157 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.157 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.157 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.158 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.158 I llm_load_print_meta: LF token         = 128 ''
0.00.049.158 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.158 I llm_load_print_meta: max token length = 1024
0.00.050.643 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.050.643 I llm_load_tensors: offloading output layer to GPU
0.00.050.644 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.050.653 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.050.654 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.051.480 I llama_new_context_with_model: n_seq_max     = 1
0.00.051.481 I llama_new_context_with_model: n_ctx         = 128
0.00.051.481 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.051.481 I llama_new_context_with_model: n_batch       = 128
0.00.051.482 I llama_new_context_with_model: n_ubatch      = 128
0.00.051.482 I llama_new_context_with_model: flash_attn    = 0
0.00.051.482 I llama_new_context_with_model: freq_base     = 10000.0
0.00.051.482 I llama_new_context_with_model: freq_scale    = 1
0.00.051.483 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.051.483 I ggml_metal_init: allocating
0.00.051.488 I ggml_metal_init: found device: Apple M4
0.00.051.490 I ggml_metal_init: picking default device: Apple M4
0.00.052.015 I ggml_metal_init: using embedded metal library
0.00.053.922 I ggml_metal_init: GPU name:   Apple M4
0.00.053.923 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.053.924 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.053.924 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.053.924 I ggml_metal_init: simdgroup reduction   = true
0.00.053.924 I ggml_metal_init: simdgroup matrix mul. = true
0.00.053.924 I ggml_metal_init: has bfloat            = true
0.00.053.925 I ggml_metal_init: use bfloat            = true
0.00.053.925 I ggml_metal_init: hasUnifiedMemory      = true
0.00.053.926 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.063.047 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.063.050 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.063.063 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.063.951 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.063.952 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.063.952 I llama_new_context_with_model: graph nodes  = 967
0.00.063.952 I llama_new_context_with_model: graph splits = 2
0.00.063.964 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.497.756 I 
0.00.497.782 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.497.789 I perplexity: tokenizing the input ..
0.00.505.616 I perplexity: tokenization took 7.825 ms
0.00.505.626 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.637.320 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.638.501 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.638.512 I llama_perf_context_print:        load time =     489.26 ms
0.00.638.513 I llama_perf_context_print: prompt eval time =     131.47 ms /   128 tokens (    1.03 ms per token,   973.61 tokens per second)
0.00.638.516 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.638.516 I llama_perf_context_print:       total time =     140.76 ms /   129 tokens
0.00.638.903 I ggml_metal_free: deallocating

real	0m0.652s
user	0m0.077s
sys	0m0.095s
```
- q4_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.040 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.070 I main: llama backend init
0.00.000.076 I main: load the model and apply lora adapter, if any
0.00.019.626 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.026.002 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.026.007 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.026.009 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.026.009 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.026.010 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.026.010 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.026.010 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.026.011 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.026.012 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.026.012 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.026.012 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.026.013 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.026.013 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.026.013 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.026.015 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.026.015 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.026.015 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.029.947 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.031.008 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.035.086 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.035.087 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.035.088 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.035.088 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.035.088 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.035.089 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.035.089 I llama_model_loader: - type  f32:  194 tensors
0.00.035.090 I llama_model_loader: - type q4_K:   61 tensors
0.00.035.090 I llama_model_loader: - type q5_K:   24 tensors
0.00.035.090 I llama_model_loader: - type q6_K:   13 tensors
0.00.056.793 I llm_load_vocab: special tokens cache size = 25
0.00.062.992 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.062.995 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.062.995 I llm_load_print_meta: arch             = gptneox
0.00.062.996 I llm_load_print_meta: vocab type       = BPE
0.00.062.996 I llm_load_print_meta: n_vocab          = 50304
0.00.062.996 I llm_load_print_meta: n_merges         = 50009
0.00.062.996 I llm_load_print_meta: vocab_only       = 0
0.00.062.996 I llm_load_print_meta: n_ctx_train      = 2048
0.00.062.997 I llm_load_print_meta: n_embd           = 2048
0.00.062.997 I llm_load_print_meta: n_layer          = 24
0.00.062.999 I llm_load_print_meta: n_head           = 16
0.00.063.000 I llm_load_print_meta: n_head_kv        = 16
0.00.063.000 I llm_load_print_meta: n_rot            = 32
0.00.063.001 I llm_load_print_meta: n_swa            = 0
0.00.063.001 I llm_load_print_meta: n_embd_head_k    = 128
0.00.063.001 I llm_load_print_meta: n_embd_head_v    = 128
0.00.063.002 I llm_load_print_meta: n_gqa            = 1
0.00.063.002 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.063.003 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.063.004 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.063.004 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.063.004 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.063.004 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.063.004 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.063.005 I llm_load_print_meta: n_ff             = 8192
0.00.063.005 I llm_load_print_meta: n_expert         = 0
0.00.063.005 I llm_load_print_meta: n_expert_used    = 0
0.00.063.006 I llm_load_print_meta: causal attn      = 1
0.00.063.006 I llm_load_print_meta: pooling type     = 0
0.00.063.006 I llm_load_print_meta: rope type        = 2
0.00.063.006 I llm_load_print_meta: rope scaling     = linear
0.00.063.007 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.063.007 I llm_load_print_meta: freq_scale_train = 1
0.00.063.007 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.063.007 I llm_load_print_meta: rope_finetuned   = unknown
0.00.063.008 I llm_load_print_meta: ssm_d_conv       = 0
0.00.063.009 I llm_load_print_meta: ssm_d_inner      = 0
0.00.063.009 I llm_load_print_meta: ssm_d_state      = 0
0.00.063.009 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.063.009 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.063.021 I llm_load_print_meta: model type       = 1.4B
0.00.063.021 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.063.021 I llm_load_print_meta: model params     = 1.41 B
0.00.063.022 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.063.022 I llm_load_print_meta: general.name     = 1.4B
0.00.063.022 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.063.022 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.063.023 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.063.023 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.063.023 I llm_load_print_meta: LF token         = 128 ''
0.00.063.023 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.063.023 I llm_load_print_meta: max token length = 1024
0.00.064.999 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.065.000 I llm_load_tensors: offloading output layer to GPU
0.00.065.000 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.065.010 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.065.011 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.065.904 I llama_new_context_with_model: n_seq_max     = 1
0.00.065.905 I llama_new_context_with_model: n_ctx         = 2048
0.00.065.905 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.065.905 I llama_new_context_with_model: n_batch       = 2048
0.00.065.905 I llama_new_context_with_model: n_ubatch      = 512
0.00.065.905 I llama_new_context_with_model: flash_attn    = 0
0.00.065.906 I llama_new_context_with_model: freq_base     = 10000.0
0.00.065.906 I llama_new_context_with_model: freq_scale    = 1
0.00.065.906 I ggml_metal_init: allocating
0.00.065.910 I ggml_metal_init: found device: Apple M4
0.00.065.912 I ggml_metal_init: picking default device: Apple M4
0.00.066.452 I ggml_metal_init: using embedded metal library
0.00.068.377 I ggml_metal_init: GPU name:   Apple M4
0.00.068.378 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.068.379 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.068.379 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.068.379 I ggml_metal_init: simdgroup reduction   = true
0.00.068.379 I ggml_metal_init: simdgroup matrix mul. = true
0.00.068.380 I ggml_metal_init: has bfloat            = true
0.00.068.380 I ggml_metal_init: use bfloat            = true
0.00.068.380 I ggml_metal_init: hasUnifiedMemory      = true
0.00.068.381 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.098.834 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.098.845 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.098.865 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.099.973 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.099.974 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.099.975 I llama_new_context_with_model: graph nodes  = 967
0.00.099.975 I llama_new_context_with_model: graph splits = 2
0.00.099.998 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.633.103 I main: llama threadpool init, n_threads = 4
0.00.633.142 I 
0.00.633.161 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.633.162 I 
0.00.633.402 I sampler seed: 1234
0.00.633.408 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.633.419 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.633.420 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.633.420 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the greatest power to create the future we want to see. I believe that we are in a wonderful time when people from all over the world are coming together to create a better world. I believe that we are going

0.01.385.717 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59814.66 tokens per second)
0.01.385.718 I llama_perf_context_print:        load time =     613.47 ms
0.01.385.718 I llama_perf_context_print: prompt eval time =      36.46 ms /     7 tokens (    5.21 ms per token,   191.98 tokens per second)
0.01.385.719 I llama_perf_context_print:        eval time =     712.88 ms /    63 runs   (   11.32 ms per token,    88.37 tokens per second)
0.01.385.719 I llama_perf_context_print:       total time =     752.62 ms /    70 tokens
0.01.385.896 I ggml_metal_free: deallocating

real	0m1.405s
user	0m0.110s
sys	0m0.142s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.092 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.137 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.892 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.015.896 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.898 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.899 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.899 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.899 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.900 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.901 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.901 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.901 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.904 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.904 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.904 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.905 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.906 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.906 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.907 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.705 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.741 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.527 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.024.528 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.528 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.529 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.529 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.529 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.024.530 I llama_model_loader: - type  f32:  194 tensors
0.00.024.530 I llama_model_loader: - type q4_K:   61 tensors
0.00.024.530 I llama_model_loader: - type q5_K:   24 tensors
0.00.024.531 I llama_model_loader: - type q6_K:   13 tensors
0.00.044.602 I llm_load_vocab: special tokens cache size = 25
0.00.050.641 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.643 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.644 I llm_load_print_meta: arch             = gptneox
0.00.050.644 I llm_load_print_meta: vocab type       = BPE
0.00.050.644 I llm_load_print_meta: n_vocab          = 50304
0.00.050.644 I llm_load_print_meta: n_merges         = 50009
0.00.050.645 I llm_load_print_meta: vocab_only       = 0
0.00.050.645 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.645 I llm_load_print_meta: n_embd           = 2048
0.00.050.645 I llm_load_print_meta: n_layer          = 24
0.00.050.648 I llm_load_print_meta: n_head           = 16
0.00.050.648 I llm_load_print_meta: n_head_kv        = 16
0.00.050.648 I llm_load_print_meta: n_rot            = 32
0.00.050.649 I llm_load_print_meta: n_swa            = 0
0.00.050.649 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.649 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.650 I llm_load_print_meta: n_gqa            = 1
0.00.050.650 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.651 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.652 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.652 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.652 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.652 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.652 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.653 I llm_load_print_meta: n_ff             = 8192
0.00.050.653 I llm_load_print_meta: n_expert         = 0
0.00.050.653 I llm_load_print_meta: n_expert_used    = 0
0.00.050.653 I llm_load_print_meta: causal attn      = 1
0.00.050.654 I llm_load_print_meta: pooling type     = 0
0.00.050.654 I llm_load_print_meta: rope type        = 2
0.00.050.654 I llm_load_print_meta: rope scaling     = linear
0.00.050.654 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.655 I llm_load_print_meta: freq_scale_train = 1
0.00.050.655 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.655 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.655 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.655 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.656 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.656 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.656 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.662 I llm_load_print_meta: model type       = 1.4B
0.00.050.663 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.050.663 I llm_load_print_meta: model params     = 1.41 B
0.00.050.664 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.050.664 I llm_load_print_meta: general.name     = 1.4B
0.00.050.664 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.665 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.666 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.667 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.667 I llm_load_print_meta: LF token         = 128 ''
0.00.050.667 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.668 I llm_load_print_meta: max token length = 1024
0.00.052.438 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.438 I llm_load_tensors: offloading output layer to GPU
0.00.052.439 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.444 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.052.444 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.053.360 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.360 I llama_new_context_with_model: n_ctx         = 128
0.00.053.361 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.361 I llama_new_context_with_model: n_batch       = 128
0.00.053.361 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.361 I llama_new_context_with_model: flash_attn    = 0
0.00.053.362 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.362 I llama_new_context_with_model: freq_scale    = 1
0.00.053.362 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.363 I ggml_metal_init: allocating
0.00.053.368 I ggml_metal_init: found device: Apple M4
0.00.053.371 I ggml_metal_init: picking default device: Apple M4
0.00.053.937 I ggml_metal_init: using embedded metal library
0.00.055.928 I ggml_metal_init: GPU name:   Apple M4
0.00.055.930 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.930 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.931 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.932 I ggml_metal_init: simdgroup reduction   = true
0.00.055.932 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.932 I ggml_metal_init: has bfloat            = true
0.00.055.934 I ggml_metal_init: use bfloat            = true
0.00.055.935 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.944 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.930 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.934 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.950 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.804 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.805 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.805 I llama_new_context_with_model: graph nodes  = 967
0.00.065.805 I llama_new_context_with_model: graph splits = 2
0.00.065.813 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.571.614 I 
0.00.571.631 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.571.634 I perplexity: tokenizing the input ..
0.00.579.658 I perplexity: tokenization took 8.023 ms
0.00.579.671 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.714.279 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.715.524 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.715.547 I llama_perf_context_print:        load time =     561.47 ms
0.00.715.548 I llama_perf_context_print: prompt eval time =     134.38 ms /   128 tokens (    1.05 ms per token,   952.54 tokens per second)
0.00.715.549 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.715.549 I llama_perf_context_print:       total time =     143.93 ms /   129 tokens
0.00.716.031 I ggml_metal_free: deallocating

real	0m0.731s
user	0m0.076s
sys	0m0.106s
```
- q5_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.044 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.075 I main: llama backend init
0.00.000.081 I main: load the model and apply lora adapter, if any
0.00.012.070 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.476 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.018.480 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.482 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.482 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.483 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.483 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.485 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.486 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.486 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.487 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.487 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.487 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.488 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.488 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.489 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.489 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.490 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.374 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.023.433 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.027.290 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.027.291 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.027.292 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.027.292 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.027.292 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.027.293 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.027.293 I llama_model_loader: - type  f32:  194 tensors
0.00.027.294 I llama_model_loader: - type q5_K:   61 tensors
0.00.027.294 I llama_model_loader: - type q6_K:   37 tensors
0.00.048.571 I llm_load_vocab: special tokens cache size = 25
0.00.054.670 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.054.673 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.054.673 I llm_load_print_meta: arch             = gptneox
0.00.054.674 I llm_load_print_meta: vocab type       = BPE
0.00.054.674 I llm_load_print_meta: n_vocab          = 50304
0.00.054.674 I llm_load_print_meta: n_merges         = 50009
0.00.054.674 I llm_load_print_meta: vocab_only       = 0
0.00.054.674 I llm_load_print_meta: n_ctx_train      = 2048
0.00.054.675 I llm_load_print_meta: n_embd           = 2048
0.00.054.675 I llm_load_print_meta: n_layer          = 24
0.00.054.677 I llm_load_print_meta: n_head           = 16
0.00.054.678 I llm_load_print_meta: n_head_kv        = 16
0.00.054.678 I llm_load_print_meta: n_rot            = 32
0.00.054.678 I llm_load_print_meta: n_swa            = 0
0.00.054.679 I llm_load_print_meta: n_embd_head_k    = 128
0.00.054.679 I llm_load_print_meta: n_embd_head_v    = 128
0.00.054.679 I llm_load_print_meta: n_gqa            = 1
0.00.054.680 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.054.681 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.054.681 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.054.682 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.054.682 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.054.682 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.054.682 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.054.683 I llm_load_print_meta: n_ff             = 8192
0.00.054.683 I llm_load_print_meta: n_expert         = 0
0.00.054.683 I llm_load_print_meta: n_expert_used    = 0
0.00.054.685 I llm_load_print_meta: causal attn      = 1
0.00.054.687 I llm_load_print_meta: pooling type     = 0
0.00.054.687 I llm_load_print_meta: rope type        = 2
0.00.054.687 I llm_load_print_meta: rope scaling     = linear
0.00.054.688 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.054.689 I llm_load_print_meta: freq_scale_train = 1
0.00.054.690 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.054.690 I llm_load_print_meta: rope_finetuned   = unknown
0.00.054.690 I llm_load_print_meta: ssm_d_conv       = 0
0.00.054.690 I llm_load_print_meta: ssm_d_inner      = 0
0.00.054.690 I llm_load_print_meta: ssm_d_state      = 0
0.00.054.690 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.054.690 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.054.702 I llm_load_print_meta: model type       = 1.4B
0.00.054.702 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.054.703 I llm_load_print_meta: model params     = 1.41 B
0.00.054.703 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.054.703 I llm_load_print_meta: general.name     = 1.4B
0.00.054.703 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.054.705 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.054.705 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.054.705 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.054.705 I llm_load_print_meta: LF token         = 128 ''
0.00.054.706 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.054.706 I llm_load_print_meta: max token length = 1024
0.00.056.799 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.056.799 I llm_load_tensors: offloading output layer to GPU
0.00.056.799 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.056.809 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.056.810 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.057.770 I llama_new_context_with_model: n_seq_max     = 1
0.00.057.770 I llama_new_context_with_model: n_ctx         = 2048
0.00.057.771 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.057.771 I llama_new_context_with_model: n_batch       = 2048
0.00.057.771 I llama_new_context_with_model: n_ubatch      = 512
0.00.057.771 I llama_new_context_with_model: flash_attn    = 0
0.00.057.772 I llama_new_context_with_model: freq_base     = 10000.0
0.00.057.772 I llama_new_context_with_model: freq_scale    = 1
0.00.057.772 I ggml_metal_init: allocating
0.00.057.775 I ggml_metal_init: found device: Apple M4
0.00.057.778 I ggml_metal_init: picking default device: Apple M4
0.00.058.344 I ggml_metal_init: using embedded metal library
0.00.060.298 I ggml_metal_init: GPU name:   Apple M4
0.00.060.299 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.060.301 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.060.301 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.060.302 I ggml_metal_init: simdgroup reduction   = true
0.00.060.302 I ggml_metal_init: simdgroup matrix mul. = true
0.00.060.302 I ggml_metal_init: has bfloat            = true
0.00.060.302 I ggml_metal_init: use bfloat            = true
0.00.060.303 I ggml_metal_init: hasUnifiedMemory      = true
0.00.060.303 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.089.120 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.089.130 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.089.150 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.090.262 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.090.263 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.090.263 I llama_new_context_with_model: graph nodes  = 967
0.00.090.263 I llama_new_context_with_model: graph splits = 2
0.00.090.286 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.724.403 I main: llama threadpool init, n_threads = 4
0.00.724.443 I 
0.00.724.462 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.724.462 I 
0.00.724.689 I sampler seed: 1234
0.00.724.694 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.724.735 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.724.735 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.724.736 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.565.213 I llama_perf_sampler_print:    sampling time =       1.19 ms /    71 runs   (    0.02 ms per token, 59865.09 tokens per second)
0.01.565.213 I llama_perf_context_print:        load time =     712.33 ms
0.01.565.214 I llama_perf_context_print: prompt eval time =      38.60 ms /     7 tokens (    5.51 ms per token,   181.33 tokens per second)
0.01.565.216 I llama_perf_context_print:        eval time =     798.88 ms /    63 runs   (   12.68 ms per token,    78.86 tokens per second)
0.01.565.216 I llama_perf_context_print:       total time =     840.81 ms /    70 tokens
0.01.565.379 I ggml_metal_free: deallocating

real	0m1.585s
user	0m0.110s
sys	0m0.172s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.097 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.611 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.470 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.014.474 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.480 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.481 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.481 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.481 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.482 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.482 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.483 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.483 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.483 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.486 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.486 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.486 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.488 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.488 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.488 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.384 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.501 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.484 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.023.486 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.486 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.486 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.487 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.487 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.023.488 I llama_model_loader: - type  f32:  194 tensors
0.00.023.488 I llama_model_loader: - type q5_K:   61 tensors
0.00.023.488 I llama_model_loader: - type q6_K:   37 tensors
0.00.044.593 I llm_load_vocab: special tokens cache size = 25
0.00.050.559 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.561 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.562 I llm_load_print_meta: arch             = gptneox
0.00.050.562 I llm_load_print_meta: vocab type       = BPE
0.00.050.562 I llm_load_print_meta: n_vocab          = 50304
0.00.050.563 I llm_load_print_meta: n_merges         = 50009
0.00.050.563 I llm_load_print_meta: vocab_only       = 0
0.00.050.563 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.563 I llm_load_print_meta: n_embd           = 2048
0.00.050.563 I llm_load_print_meta: n_layer          = 24
0.00.050.566 I llm_load_print_meta: n_head           = 16
0.00.050.567 I llm_load_print_meta: n_head_kv        = 16
0.00.050.567 I llm_load_print_meta: n_rot            = 32
0.00.050.567 I llm_load_print_meta: n_swa            = 0
0.00.050.567 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.567 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.568 I llm_load_print_meta: n_gqa            = 1
0.00.050.569 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.570 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.570 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.570 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.571 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.571 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.571 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.572 I llm_load_print_meta: n_ff             = 8192
0.00.050.572 I llm_load_print_meta: n_expert         = 0
0.00.050.572 I llm_load_print_meta: n_expert_used    = 0
0.00.050.572 I llm_load_print_meta: causal attn      = 1
0.00.050.573 I llm_load_print_meta: pooling type     = 0
0.00.050.573 I llm_load_print_meta: rope type        = 2
0.00.050.573 I llm_load_print_meta: rope scaling     = linear
0.00.050.573 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.574 I llm_load_print_meta: freq_scale_train = 1
0.00.050.574 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.574 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.574 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.574 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.575 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.575 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.575 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.587 I llm_load_print_meta: model type       = 1.4B
0.00.050.587 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.050.588 I llm_load_print_meta: model params     = 1.41 B
0.00.050.588 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.050.589 I llm_load_print_meta: general.name     = 1.4B
0.00.050.589 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.589 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.590 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.590 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.590 I llm_load_print_meta: LF token         = 128 ''
0.00.050.590 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.590 I llm_load_print_meta: max token length = 1024
0.00.052.631 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.631 I llm_load_tensors: offloading output layer to GPU
0.00.052.632 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.642 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.052.642 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.053.608 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.609 I llama_new_context_with_model: n_ctx         = 128
0.00.053.609 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.610 I llama_new_context_with_model: n_batch       = 128
0.00.053.610 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.610 I llama_new_context_with_model: flash_attn    = 0
0.00.053.610 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.610 I llama_new_context_with_model: freq_scale    = 1
0.00.053.611 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.611 I ggml_metal_init: allocating
0.00.053.614 I ggml_metal_init: found device: Apple M4
0.00.053.616 I ggml_metal_init: picking default device: Apple M4
0.00.054.155 I ggml_metal_init: using embedded metal library
0.00.056.095 I ggml_metal_init: GPU name:   Apple M4
0.00.056.097 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.097 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.097 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.098 I ggml_metal_init: simdgroup reduction   = true
0.00.056.098 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.098 I ggml_metal_init: has bfloat            = true
0.00.056.098 I ggml_metal_init: use bfloat            = true
0.00.056.098 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.099 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.572 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.576 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.590 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.550 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.551 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.551 I llama_new_context_with_model: graph nodes  = 967
0.00.066.551 I llama_new_context_with_model: graph splits = 2
0.00.066.564 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.664.664 I 
0.00.664.686 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.664.691 I perplexity: tokenizing the input ..
0.00.672.535 I perplexity: tokenization took 7.843 ms
0.00.672.552 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.812.798 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.813.943 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.813.960 I llama_perf_context_print:        load time =     656.05 ms
0.00.813.961 I llama_perf_context_print: prompt eval time =     140.02 ms /   128 tokens (    1.09 ms per token,   914.14 tokens per second)
0.00.813.962 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.813.962 I llama_perf_context_print:       total time =     149.30 ms /   129 tokens
0.00.814.301 I ggml_metal_free: deallocating

real	0m0.827s
user	0m0.078s
sys	0m0.131s
```
- q6_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.040 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.069 I main: llama backend init
0.00.000.076 I main: load the model and apply lora adapter, if any
0.00.010.009 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.776 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.780 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.782 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.782 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.783 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.783 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.789 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.790 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.790 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.790 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.792 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.792 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.793 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.793 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.795 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.795 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.796 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.703 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.753 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.600 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.025.601 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.601 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.602 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.602 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.602 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.025.603 I llama_model_loader: - type  f32:  194 tensors
0.00.025.603 I llama_model_loader: - type q6_K:   98 tensors
0.00.045.920 I llm_load_vocab: special tokens cache size = 25
0.00.052.068 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.070 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.070 I llm_load_print_meta: arch             = gptneox
0.00.052.071 I llm_load_print_meta: vocab type       = BPE
0.00.052.071 I llm_load_print_meta: n_vocab          = 50304
0.00.052.071 I llm_load_print_meta: n_merges         = 50009
0.00.052.071 I llm_load_print_meta: vocab_only       = 0
0.00.052.072 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.072 I llm_load_print_meta: n_embd           = 2048
0.00.052.072 I llm_load_print_meta: n_layer          = 24
0.00.052.075 I llm_load_print_meta: n_head           = 16
0.00.052.076 I llm_load_print_meta: n_head_kv        = 16
0.00.052.076 I llm_load_print_meta: n_rot            = 32
0.00.052.076 I llm_load_print_meta: n_swa            = 0
0.00.052.076 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.076 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.077 I llm_load_print_meta: n_gqa            = 1
0.00.052.078 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.079 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.079 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.080 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.080 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.080 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.080 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.081 I llm_load_print_meta: n_ff             = 8192
0.00.052.081 I llm_load_print_meta: n_expert         = 0
0.00.052.081 I llm_load_print_meta: n_expert_used    = 0
0.00.052.081 I llm_load_print_meta: causal attn      = 1
0.00.052.081 I llm_load_print_meta: pooling type     = 0
0.00.052.081 I llm_load_print_meta: rope type        = 2
0.00.052.082 I llm_load_print_meta: rope scaling     = linear
0.00.052.083 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.084 I llm_load_print_meta: freq_scale_train = 1
0.00.052.084 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.084 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.084 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.085 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.085 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.085 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.085 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.091 I llm_load_print_meta: model type       = 1.4B
0.00.052.092 I llm_load_print_meta: model ftype      = Q6_K
0.00.052.092 I llm_load_print_meta: model params     = 1.41 B
0.00.052.093 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.052.093 I llm_load_print_meta: general.name     = 1.4B
0.00.052.093 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.093 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.093 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.093 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.094 I llm_load_print_meta: LF token         = 128 ''
0.00.052.094 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.094 I llm_load_print_meta: max token length = 1024
0.00.053.679 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.679 I llm_load_tensors: offloading output layer to GPU
0.00.053.680 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.685 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.053.687 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.054.532 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.533 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.533 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.533 I llama_new_context_with_model: n_batch       = 2048
0.00.054.533 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.533 I llama_new_context_with_model: flash_attn    = 0
0.00.054.534 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.534 I llama_new_context_with_model: freq_scale    = 1
0.00.054.535 I ggml_metal_init: allocating
0.00.054.538 I ggml_metal_init: found device: Apple M4
0.00.054.540 I ggml_metal_init: picking default device: Apple M4
0.00.055.086 I ggml_metal_init: using embedded metal library
0.00.056.985 I ggml_metal_init: GPU name:   Apple M4
0.00.056.986 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.987 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.987 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.987 I ggml_metal_init: simdgroup reduction   = true
0.00.056.987 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.988 I ggml_metal_init: has bfloat            = true
0.00.056.988 I ggml_metal_init: use bfloat            = true
0.00.056.988 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.989 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.008 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.013 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.030 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.052 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.053 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.054 I llama_new_context_with_model: graph nodes  = 967
0.00.086.054 I llama_new_context_with_model: graph splits = 2
0.00.086.073 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.753.414 I main: llama threadpool init, n_threads = 4
0.00.753.447 I 
0.00.753.483 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.753.485 I 
0.00.753.619 I sampler seed: 1234
0.00.753.623 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = -1
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.753.669 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.753.680 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.753.680 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.

He added: Ive

0.01.627.146 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57165.86 tokens per second)
0.01.627.147 I llama_perf_context_print:        load time =     743.40 ms
0.01.627.148 I llama_perf_context_print: prompt eval time =      38.46 ms /     7 tokens (    5.49 ms per token,   182.00 tokens per second)
0.01.627.148 I llama_perf_context_print:        eval time =     831.95 ms /    63 runs   (   13.21 ms per token,    75.73 tokens per second)
0.01.627.149 I llama_perf_context_print:       total time =     873.74 ms /    70 tokens
0.01.627.315 I ggml_metal_free: deallocating

real	0m1.647s
user	0m0.111s
sys	0m0.157s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.092 I build: 4173 (0cc63754) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.400 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.076 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.015.080 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.082 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.086 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.087 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.087 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.087 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.088 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.088 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.089 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.089 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.089 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.091 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.092 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.093 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.094 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.094 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.837 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.919 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.731 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
0.00.023.732 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.733 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.733 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.734 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.734 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.023.734 I llama_model_loader: - type  f32:  194 tensors
0.00.023.735 I llama_model_loader: - type q6_K:   98 tensors
0.00.043.997 I llm_load_vocab: special tokens cache size = 25
0.00.050.179 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.181 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.181 I llm_load_print_meta: arch             = gptneox
0.00.050.182 I llm_load_print_meta: vocab type       = BPE
0.00.050.182 I llm_load_print_meta: n_vocab          = 50304
0.00.050.182 I llm_load_print_meta: n_merges         = 50009
0.00.050.182 I llm_load_print_meta: vocab_only       = 0
0.00.050.183 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.183 I llm_load_print_meta: n_embd           = 2048
0.00.050.183 I llm_load_print_meta: n_layer          = 24
0.00.050.185 I llm_load_print_meta: n_head           = 16
0.00.050.186 I llm_load_print_meta: n_head_kv        = 16
0.00.050.186 I llm_load_print_meta: n_rot            = 32
0.00.050.187 I llm_load_print_meta: n_swa            = 0
0.00.050.188 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.188 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.189 I llm_load_print_meta: n_gqa            = 1
0.00.050.190 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.191 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.191 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.191 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.192 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.192 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.192 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.193 I llm_load_print_meta: n_ff             = 8192
0.00.050.193 I llm_load_print_meta: n_expert         = 0
0.00.050.193 I llm_load_print_meta: n_expert_used    = 0
0.00.050.193 I llm_load_print_meta: causal attn      = 1
0.00.050.193 I llm_load_print_meta: pooling type     = 0
0.00.050.194 I llm_load_print_meta: rope type        = 2
0.00.050.194 I llm_load_print_meta: rope scaling     = linear
0.00.050.194 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.194 I llm_load_print_meta: freq_scale_train = 1
0.00.050.195 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.197 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.197 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.197 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.197 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.198 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.198 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.205 I llm_load_print_meta: model type       = 1.4B
0.00.050.205 I llm_load_print_meta: model ftype      = Q6_K
0.00.050.205 I llm_load_print_meta: model params     = 1.41 B
0.00.050.206 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.050.206 I llm_load_print_meta: general.name     = 1.4B
0.00.050.206 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.206 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.206 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.206 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.207 I llm_load_print_meta: LF token         = 128 ''
0.00.050.207 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.208 I llm_load_print_meta: max token length = 1024
0.00.051.979 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.979 I llm_load_tensors: offloading output layer to GPU
0.00.051.980 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.985 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.051.985 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.052.865 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.865 I llama_new_context_with_model: n_ctx         = 128
0.00.052.865 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.866 I llama_new_context_with_model: n_batch       = 128
0.00.052.866 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.866 I llama_new_context_with_model: flash_attn    = 0
0.00.052.866 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.867 I llama_new_context_with_model: freq_scale    = 1
0.00.052.867 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.867 I ggml_metal_init: allocating
0.00.052.872 I ggml_metal_init: found device: Apple M4
0.00.052.874 I ggml_metal_init: picking default device: Apple M4
0.00.053.418 I ggml_metal_init: using embedded metal library
0.00.055.331 I ggml_metal_init: GPU name:   Apple M4
0.00.055.333 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.333 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.334 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.334 I ggml_metal_init: simdgroup reduction   = true
0.00.055.334 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.334 I ggml_metal_init: has bfloat            = true
0.00.055.334 I ggml_metal_init: use bfloat            = true
0.00.055.335 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.335 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.296 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.064.303 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.064.317 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.065.126 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.065.127 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.065.127 I llama_new_context_with_model: graph nodes  = 967
0.00.065.127 I llama_new_context_with_model: graph splits = 2
0.00.065.134 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.138.137 I 
0.00.138.158 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | LLAMAFILE = 1 | AARCH64_REPACK = 1 | 
0.00.138.161 I perplexity: tokenizing the input ..
0.00.145.243 I perplexity: tokenization took 7.081 ms
0.00.145.259 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.284.549 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.285.712 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.285.724 I llama_perf_context_print:        load time =     128.73 ms
0.00.285.724 I llama_perf_context_print: prompt eval time =     139.04 ms /   128 tokens (    1.09 ms per token,   920.59 tokens per second)
0.00.285.725 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.285.728 I llama_perf_context_print:       total time =     147.59 ms /   129 tokens
0.00.285.960 I ggml_metal_free: deallocating

real	0m0.300s
user	0m0.076s
sys	0m0.037s
```
- save-load-state: 
```
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4173 (0cc63754)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 ''
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x12bc0adb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x12bc0b4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x12bc0ba90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x12bc0c040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x12bc0c5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12bc0cba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12bc0d150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12bc0d700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12bc0dcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12bc0e1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12bc0e6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12bc0ebb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x12bc0f6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x12bc0fe80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x12bc10690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x12bc10db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x12bc114d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x12bc11bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x12bc12310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x12bc12ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x12bc13200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x12bc13920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x12bc14040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x12bc148e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x12bc15000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x12bc152c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x12bc158d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x12bc16540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x12bc16a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x12bc16d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x12bc171e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x12bc174a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x12bc17d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x12bc18270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x12bc18530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x12bc189d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x12bc18e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x12bc19310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x12bc197b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x12bc19c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x12bc1a0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x12bc1a590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x12bc1aa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x12bc1aed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x12bc1b190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x12bc1b7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x12bc1bdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x12bc1c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x12bc1cce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x12bc1d2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12bc1d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x12bc1df10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12bc1e520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12bc1eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12bc1f320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x12bc1f7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x12bc1fc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x12bc1ff20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x12bc20530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x12bc20d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x12bc20fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x12bc21480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x12bc21920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x12bc21dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x12bc22260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x12bc22700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x12bc22ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x12bc23040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x12bc234e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x12bc23980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x12bc23e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x12bc242c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x12bc24760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x12bc24c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x12bc250a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x12bc25540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x12bc259e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x12bc25e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x12bc26320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x12bc267c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x12bc26c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x12bc27100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x12bc275a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x12bc27a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x12bc27ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x12bc28380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x12bc28820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x12bc28cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x12bc29160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x12bc29600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x12bc29aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x12bc29f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x12bc2a3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x12bc2a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x12bc2ad20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x12bc2b1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x12bc2b660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x12bc1c3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x12bc2bcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x12bc2c150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x12bc2c5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x12bc2ca90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x12bc2cf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x12bc2d3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x12bc2d870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x12bc2dd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x12bc2e1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x12bc2e650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x12bc2eaf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x12bc2ef90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x12bc2f430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x12bc2f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x12bc2fd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x12bc30210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x12bc306b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x12bc30b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x12bc30ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x12bc31490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x12bc31930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x12bc31dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x12bc32270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x12bc32710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x12bc32bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x12bc33050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x12bc334f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x12bc33990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x12bc33e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x12bc342d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x12bc34770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x12bc34c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x12bc350b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x12bc35550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x12bc359f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x12bc35e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x12bc36330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x12bc367d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x12bc36c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x12bc37110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x12bc375b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x12bc37a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x12bc37ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x12bc38390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x12bc38830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x12bc38cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x12bc39170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x12bc39610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x12bc39ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x12bc39f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x12bc3a3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x12bc3a890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x12bc3ad30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x12bc3b1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x12bc3b670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x12bc3bbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x12bc3c110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x12bc3c660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x12bc3cbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x12bc3ce70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x12bc3d480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x12bc3da90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x12bc3e0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x12bc3e6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x12bc3ecc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x12bc3f4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x12bc3f950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x12bc3fdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x12bc40290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x12bc40a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x12bc40f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x12bc414e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x12bc41a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x12bc41f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x12bc424d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x12bc42a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x12bc42f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x12bc434c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x12bc43a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x12bc43f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x12bc444b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x12bc44a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x12bc44f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x12bc454a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x12bc459f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x12bc45f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x12bc46490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x12bc469e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x12bc46f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x12bc47480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x12bc479d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x12bc47f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x12bc48470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x12bc489c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x12bc48f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x12bc49460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x12bc499b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x12bc49f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12bc4a450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12bc4a9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12bc4aef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12bc4b440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12bc4b990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12bc4bee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12bc4c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12bc4c980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12bc4ced0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12bc4d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12bc4d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x12bc4dec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x12bc4e410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x12bc4e960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x12bc4eeb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x12bc4f400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x12bc4f950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x12bc4fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x12bc503f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x12bc50940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x12bc50e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x12bc513e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x12bc51930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x12bc51e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x12bc523d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x12bc52920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x12bc52e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x12bc533c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x12bc53860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x12bc53d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x12bc541a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x12bc54640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x12bc54ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x12bc54f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x12bc55420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x12bc558c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x12bc55d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x12bc56200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x12bc566a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x12bc56b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x12bc56fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x12bc57530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x12bc57c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x12bc58370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x12bc58a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x12bc591b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x12bc59470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12bc59a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12bc5a090 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.131.480 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x12bc4a6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x12bc4ab40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x12bc4afb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x12bc4b420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x12bc4b890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12bc4bd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12bc4c170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12bc4c5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12bc4ca50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12bc4cec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12bc4d330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12bc4d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x12bc4e200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x12bc4e980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x12bc4f160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x12bc4f850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x12bc4ff40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x12bc50630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x12bc50d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x12bc516a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x12bc51d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x12bc52480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x12bc52b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x12bc53260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x12bc53950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x12bc53dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x12bc54230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x12bc546a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x12bc54b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x12bc54f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x12bc553f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x12bc55860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x12bc55cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x12bc55f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x12bc56400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x12bc56870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x12bc56ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x12bc57150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x12bc575c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x12bc57a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x12bc57ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x12bc58310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x12bc58780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x12bc58bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x12bc59060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x12bc594d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x12bc59940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x12bc59db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x12bc5a220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x12bc0c030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12bc0cb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x12bc0ba90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12bc0c5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12bc0a6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12bc0af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x12bc18410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x12bc18880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x12bc18cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x12bc19160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x12bc195d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x12bc19a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x12bc19eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x12bc1a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x12bc1a790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x12bc1ac00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x12bc1b070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x12bc1b4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x12bc1b950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x12bc1bdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x12bc1c230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x12bc1c6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x12bc1cb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x12bc1cf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x12bc1d3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x12bc1d860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x12bc1dcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x12bc1e140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x12bc1e5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x12bc1ea20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x12bc1ee90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x12bc1f300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x12bc1f770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x12bc1fbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x12bc20050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x12bc204c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x12bc20930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x12bc20da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x12bc21210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x12bc21680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x12bc21af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x12bc21f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x12bc223d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x12bc22840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x12bc22cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x12bc23120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x12bc23590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x12bc23a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x12bc23e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x12bc242e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x12bc24750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x12bc24bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x12bc25030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x12bc254a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x12bc25910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x12bc25d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x12bc261f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x12bc26660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x12bc26ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x12bc26f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x12bc273b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x12bc27820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x12bc27c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x12bc28100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x12bc28570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x12bc289e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x12bc28e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x12bc292c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x12bc29730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x12bc29ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x12bc2a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x12bc2a480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x12bc2a8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x12bc2ad60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x12bc2b1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x12bc2b640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x12bc2bab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x12bc2bf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x12bc2c390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x12bc2c800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x12bc2cc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x12bc2d0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x12bc2d550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x12bc2d9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x12bc2de30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x12bc2e2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x12bc2e710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x12bc2eb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x12bc2eff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x12bc2f460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x12bc2f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x12bc2fd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x12bc301b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x12bc30620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x12bc30a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x12bc30f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x12bc31370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x12bc317e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x12bc31c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x12bc320c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x12bc32530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x12bc329a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x12bc32e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x12bc33280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x12bc336f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x12bc33b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x12bc33fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x12bc34440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x12bc348b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x12bc34d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x12bc35190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x12bc35600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x12bc35a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x12bc35ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x12bc36350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x12bc367c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x12bc36c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x12bc370a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x12bc37820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x12bc37c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x12bc38100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x12bc38570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x12bc389e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x12bc38e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x12bc392c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x12bc39730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x12bc39ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x12bc3a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x12bc3a480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x12bc3a8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x12bc3ad60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x12bc3b1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x12bc3b640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x12bc3bab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x12bc3bf20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x12bc3c390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x12bc3c800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x12bc3cc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x12bc3d0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x12bc3d550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x12bc3d9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x12bc3de30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x12bc3e2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x12bc3e710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x12bc3eb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x12bc3eff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x12bc3f460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12bc3f8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12bc3fd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12bc401b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12bc40620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12bc40a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12bc40f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12bc41370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12bc417e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12bc41c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12bc420c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12bc42530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x12bc429a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x12bc42e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x12bc43280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x12bc436f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x12bc43b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x12bc43fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x12bc44440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x12bc448b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x12bc44d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x12bc45190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x12bc45600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x12bc45a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x12bc45ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x12bc46350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x12bc467c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x12bc46c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x12bc470a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x12bc47510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x12bc47980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x12bc47df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x12bc48260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x12bc486d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x12bc48b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x12bc48fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x12bc49420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x12bc49890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x12bc16c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x12bc17090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x12bc17500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x12bc17970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x12bc0e170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x12bc0e6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x12bc0eda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x12bc0f490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x12bc0fb80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x12bc0fff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12bc10460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12bc108d0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x12bb05890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x12bb05d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x12bb06170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x12bb065e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x12bb06a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12bb06ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12bb07330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12bb077a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12bb07c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12bb08080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12bb084f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12bb08b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x12bb09690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x12bb09e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x12bb0a650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x12bb0ad70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x12bb0b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x12bb0bbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x12bb0c2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x12bb0caa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x12bb0d1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x12bb0d8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x12bb0e000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x12bb0e720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x12bb0ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x12bb0f100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x12bb0f3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x12bb0f830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x12bb0fca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x12bb10110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x12bb10580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x12bb10ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x12bb10f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x12bb111e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x12bb11650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x12bb11ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x12bb11f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x12bb123a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x12bb12810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x12bb12c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x12bb130f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x12bb13560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x12bb139d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x12bb13e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x12bb142b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x12bb14720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x12bb14b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x12bb15000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x12bb15470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x12bb158e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12bb15d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x12bb161c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12bb16630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12bb16aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12bb16f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x12bb17380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x12bb178f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x12bb17df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x12bb18260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x12bb186d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x12bb18b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x12bb18fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x12bb19420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x12bb19890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x12bb19d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x12bb1a170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x12bb1a5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x12bb1aa50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x12bb1aec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x12bb1b330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x12bb1b7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x12bb1bc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x12bb1c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x12bb1c4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x12bb1c960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x12bb1cdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x12bb1d240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x12bb1d6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x12bb1db20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x12bb1df90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x12bb1e400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x12bb1e870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x12bb1ece0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x12bb1f150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x12bb1f5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x12bb1fa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x12bb1fea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x12bb20310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x12bb20780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x12bb20bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x12bb21060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x12bb214d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x12bb21940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x12bb21db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x12bb22220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x12bb22690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x12bb22b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x12bb22f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x12bb233e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x12bb23850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x12bb23cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x12bb24130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x12bb245a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x12bb24a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x12bb24e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x12bb252f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x12bb25760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x12bb25bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x12bb26040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x12bb264b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x12bb26920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x12bb26d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x12bb27200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x12bb27670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x12bb27ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x12bb27f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x12bb283c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x12bb28830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x12bb28ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x12bb29110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x12bb29580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x12bb299f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x12bb29e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x12bb2a2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x12bb2a740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x12bb2abb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x12bb2b020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x12bb2b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x12bb2b900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x12bb2bd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x12bb2c1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x12bb2c650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x12bb2cac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x12bb2cf30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x12bb2d3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x12bb2d810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x12bb2dc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x12bb2e0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x12bb2e560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x12bb2e9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x12bb2ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x12bb2f2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x12bb2f720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x12bb2fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x12bb30000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x12bb30470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x12bb308e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x12bb30d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x12bb311c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x12bb31630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x12bb31aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x12bb31f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x12bb32380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x12bb327f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x12bb32c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x12bb330d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x12bb33540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x12bb339b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x12bb33e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x12bb34290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x12bb34700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x12bb34b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x12bb34fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x12bb35450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x12bb358c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x12bb35d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x12bb361a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x12bb36d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x12bb36ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x12bb372b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x12bb37720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x12bb37b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x12bb38000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x12bb38470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x12bb388e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x12bb38d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x12bb391c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x12bb39630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x12bb39aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x12bb39f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x12bb3a380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x12bb3a7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x12bb3ac60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x12bb3b0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x12bb3b540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x12bb3b9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x12bb3be20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x12bb3c290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x12bb3c700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x12bb3cb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x12bb3cfe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x12bb3d450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x12bb3d8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x12bc0af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x12bc16c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x12bc17090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12bc17500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12bc17970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12bc18260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12bc18520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12bc18990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12bc18e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12bc19270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12bc196e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12bc19b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12bc19fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12bc1a430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x12bc1a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x12bc1ad10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x12bc1b180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x12bc1b5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x12bc1ba60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x12bc1bed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x12bc1c340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x12bc1c7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x12bc1cc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x12bc1d090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x12bc1d500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x12bc1d970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x12bc1dde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x12bc1e250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x12bc1e6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x12bc1eb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x12bc1efa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x12bc1f410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x12bc1f880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x12bc1fcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x12bc20160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x12bc205d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x12bc20a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x12bc20eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x12bc21320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x12bc21790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x12bc21c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x12bc22070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x12bc224e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x12bc22950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x12bc22dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x12bc23620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x12bc23d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x12bc24400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x12bc24af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x12bc24f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12bc253d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12bc25840 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.747s
user	0m0.284s
sys	0m0.309s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4173 (0cc63754)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = [" ", " t", " a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 ''
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x12180b720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x12180be50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x12180c400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x12180c9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x12180cf60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x12180d510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x12180dac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x12180e070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12180e620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12180eb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12180f020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12180f520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x121810040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x1218107f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x121811000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x121811720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x121811e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x121812560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x121812c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x121813450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x121813b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x121814290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x1218149b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x121815250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x121815970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x121815c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x121816240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x121816eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x1218173f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x1218176b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x121817b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x121817e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x1218186a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x121818be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x121818ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x121819340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x1218197e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x121819c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x12181a120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x12181a5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x12181aa60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x12181af00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x12181b3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x12181b840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x12181bb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x12181c110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x12181c720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x12181d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x12181d650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x12181dc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12181e270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x12181e880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12181ee90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12181f4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12181fc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x121820130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x1218205d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x121820890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x121820ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x121821690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x121821950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x121821df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x121822290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x121822730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x121822bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x121823070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x121823510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x1218239b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x121823e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x1218242f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x121824790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x121824c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x1218250d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x121825570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x121825a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x121825eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x121826350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x1218267f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x121826c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x121827130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x1218275d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x121827a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x121827f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x1218283b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x121828850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x121828cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x121829190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x121829630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x121829ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x121829f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x12182a410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x12182a8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x12182ad50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x12182b1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x12182b690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x12182bb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x12182bfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x12181cd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x12182c620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x12182cac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x12182cf60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x12182d400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x12182d8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x12182dd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x12182e1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x12182e680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x12182eb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x12182efc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x12182f460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x12182f900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x12182fda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x121830240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x1218306e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x121830b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x121831020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x1218314c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x121831960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x121831e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x1218322a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x121832740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x121832be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x121833080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x121833520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x1218339c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x121833e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x121834300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x1218347a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x121834c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x1218350e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x121835580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x121835a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x121835ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x121836360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x121836800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x121836ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x121837140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x1218375e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x121837a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x121837f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x1218383c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x121838860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x121838d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x1218391a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x121839640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x121839ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x121839f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x12183a420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x12183a8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x12183ad60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x12183b200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x12183b6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x12183bb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x12183bfe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x12183c530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x12183ca80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x12183cfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x12183d520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x12183d7e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x12183ddf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x12183e400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x12183ea10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x12183f020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x12183f630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x12183fe20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x1218402c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x121840760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x121840c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x1218413b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x121841900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x121841e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x1218423a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x1218428f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x121842e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x121843390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x1218438e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x121843e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x121844380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x1218448d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x121844e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x121845370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x1218458c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x121845e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x121846360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x1218468b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x121846e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x121847350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x1218478a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x121847df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x121848340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x121848890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x121848de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x121849330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x121849880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x121849dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x12184a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x12184a870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x12184adc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x12184b310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x12184b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x12184bdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x12184c300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x12184c850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x12184cda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x12184d2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x12184d840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x12184dd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x12184e2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x12184e830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x12184ed80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x12184f2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x12184f820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x12184fd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x1218502c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x121850810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x121850d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x1218512b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x121851800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x121851d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x1218522a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x1218527f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x121852d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x121853290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x1218537e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x121853d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x1218541d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x121854670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x121854b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x121854fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x121855450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x1218558f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x121855d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x121856230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x1218566d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x121856b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x121857010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x1218574b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x121857950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x121857ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x1218585c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x121858ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x121859400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x121859b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x121859de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x12185a3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x12185aa00 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.085.412 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x11ff094e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x11ff09950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x11ff09dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x11ff0a230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x11ff0a6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x11ff0ab10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x11ff0af80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x11ff0b3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x11ff0b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x11ff0bde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x11ff0c250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x11ff0c8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x11ff0d3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x11ff0dba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x11ff0e3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x11ff0ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x11ff0f1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x11ff0f910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x11ff10030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x11ff10800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x11ff10f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x11ff11640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x11ff11d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x11ff12480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x11ff12ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x11ff12e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x11ff13120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x11ff13590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x11ff13a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x11ff13e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x11ff14370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x11ff14880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x11ff14cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x11ff14fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x11ff15420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x11ff15890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x11ff15df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x11ff162f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x11ff167f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x11ff16cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x11ff171f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x11ff176f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x11ff17bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x11ff180f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x11ff185f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x11ff18a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x11ff18ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x11ff19340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x11ff197b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x11ff19c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x11ff1a090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x11ff1a500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x11ff1a970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x11ff1ade0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x11ff1b250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x11ff1ba20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x11ff1bec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x11ff1c180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x11ff1c790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x11ff1cf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x11ff1d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x11ff1d8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x11ff1dd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x11ff1e200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x11ff1e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x11ff1eb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x11ff1efe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x11ff1f480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x11ff1f920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x11ff1fdc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x11ff20260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x11ff20700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x11ff20ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x11ff21040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x11ff214e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x11ff21980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x11ff21e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x11ff222c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x11ff22760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x11ff22c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x11ff230a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x11ff23540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x11ff239e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x11ff23e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x11ff24320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x11ff247c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x11ff24c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x11ff25100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x11ff255a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x11ff25a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x11ff25ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x11ff26380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x11ff26820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x11ff26cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x11ff27160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x11ff27600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x11ff27aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x11ff27f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x11ff283e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x11ff28880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x11ff28d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x11ff291c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x11ff29660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x11ff29b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x11ff29fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x11ff2a440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x11ff2a8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x11ff2ad80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x11ff2b220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x11ff2b6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x11ff2bb60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x11ff2c000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x11ff2c4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x11ff2c940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x11ff2cde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x11ff2d280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x11ff2d720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x11ff2dbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x11ff2e060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x11ff2e500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x11ff2e9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x11ff2ee40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x11ff2f2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x11ff2f780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x11ff2fc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x11ff300c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x11ff30560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x11ff30a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x11ff30ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x11ff31340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x11ff317e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x11ff31c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x11ff32120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x11ff325c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x11ff32a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x11ff32f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x11ff333a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x11ff33840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x11ff33ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x11ff34180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x11ff34620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x11ff34ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x11ff34f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x11ff35400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x11ff358a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x11ff35d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x11ff361e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x11ff36680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x11ff36b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x11ff36fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x11ff37460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x11ff37900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x11ff37da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x11ff382f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x11ff38840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x11ff38d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x11ff392e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x11ff395a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x11ff39bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x11ff3a1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x11ff3a7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x11ff3ade0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x11ff3b3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x11ff3bbe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x11ff3c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x11ff3c520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x11ff3c9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x11ff3d170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x11ff3d6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x11ff3dc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x11ff3e160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x11ff3e6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x11ff3ec00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x11ff3f150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x11ff3f6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x11ff3fbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x11ff40140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x11ff40690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x11ff40be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x11ff41130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x11ff41680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x11ff41bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x11ff42120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x11ff42670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x11ff42bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x11ff43110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x11ff43660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x11ff43bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x11ff44100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x11ff44650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x11ff44ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x11ff450f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x11ff45640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x11ff45b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x11ff460e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x11ff46630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x11ff46b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x11ff470d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x11ff47620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x11ff47b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x11ff480c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x11ff48610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x11ff48b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x11ff490b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x11ff49600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x11ff49b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x11ff4a0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x11ff4a5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x11ff4ab40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x11ff4b090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x11ff4b5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x11ff4bb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x11ff4c080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x11ff4c5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x11ff4cb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x11ff4d070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x11ff4d5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x11ff4db10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x11ff4e060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x11ff4e5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x11ff4eb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x11ff4f050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x11ff4f5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x11ff4faf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x11ff4ff90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x11ff50430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x11ff508d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x11ff50d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x11ff51210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x11ff516b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x11ff51b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x11ff51ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x11ff52490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x11ff52930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x11ff52dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x11ff53270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x11ff53710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x11ff53c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x11ff54380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x11ff54aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x11ff551c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x11ff558e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x11ff55ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x11ff561b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x11ff567c0 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x11ff094e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x11ff09950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x11ff09dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x11ff0a230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x11ff0a6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x11ff0ab10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x11ff0af80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x11ff0b3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x11ff0b860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x11ff0bcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x11ff0c140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x11ff0c720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x11ff0d010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x11ff0d790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x11ff0df70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x11ff0e660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x11ff0ed50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x11ff0f440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x11ff0fb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x11ff104b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x11ff10ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x11ff11290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x11ff11980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x11ff12070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x11ff12760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x11ff12bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x11ff13040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x11ff134b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x11ff13920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x11ff13d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x11ff14200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x11ff14670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x11ff14ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x11ff14da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x11ff15210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x11ff15680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x11ff15af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x11ff15f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x11ff163d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x11ff16840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x11ff16cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x11ff17120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x11ff17590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x11ff17a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x11ff17e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x11ff182e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x11ff18750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x11ff18bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x11ff19030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x11ff194a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x11ff19910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x11ff19d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x11ff1a1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x11ff1a660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x11ff1aad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x11ff1af40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x11ff1b3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x11ff1b820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x11ff1bc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x11ff1c100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x11ff1c570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x11ff1c9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x11ff1ce50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x11ff1d2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x11ff1d730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x11ff1dba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x11ff1e010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x11ff1e480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x11ff1e8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x11ff1ed60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x11ff1f1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x11ff1f640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x11ff1fab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x11ff1ff20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x11ff20390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x11ff20800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x11ff20c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x11ff210e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x11ff21550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x11ff219c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x11ff21e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x11ff222a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x11ff22710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x11ff22b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x11ff22ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x11ff23460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x11ff238d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x11ff23d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x11ff241b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x11ff24620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x11ff24a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x11ff24f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x11ff25370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x11ff257e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x11ff25c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x11ff260c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x11ff26530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x11ff269a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x11ff26e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x11ff27280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x11ff276f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x11ff27b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x11ff27fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x11ff28440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x11ff288b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x11ff28d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x11ff29190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x11ff29600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x11ff29a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x11ff29ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x11ff2a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x11ff2a7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x11ff2ac30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x11ff2b0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x11ff2b510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x11ff2b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x11ff2bdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x11ff2c260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x11ff2c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x11ff2cb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x11ff2cfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x11ff2d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x11ff2d890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x11ff2dd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x11ff2e170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x11ff2e5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x11ff2ea50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x11ff2eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x11ff2f330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x11ff2f7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x11ff2fc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x11ff30080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x11ff304f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x11ff30960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x11ff30dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x11ff31240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x11ff316b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x11ff31b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x11ff31f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x11ff32400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x11ff32870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x11ff32ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x11ff33150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x11ff335c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x11ff33a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x11ff33ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x11ff34310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x11ff34780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x11ff34bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x11ff35060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x11ff354d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x11ff35940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x11ff35db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x11ff36220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x11ff36690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x11ff36b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x11ff36f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x11ff373e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x11ff37850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x11ff37cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x11ff38130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x11ff385a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x11ff38a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x11ff38e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x11ff392f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x11ff39760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x11ff39bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x11ff3a350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x11ff3a7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x11ff3ac30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x11ff3b0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x11ff3b510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x11ff3b980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x11ff3bdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x11ff3c260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x11ff3c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x11ff3cb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x11ff3cfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x11ff3d420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x11ff3d890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x11ff3dd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x11ff3e170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x11ff3e5e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x11ff3ea50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x11ff3eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x11ff3f330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x11ff3f7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x11ff3fc10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x11ff40080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x11ff404f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x11ff40960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x11ff40dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x11ff41240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x11ff416b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x11ff41b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x11ff41f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x11ff42400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x11ff42870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x11ff42ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x11ff43150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x11ff435c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x11ff43a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x11ff43ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x11ff44310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x11ff44780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x11ff44bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x11ff45060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x11ff454d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x11ff45940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x11ff45db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x11ff46220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x11ff46690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x11ff46b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x11ff46f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x11ff473e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x11ff47850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x11ff47cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x11ff48130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x11ff485a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x11ff48a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x11ff48e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x11ff492f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x11ff49760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x11ff49bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x11ff4a040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x11ff4a4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x11ff4a920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x11ff4ad90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x11ff4b200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x11ff4b670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x11ff4bae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x11ff4bf50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x11ff4c3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x11ff4c830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x11ff4cca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x11ff4d110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x11ff4d580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x11ff4d9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x11ff4e0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x11ff4e7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x11ff4eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x11ff4f5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x11ff4fa20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x11ff4fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x11ff50300 | th_max = 1024 | th_width =   32
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


second run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this


single seq run: The quick brown fox jumps over the lazy Dog." "Sorry, I'm a bit rubbish at this

real	0m0.903s
user	0m0.240s
sys	0m0.129s
```
### ctest_with_model_debug

Runs ctest with model files in debug mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-debug
    Start 23: test-model-load-cancel
1/2 Test #23: test-model-load-cancel ...........   Passed    0.54 sec
    Start 24: test-autorelease
2/2 Test #24: test-autorelease .................   Passed    0.58 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   1.12 sec*proc (2 tests)

Total Test time (real) =   1.13 sec
        1.15 real         0.72 user         0.05 sys
```
### ctest_with_model_release

Runs ctest with model files in release mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-release
    Start 23: test-model-load-cancel
1/2 Test #23: test-model-load-cancel ...........   Passed    0.25 sec
    Start 24: test-autorelease
2/2 Test #24: test-autorelease .................   Passed    0.26 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   0.51 sec*proc (2 tests)

Total Test time (real) =   0.51 sec
        0.51 real         0.14 user         0.04 sys
```
