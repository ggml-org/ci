### ctest_debug

Runs ctest in debug mode
- status: 0
```
+ ctest --output-on-failure -L main -E test-opt
Test project /Users/ggml/work/llama.cpp/build-ci-debug
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.44 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    1.77 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.23 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.68 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.42 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.33 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    1.44 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.07 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.33 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.07 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.98 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.32 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.32 sec
      Start 14: test-sampling
14/27 Test #14: test-sampling .....................   Passed    2.14 sec
      Start 15: test-grammar-parser
15/27 Test #15: test-grammar-parser ...............   Passed    0.17 sec
      Start 16: test-grammar-integration
16/27 Test #16: test-grammar-integration ..........   Passed    0.28 sec
      Start 17: test-llama-grammar
17/27 Test #17: test-llama-grammar ................   Passed    0.22 sec
      Start 18: test-json-schema-to-grammar
18/27 Test #18: test-json-schema-to-grammar .......   Passed    2.20 sec
      Start 19: test-tokenizer-1-llama-spm
19/27 Test #19: test-tokenizer-1-llama-spm ........   Passed    1.03 sec
      Start 20: test-log
20/27 Test #20: test-log ..........................   Passed    0.21 sec
      Start 21: test-arg-parser
21/27 Test #21: test-arg-parser ...................   Passed    0.26 sec
      Start 22: test-chat-template
22/27 Test #22: test-chat-template ................   Passed    0.20 sec
      Start 23: test-backend-ops
23/27 Test #23: test-backend-ops ..................   Passed  179.11 sec
      Start 26: test-barrier
24/27 Test #26: test-barrier ......................   Passed    0.90 sec
      Start 27: test-quantize-fns
25/27 Test #27: test-quantize-fns .................   Passed   25.97 sec
      Start 28: test-quantize-perf
26/27 Test #28: test-quantize-perf ................   Passed    0.42 sec
      Start 29: test-rope
27/27 Test #29: test-rope .........................   Passed    0.21 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    = 221.72 sec*proc (27 tests)

Total Test time (real) = 221.73 sec

real	3m41.755s
user	7m41.510s
sys	0m6.226s
```

### ctest_release

Runs ctest in release mode
- status: 0
```
+ ctest --output-on-failure -L main
Test project /Users/ggml/work/llama.cpp/build-ci-release
      Start  1: test-tokenizer-0-bert-bge
 1/27 Test  #1: test-tokenizer-0-bert-bge .........   Passed    1.63 sec
      Start  2: test-tokenizer-0-command-r
 2/27 Test  #2: test-tokenizer-0-command-r ........   Passed    0.30 sec
      Start  3: test-tokenizer-0-deepseek-coder
 3/27 Test  #3: test-tokenizer-0-deepseek-coder ...   Passed    0.04 sec
      Start  4: test-tokenizer-0-deepseek-llm
 4/27 Test  #4: test-tokenizer-0-deepseek-llm .....   Passed    0.11 sec
      Start  5: test-tokenizer-0-falcon
 5/27 Test  #5: test-tokenizer-0-falcon ...........   Passed    0.07 sec
      Start  6: test-tokenizer-0-gpt-2
 6/27 Test  #6: test-tokenizer-0-gpt-2 ............   Passed    0.06 sec
      Start  7: test-tokenizer-0-llama-bpe
 7/27 Test  #7: test-tokenizer-0-llama-bpe ........   Passed    0.22 sec
      Start  8: test-tokenizer-0-llama-spm
 8/27 Test  #8: test-tokenizer-0-llama-spm ........   Passed    0.03 sec
      Start  9: test-tokenizer-0-mpt
 9/27 Test  #9: test-tokenizer-0-mpt ..............   Passed    0.06 sec
      Start 10: test-tokenizer-0-phi-3
10/27 Test #10: test-tokenizer-0-phi-3 ............   Passed    0.03 sec
      Start 11: test-tokenizer-0-qwen2
11/27 Test #11: test-tokenizer-0-qwen2 ............   Passed    0.15 sec
      Start 12: test-tokenizer-0-refact
12/27 Test #12: test-tokenizer-0-refact ...........   Passed    0.06 sec
      Start 13: test-tokenizer-0-starcoder
13/27 Test #13: test-tokenizer-0-starcoder ........   Passed    0.06 sec
      Start 14: test-sampling
14/27 Test #14: test-sampling .....................   Passed    0.90 sec
      Start 15: test-grammar-parser
15/27 Test #15: test-grammar-parser ...............   Passed    0.17 sec
      Start 16: test-grammar-integration
16/27 Test #16: test-grammar-integration ..........   Passed    0.50 sec
      Start 17: test-llama-grammar
17/27 Test #17: test-llama-grammar ................   Passed    0.17 sec
      Start 18: test-json-schema-to-grammar
18/27 Test #18: test-json-schema-to-grammar .......   Passed    2.13 sec
      Start 19: test-tokenizer-1-llama-spm
19/27 Test #19: test-tokenizer-1-llama-spm ........   Passed    0.31 sec
      Start 20: test-log
20/27 Test #20: test-log ..........................   Passed    0.18 sec
      Start 21: test-arg-parser
21/27 Test #21: test-arg-parser ...................   Passed    0.21 sec
      Start 22: test-chat-template
22/27 Test #22: test-chat-template ................   Passed    0.17 sec
      Start 23: test-backend-ops
23/27 Test #23: test-backend-ops ..................   Passed   29.49 sec
      Start 26: test-barrier
24/27 Test #26: test-barrier ......................   Passed    0.37 sec
      Start 27: test-quantize-fns
25/27 Test #27: test-quantize-fns .................   Passed   14.03 sec
      Start 28: test-quantize-perf
26/27 Test #28: test-quantize-perf ................   Passed    0.21 sec
      Start 29: test-rope
27/27 Test #29: test-rope .........................   Passed    0.21 sec

100% tests passed, 0 tests failed out of 27

Label Time Summary:
main    =  51.86 sec*proc (27 tests)

Total Test time (real) =  51.87 sec

real	0m51.879s
user	1m11.814s
sys	0m5.711s
```
### embd_bge_small

BGE Small (BERT):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-f16.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.178 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.015.464 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.019.666 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.019.672 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.019.681 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.019.683 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.019.683 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.019.687 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.019.688 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.019.690 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.019.690 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.019.691 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.019.692 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.019.692 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.019.695 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.019.696 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.019.697 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.019.697 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.019.698 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.019.698 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.019.699 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.024.671 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.026.095 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.026.097 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.026.097 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.026.098 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.026.099 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.026.099 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.026.099 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.026.100 I llama_model_loader: - type  f32:  124 tensors
0.00.026.101 I llama_model_loader: - type  f16:   73 tensors
0.00.030.858 I llm_load_vocab: special tokens cache size = 5
0.00.033.263 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.033.267 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.033.267 I llm_load_print_meta: arch             = bert
0.00.033.268 I llm_load_print_meta: vocab type       = WPM
0.00.033.268 I llm_load_print_meta: n_vocab          = 30522
0.00.033.269 I llm_load_print_meta: n_merges         = 0
0.00.033.269 I llm_load_print_meta: vocab_only       = 0
0.00.033.269 I llm_load_print_meta: n_ctx_train      = 512
0.00.033.269 I llm_load_print_meta: n_embd           = 384
0.00.033.270 I llm_load_print_meta: n_layer          = 12
0.00.033.273 I llm_load_print_meta: n_head           = 12
0.00.033.274 I llm_load_print_meta: n_head_kv        = 12
0.00.033.274 I llm_load_print_meta: n_rot            = 32
0.00.033.275 I llm_load_print_meta: n_swa            = 0
0.00.033.275 I llm_load_print_meta: n_embd_head_k    = 32
0.00.033.275 I llm_load_print_meta: n_embd_head_v    = 32
0.00.033.276 I llm_load_print_meta: n_gqa            = 1
0.00.033.277 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.033.278 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.033.279 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.033.279 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.033.279 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.033.280 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.033.280 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.033.281 I llm_load_print_meta: n_ff             = 1536
0.00.033.281 I llm_load_print_meta: n_expert         = 0
0.00.033.281 I llm_load_print_meta: n_expert_used    = 0
0.00.033.282 I llm_load_print_meta: causal attn      = 0
0.00.033.282 I llm_load_print_meta: pooling type     = 2
0.00.033.282 I llm_load_print_meta: rope type        = 2
0.00.033.283 I llm_load_print_meta: rope scaling     = linear
0.00.033.283 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.033.284 I llm_load_print_meta: freq_scale_train = 1
0.00.033.286 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.033.286 I llm_load_print_meta: rope_finetuned   = unknown
0.00.033.286 I llm_load_print_meta: ssm_d_conv       = 0
0.00.033.287 I llm_load_print_meta: ssm_d_inner      = 0
0.00.033.287 I llm_load_print_meta: ssm_d_state      = 0
0.00.033.287 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.033.287 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.033.287 I llm_load_print_meta: model type       = 33M
0.00.033.288 I llm_load_print_meta: model ftype      = F16
0.00.033.289 I llm_load_print_meta: model params     = 33.21 M
0.00.033.289 I llm_load_print_meta: model size       = 63.84 MiB (16.12 BPW) 
0.00.033.290 I llm_load_print_meta: general.name     = Bge Small
0.00.033.290 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.033.290 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.033.291 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.033.291 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.033.291 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.033.291 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.033.292 I llm_load_print_meta: max token length = 21
0.00.035.431 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.035.432 I llm_load_tensors: offloading output layer to GPU
0.00.035.433 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.035.458 I llm_load_tensors: Metal_Mapped model buffer size =    40.73 MiB
0.00.035.460 I llm_load_tensors:   CPU_Mapped model buffer size =    23.11 MiB
................................................
0.00.036.077 I llama_new_context_with_model: n_seq_max     = 1
0.00.036.078 I llama_new_context_with_model: n_ctx         = 512
0.00.036.079 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.036.079 I llama_new_context_with_model: n_batch       = 2048
0.00.036.079 I llama_new_context_with_model: n_ubatch      = 2048
0.00.036.080 I llama_new_context_with_model: flash_attn    = 0
0.00.036.080 I llama_new_context_with_model: freq_base     = 10000.0
0.00.036.081 I llama_new_context_with_model: freq_scale    = 1
0.00.036.082 I ggml_metal_init: allocating
0.00.036.094 I ggml_metal_init: found device: Apple M4
0.00.036.100 I ggml_metal_init: picking default device: Apple M4
0.00.037.067 I ggml_metal_init: using embedded metal library
0.00.041.552 I ggml_metal_init: GPU name:   Apple M4
0.00.041.555 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.041.556 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.041.556 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.041.556 I ggml_metal_init: simdgroup reduction   = true
0.00.041.557 I ggml_metal_init: simdgroup matrix mul. = true
0.00.041.557 I ggml_metal_init: has bfloat            = true
0.00.041.557 I ggml_metal_init: use bfloat            = true
0.00.041.558 I ggml_metal_init: hasUnifiedMemory      = true
0.00.041.559 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.058.180 I llama_kv_cache_init: kv_size = 512, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 12
0.00.058.983 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.058.986 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.058.988 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.059.969 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.059.971 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.059.972 I llama_new_context_with_model: graph nodes  = 429
0.00.059.972 I llama_new_context_with_model: graph splits = 2
0.00.059.996 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 512
0.00.059.998 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.068.310 I 
0.00.068.345 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.069.250 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.043984 -0.019895  0.007670 -0.000838  0.001372 -0.037036  0.109436  0.042589  0.092046 -0.015918  0.006773 -0.035692 -0.017889  0.015040  0.018126  0.015860 -0.011308  0.010431 -0.085223 -0.008454  0.091368 -0.017067 -0.060328 -0.024484  0.027524  0.076059  0.027984 -0.014564  0.017645 -0.033268 -0.037874 -0.019012  0.068670 -0.009845 -0.025030  0.072346 -0.046570  0.011026 -0.050252  0.047693  0.032387 -0.011761  0.022055  0.049645  0.010465  0.005795 -0.028860  0.008933 -0.018507 -0.051466 -0.046036  0.030497 -0.035418  0.054204 -0.069650  0.044238  0.029786  0.046305  0.073410 -0.042580  0.076109  0.038851 -0.181182  0.082503  0.042250 -0.064549 -0.060097 -0.017853  0.006472  0.005873  0.017196 -0.026615  0.064578  0.112612  0.035159 -0.067416  0.027073 -0.067295 -0.033493 -0.033219  0.033252  0.013523 -0.003346 -0.037473 -0.052055  0.055155 -0.001982 -0.038276  0.064447  0.028824 -0.043334 -0.029236 -0.039462  0.036315  0.008379 -0.015481 -0.036573  0.018130  0.028600  0.342831 -0.044484  0.056114  0.017624 -0.020867 -0.066808  0.000146 -0.037885 -0.030063 -0.008541 -0.021595  0.000548 -0.003219  0.004020  0.018908 -0.008548  0.025835  0.049433  0.000091  0.050920 -0.042479 -0.031884  0.023606  0.030691 -0.023148 -0.046271 -0.079278  0.115198  0.046757  0.027829 -0.040710  0.067777 -0.022955  0.010332 -0.032937 -0.018305  0.043844  0.024268  0.052413  0.007469  0.008905  0.011244 -0.074655 -0.065561 -0.026750 -0.041192 -0.023884  0.026710  0.006912  0.027741  0.052873 -0.036673  0.057707 -0.000170  0.031764 -0.019760 -0.022083  0.041053 -0.058903  0.019619  0.043144  0.043582  0.041593 -0.022527  0.027037 -0.021833  0.005430 -0.041317 -0.001239  0.024452  0.002088  0.044333 -0.022745  0.043662  0.064763  0.055430  0.037060 -0.000919  0.046111  0.045790 -0.008487  0.063057 -0.073235 -0.011935  0.032107  0.023957  0.014725 -0.033688  0.001083 -0.015827 -0.019002  0.047872  0.110842  0.028428  0.031366 -0.013288 -0.057499  0.006644  0.005140 -0.012262 -0.051443 -0.000965 -0.017642 -0.019440 -0.040937  0.009209 -0.057957  0.050961  0.052340 -0.009617 -0.040259 -0.014075 -0.024877 -0.017251  0.006302  0.006588 -0.026919  0.015600  0.030760  0.002578  0.023206 -0.022199 -0.098557 -0.051105 -0.278031 -0.014994 -0.061553 -0.027218  0.017666 -0.010939 -0.017077  0.035055  0.046994 -0.015432  0.015232 -0.025477  0.047844 -0.005949 -0.000749 -0.061008 -0.068946 -0.060377 -0.035942  0.043319 -0.055047  0.015075  0.000537 -0.058175 -0.010439  0.012643  0.151495  0.127111 -0.013622  0.041993 -0.025672  0.014026 -0.001037 -0.150469  0.044857  0.005320 -0.036274 -0.029801 -0.020192 -0.034891  0.010235  0.033548 -0.048178 -0.051795 -0.017463 -0.023492  0.047349  0.052076 -0.016783 -0.055452  0.025836 -0.005707  0.010710  0.038705  0.008191 -0.009764 -0.105779 -0.027430 -0.096101  0.025068 -0.011260  0.092355  0.056101  0.003758  0.027791  0.002092 -0.051085 -0.039890 -0.013542 -0.044956 -0.015335  0.002910 -0.043498 -0.077951  0.065217 -0.006840 -0.001630 -0.014642  0.071560  0.023714 -0.037180  0.009175  0.001562 -0.032268  0.015468  0.037880  0.000337 -0.053207  0.021321 -0.039829  0.000031  0.013400  0.019798 -0.057879  0.006473 -0.049531 -0.267858  0.039156 -0.067972  0.038248 -0.012333  0.041485 -0.016117  0.052383 -0.071363  0.011369  0.024719 -0.007232  0.082087  0.028535 -0.021504  0.040494 -0.004570 -0.074594 -0.014749  0.020037  0.002304  0.023148  0.197212 -0.043222 -0.025983 -0.004959 -0.019278  0.074258  0.001716 -0.031979 -0.036599 -0.045082  0.000547 -0.011560  0.018126 -0.029461 -0.008463  0.006419  0.050799 -0.014959  0.006176  0.026096 -0.030809  0.048055  0.114093 -0.040826 -0.011457  0.005419 -0.003599  0.025154 -0.059142  0.013753 -0.010399  0.038709  0.051449  0.035413  0.035031 -0.017027  0.026360 -0.014490 -0.050032  0.003219  0.054121  0.039723 -0.039127 

0.00.074.483 I llama_perf_context_print:        load time =      52.84 ms
0.00.074.484 I llama_perf_context_print: prompt eval time =       5.07 ms /     9 tokens (    0.56 ms per token,  1774.45 tokens per second)
0.00.074.485 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.074.485 I llama_perf_context_print:       total time =       6.17 ms /    10 tokens
0.00.074.650 I ggml_metal_free: deallocating

real	0m0.256s
user	0m0.052s
sys	0m0.033s
```
- q8_0:
```
+ ./bin/llama-embedding --model ../models-mnt/bge-small/ggml-model-q8_0.gguf -p 'I believe the meaning of life is' -ngl 99 -c 0
0.00.000.034 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.349 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.011.520 I llama_model_loader: loaded meta data with 25 key-value pairs and 197 tensors from ../models-mnt/bge-small/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.011.523 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.011.524 I llama_model_loader: - kv   0:                       general.architecture str              = bert
0.00.011.525 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.011.525 I llama_model_loader: - kv   2:                               general.name str              = Bge Small
0.00.011.525 I llama_model_loader: - kv   3:                           general.basename str              = bge
0.00.011.526 I llama_model_loader: - kv   4:                         general.size_label str              = small
0.00.011.526 I llama_model_loader: - kv   5:                           bert.block_count u32              = 12
0.00.011.527 I llama_model_loader: - kv   6:                        bert.context_length u32              = 512
0.00.011.527 I llama_model_loader: - kv   7:                      bert.embedding_length u32              = 384
0.00.011.527 I llama_model_loader: - kv   8:                   bert.feed_forward_length u32              = 1536
0.00.011.527 I llama_model_loader: - kv   9:                  bert.attention.head_count u32              = 12
0.00.011.530 I llama_model_loader: - kv  10:          bert.attention.layer_norm_epsilon f32              = 0.000000
0.00.011.530 I llama_model_loader: - kv  11:                          general.file_type u32              = 7
0.00.011.530 I llama_model_loader: - kv  12:                      bert.attention.causal bool             = false
0.00.011.531 I llama_model_loader: - kv  13:                          bert.pooling_type u32              = 2
0.00.011.533 I llama_model_loader: - kv  14:            tokenizer.ggml.token_type_count u32              = 2
0.00.011.533 I llama_model_loader: - kv  15:                       tokenizer.ggml.model str              = bert
0.00.011.533 I llama_model_loader: - kv  16:                         tokenizer.ggml.pre str              = jina-v2-en
0.00.014.044 I llama_model_loader: - kv  17:                      tokenizer.ggml.tokens arr[str,30522]   = ["[PAD]", "[unused0]", "[unused1]", "...
0.00.014.718 I llama_model_loader: - kv  18:                  tokenizer.ggml.token_type arr[i32,30522]   = [3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.014.719 I llama_model_loader: - kv  19:            tokenizer.ggml.unknown_token_id u32              = 100
0.00.014.719 I llama_model_loader: - kv  20:          tokenizer.ggml.seperator_token_id u32              = 102
0.00.014.720 I llama_model_loader: - kv  21:            tokenizer.ggml.padding_token_id u32              = 0
0.00.014.720 I llama_model_loader: - kv  22:                tokenizer.ggml.cls_token_id u32              = 101
0.00.014.720 I llama_model_loader: - kv  23:               tokenizer.ggml.mask_token_id u32              = 103
0.00.014.720 I llama_model_loader: - kv  24:               general.quantization_version u32              = 2
0.00.014.721 I llama_model_loader: - type  f32:  124 tensors
0.00.014.721 I llama_model_loader: - type q8_0:   73 tensors
0.00.017.205 I llm_load_vocab: special tokens cache size = 5
0.00.018.617 I llm_load_vocab: token to piece cache size = 0.2032 MB
0.00.018.620 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.018.620 I llm_load_print_meta: arch             = bert
0.00.018.620 I llm_load_print_meta: vocab type       = WPM
0.00.018.621 I llm_load_print_meta: n_vocab          = 30522
0.00.018.621 I llm_load_print_meta: n_merges         = 0
0.00.018.621 I llm_load_print_meta: vocab_only       = 0
0.00.018.621 I llm_load_print_meta: n_ctx_train      = 512
0.00.018.621 I llm_load_print_meta: n_embd           = 384
0.00.018.621 I llm_load_print_meta: n_layer          = 12
0.00.018.623 I llm_load_print_meta: n_head           = 12
0.00.018.624 I llm_load_print_meta: n_head_kv        = 12
0.00.018.625 I llm_load_print_meta: n_rot            = 32
0.00.018.625 I llm_load_print_meta: n_swa            = 0
0.00.018.625 I llm_load_print_meta: n_embd_head_k    = 32
0.00.018.625 I llm_load_print_meta: n_embd_head_v    = 32
0.00.018.625 I llm_load_print_meta: n_gqa            = 1
0.00.018.626 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.018.628 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.018.628 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.018.629 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.018.629 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.018.629 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.018.629 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.018.630 I llm_load_print_meta: n_ff             = 1536
0.00.018.632 I llm_load_print_meta: n_expert         = 0
0.00.018.632 I llm_load_print_meta: n_expert_used    = 0
0.00.018.633 I llm_load_print_meta: causal attn      = 0
0.00.018.633 I llm_load_print_meta: pooling type     = 2
0.00.018.633 I llm_load_print_meta: rope type        = 2
0.00.018.633 I llm_load_print_meta: rope scaling     = linear
0.00.018.634 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.018.634 I llm_load_print_meta: freq_scale_train = 1
0.00.018.634 I llm_load_print_meta: n_ctx_orig_yarn  = 512
0.00.018.635 I llm_load_print_meta: rope_finetuned   = unknown
0.00.018.636 I llm_load_print_meta: ssm_d_conv       = 0
0.00.018.636 I llm_load_print_meta: ssm_d_inner      = 0
0.00.018.636 I llm_load_print_meta: ssm_d_state      = 0
0.00.018.636 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.018.636 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.018.636 I llm_load_print_meta: model type       = 33M
0.00.018.636 I llm_load_print_meta: model ftype      = Q8_0
0.00.018.637 I llm_load_print_meta: model params     = 33.21 M
0.00.018.637 I llm_load_print_meta: model size       = 34.38 MiB (8.68 BPW) 
0.00.018.637 I llm_load_print_meta: general.name     = Bge Small
0.00.018.638 I llm_load_print_meta: UNK token        = 100 '[UNK]'
0.00.018.638 I llm_load_print_meta: SEP token        = 102 '[SEP]'
0.00.018.638 I llm_load_print_meta: PAD token        = 0 '[PAD]'
0.00.018.638 I llm_load_print_meta: CLS token        = 101 '[CLS]'
0.00.018.638 I llm_load_print_meta: MASK token       = 103 '[MASK]'
0.00.018.638 I llm_load_print_meta: LF token         = 0 '[PAD]'
0.00.018.639 I llm_load_print_meta: max token length = 21
0.00.019.902 I llm_load_tensors: offloading 12 repeating layers to GPU
0.00.019.902 I llm_load_tensors: offloading output layer to GPU
0.00.019.903 I llm_load_tensors: offloaded 13/13 layers to GPU
0.00.019.908 I llm_load_tensors: Metal_Mapped model buffer size =    21.75 MiB
0.00.019.909 I llm_load_tensors:   CPU_Mapped model buffer size =    12.63 MiB
................................................
0.00.020.271 I llama_new_context_with_model: n_seq_max     = 1
0.00.020.272 I llama_new_context_with_model: n_ctx         = 512
0.00.020.273 I llama_new_context_with_model: n_ctx_per_seq = 512
0.00.020.273 I llama_new_context_with_model: n_batch       = 2048
0.00.020.273 I llama_new_context_with_model: n_ubatch      = 2048
0.00.020.273 I llama_new_context_with_model: flash_attn    = 0
0.00.020.274 I llama_new_context_with_model: freq_base     = 10000.0
0.00.020.274 I llama_new_context_with_model: freq_scale    = 1
0.00.020.274 I ggml_metal_init: allocating
0.00.020.280 I ggml_metal_init: found device: Apple M4
0.00.020.282 I ggml_metal_init: picking default device: Apple M4
0.00.020.892 I ggml_metal_init: using embedded metal library
0.00.023.489 I ggml_metal_init: GPU name:   Apple M4
0.00.023.490 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.023.491 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.023.491 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.023.491 I ggml_metal_init: simdgroup reduction   = true
0.00.023.492 I ggml_metal_init: simdgroup matrix mul. = true
0.00.023.492 I ggml_metal_init: has bfloat            = true
0.00.023.492 I ggml_metal_init: use bfloat            = true
0.00.023.492 I ggml_metal_init: hasUnifiedMemory      = true
0.00.023.493 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.033.630 I llama_kv_cache_init: kv_size = 512, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 12
0.00.034.108 I llama_kv_cache_init:      Metal KV buffer size =     9.00 MiB
0.00.034.112 I llama_new_context_with_model: KV self size  =    9.00 MiB, K (f16):    4.50 MiB, V (f16):    4.50 MiB
0.00.034.117 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.034.708 I llama_new_context_with_model:      Metal compute buffer size =    16.00 MiB
0.00.034.709 I llama_new_context_with_model:        CPU compute buffer size =     2.51 MiB
0.00.034.709 I llama_new_context_with_model: graph nodes  = 429
0.00.034.710 I llama_new_context_with_model: graph splits = 2
0.00.034.723 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 512
0.00.034.724 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.039.931 I 
0.00.039.955 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.040.483 I batch_decode: n_tokens = 9, n_seq = 1

embedding 0: -0.044994 -0.019858  0.007986 -0.001410  0.001531 -0.036276  0.109404  0.043235  0.092836 -0.015201  0.005971 -0.036330 -0.018159  0.015015  0.017667  0.014510 -0.011792  0.011812 -0.084764 -0.008081  0.091650 -0.017638 -0.061084 -0.025066  0.026879  0.076180  0.028256 -0.014273  0.017420 -0.033553 -0.037520 -0.018280  0.068843 -0.010129 -0.024896  0.071968 -0.046406  0.011471 -0.050333  0.048931  0.032317 -0.012107  0.021812  0.049796  0.010366  0.005264 -0.028665  0.008581 -0.018508 -0.052358 -0.046410  0.029426 -0.034989  0.053289 -0.069849  0.043767  0.029291  0.046759  0.073664 -0.043090  0.075213  0.038641 -0.180496  0.081648  0.043389 -0.065615 -0.059878 -0.017387  0.006913  0.005155  0.017165 -0.026679  0.064347  0.112564  0.034871 -0.067783  0.027124 -0.066989 -0.034296 -0.033344  0.033189  0.014325 -0.004253 -0.036945 -0.052008  0.054151 -0.001715 -0.038112  0.063016  0.028668 -0.041665 -0.028879 -0.039263  0.036879  0.007718 -0.015657 -0.036270  0.018699  0.029792  0.344948 -0.043880  0.056487  0.018022 -0.021448 -0.065281  0.000253 -0.037910 -0.029663 -0.008828 -0.020643  0.001162 -0.003510  0.003091  0.018576 -0.009637  0.025316  0.049298 -0.000937  0.051568 -0.042363 -0.031550  0.023315  0.030044 -0.023267 -0.045483 -0.079644  0.114489  0.047503  0.027208 -0.041477  0.067717 -0.022845  0.010232 -0.033486 -0.017199  0.044319  0.022956  0.052194  0.008122  0.008112  0.009951 -0.074643 -0.065035 -0.025938 -0.040806 -0.024533  0.027409  0.006078  0.027693  0.052243 -0.036587  0.058682  0.001467  0.032191 -0.019964 -0.021840  0.041805 -0.058801  0.019348  0.042626  0.043999  0.040911 -0.021909  0.028025 -0.022801  0.005520 -0.041266 -0.000085  0.024325  0.001532  0.044802 -0.022888  0.043056  0.065030  0.056292  0.037666 -0.001004  0.047521  0.045624 -0.008614  0.062270 -0.073313 -0.011718  0.032708  0.023348  0.014650 -0.033924  0.001158 -0.015872 -0.018974  0.047982  0.110740  0.029177  0.030881 -0.012325 -0.057836  0.006939  0.004378 -0.011864 -0.051754 -0.003018 -0.017766 -0.020051 -0.041018  0.009118 -0.058568  0.050632  0.051795 -0.008968 -0.040668 -0.014765 -0.024320 -0.015980  0.005823  0.007147 -0.027335  0.016275  0.030734  0.002342  0.023167 -0.022169 -0.098059 -0.050901 -0.277240 -0.015100 -0.061566 -0.026219  0.017141 -0.010285 -0.017522  0.034725  0.047897 -0.016594  0.015489 -0.024132  0.048613 -0.004993 -0.000001 -0.060860 -0.068346 -0.059622 -0.036157  0.043605 -0.056353  0.014713  0.000292 -0.058627 -0.010995  0.012274  0.151597  0.127025 -0.012582  0.042765 -0.025227  0.013629 -0.000381 -0.150686  0.043974  0.004714 -0.036955 -0.029586 -0.019853 -0.034063  0.009522  0.034004 -0.048909 -0.051765 -0.017243 -0.025080  0.047588  0.050981 -0.017553 -0.056746  0.024054 -0.006285  0.011003  0.038719  0.008083 -0.008595 -0.106361 -0.027365 -0.096966  0.025294 -0.011096  0.091579  0.056180  0.004494  0.028066  0.001727 -0.051388 -0.039497 -0.013817 -0.045907 -0.015238  0.002920 -0.043938 -0.077716  0.066102 -0.006195 -0.000885 -0.013768  0.071562  0.023826 -0.036363  0.007848  0.001487 -0.032916  0.016336  0.037378  0.000625 -0.052389  0.021549 -0.039695 -0.000026  0.013496  0.020436 -0.057513  0.005900 -0.049906 -0.267546  0.038686 -0.067509  0.037450 -0.011471  0.041547 -0.015904  0.051347 -0.072313  0.012571  0.024808 -0.007420  0.082069  0.028175 -0.021956  0.040736 -0.003945 -0.074192 -0.014923  0.020417  0.002644  0.023207  0.197144 -0.043068 -0.025876 -0.004886 -0.018582  0.073936  0.001341 -0.031663 -0.037140 -0.044262  0.000049 -0.010741  0.018225 -0.028045 -0.008828  0.006047  0.050183 -0.015017  0.007037  0.025894 -0.030628  0.048075  0.112795 -0.039982 -0.011695  0.005039 -0.002800  0.025072 -0.059720  0.014182 -0.010019  0.038100  0.051088  0.034726  0.035947 -0.017035  0.027243 -0.015391 -0.051195  0.003744  0.053928  0.040014 -0.039140 

0.00.043.924 I llama_perf_context_print:        load time =      30.57 ms
0.00.043.925 I llama_perf_context_print: prompt eval time =       3.32 ms /     9 tokens (    0.37 ms per token,  2708.40 tokens per second)
0.00.043.925 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.043.926 I llama_perf_context_print:       total time =       3.99 ms /    10 tokens
0.00.044.112 I ggml_metal_free: deallocating

real	0m0.057s
user	0m0.031s
sys	0m0.017s
```
### rerank_tiny

Rerank Tiny (Jina):
- status: 0
- f16: 
```
+ ./bin/llama-embedding --model ../models-mnt/rerank-tiny/ggml-model-f16.gguf -p 'what is panda?</s></s>hi\nwhat is panda?</s></s>it'\''s a bear\nwhat is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.' -ngl 99 -c 0 --pooling rank --embd-normalize -1 --verbose-prompt
0.00.000.283 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.023.384 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.034.165 I llama_model_loader: loaded meta data with 29 key-value pairs and 70 tensors from ../models-mnt/rerank-tiny/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.034.170 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.034.173 I llama_model_loader: - kv   0:                       general.architecture str              = jina-bert-v2
0.00.034.174 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.034.179 I llama_model_loader: - kv   2:                               general.name str              = Jina Bert Implementation
0.00.034.179 I llama_model_loader: - kv   3:                       general.organization str              = Jinaai
0.00.034.180 I llama_model_loader: - kv   4:                         general.size_label str              = 33M
0.00.034.182 I llama_model_loader: - kv   5:                   jina-bert-v2.block_count u32              = 4
0.00.034.182 I llama_model_loader: - kv   6:                jina-bert-v2.context_length u32              = 8192
0.00.034.183 I llama_model_loader: - kv   7:              jina-bert-v2.embedding_length u32              = 384
0.00.034.184 I llama_model_loader: - kv   8:           jina-bert-v2.feed_forward_length u32              = 1536
0.00.034.184 I llama_model_loader: - kv   9:          jina-bert-v2.attention.head_count u32              = 12
0.00.034.188 I llama_model_loader: - kv  10:  jina-bert-v2.attention.layer_norm_epsilon f32              = 0.000000
0.00.034.189 I llama_model_loader: - kv  11:                          general.file_type u32              = 1
0.00.034.190 I llama_model_loader: - kv  12:              jina-bert-v2.attention.causal bool             = false
0.00.034.192 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.034.193 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = jina-v1-en
0.00.042.381 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,61056]   = ["<s>", "<pad>", "</s>", "<unk>", "<m...
0.00.044.747 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,61056]   = [3, 3, 3, 3, 3, 1, 1, 1, 1, 1, 1, 1, ...
0.00.049.623 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,39382]   = ["t h", "i n", "a n", "e r", "th e", ...
0.00.049.625 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.049.625 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 2
0.00.049.626 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 3
0.00.049.626 I llama_model_loader: - kv  21:          tokenizer.ggml.seperator_token_id u32              = 2
0.00.049.627 I llama_model_loader: - kv  22:            tokenizer.ggml.padding_token_id u32              = 1
0.00.049.627 I llama_model_loader: - kv  23:                tokenizer.ggml.cls_token_id u32              = 0
0.00.049.627 I llama_model_loader: - kv  24:               tokenizer.ggml.mask_token_id u32              = 4
0.00.049.628 I llama_model_loader: - kv  25:            tokenizer.ggml.token_type_count u32              = 2
0.00.049.628 I llama_model_loader: - kv  26:               tokenizer.ggml.add_bos_token bool             = true
0.00.049.628 I llama_model_loader: - kv  27:               tokenizer.ggml.add_eos_token bool             = true
0.00.049.629 I llama_model_loader: - kv  28:               general.quantization_version u32              = 2
0.00.049.630 I llama_model_loader: - type  f32:   40 tensors
0.00.049.630 I llama_model_loader: - type  f16:   30 tensors
0.00.068.264 W llm_load_vocab: empty token at index 5
0.00.073.073 W llm_load_vocab: model vocab missing newline token, using special_pad_id instead
0.00.074.457 W llm_load_vocab: special_eos_id is not in special_eog_ids - the tokenizer config may be incorrect
0.00.074.487 I llm_load_vocab: special tokens cache size = 5
0.00.333.945 I llm_load_vocab: token to piece cache size = 1.5060 MB
0.00.333.951 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.333.951 I llm_load_print_meta: arch             = jina-bert-v2
0.00.333.951 I llm_load_print_meta: vocab type       = BPE
0.00.333.952 I llm_load_print_meta: n_vocab          = 61056
0.00.333.952 I llm_load_print_meta: n_merges         = 39382
0.00.333.952 I llm_load_print_meta: vocab_only       = 0
0.00.333.952 I llm_load_print_meta: n_ctx_train      = 8192
0.00.333.952 I llm_load_print_meta: n_embd           = 384
0.00.333.953 I llm_load_print_meta: n_layer          = 4
0.00.333.962 I llm_load_print_meta: n_head           = 12
0.00.333.963 I llm_load_print_meta: n_head_kv        = 12
0.00.333.963 I llm_load_print_meta: n_rot            = 32
0.00.333.963 I llm_load_print_meta: n_swa            = 0
0.00.333.963 I llm_load_print_meta: n_embd_head_k    = 32
0.00.333.963 I llm_load_print_meta: n_embd_head_v    = 32
0.00.333.964 I llm_load_print_meta: n_gqa            = 1
0.00.333.965 I llm_load_print_meta: n_embd_k_gqa     = 384
0.00.333.966 I llm_load_print_meta: n_embd_v_gqa     = 384
0.00.333.966 I llm_load_print_meta: f_norm_eps       = 1.0e-12
0.00.333.967 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.333.967 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.333.967 I llm_load_print_meta: f_max_alibi_bias = 8.0e+00
0.00.333.968 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.333.968 I llm_load_print_meta: n_ff             = 1536
0.00.333.969 I llm_load_print_meta: n_expert         = 0
0.00.333.969 I llm_load_print_meta: n_expert_used    = 0
0.00.333.969 I llm_load_print_meta: causal attn      = 0
0.00.333.969 I llm_load_print_meta: pooling type     = -1
0.00.333.969 I llm_load_print_meta: rope type        = -1
0.00.333.969 I llm_load_print_meta: rope scaling     = linear
0.00.333.970 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.333.970 I llm_load_print_meta: freq_scale_train = 1
0.00.333.972 I llm_load_print_meta: n_ctx_orig_yarn  = 8192
0.00.333.972 I llm_load_print_meta: rope_finetuned   = unknown
0.00.333.972 I llm_load_print_meta: ssm_d_conv       = 0
0.00.333.972 I llm_load_print_meta: ssm_d_inner      = 0
0.00.333.972 I llm_load_print_meta: ssm_d_state      = 0
0.00.333.973 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.333.973 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.333.973 I llm_load_print_meta: model type       = 33M
0.00.333.974 I llm_load_print_meta: model ftype      = F16
0.00.333.974 I llm_load_print_meta: model params     = 32.90 M
0.00.333.974 I llm_load_print_meta: model size       = 62.78 MiB (16.01 BPW) 
0.00.333.975 I llm_load_print_meta: general.name     = Jina Bert Implementation
0.00.333.975 I llm_load_print_meta: BOS token        = 0 '<s>'
0.00.333.975 I llm_load_print_meta: EOS token        = 2 '</s>'
0.00.333.975 I llm_load_print_meta: UNK token        = 3 '<unk>'
0.00.333.976 I llm_load_print_meta: SEP token        = 2 '</s>'
0.00.333.976 I llm_load_print_meta: PAD token        = 1 '<pad>'
0.00.333.976 I llm_load_print_meta: CLS token        = 0 '<s>'
0.00.333.976 I llm_load_print_meta: MASK token       = 4 '<mask>'
0.00.333.977 I llm_load_print_meta: EOG token        = 2 '</s>'
0.00.333.977 I llm_load_print_meta: max token length = 45
0.00.335.266 I llm_load_tensors: offloading 4 repeating layers to GPU
0.00.335.267 I llm_load_tensors: offloading output layer to GPU
0.00.335.267 I llm_load_tensors: offloaded 5/5 layers to GPU
0.00.335.291 I llm_load_tensors: Metal_Mapped model buffer size =    18.06 MiB
0.00.335.292 I llm_load_tensors:   CPU_Mapped model buffer size =    44.72 MiB
....................
0.00.336.186 I llama_new_context_with_model: n_seq_max     = 1
0.00.336.187 I llama_new_context_with_model: n_ctx         = 8192
0.00.336.187 I llama_new_context_with_model: n_ctx_per_seq = 8192
0.00.336.187 I llama_new_context_with_model: n_batch       = 2048
0.00.336.188 I llama_new_context_with_model: n_ubatch      = 2048
0.00.336.188 I llama_new_context_with_model: flash_attn    = 0
0.00.336.188 I llama_new_context_with_model: freq_base     = 10000.0
0.00.336.188 I llama_new_context_with_model: freq_scale    = 1
0.00.336.189 I ggml_metal_init: allocating
0.00.336.193 I ggml_metal_init: found device: Apple M4
0.00.336.194 I ggml_metal_init: picking default device: Apple M4
0.00.337.256 I ggml_metal_init: using embedded metal library
0.00.340.089 I ggml_metal_init: GPU name:   Apple M4
0.00.340.090 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.340.091 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.340.091 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.340.091 I ggml_metal_init: simdgroup reduction   = true
0.00.340.091 I ggml_metal_init: simdgroup matrix mul. = true
0.00.340.091 I ggml_metal_init: has bfloat            = true
0.00.340.092 I ggml_metal_init: use bfloat            = true
0.00.340.092 I ggml_metal_init: hasUnifiedMemory      = true
0.00.340.093 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.349.549 I llama_kv_cache_init: kv_size = 8192, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 4
0.00.352.011 I llama_kv_cache_init:      Metal KV buffer size =    48.00 MiB
0.00.352.014 I llama_new_context_with_model: KV self size  =   48.00 MiB, K (f16):   24.00 MiB, V (f16):   24.00 MiB
0.00.352.018 I llama_new_context_with_model:        CPU  output buffer size =     0.00 MiB
0.00.352.622 I llama_new_context_with_model:      Metal compute buffer size =   220.01 MiB
0.00.352.623 I llama_new_context_with_model:        CPU compute buffer size =    22.02 MiB
0.00.352.623 I llama_new_context_with_model: graph nodes  = 154
0.00.352.623 I llama_new_context_with_model: graph splits = 2
0.00.352.642 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 8192
0.00.352.642 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.365.218 I 
0.00.365.257 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.365.482 I main: prompt 0: 'what is panda?</s></s>hi'
0.00.365.483 I main: number of tokens in prompt = 9
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 23233 -> 'hi'
     2 -> '</s>'


0.00.365.486 I main: prompt 1: 'what is panda?</s></s>it's a bear'
0.00.365.486 I main: number of tokens in prompt = 13
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21153 -> 'it'
    37 -> '''
    87 -> 's'
    69 -> 'a'
 25706 -> 'bear'
     2 -> '</s>'


0.00.365.493 I main: prompt 2: 'what is panda?</s></s>The giant panda (Ailuropoda melanoleuca), sometimes called a panda bear or simply panda, is a bear species endemic to China.'
0.00.365.493 I main: number of tokens in prompt = 40
     0 -> '<s>'
 21381 -> 'what'
 21152 -> 'is'
 49990 -> 'panda'
    61 -> '?'
     2 -> '</s>'
     2 -> '</s>'
 21215 -> 'he'
 28390 -> 'giant'
 49990 -> 'panda'
    38 -> '('
 21163 -> 'il'
 26237 -> 'uro'
 21223 -> 'po'
 23179 -> 'da'
 36906 -> 'melan'
 26791 -> 'ole'
    89 -> 'u'
 21402 -> 'ca'
 21686 -> '),'
 23314 -> 'sometimes'
 22517 -> 'called'
    69 -> 'a'
 49990 -> 'panda'
 25706 -> 'bear'
 21142 -> 'or'
 22810 -> 'simply'
 49990 -> 'panda'
    42 -> ','
 21152 -> 'is'
    69 -> 'a'
 25706 -> 'bear'
 25677 -> 'species'
 28930 -> 'ende'
 22024 -> 'mic'
 21148 -> 'to'
    76 -> 'h'
 22344 -> 'ina'
    44 -> '.'
     2 -> '</s>'


0.00.366.028 I batch_decode: n_tokens = 62, n_seq = 3

rerank score 0:    0.023
rerank score 1:    0.024
rerank score 2:    0.199

0.00.369.669 I llama_perf_context_print:        load time =     341.83 ms
0.00.369.670 I llama_perf_context_print: prompt eval time =       3.63 ms /    62 tokens (    0.06 ms per token, 17065.79 tokens per second)
0.00.369.673 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.369.674 I llama_perf_context_print:       total time =       4.45 ms /    63 tokens
0.00.369.882 I ggml_metal_free: deallocating

real	0m1.065s
user	0m0.341s
sys	0m0.046s
  - rerank score 0 @ 0.023 OK
  - rerank score 1 @ 0.024 OK
  - rerank score 2 @ 0.199 OK
```
### pythia_1_4b

Pythia 1.4B:
- status: 0
- perplexity:
  - f16 @ 10.1498 OK
  - q8_0 @ 10.1362 OK
  - q4_0 @ 11.1740 OK
  - q4_1 @ 10.5507 OK
  - q5_0 @ 10.0972 OK
  - q5_1 @ 10.1971 OK
  - q3_k @ 12.0517 OK
  - q4_k @ 10.1031 OK
  - q5_k @ 10.2433 OK
  - q6_k @ 10.3179 OK
- imatrix:
```
Final estimate: PPL = 10.1498 +/- 3.22650
```
- f16: 
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.097 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.203 I main: llama backend init
0.00.000.208 I main: load the model and apply lora adapter, if any
0.00.064.377 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.075.344 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.075.358 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.075.367 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.075.368 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.075.369 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.075.370 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.075.370 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.075.372 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.075.373 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.075.374 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.075.375 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.075.375 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.075.376 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.075.377 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.075.382 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.075.382 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.075.383 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.082.237 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.084.484 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.091.491 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.091.498 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.091.499 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.091.499 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.091.500 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.091.502 I llama_model_loader: - type  f32:  194 tensors
0.00.091.502 I llama_model_loader: - type  f16:   98 tensors
0.00.125.936 I llm_load_vocab: special tokens cache size = 25
0.00.133.813 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.133.817 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.133.817 I llm_load_print_meta: arch             = gptneox
0.00.133.817 I llm_load_print_meta: vocab type       = BPE
0.00.133.818 I llm_load_print_meta: n_vocab          = 50304
0.00.133.818 I llm_load_print_meta: n_merges         = 50009
0.00.133.818 I llm_load_print_meta: vocab_only       = 0
0.00.133.818 I llm_load_print_meta: n_ctx_train      = 2048
0.00.133.820 I llm_load_print_meta: n_embd           = 2048
0.00.133.820 I llm_load_print_meta: n_layer          = 24
0.00.133.824 I llm_load_print_meta: n_head           = 16
0.00.133.825 I llm_load_print_meta: n_head_kv        = 16
0.00.133.825 I llm_load_print_meta: n_rot            = 32
0.00.133.825 I llm_load_print_meta: n_swa            = 0
0.00.133.826 I llm_load_print_meta: n_embd_head_k    = 128
0.00.133.826 I llm_load_print_meta: n_embd_head_v    = 128
0.00.133.827 I llm_load_print_meta: n_gqa            = 1
0.00.133.827 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.133.828 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.133.829 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.133.829 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.133.829 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.133.829 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.133.830 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.133.831 I llm_load_print_meta: n_ff             = 8192
0.00.133.831 I llm_load_print_meta: n_expert         = 0
0.00.133.831 I llm_load_print_meta: n_expert_used    = 0
0.00.133.832 I llm_load_print_meta: causal attn      = 1
0.00.133.832 I llm_load_print_meta: pooling type     = 0
0.00.133.832 I llm_load_print_meta: rope type        = 2
0.00.133.834 I llm_load_print_meta: rope scaling     = linear
0.00.133.834 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.133.835 I llm_load_print_meta: freq_scale_train = 1
0.00.133.835 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.133.836 I llm_load_print_meta: rope_finetuned   = unknown
0.00.133.837 I llm_load_print_meta: ssm_d_conv       = 0
0.00.133.837 I llm_load_print_meta: ssm_d_inner      = 0
0.00.133.838 I llm_load_print_meta: ssm_d_state      = 0
0.00.133.838 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.133.838 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.133.838 I llm_load_print_meta: model type       = 1.4B
0.00.133.839 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.133.839 I llm_load_print_meta: model params     = 1.41 B
0.00.133.840 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.133.840 I llm_load_print_meta: general.name     = 1.4B
0.00.133.840 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.133.840 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.133.841 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.133.841 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.133.842 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.133.843 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.133.843 I llm_load_print_meta: max token length = 1024
0.00.135.894 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.135.895 I llm_load_tensors: offloading output layer to GPU
0.00.135.895 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.135.914 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.135.915 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.136.899 I llama_new_context_with_model: n_seq_max     = 1
0.00.136.900 I llama_new_context_with_model: n_ctx         = 2048
0.00.136.901 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.136.901 I llama_new_context_with_model: n_batch       = 2048
0.00.136.901 I llama_new_context_with_model: n_ubatch      = 512
0.00.136.901 I llama_new_context_with_model: flash_attn    = 0
0.00.136.902 I llama_new_context_with_model: freq_base     = 10000.0
0.00.136.902 I llama_new_context_with_model: freq_scale    = 1
0.00.136.902 I ggml_metal_init: allocating
0.00.136.906 I ggml_metal_init: found device: Apple M4
0.00.136.908 I ggml_metal_init: picking default device: Apple M4
0.00.137.620 I ggml_metal_init: using embedded metal library
0.00.147.822 I ggml_metal_init: GPU name:   Apple M4
0.00.147.826 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.147.826 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.147.826 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.147.827 I ggml_metal_init: simdgroup reduction   = true
0.00.147.827 I ggml_metal_init: simdgroup matrix mul. = true
0.00.147.827 I ggml_metal_init: has bfloat            = true
0.00.147.827 I ggml_metal_init: use bfloat            = true
0.00.147.828 I ggml_metal_init: hasUnifiedMemory      = true
0.00.147.829 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.172.164 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.191.737 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.191.743 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.191.762 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.192.729 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.192.730 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.192.730 I llama_new_context_with_model: graph nodes  = 967
0.00.192.731 I llama_new_context_with_model: graph splits = 2
0.00.192.755 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.192.901 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.192.902 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.268.719 I main: llama threadpool init, n_threads = 4
0.00.268.751 I 
0.00.268.786 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.268.787 I 
0.00.268.857 I sampler seed: 1234
0.00.268.862 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.268.897 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.268.899 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.268.899 I 
I believe the meaning of life is to do the things we love, with the people we love, in the way we love, and in the time we love.

The last few months have been very hard for me. I don't like feeling guilty. I don't like feeling bad. I don't like feeling like I am a failure,

0.02.125.873 I llama_perf_sampler_print:    sampling time =       1.36 ms /    71 runs   (    0.02 ms per token, 52282.77 tokens per second)
0.02.125.874 I llama_perf_context_print:        load time =     204.33 ms
0.02.125.874 I llama_perf_context_print: prompt eval time =      43.90 ms /     7 tokens (    6.27 ms per token,   159.44 tokens per second)
0.02.125.875 I llama_perf_context_print:        eval time =    1810.03 ms /    63 runs   (   28.73 ms per token,    34.81 tokens per second)
0.02.125.876 I llama_perf_context_print:       total time =    1857.16 ms /    70 tokens
0.02.126.057 I ggml_metal_free: deallocating

real	0m2.463s
user	0m0.144s
sys	0m0.090s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-f16.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.835 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.022.972 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.036.127 I llama_model_loader: loaded meta data with 22 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-f16.gguf (version GGUF V3 (latest))
0.00.036.132 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.036.133 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.036.134 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.036.137 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.036.137 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.036.138 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.036.139 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.036.139 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.036.140 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.036.140 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.036.140 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.036.141 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.036.141 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.036.146 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.036.146 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.036.147 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.044.704 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.046.753 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.053.650 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.053.652 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.053.652 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.053.653 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.053.653 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.053.654 I llama_model_loader: - type  f32:  194 tensors
0.00.053.655 I llama_model_loader: - type  f16:   98 tensors
0.00.082.487 I llm_load_vocab: special tokens cache size = 25
0.00.090.459 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.090.462 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.090.462 I llm_load_print_meta: arch             = gptneox
0.00.090.462 I llm_load_print_meta: vocab type       = BPE
0.00.090.463 I llm_load_print_meta: n_vocab          = 50304
0.00.090.463 I llm_load_print_meta: n_merges         = 50009
0.00.090.463 I llm_load_print_meta: vocab_only       = 0
0.00.090.463 I llm_load_print_meta: n_ctx_train      = 2048
0.00.090.463 I llm_load_print_meta: n_embd           = 2048
0.00.090.463 I llm_load_print_meta: n_layer          = 24
0.00.090.466 I llm_load_print_meta: n_head           = 16
0.00.090.467 I llm_load_print_meta: n_head_kv        = 16
0.00.090.467 I llm_load_print_meta: n_rot            = 32
0.00.090.467 I llm_load_print_meta: n_swa            = 0
0.00.090.467 I llm_load_print_meta: n_embd_head_k    = 128
0.00.090.468 I llm_load_print_meta: n_embd_head_v    = 128
0.00.090.471 I llm_load_print_meta: n_gqa            = 1
0.00.090.471 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.090.474 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.090.474 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.090.475 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.090.475 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.090.475 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.090.475 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.090.476 I llm_load_print_meta: n_ff             = 8192
0.00.090.476 I llm_load_print_meta: n_expert         = 0
0.00.090.476 I llm_load_print_meta: n_expert_used    = 0
0.00.090.476 I llm_load_print_meta: causal attn      = 1
0.00.090.477 I llm_load_print_meta: pooling type     = 0
0.00.090.477 I llm_load_print_meta: rope type        = 2
0.00.090.478 I llm_load_print_meta: rope scaling     = linear
0.00.090.479 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.090.479 I llm_load_print_meta: freq_scale_train = 1
0.00.090.479 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.090.479 I llm_load_print_meta: rope_finetuned   = unknown
0.00.090.479 I llm_load_print_meta: ssm_d_conv       = 0
0.00.090.479 I llm_load_print_meta: ssm_d_inner      = 0
0.00.090.481 I llm_load_print_meta: ssm_d_state      = 0
0.00.090.481 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.090.481 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.090.481 I llm_load_print_meta: model type       = 1.4B
0.00.090.482 I llm_load_print_meta: model ftype      = all F32 (guessed)
0.00.090.482 I llm_load_print_meta: model params     = 1.41 B
0.00.090.483 I llm_load_print_meta: model size       = 2.64 GiB (16.01 BPW) 
0.00.090.483 I llm_load_print_meta: general.name     = 1.4B
0.00.090.483 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.090.483 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.090.483 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.090.484 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.090.485 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.090.485 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.090.485 I llm_load_print_meta: max token length = 1024
0.00.092.961 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.092.961 I llm_load_tensors: offloading output layer to GPU
0.00.092.962 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.092.972 I llm_load_tensors: Metal_Mapped model buffer size =  2502.97 MiB
0.00.092.973 I llm_load_tensors:   CPU_Mapped model buffer size =   196.50 MiB
...............................................................................
0.00.093.889 I llama_new_context_with_model: n_seq_max     = 1
0.00.093.890 I llama_new_context_with_model: n_ctx         = 128
0.00.093.890 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.093.890 I llama_new_context_with_model: n_batch       = 128
0.00.093.890 I llama_new_context_with_model: n_ubatch      = 128
0.00.093.890 I llama_new_context_with_model: flash_attn    = 0
0.00.093.891 I llama_new_context_with_model: freq_base     = 10000.0
0.00.093.891 I llama_new_context_with_model: freq_scale    = 1
0.00.093.891 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.093.892 I ggml_metal_init: allocating
0.00.093.896 I ggml_metal_init: found device: Apple M4
0.00.093.900 I ggml_metal_init: picking default device: Apple M4
0.00.094.493 I ggml_metal_init: using embedded metal library
0.00.096.947 I ggml_metal_init: GPU name:   Apple M4
0.00.096.948 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.096.948 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.096.949 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.096.949 I ggml_metal_init: simdgroup reduction   = true
0.00.096.949 I ggml_metal_init: simdgroup matrix mul. = true
0.00.096.949 I ggml_metal_init: has bfloat            = true
0.00.096.950 I ggml_metal_init: use bfloat            = true
0.00.096.950 I ggml_metal_init: hasUnifiedMemory      = true
0.00.096.951 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.106.272 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.107.521 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.107.524 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.107.540 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.108.459 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.108.460 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.108.460 I llama_new_context_with_model: graph nodes  = 967
0.00.108.460 I llama_new_context_with_model: graph splits = 2
0.00.108.472 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.108.473 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.043.654 I 
0.01.043.706 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.01.043.744 I perplexity: tokenizing the input ..
0.01.057.242 I perplexity: tokenization took 13.493 ms
0.01.057.248 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.176.811 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1498,
0.01.178.115 I Final estimate: PPL = 10.1498 +/- 3.22650

0.01.178.132 I llama_perf_context_print:        load time =    1020.67 ms
0.01.178.134 I llama_perf_context_print: prompt eval time =     119.00 ms /   128 tokens (    0.93 ms per token,  1075.59 tokens per second)
0.01.178.135 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.178.135 I llama_perf_context_print:       total time =     134.48 ms /   129 tokens
0.01.178.486 I ggml_metal_free: deallocating

real	0m1.363s
user	0m0.120s
sys	0m0.203s
```
- q8_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.068 I main: llama backend init
0.00.000.070 I main: load the model and apply lora adapter, if any
0.00.009.807 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.027.257 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.027.263 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.027.264 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.027.265 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.027.267 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.027.267 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.027.268 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.027.269 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.027.269 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.027.269 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.027.270 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.027.270 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.027.270 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.027.271 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.027.273 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.027.273 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.027.273 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.031.067 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.032.200 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.036.325 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.036.327 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.036.327 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.036.327 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.036.328 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.036.328 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.036.329 I llama_model_loader: - type  f32:  194 tensors
0.00.036.329 I llama_model_loader: - type q8_0:   98 tensors
0.00.060.902 I llm_load_vocab: special tokens cache size = 25
0.00.067.312 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.067.316 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.067.316 I llm_load_print_meta: arch             = gptneox
0.00.067.317 I llm_load_print_meta: vocab type       = BPE
0.00.067.317 I llm_load_print_meta: n_vocab          = 50304
0.00.067.317 I llm_load_print_meta: n_merges         = 50009
0.00.067.317 I llm_load_print_meta: vocab_only       = 0
0.00.067.319 I llm_load_print_meta: n_ctx_train      = 2048
0.00.067.319 I llm_load_print_meta: n_embd           = 2048
0.00.067.319 I llm_load_print_meta: n_layer          = 24
0.00.067.324 I llm_load_print_meta: n_head           = 16
0.00.067.325 I llm_load_print_meta: n_head_kv        = 16
0.00.067.325 I llm_load_print_meta: n_rot            = 32
0.00.067.325 I llm_load_print_meta: n_swa            = 0
0.00.067.325 I llm_load_print_meta: n_embd_head_k    = 128
0.00.067.325 I llm_load_print_meta: n_embd_head_v    = 128
0.00.067.326 I llm_load_print_meta: n_gqa            = 1
0.00.067.327 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.067.327 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.067.328 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.067.328 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.067.329 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.067.329 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.067.329 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.067.330 I llm_load_print_meta: n_ff             = 8192
0.00.067.330 I llm_load_print_meta: n_expert         = 0
0.00.067.330 I llm_load_print_meta: n_expert_used    = 0
0.00.067.330 I llm_load_print_meta: causal attn      = 1
0.00.067.330 I llm_load_print_meta: pooling type     = 0
0.00.067.330 I llm_load_print_meta: rope type        = 2
0.00.067.330 I llm_load_print_meta: rope scaling     = linear
0.00.067.331 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.067.331 I llm_load_print_meta: freq_scale_train = 1
0.00.067.331 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.067.332 I llm_load_print_meta: rope_finetuned   = unknown
0.00.067.333 I llm_load_print_meta: ssm_d_conv       = 0
0.00.067.333 I llm_load_print_meta: ssm_d_inner      = 0
0.00.067.333 I llm_load_print_meta: ssm_d_state      = 0
0.00.067.333 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.067.333 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.067.334 I llm_load_print_meta: model type       = 1.4B
0.00.067.334 I llm_load_print_meta: model ftype      = Q8_0
0.00.067.334 I llm_load_print_meta: model params     = 1.41 B
0.00.067.336 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.067.337 I llm_load_print_meta: general.name     = 1.4B
0.00.067.337 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.067.337 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.067.337 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.067.337 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.067.337 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.067.338 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.067.338 I llm_load_print_meta: max token length = 1024
0.00.069.828 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.069.828 I llm_load_tensors: offloading output layer to GPU
0.00.069.829 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.069.839 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.069.840 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.070.831 I llama_new_context_with_model: n_seq_max     = 1
0.00.070.831 I llama_new_context_with_model: n_ctx         = 2048
0.00.070.832 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.070.832 I llama_new_context_with_model: n_batch       = 2048
0.00.070.832 I llama_new_context_with_model: n_ubatch      = 512
0.00.070.832 I llama_new_context_with_model: flash_attn    = 0
0.00.070.833 I llama_new_context_with_model: freq_base     = 10000.0
0.00.070.833 I llama_new_context_with_model: freq_scale    = 1
0.00.070.833 I ggml_metal_init: allocating
0.00.070.837 I ggml_metal_init: found device: Apple M4
0.00.070.839 I ggml_metal_init: picking default device: Apple M4
0.00.071.619 I ggml_metal_init: using embedded metal library
0.00.074.401 I ggml_metal_init: GPU name:   Apple M4
0.00.074.403 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.074.403 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.074.403 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.074.404 I ggml_metal_init: simdgroup reduction   = true
0.00.074.404 I ggml_metal_init: simdgroup matrix mul. = true
0.00.074.404 I ggml_metal_init: has bfloat            = true
0.00.074.404 I ggml_metal_init: use bfloat            = true
0.00.074.404 I ggml_metal_init: hasUnifiedMemory      = true
0.00.074.405 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.085.440 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.112.492 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.112.500 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.112.526 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.113.718 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.113.722 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.113.722 I llama_new_context_with_model: graph nodes  = 967
0.00.113.722 I llama_new_context_with_model: graph splits = 2
0.00.113.742 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.113.884 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.113.884 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.01.278.208 I main: llama threadpool init, n_threads = 4
0.01.278.248 I 
0.01.278.288 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.01.278.291 I 
0.01.278.546 I sampler seed: 1234
0.01.278.550 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.01.278.566 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.01.278.567 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.01.278.567 I 
I believe the meaning of life is to do the best one can with the tools one has, and not to seek to change the tools or to put them in a new configuration.

That is, the best tool in the box will not help the one who is not the best tool in the box.

The best tool in the box,

0.02.367.050 I llama_perf_sampler_print:    sampling time =       1.14 ms /    71 runs   (    0.02 ms per token, 62280.70 tokens per second)
0.02.367.051 I llama_perf_context_print:        load time =    1268.40 ms
0.02.367.052 I llama_perf_context_print: prompt eval time =      42.95 ms /     7 tokens (    6.14 ms per token,   162.99 tokens per second)
0.02.367.052 I llama_perf_context_print:        eval time =    1042.76 ms /    63 runs   (   16.55 ms per token,    60.42 tokens per second)
0.02.367.056 I llama_perf_context_print:       total time =    1088.85 ms /    70 tokens
0.02.367.227 I ggml_metal_free: deallocating

real	0m2.386s
user	0m0.119s
sys	0m0.231s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.099 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.020 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.450 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q8_0.gguf (version GGUF V3 (latest))
0.00.016.456 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.458 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.458 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.458 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.459 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.459 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.462 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.462 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.462 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.463 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.463 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.463 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.464 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.467 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.467 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.467 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.330 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.425 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.365 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.366 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.367 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.367 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.367 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.368 I llama_model_loader: - kv  22:                          general.file_type u32              = 7
0.00.025.368 I llama_model_loader: - type  f32:  194 tensors
0.00.025.369 I llama_model_loader: - type q8_0:   98 tensors
0.00.047.380 I llm_load_vocab: special tokens cache size = 25
0.00.053.412 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.053.416 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.053.417 I llm_load_print_meta: arch             = gptneox
0.00.053.417 I llm_load_print_meta: vocab type       = BPE
0.00.053.417 I llm_load_print_meta: n_vocab          = 50304
0.00.053.417 I llm_load_print_meta: n_merges         = 50009
0.00.053.420 I llm_load_print_meta: vocab_only       = 0
0.00.053.420 I llm_load_print_meta: n_ctx_train      = 2048
0.00.053.420 I llm_load_print_meta: n_embd           = 2048
0.00.053.420 I llm_load_print_meta: n_layer          = 24
0.00.053.424 I llm_load_print_meta: n_head           = 16
0.00.053.425 I llm_load_print_meta: n_head_kv        = 16
0.00.053.426 I llm_load_print_meta: n_rot            = 32
0.00.053.426 I llm_load_print_meta: n_swa            = 0
0.00.053.426 I llm_load_print_meta: n_embd_head_k    = 128
0.00.053.426 I llm_load_print_meta: n_embd_head_v    = 128
0.00.053.427 I llm_load_print_meta: n_gqa            = 1
0.00.053.428 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.053.428 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.053.429 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.053.429 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.053.430 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.053.430 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.053.431 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.053.432 I llm_load_print_meta: n_ff             = 8192
0.00.053.432 I llm_load_print_meta: n_expert         = 0
0.00.053.432 I llm_load_print_meta: n_expert_used    = 0
0.00.053.432 I llm_load_print_meta: causal attn      = 1
0.00.053.432 I llm_load_print_meta: pooling type     = 0
0.00.053.432 I llm_load_print_meta: rope type        = 2
0.00.053.433 I llm_load_print_meta: rope scaling     = linear
0.00.053.433 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.053.433 I llm_load_print_meta: freq_scale_train = 1
0.00.053.435 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.053.436 I llm_load_print_meta: rope_finetuned   = unknown
0.00.053.436 I llm_load_print_meta: ssm_d_conv       = 0
0.00.053.436 I llm_load_print_meta: ssm_d_inner      = 0
0.00.053.437 I llm_load_print_meta: ssm_d_state      = 0
0.00.053.437 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.053.437 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.053.437 I llm_load_print_meta: model type       = 1.4B
0.00.053.441 I llm_load_print_meta: model ftype      = Q8_0
0.00.053.443 I llm_load_print_meta: model params     = 1.41 B
0.00.053.443 I llm_load_print_meta: model size       = 1.40 GiB (8.51 BPW) 
0.00.053.443 I llm_load_print_meta: general.name     = 1.4B
0.00.053.443 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.053.443 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.053.445 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.053.445 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.053.445 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.053.445 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.053.446 I llm_load_print_meta: max token length = 1024
0.00.055.540 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.055.541 I llm_load_tensors: offloading output layer to GPU
0.00.055.542 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.055.552 I llm_load_tensors: Metal_Mapped model buffer size =  1435.25 MiB
0.00.055.553 I llm_load_tensors:   CPU_Mapped model buffer size =   104.39 MiB
...............................................................................
0.00.056.485 I llama_new_context_with_model: n_seq_max     = 1
0.00.056.486 I llama_new_context_with_model: n_ctx         = 128
0.00.056.486 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.056.486 I llama_new_context_with_model: n_batch       = 128
0.00.056.487 I llama_new_context_with_model: n_ubatch      = 128
0.00.056.487 I llama_new_context_with_model: flash_attn    = 0
0.00.056.487 I llama_new_context_with_model: freq_base     = 10000.0
0.00.056.487 I llama_new_context_with_model: freq_scale    = 1
0.00.056.488 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.056.488 I ggml_metal_init: allocating
0.00.056.493 I ggml_metal_init: found device: Apple M4
0.00.056.495 I ggml_metal_init: picking default device: Apple M4
0.00.057.100 I ggml_metal_init: using embedded metal library
0.00.059.532 I ggml_metal_init: GPU name:   Apple M4
0.00.059.534 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.059.534 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.059.534 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.059.535 I ggml_metal_init: simdgroup reduction   = true
0.00.059.535 I ggml_metal_init: simdgroup matrix mul. = true
0.00.059.535 I ggml_metal_init: has bfloat            = true
0.00.059.535 I ggml_metal_init: use bfloat            = true
0.00.059.536 I ggml_metal_init: hasUnifiedMemory      = true
0.00.059.538 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.069.304 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.070.639 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.070.646 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.070.668 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.071.502 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.071.503 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.071.503 I llama_new_context_with_model: graph nodes  = 967
0.00.071.504 I llama_new_context_with_model: graph splits = 2
0.00.071.516 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.071.517 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.914.357 I 
0.00.914.387 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.914.405 I perplexity: tokenizing the input ..
0.00.922.297 I perplexity: tokenization took 7.89 ms
0.00.922.306 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.01.047.160 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.1362,
0.01.048.395 I Final estimate: PPL = 10.1362 +/- 3.22437

0.01.048.419 I llama_perf_context_print:        load time =     904.33 ms
0.01.048.422 I llama_perf_context_print: prompt eval time =     124.62 ms /   128 tokens (    0.97 ms per token,  1027.08 tokens per second)
0.01.048.423 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.01.048.424 I llama_perf_context_print:       total time =     134.06 ms /   129 tokens
0.01.048.824 I ggml_metal_free: deallocating

real	0m1.064s
user	0m0.081s
sys	0m0.145s
```
- q4_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.038 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.069 I main: llama backend init
0.00.000.071 I main: load the model and apply lora adapter, if any
0.00.011.591 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.020.664 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.020.669 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.020.671 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.020.671 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.020.672 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.020.672 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.020.674 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.020.675 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.020.676 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.020.676 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.020.676 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.020.677 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.020.677 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.020.677 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.020.680 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.020.681 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.020.681 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.024.474 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.025.546 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.029.418 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.029.419 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.029.420 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.029.420 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.029.420 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.029.421 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.029.421 I llama_model_loader: - type  f32:  194 tensors
0.00.029.422 I llama_model_loader: - type q4_0:   97 tensors
0.00.029.422 I llama_model_loader: - type q6_K:    1 tensors
0.00.050.749 I llm_load_vocab: special tokens cache size = 25
0.00.056.767 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.056.770 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.056.771 I llm_load_print_meta: arch             = gptneox
0.00.056.771 I llm_load_print_meta: vocab type       = BPE
0.00.056.771 I llm_load_print_meta: n_vocab          = 50304
0.00.056.771 I llm_load_print_meta: n_merges         = 50009
0.00.056.772 I llm_load_print_meta: vocab_only       = 0
0.00.056.772 I llm_load_print_meta: n_ctx_train      = 2048
0.00.056.772 I llm_load_print_meta: n_embd           = 2048
0.00.056.772 I llm_load_print_meta: n_layer          = 24
0.00.056.777 I llm_load_print_meta: n_head           = 16
0.00.056.779 I llm_load_print_meta: n_head_kv        = 16
0.00.056.779 I llm_load_print_meta: n_rot            = 32
0.00.056.779 I llm_load_print_meta: n_swa            = 0
0.00.056.779 I llm_load_print_meta: n_embd_head_k    = 128
0.00.056.779 I llm_load_print_meta: n_embd_head_v    = 128
0.00.056.780 I llm_load_print_meta: n_gqa            = 1
0.00.056.781 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.056.782 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.056.783 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.056.783 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.056.783 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.056.783 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.056.783 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.056.784 I llm_load_print_meta: n_ff             = 8192
0.00.056.784 I llm_load_print_meta: n_expert         = 0
0.00.056.785 I llm_load_print_meta: n_expert_used    = 0
0.00.056.787 I llm_load_print_meta: causal attn      = 1
0.00.056.788 I llm_load_print_meta: pooling type     = 0
0.00.056.789 I llm_load_print_meta: rope type        = 2
0.00.056.789 I llm_load_print_meta: rope scaling     = linear
0.00.056.789 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.056.790 I llm_load_print_meta: freq_scale_train = 1
0.00.056.790 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.056.790 I llm_load_print_meta: rope_finetuned   = unknown
0.00.056.790 I llm_load_print_meta: ssm_d_conv       = 0
0.00.056.790 I llm_load_print_meta: ssm_d_inner      = 0
0.00.056.790 I llm_load_print_meta: ssm_d_state      = 0
0.00.056.791 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.056.795 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.056.796 I llm_load_print_meta: model type       = 1.4B
0.00.056.796 I llm_load_print_meta: model ftype      = Q4_0
0.00.056.796 I llm_load_print_meta: model params     = 1.41 B
0.00.056.797 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.056.798 I llm_load_print_meta: general.name     = 1.4B
0.00.056.798 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.056.798 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.056.798 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.056.798 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.056.798 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.056.799 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.056.799 I llm_load_print_meta: max token length = 1024
0.00.059.057 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.059.058 I llm_load_tensors: offloading output layer to GPU
0.00.059.058 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.059.069 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.059.070 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.060.062 I llama_new_context_with_model: n_seq_max     = 1
0.00.060.063 I llama_new_context_with_model: n_ctx         = 2048
0.00.060.064 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.060.064 I llama_new_context_with_model: n_batch       = 2048
0.00.060.064 I llama_new_context_with_model: n_ubatch      = 512
0.00.060.064 I llama_new_context_with_model: flash_attn    = 0
0.00.060.065 I llama_new_context_with_model: freq_base     = 10000.0
0.00.060.065 I llama_new_context_with_model: freq_scale    = 1
0.00.060.065 I ggml_metal_init: allocating
0.00.060.068 I ggml_metal_init: found device: Apple M4
0.00.060.070 I ggml_metal_init: picking default device: Apple M4
0.00.060.840 I ggml_metal_init: using embedded metal library
0.00.063.380 I ggml_metal_init: GPU name:   Apple M4
0.00.063.382 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.063.382 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.063.382 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.063.383 I ggml_metal_init: simdgroup reduction   = true
0.00.063.383 I ggml_metal_init: simdgroup matrix mul. = true
0.00.063.383 I ggml_metal_init: has bfloat            = true
0.00.063.385 I ggml_metal_init: use bfloat            = true
0.00.063.385 I ggml_metal_init: hasUnifiedMemory      = true
0.00.063.386 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.073.074 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.098.042 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.098.051 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.098.076 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.099.187 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.099.190 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.099.190 I llama_new_context_with_model: graph nodes  = 967
0.00.099.191 I llama_new_context_with_model: graph splits = 2
0.00.099.209 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.099.354 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.099.354 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.725.456 I main: llama threadpool init, n_threads = 4
0.00.725.491 I 
0.00.725.524 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.725.526 I 
0.00.725.759 I sampler seed: 1234
0.00.725.763 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.725.808 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.725.809 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.725.809 I 
I believe the meaning of life is to love. If that is not what you are looking for, I will be happy to explain it to you and you can go back to your life." - Unknown

"I think I am on the way to true happiness. I believe in the importance of family and friends. I believe that when you are truly

0.01.406.244 I llama_perf_sampler_print:    sampling time =       1.42 ms /    71 runs   (    0.02 ms per token, 50070.52 tokens per second)
0.01.406.245 I llama_perf_context_print:        load time =     713.86 ms
0.01.406.246 I llama_perf_context_print: prompt eval time =      45.79 ms /     7 tokens (    6.54 ms per token,   152.88 tokens per second)
0.01.406.247 I llama_perf_context_print:        eval time =     631.88 ms /    63 runs   (   10.03 ms per token,    99.70 tokens per second)
0.01.406.247 I llama_perf_context_print:       total time =     680.79 ms /    70 tokens
0.01.406.465 I ggml_metal_free: deallocating

real	0m1.426s
user	0m0.111s
sys	0m0.158s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.078 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.005 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
0.00.016.009 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.011 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.011 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.011 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.012 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.012 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.013 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.013 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.014 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.014 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.014 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.015 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.017 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.019 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.019 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.019 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.791 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.828 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.682 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.683 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.684 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.684 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.684 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.685 I llama_model_loader: - kv  22:                          general.file_type u32              = 2
0.00.024.685 I llama_model_loader: - type  f32:  194 tensors
0.00.024.686 I llama_model_loader: - type q4_0:   97 tensors
0.00.024.686 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.949 I llm_load_vocab: special tokens cache size = 25
0.00.050.843 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.846 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.846 I llm_load_print_meta: arch             = gptneox
0.00.050.846 I llm_load_print_meta: vocab type       = BPE
0.00.050.847 I llm_load_print_meta: n_vocab          = 50304
0.00.050.847 I llm_load_print_meta: n_merges         = 50009
0.00.050.847 I llm_load_print_meta: vocab_only       = 0
0.00.050.847 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.847 I llm_load_print_meta: n_embd           = 2048
0.00.050.847 I llm_load_print_meta: n_layer          = 24
0.00.050.850 I llm_load_print_meta: n_head           = 16
0.00.050.851 I llm_load_print_meta: n_head_kv        = 16
0.00.050.851 I llm_load_print_meta: n_rot            = 32
0.00.050.851 I llm_load_print_meta: n_swa            = 0
0.00.050.852 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.852 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.853 I llm_load_print_meta: n_gqa            = 1
0.00.050.853 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.854 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.855 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.855 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.855 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.855 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.855 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.856 I llm_load_print_meta: n_ff             = 8192
0.00.050.856 I llm_load_print_meta: n_expert         = 0
0.00.050.856 I llm_load_print_meta: n_expert_used    = 0
0.00.050.857 I llm_load_print_meta: causal attn      = 1
0.00.050.857 I llm_load_print_meta: pooling type     = 0
0.00.050.857 I llm_load_print_meta: rope type        = 2
0.00.050.857 I llm_load_print_meta: rope scaling     = linear
0.00.050.857 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.858 I llm_load_print_meta: freq_scale_train = 1
0.00.050.858 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.858 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.858 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.858 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.858 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.858 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.859 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.859 I llm_load_print_meta: model type       = 1.4B
0.00.050.860 I llm_load_print_meta: model ftype      = Q4_0
0.00.050.860 I llm_load_print_meta: model params     = 1.41 B
0.00.050.861 I llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
0.00.050.863 I llm_load_print_meta: general.name     = 1.4B
0.00.050.863 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.863 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.863 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.863 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.864 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.864 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.864 I llm_load_print_meta: max token length = 1024
0.00.052.829 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.829 I llm_load_tensors: offloading output layer to GPU
0.00.052.830 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.840 I llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
0.00.052.841 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
0.00.053.779 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.780 I llama_new_context_with_model: n_ctx         = 128
0.00.053.780 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.780 I llama_new_context_with_model: n_batch       = 128
0.00.053.780 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.780 I llama_new_context_with_model: flash_attn    = 0
0.00.053.781 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.781 I llama_new_context_with_model: freq_scale    = 1
0.00.053.781 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.782 I ggml_metal_init: allocating
0.00.053.785 I ggml_metal_init: found device: Apple M4
0.00.053.787 I ggml_metal_init: picking default device: Apple M4
0.00.054.354 I ggml_metal_init: using embedded metal library
0.00.056.652 I ggml_metal_init: GPU name:   Apple M4
0.00.056.654 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.654 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.654 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.655 I ggml_metal_init: simdgroup reduction   = true
0.00.056.655 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.655 I ggml_metal_init: has bfloat            = true
0.00.056.655 I ggml_metal_init: use bfloat            = true
0.00.056.655 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.656 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.677 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.067.983 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.985 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.999 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.928 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.929 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.930 I llama_new_context_with_model: graph nodes  = 967
0.00.068.930 I llama_new_context_with_model: graph splits = 2
0.00.068.942 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.068.943 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.614.342 I 
0.00.614.387 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.614.398 I perplexity: tokenizing the input ..
0.00.622.054 I perplexity: tokenization took 7.654 ms
0.00.622.057 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.744.171 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]11.1740,
0.00.745.450 I Final estimate: PPL = 11.1740 +/- 3.48446

0.00.745.463 I llama_perf_context_print:        load time =     604.26 ms
0.00.745.464 I llama_perf_context_print: prompt eval time =     121.89 ms /   128 tokens (    0.95 ms per token,  1050.13 tokens per second)
0.00.745.466 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.745.467 I llama_perf_context_print:       total time =     131.12 ms /   129 tokens
0.00.745.918 I ggml_metal_free: deallocating

real	0m0.760s
user	0m0.077s
sys	0m0.093s
```
- q4_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.033 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.065 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.012.127 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.027.081 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.027.085 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.027.086 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.027.086 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.027.087 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.027.087 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.027.087 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.027.088 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.027.088 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.027.088 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.027.089 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.027.089 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.027.089 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.027.090 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.027.094 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.027.094 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.027.094 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.031.091 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.032.145 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.036.251 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.036.252 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.036.252 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.036.253 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.036.253 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.036.253 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.036.254 I llama_model_loader: - type  f32:  194 tensors
0.00.036.254 I llama_model_loader: - type q4_1:   97 tensors
0.00.036.254 I llama_model_loader: - type q6_K:    1 tensors
0.00.061.828 I llm_load_vocab: special tokens cache size = 25
0.00.070.318 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.070.321 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.070.321 I llm_load_print_meta: arch             = gptneox
0.00.070.322 I llm_load_print_meta: vocab type       = BPE
0.00.070.322 I llm_load_print_meta: n_vocab          = 50304
0.00.070.322 I llm_load_print_meta: n_merges         = 50009
0.00.070.322 I llm_load_print_meta: vocab_only       = 0
0.00.070.322 I llm_load_print_meta: n_ctx_train      = 2048
0.00.070.323 I llm_load_print_meta: n_embd           = 2048
0.00.070.323 I llm_load_print_meta: n_layer          = 24
0.00.070.326 I llm_load_print_meta: n_head           = 16
0.00.070.327 I llm_load_print_meta: n_head_kv        = 16
0.00.070.330 I llm_load_print_meta: n_rot            = 32
0.00.070.330 I llm_load_print_meta: n_swa            = 0
0.00.070.330 I llm_load_print_meta: n_embd_head_k    = 128
0.00.070.330 I llm_load_print_meta: n_embd_head_v    = 128
0.00.070.331 I llm_load_print_meta: n_gqa            = 1
0.00.070.332 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.070.333 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.070.334 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.070.334 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.070.334 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.070.336 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.070.336 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.070.337 I llm_load_print_meta: n_ff             = 8192
0.00.070.337 I llm_load_print_meta: n_expert         = 0
0.00.070.337 I llm_load_print_meta: n_expert_used    = 0
0.00.070.339 I llm_load_print_meta: causal attn      = 1
0.00.070.339 I llm_load_print_meta: pooling type     = 0
0.00.070.339 I llm_load_print_meta: rope type        = 2
0.00.070.339 I llm_load_print_meta: rope scaling     = linear
0.00.070.340 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.070.340 I llm_load_print_meta: freq_scale_train = 1
0.00.070.340 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.070.341 I llm_load_print_meta: rope_finetuned   = unknown
0.00.070.342 I llm_load_print_meta: ssm_d_conv       = 0
0.00.070.342 I llm_load_print_meta: ssm_d_inner      = 0
0.00.070.342 I llm_load_print_meta: ssm_d_state      = 0
0.00.070.342 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.070.343 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.070.344 I llm_load_print_meta: model type       = 1.4B
0.00.070.345 I llm_load_print_meta: model ftype      = Q4_1
0.00.070.345 I llm_load_print_meta: model params     = 1.41 B
0.00.070.346 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.070.346 I llm_load_print_meta: general.name     = 1.4B
0.00.070.351 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.070.352 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.070.352 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.070.352 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.070.354 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.070.354 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.070.354 I llm_load_print_meta: max token length = 1024
0.00.072.894 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.072.895 I llm_load_tensors: offloading output layer to GPU
0.00.072.896 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.072.907 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.072.908 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.074.146 I llama_new_context_with_model: n_seq_max     = 1
0.00.074.148 I llama_new_context_with_model: n_ctx         = 2048
0.00.074.148 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.074.148 I llama_new_context_with_model: n_batch       = 2048
0.00.074.148 I llama_new_context_with_model: n_ubatch      = 512
0.00.074.149 I llama_new_context_with_model: flash_attn    = 0
0.00.074.149 I llama_new_context_with_model: freq_base     = 10000.0
0.00.074.150 I llama_new_context_with_model: freq_scale    = 1
0.00.074.150 I ggml_metal_init: allocating
0.00.074.159 I ggml_metal_init: found device: Apple M4
0.00.074.162 I ggml_metal_init: picking default device: Apple M4
0.00.074.925 I ggml_metal_init: using embedded metal library
0.00.078.197 I ggml_metal_init: GPU name:   Apple M4
0.00.078.199 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.078.200 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.078.200 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.078.200 I ggml_metal_init: simdgroup reduction   = true
0.00.078.200 I ggml_metal_init: simdgroup matrix mul. = true
0.00.078.201 I ggml_metal_init: has bfloat            = true
0.00.078.202 I ggml_metal_init: use bfloat            = true
0.00.078.203 I ggml_metal_init: hasUnifiedMemory      = true
0.00.078.203 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.090.696 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.112.981 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.112.987 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.113.015 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.114.060 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.114.062 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.114.062 I llama_new_context_with_model: graph nodes  = 967
0.00.114.063 I llama_new_context_with_model: graph splits = 2
0.00.114.079 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.114.220 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.114.221 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.866.821 I main: llama threadpool init, n_threads = 4
0.00.866.862 I 
0.00.866.892 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.866.893 I 
0.00.867.123 I sampler seed: 1234
0.00.867.127 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.867.142 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.867.143 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.867.143 I 
I believe the meaning of life is to give
<em>a<br>
<em>s<br>
<em>n<br>
<em>a<br>
<em>c<br>
<em>i<br>
<em>s<br>
<em>e<

0.01.600.345 I llama_perf_sampler_print:    sampling time =       1.06 ms /    71 runs   (    0.01 ms per token, 66981.13 tokens per second)
0.01.600.345 I llama_perf_context_print:        load time =     854.69 ms
0.01.600.346 I llama_perf_context_print: prompt eval time =      45.14 ms /     7 tokens (    6.45 ms per token,   155.07 tokens per second)
0.01.600.347 I llama_perf_context_print:        eval time =     685.27 ms /    63 runs   (   10.88 ms per token,    91.93 tokens per second)
0.01.600.347 I llama_perf_context_print:       total time =     733.53 ms /    70 tokens
0.01.600.498 I ggml_metal_free: deallocating

real	0m1.621s
user	0m0.123s
sys	0m0.156s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.095 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.615 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.201 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_1.gguf (version GGUF V3 (latest))
0.00.014.205 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.211 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.211 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.212 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.212 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.212 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.214 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.214 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.214 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.216 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.217 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.217 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.217 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.219 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.219 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.219 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.017.986 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.021 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.022.856 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.022.857 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.022.858 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.022.858 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.022.858 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.022.858 I llama_model_loader: - kv  22:                          general.file_type u32              = 3
0.00.022.859 I llama_model_loader: - type  f32:  194 tensors
0.00.022.859 I llama_model_loader: - type q4_1:   97 tensors
0.00.022.860 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.112 I llm_load_vocab: special tokens cache size = 25
0.00.049.138 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.140 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.141 I llm_load_print_meta: arch             = gptneox
0.00.049.141 I llm_load_print_meta: vocab type       = BPE
0.00.049.141 I llm_load_print_meta: n_vocab          = 50304
0.00.049.142 I llm_load_print_meta: n_merges         = 50009
0.00.049.142 I llm_load_print_meta: vocab_only       = 0
0.00.049.142 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.142 I llm_load_print_meta: n_embd           = 2048
0.00.049.142 I llm_load_print_meta: n_layer          = 24
0.00.049.145 I llm_load_print_meta: n_head           = 16
0.00.049.145 I llm_load_print_meta: n_head_kv        = 16
0.00.049.146 I llm_load_print_meta: n_rot            = 32
0.00.049.146 I llm_load_print_meta: n_swa            = 0
0.00.049.146 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.146 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.147 I llm_load_print_meta: n_gqa            = 1
0.00.049.148 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.148 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.149 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.149 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.149 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.150 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.150 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.151 I llm_load_print_meta: n_ff             = 8192
0.00.049.151 I llm_load_print_meta: n_expert         = 0
0.00.049.152 I llm_load_print_meta: n_expert_used    = 0
0.00.049.152 I llm_load_print_meta: causal attn      = 1
0.00.049.152 I llm_load_print_meta: pooling type     = 0
0.00.049.152 I llm_load_print_meta: rope type        = 2
0.00.049.152 I llm_load_print_meta: rope scaling     = linear
0.00.049.154 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.154 I llm_load_print_meta: freq_scale_train = 1
0.00.049.155 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.155 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.155 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.155 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.155 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.155 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.156 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.156 I llm_load_print_meta: model type       = 1.4B
0.00.049.156 I llm_load_print_meta: model ftype      = Q4_1
0.00.049.157 I llm_load_print_meta: model params     = 1.41 B
0.00.049.161 I llm_load_print_meta: model size       = 864.46 MiB (5.13 BPW) 
0.00.049.161 I llm_load_print_meta: general.name     = 1.4B
0.00.049.161 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.162 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.162 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.162 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.162 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.163 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.163 I llm_load_print_meta: max token length = 1024
0.00.051.156 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.156 I llm_load_tensors: offloading output layer to GPU
0.00.051.157 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.167 I llm_load_tensors: Metal_Mapped model buffer size =   864.47 MiB
0.00.051.168 I llm_load_tensors:   CPU_Mapped model buffer size =    61.41 MiB
............................................................................
0.00.052.084 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.085 I llama_new_context_with_model: n_ctx         = 128
0.00.052.085 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.086 I llama_new_context_with_model: n_batch       = 128
0.00.052.086 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.086 I llama_new_context_with_model: flash_attn    = 0
0.00.052.086 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.087 I llama_new_context_with_model: freq_scale    = 1
0.00.052.087 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.088 I ggml_metal_init: allocating
0.00.052.094 I ggml_metal_init: found device: Apple M4
0.00.052.097 I ggml_metal_init: picking default device: Apple M4
0.00.052.666 I ggml_metal_init: using embedded metal library
0.00.055.003 I ggml_metal_init: GPU name:   Apple M4
0.00.055.004 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.004 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.005 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.005 I ggml_metal_init: simdgroup reduction   = true
0.00.055.005 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.005 I ggml_metal_init: has bfloat            = true
0.00.055.005 I ggml_metal_init: use bfloat            = true
0.00.055.006 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.007 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.064.634 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.065.867 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.065.871 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.065.885 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.066.775 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.066.776 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.066.776 I llama_new_context_with_model: graph nodes  = 967
0.00.066.776 I llama_new_context_with_model: graph splits = 2
0.00.066.784 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.066.785 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.665.715 I 
0.00.665.758 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.665.771 I perplexity: tokenizing the input ..
0.00.673.785 I perplexity: tokenization took 8.012 ms
0.00.673.788 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.796.444 I perplexity: 0.12 seconds per pass - ETA 0.00 minutes
[1]10.5507,
0.00.797.614 I Final estimate: PPL = 10.5507 +/- 3.34263

0.00.797.632 I llama_perf_context_print:        load time =     657.09 ms
0.00.797.633 I llama_perf_context_print: prompt eval time =     122.43 ms /   128 tokens (    0.96 ms per token,  1045.50 tokens per second)
0.00.797.634 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.797.634 I llama_perf_context_print:       total time =     131.92 ms /   129 tokens
0.00.798.168 I ggml_metal_free: deallocating

real	0m0.811s
user	0m0.078s
sys	0m0.105s
```
- q5_0:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.033 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.062 I main: llama backend init
0.00.000.064 I main: load the model and apply lora adapter, if any
0.00.009.191 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.696 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.015.700 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.702 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.702 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.702 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.707 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.707 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.710 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.710 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.711 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.711 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.711 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.712 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.716 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.718 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.719 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.719 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.392 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.367 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.002 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.003 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.004 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.004 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.004 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.005 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.024.005 I llama_model_loader: - type  f32:  194 tensors
0.00.024.005 I llama_model_loader: - type q5_0:   97 tensors
0.00.024.006 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.453 I llm_load_vocab: special tokens cache size = 25
0.00.050.496 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.499 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.499 I llm_load_print_meta: arch             = gptneox
0.00.050.500 I llm_load_print_meta: vocab type       = BPE
0.00.050.500 I llm_load_print_meta: n_vocab          = 50304
0.00.050.500 I llm_load_print_meta: n_merges         = 50009
0.00.050.500 I llm_load_print_meta: vocab_only       = 0
0.00.050.500 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.501 I llm_load_print_meta: n_embd           = 2048
0.00.050.501 I llm_load_print_meta: n_layer          = 24
0.00.050.503 I llm_load_print_meta: n_head           = 16
0.00.050.504 I llm_load_print_meta: n_head_kv        = 16
0.00.050.504 I llm_load_print_meta: n_rot            = 32
0.00.050.505 I llm_load_print_meta: n_swa            = 0
0.00.050.505 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.505 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.506 I llm_load_print_meta: n_gqa            = 1
0.00.050.507 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.508 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.508 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.509 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.509 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.509 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.509 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.510 I llm_load_print_meta: n_ff             = 8192
0.00.050.510 I llm_load_print_meta: n_expert         = 0
0.00.050.510 I llm_load_print_meta: n_expert_used    = 0
0.00.050.512 I llm_load_print_meta: causal attn      = 1
0.00.050.514 I llm_load_print_meta: pooling type     = 0
0.00.050.514 I llm_load_print_meta: rope type        = 2
0.00.050.514 I llm_load_print_meta: rope scaling     = linear
0.00.050.514 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.515 I llm_load_print_meta: freq_scale_train = 1
0.00.050.515 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.515 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.515 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.515 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.515 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.516 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.516 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.516 I llm_load_print_meta: model type       = 1.4B
0.00.050.516 I llm_load_print_meta: model ftype      = Q5_0
0.00.050.517 I llm_load_print_meta: model params     = 1.41 B
0.00.050.517 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.050.517 I llm_load_print_meta: general.name     = 1.4B
0.00.050.518 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.518 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.522 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.522 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.527 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.527 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.528 I llm_load_print_meta: max token length = 1024
0.00.052.465 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.465 I llm_load_tensors: offloading output layer to GPU
0.00.052.466 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.476 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.052.477 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.053.344 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.345 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.345 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.345 I llama_new_context_with_model: n_batch       = 2048
0.00.053.345 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.346 I llama_new_context_with_model: flash_attn    = 0
0.00.053.346 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.346 I llama_new_context_with_model: freq_scale    = 1
0.00.053.347 I ggml_metal_init: allocating
0.00.053.351 I ggml_metal_init: found device: Apple M4
0.00.053.353 I ggml_metal_init: picking default device: Apple M4
0.00.053.957 I ggml_metal_init: using embedded metal library
0.00.056.296 I ggml_metal_init: GPU name:   Apple M4
0.00.056.298 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.298 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.298 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.299 I ggml_metal_init: simdgroup reduction   = true
0.00.056.299 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.299 I ggml_metal_init: has bfloat            = true
0.00.056.299 I ggml_metal_init: use bfloat            = true
0.00.056.299 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.301 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.937 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.085.136 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.142 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.164 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.194 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.196 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.196 I llama_new_context_with_model: graph nodes  = 967
0.00.086.196 I llama_new_context_with_model: graph splits = 2
0.00.086.213 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.086.366 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.086.367 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.772.904 I main: llama threadpool init, n_threads = 4
0.00.772.940 I 
0.00.772.966 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.772.967 I 
0.00.773.210 I sampler seed: 1234
0.00.773.214 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.773.229 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.773.231 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.773.231 I 
I believe the meaning of life is to do what is best for your self, and to be happy, and to enjoy the present moment, and the future is a gift that you will never regret.

I believe the meaning of life is to enjoy every moment of your life, and to be happy, and to enjoy the present moment, and the

0.01.566.106 I llama_perf_sampler_print:    sampling time =       1.24 ms /    71 runs   (    0.02 ms per token, 57350.57 tokens per second)
0.01.566.107 I llama_perf_context_print:        load time =     763.71 ms
0.01.566.108 I llama_perf_context_print: prompt eval time =      47.11 ms /     7 tokens (    6.73 ms per token,   148.58 tokens per second)
0.01.566.108 I llama_perf_context_print:        eval time =     742.70 ms /    63 runs   (   11.79 ms per token,    84.83 tokens per second)
0.01.566.109 I llama_perf_context_print:       total time =     793.21 ms /    70 tokens
0.01.566.317 I ggml_metal_free: deallocating

real	0m1.584s
user	0m0.109s
sys	0m0.170s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.084 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.277 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.944 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_0.gguf (version GGUF V3 (latest))
0.00.014.948 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.950 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.951 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.951 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.951 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.952 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.953 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.953 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.953 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.954 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.954 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.954 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.955 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.956 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.956 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.957 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.721 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.762 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.441 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.442 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.442 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.442 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.443 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.443 I llama_model_loader: - kv  22:                          general.file_type u32              = 8
0.00.023.443 I llama_model_loader: - type  f32:  194 tensors
0.00.023.444 I llama_model_loader: - type q5_0:   97 tensors
0.00.023.444 I llama_model_loader: - type q6_K:    1 tensors
0.00.043.701 I llm_load_vocab: special tokens cache size = 25
0.00.050.991 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.994 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.994 I llm_load_print_meta: arch             = gptneox
0.00.050.995 I llm_load_print_meta: vocab type       = BPE
0.00.050.995 I llm_load_print_meta: n_vocab          = 50304
0.00.050.995 I llm_load_print_meta: n_merges         = 50009
0.00.050.995 I llm_load_print_meta: vocab_only       = 0
0.00.050.995 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.995 I llm_load_print_meta: n_embd           = 2048
0.00.050.996 I llm_load_print_meta: n_layer          = 24
0.00.050.998 I llm_load_print_meta: n_head           = 16
0.00.050.999 I llm_load_print_meta: n_head_kv        = 16
0.00.050.999 I llm_load_print_meta: n_rot            = 32
0.00.050.999 I llm_load_print_meta: n_swa            = 0
0.00.050.999 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.000 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.000 I llm_load_print_meta: n_gqa            = 1
0.00.051.001 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.002 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.003 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.003 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.003 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.003 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.003 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.004 I llm_load_print_meta: n_ff             = 8192
0.00.051.004 I llm_load_print_meta: n_expert         = 0
0.00.051.004 I llm_load_print_meta: n_expert_used    = 0
0.00.051.005 I llm_load_print_meta: causal attn      = 1
0.00.051.005 I llm_load_print_meta: pooling type     = 0
0.00.051.005 I llm_load_print_meta: rope type        = 2
0.00.051.005 I llm_load_print_meta: rope scaling     = linear
0.00.051.008 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.008 I llm_load_print_meta: freq_scale_train = 1
0.00.051.008 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.009 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.009 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.009 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.009 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.009 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.009 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.009 I llm_load_print_meta: model type       = 1.4B
0.00.051.010 I llm_load_print_meta: model ftype      = Q5_0
0.00.051.010 I llm_load_print_meta: model params     = 1.41 B
0.00.051.011 I llm_load_print_meta: model size       = 942.60 MiB (5.59 BPW) 
0.00.051.011 I llm_load_print_meta: general.name     = 1.4B
0.00.051.011 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.012 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.012 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.012 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.012 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.013 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.013 I llm_load_print_meta: max token length = 1024
0.00.052.992 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.993 I llm_load_tensors: offloading output layer to GPU
0.00.052.993 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.003 I llm_load_tensors: Metal_Mapped model buffer size =   942.61 MiB
0.00.053.004 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
..........................................................................
0.00.053.909 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.910 I llama_new_context_with_model: n_ctx         = 128
0.00.053.910 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.910 I llama_new_context_with_model: n_batch       = 128
0.00.053.910 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.910 I llama_new_context_with_model: flash_attn    = 0
0.00.053.911 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.911 I llama_new_context_with_model: freq_scale    = 1
0.00.053.911 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.912 I ggml_metal_init: allocating
0.00.053.915 I ggml_metal_init: found device: Apple M4
0.00.053.917 I ggml_metal_init: picking default device: Apple M4
0.00.054.469 I ggml_metal_init: using embedded metal library
0.00.056.777 I ggml_metal_init: GPU name:   Apple M4
0.00.056.779 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.779 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.780 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.780 I ggml_metal_init: simdgroup reduction   = true
0.00.056.780 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.780 I ggml_metal_init: has bfloat            = true
0.00.056.780 I ggml_metal_init: use bfloat            = true
0.00.056.781 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.781 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.345 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.067.636 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.638 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.654 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.564 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.564 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.565 I llama_new_context_with_model: graph nodes  = 967
0.00.068.565 I llama_new_context_with_model: graph splits = 2
0.00.068.577 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.068.578 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.717.040 I 
0.00.717.078 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.717.090 I perplexity: tokenizing the input ..
0.00.725.403 I perplexity: tokenization took 8.311 ms
0.00.725.406 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.859.745 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.0972,
0.00.860.911 I Final estimate: PPL = 10.0972 +/- 3.20136

0.00.860.926 I llama_perf_context_print:        load time =     707.76 ms
0.00.860.927 I llama_perf_context_print: prompt eval time =     134.11 ms /   128 tokens (    1.05 ms per token,   954.44 tokens per second)
0.00.860.928 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.860.928 I llama_perf_context_print:       total time =     143.89 ms /   129 tokens
0.00.861.426 I ggml_metal_free: deallocating

real	0m0.878s
user	0m0.079s
sys	0m0.127s
```
- q5_1:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.035 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.064 I main: llama backend init
0.00.000.067 I main: load the model and apply lora adapter, if any
0.00.008.786 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.573 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.015.577 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.582 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.583 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.583 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.584 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.584 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.584 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.585 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.585 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.586 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.586 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.586 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.587 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.588 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.588 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.589 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.406 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.460 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.237 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.238 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.239 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.239 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.239 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.240 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.024.240 I llama_model_loader: - type  f32:  194 tensors
0.00.024.240 I llama_model_loader: - type q5_1:   97 tensors
0.00.024.241 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.601 I llm_load_vocab: special tokens cache size = 25
0.00.050.764 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.767 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.767 I llm_load_print_meta: arch             = gptneox
0.00.050.768 I llm_load_print_meta: vocab type       = BPE
0.00.050.768 I llm_load_print_meta: n_vocab          = 50304
0.00.050.768 I llm_load_print_meta: n_merges         = 50009
0.00.050.768 I llm_load_print_meta: vocab_only       = 0
0.00.050.768 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.768 I llm_load_print_meta: n_embd           = 2048
0.00.050.769 I llm_load_print_meta: n_layer          = 24
0.00.050.771 I llm_load_print_meta: n_head           = 16
0.00.050.772 I llm_load_print_meta: n_head_kv        = 16
0.00.050.772 I llm_load_print_meta: n_rot            = 32
0.00.050.772 I llm_load_print_meta: n_swa            = 0
0.00.050.773 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.773 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.774 I llm_load_print_meta: n_gqa            = 1
0.00.050.774 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.775 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.776 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.776 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.776 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.777 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.777 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.777 I llm_load_print_meta: n_ff             = 8192
0.00.050.778 I llm_load_print_meta: n_expert         = 0
0.00.050.778 I llm_load_print_meta: n_expert_used    = 0
0.00.050.778 I llm_load_print_meta: causal attn      = 1
0.00.050.778 I llm_load_print_meta: pooling type     = 0
0.00.050.779 I llm_load_print_meta: rope type        = 2
0.00.050.779 I llm_load_print_meta: rope scaling     = linear
0.00.050.782 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.782 I llm_load_print_meta: freq_scale_train = 1
0.00.050.782 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.782 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.783 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.783 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.783 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.783 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.783 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.783 I llm_load_print_meta: model type       = 1.4B
0.00.050.784 I llm_load_print_meta: model ftype      = Q5_1
0.00.050.784 I llm_load_print_meta: model params     = 1.41 B
0.00.050.785 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.050.785 I llm_load_print_meta: general.name     = 1.4B
0.00.050.785 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.785 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.786 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.786 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.790 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.790 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.790 I llm_load_print_meta: max token length = 1024
0.00.052.822 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.822 I llm_load_tensors: offloading output layer to GPU
0.00.052.822 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.833 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.052.834 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.053.725 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.725 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.725 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.726 I llama_new_context_with_model: n_batch       = 2048
0.00.053.726 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.726 I llama_new_context_with_model: flash_attn    = 0
0.00.053.726 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.727 I llama_new_context_with_model: freq_scale    = 1
0.00.053.727 I ggml_metal_init: allocating
0.00.053.730 I ggml_metal_init: found device: Apple M4
0.00.053.732 I ggml_metal_init: picking default device: Apple M4
0.00.054.317 I ggml_metal_init: using embedded metal library
0.00.056.629 I ggml_metal_init: GPU name:   Apple M4
0.00.056.631 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.631 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.631 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.632 I ggml_metal_init: simdgroup reduction   = true
0.00.056.632 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.632 I ggml_metal_init: has bfloat            = true
0.00.056.632 I ggml_metal_init: use bfloat            = true
0.00.056.633 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.633 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.325 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.085.117 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.126 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.151 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.102 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.103 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.104 I llama_new_context_with_model: graph nodes  = 967
0.00.086.104 I llama_new_context_with_model: graph splits = 2
0.00.086.119 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.086.261 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.086.261 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.696.972 I main: llama threadpool init, n_threads = 4
0.00.697.008 I 
0.00.697.037 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.697.037 I 
0.00.697.259 I sampler seed: 1234
0.00.697.264 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.697.279 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.697.279 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.697.279 I 
I believe the meaning of life is to give all things an equal chance, and to be content with one's lot in life.

When one is in a good situation, one can think of no better way to express it than through music, art or literature.

If one's life is not good, one can be sure that one is

0.01.535.400 I llama_perf_sampler_print:    sampling time =       1.23 ms /    71 runs   (    0.02 ms per token, 57911.91 tokens per second)
0.01.535.400 I llama_perf_context_print:        load time =     688.18 ms
0.01.535.401 I llama_perf_context_print: prompt eval time =      42.25 ms /     7 tokens (    6.04 ms per token,   165.68 tokens per second)
0.01.535.401 I llama_perf_context_print:        eval time =     792.84 ms /    63 runs   (   12.58 ms per token,    79.46 tokens per second)
0.01.535.402 I llama_perf_context_print:       total time =     838.43 ms /    70 tokens
0.01.535.565 I ggml_metal_free: deallocating

real	0m1.552s
user	0m0.110s
sys	0m0.154s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.085 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.403 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.843 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_1.gguf (version GGUF V3 (latest))
0.00.016.847 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.849 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.853 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.854 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.854 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.855 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.855 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.856 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.856 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.857 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.857 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.857 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.858 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.859 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.860 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.860 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.519 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.539 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.290 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.292 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.292 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.292 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.293 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.293 I llama_model_loader: - kv  22:                          general.file_type u32              = 9
0.00.025.293 I llama_model_loader: - type  f32:  194 tensors
0.00.025.294 I llama_model_loader: - type q5_1:   97 tensors
0.00.025.294 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.497 I llm_load_vocab: special tokens cache size = 25
0.00.051.459 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.462 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.462 I llm_load_print_meta: arch             = gptneox
0.00.051.463 I llm_load_print_meta: vocab type       = BPE
0.00.051.463 I llm_load_print_meta: n_vocab          = 50304
0.00.051.463 I llm_load_print_meta: n_merges         = 50009
0.00.051.463 I llm_load_print_meta: vocab_only       = 0
0.00.051.463 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.464 I llm_load_print_meta: n_embd           = 2048
0.00.051.464 I llm_load_print_meta: n_layer          = 24
0.00.051.466 I llm_load_print_meta: n_head           = 16
0.00.051.467 I llm_load_print_meta: n_head_kv        = 16
0.00.051.467 I llm_load_print_meta: n_rot            = 32
0.00.051.467 I llm_load_print_meta: n_swa            = 0
0.00.051.468 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.468 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.469 I llm_load_print_meta: n_gqa            = 1
0.00.051.469 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.470 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.471 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.471 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.471 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.471 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.472 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.472 I llm_load_print_meta: n_ff             = 8192
0.00.051.472 I llm_load_print_meta: n_expert         = 0
0.00.051.473 I llm_load_print_meta: n_expert_used    = 0
0.00.051.475 I llm_load_print_meta: causal attn      = 1
0.00.051.476 I llm_load_print_meta: pooling type     = 0
0.00.051.476 I llm_load_print_meta: rope type        = 2
0.00.051.476 I llm_load_print_meta: rope scaling     = linear
0.00.051.476 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.477 I llm_load_print_meta: freq_scale_train = 1
0.00.051.477 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.477 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.477 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.477 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.477 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.477 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.478 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.478 I llm_load_print_meta: model type       = 1.4B
0.00.051.478 I llm_load_print_meta: model ftype      = Q5_1
0.00.051.479 I llm_load_print_meta: model params     = 1.41 B
0.00.051.479 I llm_load_print_meta: model size       = 1020.74 MiB (6.05 BPW) 
0.00.051.479 I llm_load_print_meta: general.name     = 1.4B
0.00.051.480 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.480 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.484 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.484 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.484 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.485 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.485 I llm_load_print_meta: max token length = 1024
0.00.053.517 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.518 I llm_load_tensors: offloading output layer to GPU
0.00.053.518 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.529 I llm_load_tensors: Metal_Mapped model buffer size =  1020.75 MiB
0.00.053.530 I llm_load_tensors:   CPU_Mapped model buffer size =    73.69 MiB
..............................................................................
0.00.054.429 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.430 I llama_new_context_with_model: n_ctx         = 128
0.00.054.431 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.431 I llama_new_context_with_model: n_batch       = 128
0.00.054.431 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.431 I llama_new_context_with_model: flash_attn    = 0
0.00.054.432 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.432 I llama_new_context_with_model: freq_scale    = 1
0.00.054.432 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.433 I ggml_metal_init: allocating
0.00.054.436 I ggml_metal_init: found device: Apple M4
0.00.054.438 I ggml_metal_init: picking default device: Apple M4
0.00.054.985 I ggml_metal_init: using embedded metal library
0.00.057.338 I ggml_metal_init: GPU name:   Apple M4
0.00.057.339 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.339 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.340 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.340 I ggml_metal_init: simdgroup reduction   = true
0.00.057.340 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.340 I ggml_metal_init: has bfloat            = true
0.00.057.340 I ggml_metal_init: use bfloat            = true
0.00.057.341 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.341 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.946 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.068.339 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.068.341 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.068.358 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.069.202 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.069.203 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.069.203 I llama_new_context_with_model: graph nodes  = 967
0.00.069.203 I llama_new_context_with_model: graph splits = 2
0.00.069.216 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.069.216 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.644.229 I 
0.00.644.265 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.644.276 I perplexity: tokenizing the input ..
0.00.652.055 I perplexity: tokenization took 7.777 ms
0.00.652.059 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.787.337 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.1971,
0.00.788.602 I Final estimate: PPL = 10.1971 +/- 3.18866

0.00.788.622 I llama_perf_context_print:        load time =     634.82 ms
0.00.788.623 I llama_perf_context_print: prompt eval time =     135.03 ms /   128 tokens (    1.05 ms per token,   947.96 tokens per second)
0.00.788.624 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.788.624 I llama_perf_context_print:       total time =     144.39 ms /   129 tokens
0.00.789.034 I ggml_metal_free: deallocating

real	0m0.802s
user	0m0.077s
sys	0m0.109s
```
- q2_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.067 I main: llama backend init
0.00.000.069 I main: load the model and apply lora adapter, if any
0.00.010.032 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.632 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.015.638 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.639 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.640 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.640 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.640 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.641 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.642 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.642 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.643 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.643 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.643 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.644 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.644 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.646 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.646 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.646 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.475 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.501 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.299 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.300 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.300 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.301 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.301 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.301 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.024.302 I llama_model_loader: - type  f32:  194 tensors
0.00.024.302 I llama_model_loader: - type q2_K:   49 tensors
0.00.024.302 I llama_model_loader: - type q3_K:   48 tensors
0.00.024.303 I llama_model_loader: - type q6_K:    1 tensors
0.00.044.727 I llm_load_vocab: special tokens cache size = 25
0.00.050.786 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.790 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.790 I llm_load_print_meta: arch             = gptneox
0.00.050.791 I llm_load_print_meta: vocab type       = BPE
0.00.050.791 I llm_load_print_meta: n_vocab          = 50304
0.00.050.791 I llm_load_print_meta: n_merges         = 50009
0.00.050.796 I llm_load_print_meta: vocab_only       = 0
0.00.050.796 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.797 I llm_load_print_meta: n_embd           = 2048
0.00.050.797 I llm_load_print_meta: n_layer          = 24
0.00.050.799 I llm_load_print_meta: n_head           = 16
0.00.050.800 I llm_load_print_meta: n_head_kv        = 16
0.00.050.800 I llm_load_print_meta: n_rot            = 32
0.00.050.800 I llm_load_print_meta: n_swa            = 0
0.00.050.801 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.801 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.802 I llm_load_print_meta: n_gqa            = 1
0.00.050.803 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.804 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.804 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.805 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.805 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.805 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.805 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.807 I llm_load_print_meta: n_ff             = 8192
0.00.050.808 I llm_load_print_meta: n_expert         = 0
0.00.050.808 I llm_load_print_meta: n_expert_used    = 0
0.00.050.808 I llm_load_print_meta: causal attn      = 1
0.00.050.808 I llm_load_print_meta: pooling type     = 0
0.00.050.808 I llm_load_print_meta: rope type        = 2
0.00.050.808 I llm_load_print_meta: rope scaling     = linear
0.00.050.809 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.809 I llm_load_print_meta: freq_scale_train = 1
0.00.050.809 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.810 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.810 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.810 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.810 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.810 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.810 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.813 I llm_load_print_meta: model type       = 1.4B
0.00.050.813 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.050.814 I llm_load_print_meta: model params     = 1.41 B
0.00.050.814 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.050.814 I llm_load_print_meta: general.name     = 1.4B
0.00.050.815 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.815 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.815 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.815 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.815 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.816 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.816 I llm_load_print_meta: max token length = 1024
0.00.052.757 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.758 I llm_load_tensors: offloading output layer to GPU
0.00.052.758 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.768 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.052.769 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.053.741 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.742 I llama_new_context_with_model: n_ctx         = 2048
0.00.053.742 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.053.742 I llama_new_context_with_model: n_batch       = 2048
0.00.053.743 I llama_new_context_with_model: n_ubatch      = 512
0.00.053.743 I llama_new_context_with_model: flash_attn    = 0
0.00.053.743 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.743 I llama_new_context_with_model: freq_scale    = 1
0.00.053.744 I ggml_metal_init: allocating
0.00.053.747 I ggml_metal_init: found device: Apple M4
0.00.053.749 I ggml_metal_init: picking default device: Apple M4
0.00.054.336 I ggml_metal_init: using embedded metal library
0.00.056.644 I ggml_metal_init: GPU name:   Apple M4
0.00.056.645 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.646 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.646 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.646 I ggml_metal_init: simdgroup reduction   = true
0.00.056.647 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.647 I ggml_metal_init: has bfloat            = true
0.00.056.647 I ggml_metal_init: use bfloat            = true
0.00.056.647 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.648 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.328 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.085.773 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.085.780 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.085.798 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.086.849 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.086.850 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.086.850 I llama_new_context_with_model: graph nodes  = 967
0.00.086.851 I llama_new_context_with_model: graph splits = 2
0.00.086.866 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.087.014 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.087.014 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.451.850 I main: llama threadpool init, n_threads = 4
0.00.451.885 I 
0.00.451.916 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.451.917 I 
0.00.452.134 I sampler seed: 1234
0.00.452.139 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.452.190 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.452.192 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.452.192 I 
I believe the meaning of life is the meaning of choice and the meaning of choice is the meaning of the chosen. I believe in the meaning of a chosen. I believe in the meaning of an under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-under-

0.01.135.483 I llama_perf_sampler_print:    sampling time =       1.11 ms /    71 runs   (    0.02 ms per token, 63963.96 tokens per second)
0.01.135.483 I llama_perf_context_print:        load time =     441.81 ms
0.01.135.484 I llama_perf_context_print: prompt eval time =      39.71 ms /     7 tokens (    5.67 ms per token,   176.27 tokens per second)
0.01.135.484 I llama_perf_context_print:        eval time =     640.69 ms /    63 runs   (   10.17 ms per token,    98.33 tokens per second)
0.01.135.485 I llama_perf_context_print:       total time =     683.64 ms /    70 tokens
0.01.135.670 I ggml_metal_free: deallocating

real	0m1.154s
user	0m0.109s
sys	0m0.114s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.091 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.010.886 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.449 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q2_k.gguf (version GGUF V3 (latest))
0.00.016.453 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.455 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.456 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.456 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.457 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.457 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.458 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.458 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.458 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.459 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.459 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.459 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.460 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.461 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.461 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.462 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.250 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.294 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.169 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.170 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.170 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.171 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.171 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.172 I llama_model_loader: - kv  22:                          general.file_type u32              = 10
0.00.025.172 I llama_model_loader: - type  f32:  194 tensors
0.00.025.173 I llama_model_loader: - type q2_K:   49 tensors
0.00.025.173 I llama_model_loader: - type q3_K:   48 tensors
0.00.025.173 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.095 I llm_load_vocab: special tokens cache size = 25
0.00.052.077 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.080 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.080 I llm_load_print_meta: arch             = gptneox
0.00.052.080 I llm_load_print_meta: vocab type       = BPE
0.00.052.081 I llm_load_print_meta: n_vocab          = 50304
0.00.052.081 I llm_load_print_meta: n_merges         = 50009
0.00.052.081 I llm_load_print_meta: vocab_only       = 0
0.00.052.081 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.081 I llm_load_print_meta: n_embd           = 2048
0.00.052.082 I llm_load_print_meta: n_layer          = 24
0.00.052.084 I llm_load_print_meta: n_head           = 16
0.00.052.085 I llm_load_print_meta: n_head_kv        = 16
0.00.052.085 I llm_load_print_meta: n_rot            = 32
0.00.052.086 I llm_load_print_meta: n_swa            = 0
0.00.052.086 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.086 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.087 I llm_load_print_meta: n_gqa            = 1
0.00.052.088 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.088 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.089 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.089 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.089 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.092 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.092 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.092 I llm_load_print_meta: n_ff             = 8192
0.00.052.093 I llm_load_print_meta: n_expert         = 0
0.00.052.093 I llm_load_print_meta: n_expert_used    = 0
0.00.052.093 I llm_load_print_meta: causal attn      = 1
0.00.052.093 I llm_load_print_meta: pooling type     = 0
0.00.052.094 I llm_load_print_meta: rope type        = 2
0.00.052.101 I llm_load_print_meta: rope scaling     = linear
0.00.052.102 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.103 I llm_load_print_meta: freq_scale_train = 1
0.00.052.103 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.103 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.104 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.104 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.104 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.104 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.104 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.104 I llm_load_print_meta: model type       = 1.4B
0.00.052.105 I llm_load_print_meta: model ftype      = Q2_K - Medium
0.00.052.105 I llm_load_print_meta: model params     = 1.41 B
0.00.052.105 I llm_load_print_meta: model size       = 542.04 MiB (3.21 BPW) 
0.00.052.106 I llm_load_print_meta: general.name     = 1.4B
0.00.052.106 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.106 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.106 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.106 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.106 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.107 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.107 I llm_load_print_meta: max token length = 1024
0.00.053.900 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.900 I llm_load_tensors: offloading output layer to GPU
0.00.053.901 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.906 I llm_load_tensors: Metal_Mapped model buffer size =   542.05 MiB
0.00.053.906 I llm_load_tensors:   CPU_Mapped model buffer size =    32.24 MiB
............................................................................
0.00.054.798 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.798 I llama_new_context_with_model: n_ctx         = 128
0.00.054.799 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.054.799 I llama_new_context_with_model: n_batch       = 128
0.00.054.799 I llama_new_context_with_model: n_ubatch      = 128
0.00.054.799 I llama_new_context_with_model: flash_attn    = 0
0.00.054.799 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.800 I llama_new_context_with_model: freq_scale    = 1
0.00.054.800 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.054.800 I ggml_metal_init: allocating
0.00.054.806 I ggml_metal_init: found device: Apple M4
0.00.054.808 I ggml_metal_init: picking default device: Apple M4
0.00.055.344 I ggml_metal_init: using embedded metal library
0.00.057.692 I ggml_metal_init: GPU name:   Apple M4
0.00.057.694 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.694 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.694 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.694 I ggml_metal_init: simdgroup reduction   = true
0.00.057.695 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.695 I ggml_metal_init: has bfloat            = true
0.00.057.695 I ggml_metal_init: use bfloat            = true
0.00.057.695 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.696 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.186 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.068.561 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.068.563 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.068.578 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.069.400 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.069.401 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.069.401 I llama_new_context_with_model: graph nodes  = 967
0.00.069.401 I llama_new_context_with_model: graph splits = 2
0.00.069.408 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.069.409 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.414.538 I 
0.00.414.578 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.414.590 I perplexity: tokenizing the input ..
0.00.422.344 I perplexity: tokenization took 7.753 ms
0.00.422.348 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.554.497 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]70.7978,
0.00.555.682 I Final estimate: PPL = 70.7978 +/- 27.57202

0.00.555.704 I llama_perf_context_print:        load time =     403.65 ms
0.00.555.704 I llama_perf_context_print: prompt eval time =     131.92 ms /   128 tokens (    1.03 ms per token,   970.26 tokens per second)
0.00.555.705 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.555.706 I llama_perf_context_print:       total time =     141.17 ms /   129 tokens
0.00.556.177 I ggml_metal_free: deallocating

real	0m0.572s
user	0m0.078s
sys	0m0.075s
```
- q3_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.066 I main: llama backend init
0.00.000.068 I main: load the model and apply lora adapter, if any
0.00.009.603 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.070 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.016.075 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.076 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.077 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.077 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.082 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.082 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.084 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.085 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.085 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.086 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.086 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.086 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.090 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.092 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.093 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.093 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.986 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.033 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.971 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.972 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.973 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.973 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.973 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.974 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.024.974 I llama_model_loader: - type  f32:  194 tensors
0.00.024.975 I llama_model_loader: - type q3_K:   25 tensors
0.00.024.975 I llama_model_loader: - type q4_K:   71 tensors
0.00.024.975 I llama_model_loader: - type q5_K:    1 tensors
0.00.024.975 I llama_model_loader: - type q6_K:    1 tensors
0.00.046.106 I llm_load_vocab: special tokens cache size = 25
0.00.052.141 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.144 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.144 I llm_load_print_meta: arch             = gptneox
0.00.052.145 I llm_load_print_meta: vocab type       = BPE
0.00.052.145 I llm_load_print_meta: n_vocab          = 50304
0.00.052.145 I llm_load_print_meta: n_merges         = 50009
0.00.052.145 I llm_load_print_meta: vocab_only       = 0
0.00.052.145 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.146 I llm_load_print_meta: n_embd           = 2048
0.00.052.146 I llm_load_print_meta: n_layer          = 24
0.00.052.148 I llm_load_print_meta: n_head           = 16
0.00.052.149 I llm_load_print_meta: n_head_kv        = 16
0.00.052.149 I llm_load_print_meta: n_rot            = 32
0.00.052.150 I llm_load_print_meta: n_swa            = 0
0.00.052.150 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.150 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.151 I llm_load_print_meta: n_gqa            = 1
0.00.052.153 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.153 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.154 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.154 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.154 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.154 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.155 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.155 I llm_load_print_meta: n_ff             = 8192
0.00.052.157 I llm_load_print_meta: n_expert         = 0
0.00.052.158 I llm_load_print_meta: n_expert_used    = 0
0.00.052.159 I llm_load_print_meta: causal attn      = 1
0.00.052.159 I llm_load_print_meta: pooling type     = 0
0.00.052.159 I llm_load_print_meta: rope type        = 2
0.00.052.159 I llm_load_print_meta: rope scaling     = linear
0.00.052.159 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.160 I llm_load_print_meta: freq_scale_train = 1
0.00.052.160 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.160 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.160 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.160 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.161 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.161 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.161 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.161 I llm_load_print_meta: model type       = 1.4B
0.00.052.163 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.052.163 I llm_load_print_meta: model params     = 1.41 B
0.00.052.164 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.052.164 I llm_load_print_meta: general.name     = 1.4B
0.00.052.166 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.166 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.166 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.166 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.167 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.167 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.167 I llm_load_print_meta: max token length = 1024
0.00.054.173 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.174 I llm_load_tensors: offloading output layer to GPU
0.00.054.175 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.185 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.054.186 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.055.094 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.095 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.095 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.095 I llama_new_context_with_model: n_batch       = 2048
0.00.055.095 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.095 I llama_new_context_with_model: flash_attn    = 0
0.00.055.096 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.096 I llama_new_context_with_model: freq_scale    = 1
0.00.055.096 I ggml_metal_init: allocating
0.00.055.100 I ggml_metal_init: found device: Apple M4
0.00.055.102 I ggml_metal_init: picking default device: Apple M4
0.00.055.721 I ggml_metal_init: using embedded metal library
0.00.058.942 I ggml_metal_init: GPU name:   Apple M4
0.00.058.945 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.945 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.945 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.946 I ggml_metal_init: simdgroup reduction   = true
0.00.058.946 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.946 I ggml_metal_init: has bfloat            = true
0.00.058.946 I ggml_metal_init: use bfloat            = true
0.00.058.947 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.947 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.069.260 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.089.177 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.089.188 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.089.215 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.090.231 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.090.232 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.090.232 I llama_new_context_with_model: graph nodes  = 967
0.00.090.233 I llama_new_context_with_model: graph splits = 2
0.00.090.250 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.090.433 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.090.433 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.504.591 I main: llama threadpool init, n_threads = 4
0.00.504.645 I 
0.00.504.673 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.504.673 I 
0.00.504.929 I sampler seed: 1234
0.00.504.964 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.504.996 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.504.998 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.504.998 I 
I believe the meaning of life is that one should always seek to be understood.

"The question is not, 'What is the best and most beautiful thing that I can do?'

"The question is, 'What can I do,

"To be better and wiser and happier and more

"Loved than anyone

0.01.246.527 I llama_perf_sampler_print:    sampling time =       1.49 ms /    71 runs   (    0.02 ms per token, 47651.01 tokens per second)
0.01.246.527 I llama_perf_context_print:        load time =     494.98 ms
0.01.246.528 I llama_perf_context_print: prompt eval time =      40.36 ms /     7 tokens (    5.77 ms per token,   173.45 tokens per second)
0.01.246.529 I llama_perf_context_print:        eval time =     698.63 ms /    63 runs   (   11.09 ms per token,    90.18 tokens per second)
0.01.246.530 I llama_perf_context_print:       total time =     741.94 ms /    70 tokens
0.01.246.725 I ggml_metal_free: deallocating

real	0m1.264s
user	0m0.110s
sys	0m0.106s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.083 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.157 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.687 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q3_k.gguf (version GGUF V3 (latest))
0.00.016.692 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.693 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.694 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.694 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.695 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.695 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.696 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.696 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.697 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.697 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.697 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.698 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.698 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.699 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.702 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.702 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.484 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.538 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.025.266 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.025.267 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.025.267 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.025.268 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.025.268 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.025.268 I llama_model_loader: - kv  22:                          general.file_type u32              = 12
0.00.025.269 I llama_model_loader: - type  f32:  194 tensors
0.00.025.269 I llama_model_loader: - type q3_K:   25 tensors
0.00.025.270 I llama_model_loader: - type q4_K:   71 tensors
0.00.025.270 I llama_model_loader: - type q5_K:    1 tensors
0.00.025.270 I llama_model_loader: - type q6_K:    1 tensors
0.00.045.409 I llm_load_vocab: special tokens cache size = 25
0.00.051.364 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.367 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.368 I llm_load_print_meta: arch             = gptneox
0.00.051.368 I llm_load_print_meta: vocab type       = BPE
0.00.051.368 I llm_load_print_meta: n_vocab          = 50304
0.00.051.369 I llm_load_print_meta: n_merges         = 50009
0.00.051.369 I llm_load_print_meta: vocab_only       = 0
0.00.051.369 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.369 I llm_load_print_meta: n_embd           = 2048
0.00.051.369 I llm_load_print_meta: n_layer          = 24
0.00.051.372 I llm_load_print_meta: n_head           = 16
0.00.051.373 I llm_load_print_meta: n_head_kv        = 16
0.00.051.373 I llm_load_print_meta: n_rot            = 32
0.00.051.373 I llm_load_print_meta: n_swa            = 0
0.00.051.373 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.373 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.374 I llm_load_print_meta: n_gqa            = 1
0.00.051.375 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.376 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.376 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.377 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.377 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.377 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.377 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.378 I llm_load_print_meta: n_ff             = 8192
0.00.051.378 I llm_load_print_meta: n_expert         = 0
0.00.051.378 I llm_load_print_meta: n_expert_used    = 0
0.00.051.378 I llm_load_print_meta: causal attn      = 1
0.00.051.378 I llm_load_print_meta: pooling type     = 0
0.00.051.379 I llm_load_print_meta: rope type        = 2
0.00.051.380 I llm_load_print_meta: rope scaling     = linear
0.00.051.380 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.381 I llm_load_print_meta: freq_scale_train = 1
0.00.051.381 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.381 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.381 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.381 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.381 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.381 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.382 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.382 I llm_load_print_meta: model type       = 1.4B
0.00.051.382 I llm_load_print_meta: model ftype      = Q3_K - Medium
0.00.051.382 I llm_load_print_meta: model params     = 1.41 B
0.00.051.383 I llm_load_print_meta: model size       = 724.27 MiB (4.29 BPW) 
0.00.051.383 I llm_load_print_meta: general.name     = 1.4B
0.00.051.383 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.384 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.384 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.384 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.384 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.385 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.385 I llm_load_print_meta: max token length = 1024
0.00.052.968 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.968 I llm_load_tensors: offloading output layer to GPU
0.00.052.969 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.979 I llm_load_tensors: Metal_Mapped model buffer size =   724.28 MiB
0.00.052.980 I llm_load_tensors:   CPU_Mapped model buffer size =    42.22 MiB
................................................................................
0.00.053.817 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.818 I llama_new_context_with_model: n_ctx         = 128
0.00.053.818 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.818 I llama_new_context_with_model: n_batch       = 128
0.00.053.818 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.818 I llama_new_context_with_model: flash_attn    = 0
0.00.053.819 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.819 I llama_new_context_with_model: freq_scale    = 1
0.00.053.819 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.820 I ggml_metal_init: allocating
0.00.053.823 I ggml_metal_init: found device: Apple M4
0.00.053.825 I ggml_metal_init: picking default device: Apple M4
0.00.054.375 I ggml_metal_init: using embedded metal library
0.00.056.670 I ggml_metal_init: GPU name:   Apple M4
0.00.056.672 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.672 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.672 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.673 I ggml_metal_init: simdgroup reduction   = true
0.00.056.673 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.673 I ggml_metal_init: has bfloat            = true
0.00.056.673 I ggml_metal_init: use bfloat            = true
0.00.056.674 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.674 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.271 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.067.548 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.551 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.566 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.477 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.478 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.479 I llama_new_context_with_model: graph nodes  = 967
0.00.068.479 I llama_new_context_with_model: graph splits = 2
0.00.068.491 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.068.491 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.496.030 I 
0.00.496.075 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.496.086 I perplexity: tokenizing the input ..
0.00.504.253 I perplexity: tokenization took 8.165 ms
0.00.504.256 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.636.482 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]12.0517,
0.00.637.629 I Final estimate: PPL = 12.0517 +/- 3.93502

0.00.637.648 I llama_perf_context_print:        load time =     486.87 ms
0.00.637.649 I llama_perf_context_print: prompt eval time =     132.00 ms /   128 tokens (    1.03 ms per token,   969.70 tokens per second)
0.00.637.650 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.637.650 I llama_perf_context_print:       total time =     141.62 ms /   129 tokens
0.00.638.162 I ggml_metal_free: deallocating

real	0m0.651s
user	0m0.078s
sys	0m0.093s
```
- q4_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.036 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.074 I main: llama backend init
0.00.000.076 I main: load the model and apply lora adapter, if any
0.00.011.991 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.018.337 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.018.342 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.018.348 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.018.349 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.018.349 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.018.350 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.018.350 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.018.351 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.018.351 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.018.351 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.018.352 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.018.352 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.018.352 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.018.353 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.018.354 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.018.354 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.018.355 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.022.189 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.023.226 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.027.034 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.027.035 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.027.035 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.027.035 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.027.036 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.027.036 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.027.037 I llama_model_loader: - type  f32:  194 tensors
0.00.027.037 I llama_model_loader: - type q4_K:   61 tensors
0.00.027.037 I llama_model_loader: - type q5_K:   24 tensors
0.00.027.037 I llama_model_loader: - type q6_K:   13 tensors
0.00.047.512 I llm_load_vocab: special tokens cache size = 25
0.00.053.581 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.053.583 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.053.584 I llm_load_print_meta: arch             = gptneox
0.00.053.584 I llm_load_print_meta: vocab type       = BPE
0.00.053.584 I llm_load_print_meta: n_vocab          = 50304
0.00.053.585 I llm_load_print_meta: n_merges         = 50009
0.00.053.585 I llm_load_print_meta: vocab_only       = 0
0.00.053.585 I llm_load_print_meta: n_ctx_train      = 2048
0.00.053.585 I llm_load_print_meta: n_embd           = 2048
0.00.053.586 I llm_load_print_meta: n_layer          = 24
0.00.053.589 I llm_load_print_meta: n_head           = 16
0.00.053.589 I llm_load_print_meta: n_head_kv        = 16
0.00.053.590 I llm_load_print_meta: n_rot            = 32
0.00.053.590 I llm_load_print_meta: n_swa            = 0
0.00.053.590 I llm_load_print_meta: n_embd_head_k    = 128
0.00.053.590 I llm_load_print_meta: n_embd_head_v    = 128
0.00.053.591 I llm_load_print_meta: n_gqa            = 1
0.00.053.592 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.053.592 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.053.593 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.053.593 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.053.595 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.053.595 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.053.595 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.053.596 I llm_load_print_meta: n_ff             = 8192
0.00.053.596 I llm_load_print_meta: n_expert         = 0
0.00.053.596 I llm_load_print_meta: n_expert_used    = 0
0.00.053.596 I llm_load_print_meta: causal attn      = 1
0.00.053.596 I llm_load_print_meta: pooling type     = 0
0.00.053.598 I llm_load_print_meta: rope type        = 2
0.00.053.598 I llm_load_print_meta: rope scaling     = linear
0.00.053.599 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.053.599 I llm_load_print_meta: freq_scale_train = 1
0.00.053.599 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.053.599 I llm_load_print_meta: rope_finetuned   = unknown
0.00.053.599 I llm_load_print_meta: ssm_d_conv       = 0
0.00.053.600 I llm_load_print_meta: ssm_d_inner      = 0
0.00.053.600 I llm_load_print_meta: ssm_d_state      = 0
0.00.053.600 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.053.600 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.053.600 I llm_load_print_meta: model type       = 1.4B
0.00.053.601 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.053.601 I llm_load_print_meta: model params     = 1.41 B
0.00.053.602 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.053.602 I llm_load_print_meta: general.name     = 1.4B
0.00.053.602 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.053.602 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.053.602 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.053.603 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.053.603 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.053.603 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.053.603 I llm_load_print_meta: max token length = 1024
0.00.055.642 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.055.643 I llm_load_tensors: offloading output layer to GPU
0.00.055.643 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.055.653 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.055.654 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.056.633 I llama_new_context_with_model: n_seq_max     = 1
0.00.056.634 I llama_new_context_with_model: n_ctx         = 2048
0.00.056.634 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.056.634 I llama_new_context_with_model: n_batch       = 2048
0.00.056.634 I llama_new_context_with_model: n_ubatch      = 512
0.00.056.634 I llama_new_context_with_model: flash_attn    = 0
0.00.056.635 I llama_new_context_with_model: freq_base     = 10000.0
0.00.056.635 I llama_new_context_with_model: freq_scale    = 1
0.00.056.635 I ggml_metal_init: allocating
0.00.056.638 I ggml_metal_init: found device: Apple M4
0.00.056.640 I ggml_metal_init: picking default device: Apple M4
0.00.057.221 I ggml_metal_init: using embedded metal library
0.00.059.532 I ggml_metal_init: GPU name:   Apple M4
0.00.059.533 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.059.534 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.059.534 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.059.534 I ggml_metal_init: simdgroup reduction   = true
0.00.059.534 I ggml_metal_init: simdgroup matrix mul. = true
0.00.059.535 I ggml_metal_init: has bfloat            = true
0.00.059.535 I ggml_metal_init: use bfloat            = true
0.00.059.535 I ggml_metal_init: hasUnifiedMemory      = true
0.00.059.536 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.069.266 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.089.061 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.089.067 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.089.086 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.090.058 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.090.059 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.090.059 I llama_new_context_with_model: graph nodes  = 967
0.00.090.060 I llama_new_context_with_model: graph splits = 2
0.00.090.075 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.090.216 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.090.216 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.621.727 I main: llama threadpool init, n_threads = 4
0.00.621.770 I 
0.00.621.803 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.621.805 I 
0.00.622.034 I sampler seed: 1234
0.00.622.041 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.622.056 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.622.057 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.622.057 I 
I believe the meaning of life is that there is a lot of suffering and pain in the world. That is why I believe that we have the capability to help each other out of the suffering in the world. I believe that if we just believe and feel like we are part of a bigger, more loving, more compassionate world, that we can help each

0.01.387.082 I llama_perf_sampler_print:    sampling time =       1.23 ms /    71 runs   (    0.02 ms per token, 57723.58 tokens per second)
0.01.387.083 I llama_perf_context_print:        load time =     609.73 ms
0.01.387.084 I llama_perf_context_print: prompt eval time =      51.55 ms /     7 tokens (    7.37 ms per token,   135.78 tokens per second)
0.01.387.085 I llama_perf_context_print:        eval time =     710.47 ms /    63 runs   (   11.28 ms per token,    88.67 tokens per second)
0.01.387.085 I llama_perf_context_print:       total time =     765.36 ms /    70 tokens
0.01.387.290 I ggml_metal_free: deallocating

real	0m1.404s
user	0m0.110s
sys	0m0.141s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.087 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.008.783 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.014.710 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_k.gguf (version GGUF V3 (latest))
0.00.014.715 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.014.717 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.014.717 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.014.717 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.014.718 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.014.718 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.014.719 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.014.719 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.014.720 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.014.720 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.014.720 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.014.721 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.014.721 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.014.723 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.014.723 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.014.723 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.018.544 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.019.574 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.426 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.427 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.427 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.428 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.428 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.428 I llama_model_loader: - kv  22:                          general.file_type u32              = 15
0.00.023.429 I llama_model_loader: - type  f32:  194 tensors
0.00.023.429 I llama_model_loader: - type q4_K:   61 tensors
0.00.023.429 I llama_model_loader: - type q5_K:   24 tensors
0.00.023.430 I llama_model_loader: - type q6_K:   13 tensors
0.00.044.577 I llm_load_vocab: special tokens cache size = 25
0.00.050.519 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.050.522 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.050.523 I llm_load_print_meta: arch             = gptneox
0.00.050.523 I llm_load_print_meta: vocab type       = BPE
0.00.050.523 I llm_load_print_meta: n_vocab          = 50304
0.00.050.523 I llm_load_print_meta: n_merges         = 50009
0.00.050.523 I llm_load_print_meta: vocab_only       = 0
0.00.050.524 I llm_load_print_meta: n_ctx_train      = 2048
0.00.050.524 I llm_load_print_meta: n_embd           = 2048
0.00.050.524 I llm_load_print_meta: n_layer          = 24
0.00.050.527 I llm_load_print_meta: n_head           = 16
0.00.050.528 I llm_load_print_meta: n_head_kv        = 16
0.00.050.528 I llm_load_print_meta: n_rot            = 32
0.00.050.528 I llm_load_print_meta: n_swa            = 0
0.00.050.528 I llm_load_print_meta: n_embd_head_k    = 128
0.00.050.528 I llm_load_print_meta: n_embd_head_v    = 128
0.00.050.529 I llm_load_print_meta: n_gqa            = 1
0.00.050.530 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.050.531 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.050.531 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.050.532 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.050.532 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.050.533 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.050.533 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.050.534 I llm_load_print_meta: n_ff             = 8192
0.00.050.534 I llm_load_print_meta: n_expert         = 0
0.00.050.534 I llm_load_print_meta: n_expert_used    = 0
0.00.050.534 I llm_load_print_meta: causal attn      = 1
0.00.050.534 I llm_load_print_meta: pooling type     = 0
0.00.050.534 I llm_load_print_meta: rope type        = 2
0.00.050.535 I llm_load_print_meta: rope scaling     = linear
0.00.050.537 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.050.538 I llm_load_print_meta: freq_scale_train = 1
0.00.050.538 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.050.538 I llm_load_print_meta: rope_finetuned   = unknown
0.00.050.538 I llm_load_print_meta: ssm_d_conv       = 0
0.00.050.538 I llm_load_print_meta: ssm_d_inner      = 0
0.00.050.538 I llm_load_print_meta: ssm_d_state      = 0
0.00.050.539 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.050.539 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.050.539 I llm_load_print_meta: model type       = 1.4B
0.00.050.539 I llm_load_print_meta: model ftype      = Q4_K - Medium
0.00.050.540 I llm_load_print_meta: model params     = 1.41 B
0.00.050.545 I llm_load_print_meta: model size       = 871.81 MiB (5.17 BPW) 
0.00.050.545 I llm_load_print_meta: general.name     = 1.4B
0.00.050.547 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.050.547 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.050.547 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.050.547 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.050.547 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.050.547 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.050.547 I llm_load_print_meta: max token length = 1024
0.00.052.610 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.052.611 I llm_load_tensors: offloading output layer to GPU
0.00.052.611 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.052.621 I llm_load_tensors: Metal_Mapped model buffer size =   871.83 MiB
0.00.052.622 I llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
..............................................................................
0.00.053.537 I llama_new_context_with_model: n_seq_max     = 1
0.00.053.538 I llama_new_context_with_model: n_ctx         = 128
0.00.053.538 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.053.538 I llama_new_context_with_model: n_batch       = 128
0.00.053.538 I llama_new_context_with_model: n_ubatch      = 128
0.00.053.539 I llama_new_context_with_model: flash_attn    = 0
0.00.053.539 I llama_new_context_with_model: freq_base     = 10000.0
0.00.053.539 I llama_new_context_with_model: freq_scale    = 1
0.00.053.540 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.053.540 I ggml_metal_init: allocating
0.00.053.544 I ggml_metal_init: found device: Apple M4
0.00.053.546 I ggml_metal_init: picking default device: Apple M4
0.00.054.131 I ggml_metal_init: using embedded metal library
0.00.056.480 I ggml_metal_init: GPU name:   Apple M4
0.00.056.481 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.056.482 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.056.482 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.056.482 I ggml_metal_init: simdgroup reduction   = true
0.00.056.483 I ggml_metal_init: simdgroup matrix mul. = true
0.00.056.483 I ggml_metal_init: has bfloat            = true
0.00.056.483 I ggml_metal_init: use bfloat            = true
0.00.056.483 I ggml_metal_init: hasUnifiedMemory      = true
0.00.056.484 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.066.352 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.067.612 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.067.614 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.067.627 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.068.544 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.068.546 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.068.546 I llama_new_context_with_model: graph nodes  = 967
0.00.068.546 I llama_new_context_with_model: graph splits = 2
0.00.068.559 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.068.560 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.578.534 I 
0.00.578.562 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.578.573 I perplexity: tokenizing the input ..
0.00.586.579 I perplexity: tokenization took 8.004 ms
0.00.586.582 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.721.514 I perplexity: 0.13 seconds per pass - ETA 0.00 minutes
[1]10.1031,
0.00.722.769 I Final estimate: PPL = 10.1031 +/- 3.22057

0.00.722.786 I llama_perf_context_print:        load time =     569.75 ms
0.00.722.787 I llama_perf_context_print: prompt eval time =     134.70 ms /   128 tokens (    1.05 ms per token,   950.25 tokens per second)
0.00.722.788 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.722.788 I llama_perf_context_print:       total time =     144.25 ms /   129 tokens
0.00.723.203 I ggml_metal_free: deallocating

real	0m0.737s
user	0m0.079s
sys	0m0.100s
```
- q5_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.034 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.062 I main: llama backend init
0.00.000.063 I main: load the model and apply lora adapter, if any
0.00.008.635 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.452 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.015.456 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.462 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.463 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.463 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.464 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.464 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.465 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.465 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.466 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.467 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.468 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.468 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.468 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.470 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.470 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.470 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.402 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.523 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.374 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.375 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.375 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.376 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.376 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.376 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.024.377 I llama_model_loader: - type  f32:  194 tensors
0.00.024.377 I llama_model_loader: - type q5_K:   61 tensors
0.00.024.377 I llama_model_loader: - type q6_K:   37 tensors
0.00.045.477 I llm_load_vocab: special tokens cache size = 25
0.00.051.361 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.051.364 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.051.364 I llm_load_print_meta: arch             = gptneox
0.00.051.364 I llm_load_print_meta: vocab type       = BPE
0.00.051.365 I llm_load_print_meta: n_vocab          = 50304
0.00.051.365 I llm_load_print_meta: n_merges         = 50009
0.00.051.365 I llm_load_print_meta: vocab_only       = 0
0.00.051.365 I llm_load_print_meta: n_ctx_train      = 2048
0.00.051.365 I llm_load_print_meta: n_embd           = 2048
0.00.051.365 I llm_load_print_meta: n_layer          = 24
0.00.051.368 I llm_load_print_meta: n_head           = 16
0.00.051.369 I llm_load_print_meta: n_head_kv        = 16
0.00.051.369 I llm_load_print_meta: n_rot            = 32
0.00.051.369 I llm_load_print_meta: n_swa            = 0
0.00.051.369 I llm_load_print_meta: n_embd_head_k    = 128
0.00.051.370 I llm_load_print_meta: n_embd_head_v    = 128
0.00.051.370 I llm_load_print_meta: n_gqa            = 1
0.00.051.371 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.051.372 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.051.373 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.051.375 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.051.375 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.051.375 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.051.375 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.051.376 I llm_load_print_meta: n_ff             = 8192
0.00.051.376 I llm_load_print_meta: n_expert         = 0
0.00.051.376 I llm_load_print_meta: n_expert_used    = 0
0.00.051.377 I llm_load_print_meta: causal attn      = 1
0.00.051.377 I llm_load_print_meta: pooling type     = 0
0.00.051.377 I llm_load_print_meta: rope type        = 2
0.00.051.377 I llm_load_print_meta: rope scaling     = linear
0.00.051.378 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.051.378 I llm_load_print_meta: freq_scale_train = 1
0.00.051.378 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.051.378 I llm_load_print_meta: rope_finetuned   = unknown
0.00.051.378 I llm_load_print_meta: ssm_d_conv       = 0
0.00.051.379 I llm_load_print_meta: ssm_d_inner      = 0
0.00.051.379 I llm_load_print_meta: ssm_d_state      = 0
0.00.051.380 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.051.380 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.051.380 I llm_load_print_meta: model type       = 1.4B
0.00.051.381 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.051.381 I llm_load_print_meta: model params     = 1.41 B
0.00.051.382 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.051.382 I llm_load_print_meta: general.name     = 1.4B
0.00.051.382 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.051.382 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.051.383 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.051.383 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.051.383 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.051.387 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.051.387 I llm_load_print_meta: max token length = 1024
0.00.053.404 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.053.405 I llm_load_tensors: offloading output layer to GPU
0.00.053.405 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.053.415 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.053.416 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.054.330 I llama_new_context_with_model: n_seq_max     = 1
0.00.054.331 I llama_new_context_with_model: n_ctx         = 2048
0.00.054.331 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.054.332 I llama_new_context_with_model: n_batch       = 2048
0.00.054.332 I llama_new_context_with_model: n_ubatch      = 512
0.00.054.332 I llama_new_context_with_model: flash_attn    = 0
0.00.054.333 I llama_new_context_with_model: freq_base     = 10000.0
0.00.054.333 I llama_new_context_with_model: freq_scale    = 1
0.00.054.333 I ggml_metal_init: allocating
0.00.054.341 I ggml_metal_init: found device: Apple M4
0.00.054.344 I ggml_metal_init: picking default device: Apple M4
0.00.054.925 I ggml_metal_init: using embedded metal library
0.00.057.239 I ggml_metal_init: GPU name:   Apple M4
0.00.057.240 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.057.241 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.057.241 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.057.241 I ggml_metal_init: simdgroup reduction   = true
0.00.057.241 I ggml_metal_init: simdgroup matrix mul. = true
0.00.057.241 I ggml_metal_init: has bfloat            = true
0.00.057.242 I ggml_metal_init: use bfloat            = true
0.00.057.242 I ggml_metal_init: hasUnifiedMemory      = true
0.00.057.243 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.127 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.086.816 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.086.822 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.086.844 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.087.838 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.087.839 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.087.839 I llama_new_context_with_model: graph nodes  = 967
0.00.087.840 I llama_new_context_with_model: graph splits = 2
0.00.087.854 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.087.983 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.087.984 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.707.739 I main: llama threadpool init, n_threads = 4
0.00.707.779 I 
0.00.707.827 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.707.828 I 
0.00.708.048 I sampler seed: 1234
0.00.708.052 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.708.085 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.708.088 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.708.088 I 
I believe the meaning of life is to find love."

"Then why did you say you don't have any?"

"Because you're a girl. It's not the same thing."

"So what is love?"

"I don't know."

"You don't know?"

"I don't

0.01.557.160 I llama_perf_sampler_print:    sampling time =       1.17 ms /    71 runs   (    0.02 ms per token, 60580.20 tokens per second)
0.01.557.161 I llama_perf_context_print:        load time =     699.10 ms
0.01.557.162 I llama_perf_context_print: prompt eval time =      51.55 ms /     7 tokens (    7.36 ms per token,   135.80 tokens per second)
0.01.557.162 I llama_perf_context_print:        eval time =     794.59 ms /    63 runs   (   12.61 ms per token,    79.29 tokens per second)
0.01.557.163 I llama_perf_context_print:       total time =     849.43 ms /    70 tokens
0.01.557.329 I ggml_metal_free: deallocating

real	0m1.573s
user	0m0.109s
sys	0m0.165s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.086 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.496 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.221 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q5_k.gguf (version GGUF V3 (latest))
0.00.015.225 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.227 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.228 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.228 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.228 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.229 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.229 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.230 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.230 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.230 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.233 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.233 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.234 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.237 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.237 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.237 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.010 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.044 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.023.764 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.023.765 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.023.765 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.023.766 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.023.766 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.023.766 I llama_model_loader: - kv  22:                          general.file_type u32              = 17
0.00.023.767 I llama_model_loader: - type  f32:  194 tensors
0.00.023.768 I llama_model_loader: - type q5_K:   61 tensors
0.00.023.768 I llama_model_loader: - type q6_K:   37 tensors
0.00.043.941 I llm_load_vocab: special tokens cache size = 25
0.00.049.849 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.049.852 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.049.852 I llm_load_print_meta: arch             = gptneox
0.00.049.852 I llm_load_print_meta: vocab type       = BPE
0.00.049.853 I llm_load_print_meta: n_vocab          = 50304
0.00.049.853 I llm_load_print_meta: n_merges         = 50009
0.00.049.853 I llm_load_print_meta: vocab_only       = 0
0.00.049.853 I llm_load_print_meta: n_ctx_train      = 2048
0.00.049.853 I llm_load_print_meta: n_embd           = 2048
0.00.049.854 I llm_load_print_meta: n_layer          = 24
0.00.049.856 I llm_load_print_meta: n_head           = 16
0.00.049.857 I llm_load_print_meta: n_head_kv        = 16
0.00.049.857 I llm_load_print_meta: n_rot            = 32
0.00.049.857 I llm_load_print_meta: n_swa            = 0
0.00.049.857 I llm_load_print_meta: n_embd_head_k    = 128
0.00.049.857 I llm_load_print_meta: n_embd_head_v    = 128
0.00.049.860 I llm_load_print_meta: n_gqa            = 1
0.00.049.861 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.049.862 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.049.863 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.049.864 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.049.864 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.049.864 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.049.865 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.049.865 I llm_load_print_meta: n_ff             = 8192
0.00.049.865 I llm_load_print_meta: n_expert         = 0
0.00.049.866 I llm_load_print_meta: n_expert_used    = 0
0.00.049.866 I llm_load_print_meta: causal attn      = 1
0.00.049.866 I llm_load_print_meta: pooling type     = 0
0.00.049.866 I llm_load_print_meta: rope type        = 2
0.00.049.866 I llm_load_print_meta: rope scaling     = linear
0.00.049.867 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.049.867 I llm_load_print_meta: freq_scale_train = 1
0.00.049.867 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.049.867 I llm_load_print_meta: rope_finetuned   = unknown
0.00.049.868 I llm_load_print_meta: ssm_d_conv       = 0
0.00.049.868 I llm_load_print_meta: ssm_d_inner      = 0
0.00.049.868 I llm_load_print_meta: ssm_d_state      = 0
0.00.049.868 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.049.868 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.049.868 I llm_load_print_meta: model type       = 1.4B
0.00.049.869 I llm_load_print_meta: model ftype      = Q5_K - Medium
0.00.049.869 I llm_load_print_meta: model params     = 1.41 B
0.00.049.870 I llm_load_print_meta: model size       = 1006.35 MiB (5.97 BPW) 
0.00.049.870 I llm_load_print_meta: general.name     = 1.4B
0.00.049.871 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.049.871 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.049.871 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.049.871 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.049.871 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.049.872 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.049.872 I llm_load_print_meta: max token length = 1024
0.00.051.836 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.051.837 I llm_load_tensors: offloading output layer to GPU
0.00.051.837 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.051.847 I llm_load_tensors: Metal_Mapped model buffer size =  1006.36 MiB
0.00.051.848 I llm_load_tensors:   CPU_Mapped model buffer size =    67.55 MiB
.................................................................................
0.00.052.759 I llama_new_context_with_model: n_seq_max     = 1
0.00.052.759 I llama_new_context_with_model: n_ctx         = 128
0.00.052.760 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.052.760 I llama_new_context_with_model: n_batch       = 128
0.00.052.760 I llama_new_context_with_model: n_ubatch      = 128
0.00.052.760 I llama_new_context_with_model: flash_attn    = 0
0.00.052.761 I llama_new_context_with_model: freq_base     = 10000.0
0.00.052.761 I llama_new_context_with_model: freq_scale    = 1
0.00.052.761 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.052.762 I ggml_metal_init: allocating
0.00.052.765 I ggml_metal_init: found device: Apple M4
0.00.052.767 I ggml_metal_init: picking default device: Apple M4
0.00.053.463 I ggml_metal_init: using embedded metal library
0.00.055.730 I ggml_metal_init: GPU name:   Apple M4
0.00.055.731 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.055.732 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.055.732 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.055.732 I ggml_metal_init: simdgroup reduction   = true
0.00.055.732 I ggml_metal_init: simdgroup matrix mul. = true
0.00.055.732 I ggml_metal_init: has bfloat            = true
0.00.055.733 I ggml_metal_init: use bfloat            = true
0.00.055.733 I ggml_metal_init: hasUnifiedMemory      = true
0.00.055.734 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.065.335 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.066.579 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.066.581 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.066.596 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.067.520 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.067.521 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.067.521 I llama_new_context_with_model: graph nodes  = 967
0.00.067.521 I llama_new_context_with_model: graph splits = 2
0.00.067.529 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.067.529 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.674.432 I 
0.00.674.478 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.674.491 I perplexity: tokenizing the input ..
0.00.682.158 I perplexity: tokenization took 7.665 ms
0.00.682.163 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.822.243 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.2433,
0.00.823.535 I Final estimate: PPL = 10.2433 +/- 3.24778

0.00.823.552 I llama_perf_context_print:        load time =     664.93 ms
0.00.823.553 I llama_perf_context_print: prompt eval time =     139.83 ms /   128 tokens (    1.09 ms per token,   915.40 tokens per second)
0.00.823.554 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.823.557 I llama_perf_context_print:       total time =     149.12 ms /   129 tokens
0.00.823.911 I ggml_metal_free: deallocating

real	0m0.840s
user	0m0.077s
sys	0m0.110s
```
- q6_k:
```
+ ./bin/llama-cli --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -ngl 99 -c 0 -s 1234 -n 64 --ignore-eos -p 'I believe the meaning of life is'
0.00.000.033 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.000.062 I main: llama backend init
0.00.000.064 I main: load the model and apply lora adapter, if any
0.00.009.627 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.016.124 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.016.128 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.016.129 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.016.130 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.016.130 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.016.130 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.016.131 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.016.132 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.016.132 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.016.132 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.016.133 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.016.133 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.016.133 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.016.134 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.016.136 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.016.137 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.016.137 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.020.030 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.021.102 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.895 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.897 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.897 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.897 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.897 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.898 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.898 I llama_model_loader: - type  f32:  194 tensors
0.00.024.899 I llama_model_loader: - type q6_K:   98 tensors
0.00.046.179 I llm_load_vocab: special tokens cache size = 25
0.00.052.229 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.232 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.232 I llm_load_print_meta: arch             = gptneox
0.00.052.233 I llm_load_print_meta: vocab type       = BPE
0.00.052.233 I llm_load_print_meta: n_vocab          = 50304
0.00.052.233 I llm_load_print_meta: n_merges         = 50009
0.00.052.234 I llm_load_print_meta: vocab_only       = 0
0.00.052.234 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.234 I llm_load_print_meta: n_embd           = 2048
0.00.052.234 I llm_load_print_meta: n_layer          = 24
0.00.052.237 I llm_load_print_meta: n_head           = 16
0.00.052.238 I llm_load_print_meta: n_head_kv        = 16
0.00.052.238 I llm_load_print_meta: n_rot            = 32
0.00.052.238 I llm_load_print_meta: n_swa            = 0
0.00.052.239 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.239 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.239 I llm_load_print_meta: n_gqa            = 1
0.00.052.242 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.243 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.243 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.244 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.244 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.244 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.246 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.246 I llm_load_print_meta: n_ff             = 8192
0.00.052.247 I llm_load_print_meta: n_expert         = 0
0.00.052.247 I llm_load_print_meta: n_expert_used    = 0
0.00.052.247 I llm_load_print_meta: causal attn      = 1
0.00.052.249 I llm_load_print_meta: pooling type     = 0
0.00.052.249 I llm_load_print_meta: rope type        = 2
0.00.052.249 I llm_load_print_meta: rope scaling     = linear
0.00.052.250 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.250 I llm_load_print_meta: freq_scale_train = 1
0.00.052.251 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.251 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.252 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.253 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.253 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.253 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.253 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.253 I llm_load_print_meta: model type       = 1.4B
0.00.052.254 I llm_load_print_meta: model ftype      = Q6_K
0.00.052.255 I llm_load_print_meta: model params     = 1.41 B
0.00.052.256 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.052.256 I llm_load_print_meta: general.name     = 1.4B
0.00.052.259 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.259 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.260 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.260 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.260 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.260 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.261 I llm_load_print_meta: max token length = 1024
0.00.054.345 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.346 I llm_load_tensors: offloading output layer to GPU
0.00.054.346 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.357 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.054.358 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.055.243 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.244 I llama_new_context_with_model: n_ctx         = 2048
0.00.055.244 I llama_new_context_with_model: n_ctx_per_seq = 2048
0.00.055.244 I llama_new_context_with_model: n_batch       = 2048
0.00.055.244 I llama_new_context_with_model: n_ubatch      = 512
0.00.055.244 I llama_new_context_with_model: flash_attn    = 0
0.00.055.245 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.245 I llama_new_context_with_model: freq_scale    = 1
0.00.055.245 I ggml_metal_init: allocating
0.00.055.251 I ggml_metal_init: found device: Apple M4
0.00.055.253 I ggml_metal_init: picking default device: Apple M4
0.00.055.844 I ggml_metal_init: using embedded metal library
0.00.058.183 I ggml_metal_init: GPU name:   Apple M4
0.00.058.185 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.185 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.185 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.186 I ggml_metal_init: simdgroup reduction   = true
0.00.058.187 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.187 I ggml_metal_init: has bfloat            = true
0.00.058.187 I ggml_metal_init: use bfloat            = true
0.00.058.188 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.188 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.619 I llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.087.467 I llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
0.00.087.477 I llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
0.00.087.499 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.088.504 I llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
0.00.088.506 I llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
0.00.088.506 I llama_new_context_with_model: graph nodes  = 967
0.00.088.506 I llama_new_context_with_model: graph splits = 2
0.00.088.522 I common_init_from_params: added <|endoftext|> logit bias = -inf
0.00.088.666 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.088.667 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.767.354 I main: llama threadpool init, n_threads = 4
0.00.767.391 I 
0.00.767.419 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.767.419 I 
0.00.767.660 I sampler seed: 1234
0.00.767.665 I sampler params: 
	repeat_last_n = 64, repeat_penalty = 1.000, frequency_penalty = 0.000, presence_penalty = 0.000
	dry_multiplier = 0.000, dry_base = 1.750, dry_allowed_length = 2, dry_penalty_last_n = 2048
	top_k = 40, top_p = 0.950, min_p = 0.050, xtc_probability = 0.000, xtc_threshold = 0.100, typical_p = 1.000, temp = 0.800
	mirostat = 0, mirostat_lr = 0.100, mirostat_ent = 5.000
0.00.767.712 I sampler chain: logits -> logit-bias -> penalties -> dry -> top-k -> typical -> top-p -> min-p -> xtc -> temp-ext -> dist 
0.00.767.716 I generate: n_ctx = 2048, n_batch = 2048, n_predict = 64, n_keep = 0
0.00.767.716 I 
I believe the meaning of life is to become as big as possible, but I also believe that life is short and we should enjoy it as we have it.

“I believe in life and death, and I think we should use every minute that we have to live our lives to the fullest.”

He added: “I’ve

0.01.647.731 I llama_perf_sampler_print:    sampling time =       1.18 ms /    71 runs   (    0.02 ms per token, 60067.68 tokens per second)
0.01.647.732 I llama_perf_context_print:        load time =     757.72 ms
0.01.647.733 I llama_perf_context_print: prompt eval time =      54.59 ms /     7 tokens (    7.80 ms per token,   128.23 tokens per second)
0.01.647.733 I llama_perf_context_print:        eval time =     822.47 ms /    63 runs   (   13.06 ms per token,    76.60 tokens per second)
0.01.647.734 I llama_perf_context_print:       total time =     880.38 ms /    70 tokens
0.01.647.907 I ggml_metal_free: deallocating

real	0m1.668s
user	0m0.111s
sys	0m0.181s
+ ./bin/llama-perplexity --model ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf -f ../models-mnt/wikitext/wikitext-2-raw/wiki.test-60.raw -ngl 99 -c 128 -b 128 --chunks 1
0.00.000.113 I build: 4367 (91a3530d) with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
0.00.009.284 I llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
0.00.015.285 I llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q6_k.gguf (version GGUF V3 (latest))
0.00.015.290 I llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
0.00.015.292 I llama_model_loader: - kv   0:                       general.architecture str              = gptneox
0.00.015.293 I llama_model_loader: - kv   1:                               general.type str              = model
0.00.015.293 I llama_model_loader: - kv   2:                               general.name str              = 1.4B
0.00.015.294 I llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
0.00.015.299 I llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
0.00.015.299 I llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
0.00.015.300 I llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
0.00.015.300 I llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
0.00.015.300 I llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
0.00.015.301 I llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
0.00.015.301 I llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
0.00.015.301 I llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
0.00.015.303 I llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
0.00.015.303 I llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
0.00.015.303 I llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
0.00.019.275 I llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
0.00.020.335 I llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
0.00.024.230 I llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
0.00.024.232 I llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
0.00.024.232 I llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
0.00.024.232 I llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
0.00.024.233 I llama_model_loader: - kv  21:               general.quantization_version u32              = 2
0.00.024.233 I llama_model_loader: - kv  22:                          general.file_type u32              = 18
0.00.024.234 I llama_model_loader: - type  f32:  194 tensors
0.00.024.234 I llama_model_loader: - type q6_K:   98 tensors
0.00.046.139 I llm_load_vocab: special tokens cache size = 25
0.00.052.342 I llm_load_vocab: token to piece cache size = 0.2984 MB
0.00.052.347 I llm_load_print_meta: format           = GGUF V3 (latest)
0.00.052.347 I llm_load_print_meta: arch             = gptneox
0.00.052.348 I llm_load_print_meta: vocab type       = BPE
0.00.052.348 I llm_load_print_meta: n_vocab          = 50304
0.00.052.348 I llm_load_print_meta: n_merges         = 50009
0.00.052.350 I llm_load_print_meta: vocab_only       = 0
0.00.052.350 I llm_load_print_meta: n_ctx_train      = 2048
0.00.052.350 I llm_load_print_meta: n_embd           = 2048
0.00.052.350 I llm_load_print_meta: n_layer          = 24
0.00.052.354 I llm_load_print_meta: n_head           = 16
0.00.052.354 I llm_load_print_meta: n_head_kv        = 16
0.00.052.355 I llm_load_print_meta: n_rot            = 32
0.00.052.355 I llm_load_print_meta: n_swa            = 0
0.00.052.355 I llm_load_print_meta: n_embd_head_k    = 128
0.00.052.355 I llm_load_print_meta: n_embd_head_v    = 128
0.00.052.357 I llm_load_print_meta: n_gqa            = 1
0.00.052.358 I llm_load_print_meta: n_embd_k_gqa     = 2048
0.00.052.358 I llm_load_print_meta: n_embd_v_gqa     = 2048
0.00.052.359 I llm_load_print_meta: f_norm_eps       = 1.0e-05
0.00.052.363 I llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
0.00.052.363 I llm_load_print_meta: f_clamp_kqv      = 0.0e+00
0.00.052.363 I llm_load_print_meta: f_max_alibi_bias = 0.0e+00
0.00.052.363 I llm_load_print_meta: f_logit_scale    = 0.0e+00
0.00.052.364 I llm_load_print_meta: n_ff             = 8192
0.00.052.364 I llm_load_print_meta: n_expert         = 0
0.00.052.364 I llm_load_print_meta: n_expert_used    = 0
0.00.052.364 I llm_load_print_meta: causal attn      = 1
0.00.052.364 I llm_load_print_meta: pooling type     = 0
0.00.052.364 I llm_load_print_meta: rope type        = 2
0.00.052.367 I llm_load_print_meta: rope scaling     = linear
0.00.052.368 I llm_load_print_meta: freq_base_train  = 10000.0
0.00.052.368 I llm_load_print_meta: freq_scale_train = 1
0.00.052.368 I llm_load_print_meta: n_ctx_orig_yarn  = 2048
0.00.052.368 I llm_load_print_meta: rope_finetuned   = unknown
0.00.052.368 I llm_load_print_meta: ssm_d_conv       = 0
0.00.052.369 I llm_load_print_meta: ssm_d_inner      = 0
0.00.052.369 I llm_load_print_meta: ssm_d_state      = 0
0.00.052.369 I llm_load_print_meta: ssm_dt_rank      = 0
0.00.052.369 I llm_load_print_meta: ssm_dt_b_c_rms   = 0
0.00.052.369 I llm_load_print_meta: model type       = 1.4B
0.00.052.369 I llm_load_print_meta: model ftype      = Q6_K
0.00.052.370 I llm_load_print_meta: model params     = 1.41 B
0.00.052.370 I llm_load_print_meta: model size       = 1.08 GiB (6.57 BPW) 
0.00.052.370 I llm_load_print_meta: general.name     = 1.4B
0.00.052.371 I llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
0.00.052.371 I llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
0.00.052.371 I llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
0.00.052.371 I llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
0.00.052.373 I llm_load_print_meta: LF token         = 128 'Ä'
0.00.052.373 I llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
0.00.052.373 I llm_load_print_meta: max token length = 1024
0.00.054.421 I llm_load_tensors: offloading 24 repeating layers to GPU
0.00.054.423 I llm_load_tensors: offloading output layer to GPU
0.00.054.423 I llm_load_tensors: offloaded 25/25 layers to GPU
0.00.054.433 I llm_load_tensors: Metal_Mapped model buffer size =  1108.66 MiB
0.00.054.435 I llm_load_tensors:   CPU_Mapped model buffer size =    80.60 MiB
...............................................................................
0.00.055.382 I llama_new_context_with_model: n_seq_max     = 1
0.00.055.383 I llama_new_context_with_model: n_ctx         = 128
0.00.055.383 I llama_new_context_with_model: n_ctx_per_seq = 128
0.00.055.383 I llama_new_context_with_model: n_batch       = 128
0.00.055.383 I llama_new_context_with_model: n_ubatch      = 128
0.00.055.383 I llama_new_context_with_model: flash_attn    = 0
0.00.055.384 I llama_new_context_with_model: freq_base     = 10000.0
0.00.055.384 I llama_new_context_with_model: freq_scale    = 1
0.00.055.384 W llama_new_context_with_model: n_ctx_per_seq (128) < n_ctx_train (2048) -- the full capacity of the model will not be utilized
0.00.055.385 I ggml_metal_init: allocating
0.00.055.390 I ggml_metal_init: found device: Apple M4
0.00.055.392 I ggml_metal_init: picking default device: Apple M4
0.00.056.015 I ggml_metal_init: using embedded metal library
0.00.058.489 I ggml_metal_init: GPU name:   Apple M4
0.00.058.491 I ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
0.00.058.492 I ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
0.00.058.492 I ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
0.00.058.492 I ggml_metal_init: simdgroup reduction   = true
0.00.058.492 I ggml_metal_init: simdgroup matrix mul. = true
0.00.058.493 I ggml_metal_init: has bfloat            = true
0.00.058.493 I ggml_metal_init: use bfloat            = true
0.00.058.493 I ggml_metal_init: hasUnifiedMemory      = true
0.00.058.494 I ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
0.00.067.962 I llama_kv_cache_init: kv_size = 128, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
0.00.069.284 I llama_kv_cache_init:      Metal KV buffer size =    24.00 MiB
0.00.069.286 I llama_new_context_with_model: KV self size  =   24.00 MiB, K (f16):   12.00 MiB, V (f16):   12.00 MiB
0.00.069.304 I llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
0.00.070.334 I llama_new_context_with_model:      Metal compute buffer size =    25.56 MiB
0.00.070.335 I llama_new_context_with_model:        CPU compute buffer size =     1.06 MiB
0.00.070.335 I llama_new_context_with_model: graph nodes  = 967
0.00.070.336 I llama_new_context_with_model: graph splits = 2
0.00.070.348 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 128
0.00.070.349 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
0.00.303.933 I 
0.00.303.961 I system_info: n_threads = 4 (n_threads_batch = 4) / 10 | Metal : EMBED_LIBRARY = 1 | BF16 = 1 | CPU : NEON = 1 | ARM_FMA = 1 | FP16_VA = 1 | MATMUL_INT8 = 1 | ACCELERATE = 1 | AARCH64_REPACK = 1 | 
0.00.303.973 I perplexity: tokenizing the input ..
0.00.312.050 I perplexity: tokenization took 8.075 ms
0.00.312.057 I perplexity: calculating perplexity over 1 chunks, n_ctx=128, batch_size=128, n_seq=1
0.00.451.375 I perplexity: 0.14 seconds per pass - ETA 0.00 minutes
[1]10.3179,
0.00.452.747 I Final estimate: PPL = 10.3179 +/- 3.28637

0.00.452.759 I llama_perf_context_print:        load time =     294.64 ms
0.00.452.760 I llama_perf_context_print: prompt eval time =     139.07 ms /   128 tokens (    1.09 ms per token,   920.39 tokens per second)
0.00.452.761 I llama_perf_context_print:        eval time =       0.00 ms /     1 runs   (    0.00 ms per token,      inf tokens per second)
0.00.452.761 I llama_perf_context_print:       total time =     148.83 ms /   129 tokens
0.00.453.062 I ggml_metal_free: deallocating

real	0m0.468s
user	0m0.081s
sys	0m0.054s
```
- save-load-state: 
```
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0
main: build = 4367 (91a3530d)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x125607590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x125607ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x125608250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x125608800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x125608db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x125609360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x125609910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x125609ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x12560a470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x12560a970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x12560ae70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x12560b370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x12560be90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x12560c640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x12560ce50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x12560d570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x12560dc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x12560e3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x12560ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x12560f2a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x12560f9c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x1256100e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x125610800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x1256110a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x1256117c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x125611a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x125612090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x125612d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x125613240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x125613500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x1256139a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x125613c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x1256144f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x125614a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x125614cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x125615190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x125615630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x125615ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x125615f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x125616410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x1256168b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x125616d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x1256171f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x125617690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x125617950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x125617f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x125618570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x125618e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x1256194a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x125619ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x12561a0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x12561a6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x12561ace0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x12561b2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x12561bae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x12561bf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x12561c420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x12561c6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x12561ccf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x12561d4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x12561d7a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x12561dc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x12561e0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x12561e580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x12561ea20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x12561eec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x12561f360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x12561f800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x12561fca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x125620140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x1256205e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x125620a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x125620f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x125621470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x1256219c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x125621f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x125622460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x1256229b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x125622f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x125623450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x1256239a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x125623ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x125624440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x125624990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x125624ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x125625430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x125625980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x125625ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x125626420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x125626970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x125626ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x125627410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x125627960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x125627eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x125628400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x125628950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x125628ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x125618b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x125629310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x125629ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x12562a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x12562a560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x12562aab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x12562b000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x12562b550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x12562baa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x12562bff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x12562c540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x12562ca90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x12562cfe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x12562d530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x12562da80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x12562dfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x12562e470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x12562e910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x12562edb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x12562f250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x12562f6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x12562fb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x125630030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x1256304d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x125630970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x125630e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x1256312b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x125631750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x125631bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x125632090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x125632530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x1256329d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x125632e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x125633310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x1256337b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x125633c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x1256340f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x125634590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x125634a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x125634ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x125635370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x125635810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x125635cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x125636150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x1256365f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x125636a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x125636f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x1256373d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x125637870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x125637d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x1256381b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x125638650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x125638af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x125638f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x125639430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x1256398d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x125639d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x12563a210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x12563a6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x12563ab50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x12563aff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x12563b490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x12563b930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x12563bdd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x12563c270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x12563c710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x12563cbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x12563d050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x12563d4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x12563d990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x12563de30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x12563e2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x12563e770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x12563ec10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x12563f0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x12563f550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x12563f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x12563fe90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x125640330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x1256407d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x125640c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x125641110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x1256415b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x125641a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x125641ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x125642390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x125642830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x125642cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x125643170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x125643610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x125643ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x125643f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x1256443f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x125644890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x125644d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x1256451d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x125645720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x125645c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x1256461c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x125646710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x1256469d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x125646fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x1256475f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x125647c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x1256483f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x125648890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x125648b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x125649160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x125649770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x125649f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x12564a400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x12564a8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x12564ad40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x12564b4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x12564ba40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x12564bf90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x12564c4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x12564ca30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x12564cf80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x12564d4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x12564da20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x12564df70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x12564e4c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x12564ea10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x12564ef60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x12564f4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x12564fa00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x12564ff50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x1256504a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x1256509f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x125650f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x125651490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x1256519e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x125651f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x125652480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x1256529d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x125652f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x125653470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x1256539c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x125653f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x125654460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x1256549b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x125654f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x125655450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x1256559a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x125655ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x125656440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x125656990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x125656ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x125657430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x125657980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x125657ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x125658420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x125658970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x125658ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x125659410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x125659960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x125659eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x12565a400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x12565a950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x12565aea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x12565b3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x12565b940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x12565be90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x12565c3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x12565c930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x12565ce80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x12565d3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x12565d920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x12565de70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x12565e310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x12565e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x12565ec50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x12565f0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x12565f590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x12565fa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x12565fed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x125660370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x125660810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x125660cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x125661150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x1256615f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x125661a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x125661f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x1256623d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x125662920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x125663040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x125663760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x125663e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x1256645a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x125664860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x125665050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x125665310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x125665920 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
0.00.144.891 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.144.895 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x115f04b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x115f04fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x115f05430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x115f058a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x115f05d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x115f06180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x115f065f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x115f06a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x115f06ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x115f07340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x115f077b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x115f07ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x115f089c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x115f09170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x115f09980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x115f0a0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x115f0a7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x115f0aee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x115f0b600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x115f0bd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x115f0c450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x115f0cb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x115f0d290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x115f0d9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x115f0e0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x115f0e390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x115f0e650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x115f0eac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x115f0ef30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x115f0f3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x115f0f810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x115f0fd40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x115f101b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x115f10470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x115f108e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x115f10d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x115f111c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x115f11630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x115f11aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x115f11f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x115f12380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x115f127f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x115f12c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x115f130d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x115f13540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x115f139b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x115f13e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x115f14290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x115f14700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x115f14b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x115f14fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x115f15450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x115f158c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x115f15d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x115f161a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x115f16610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x115f16b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x115f17080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x115f174f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x115f17960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x115f17dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x115f18240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x115f186b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x115f18b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x115f18f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x115f19400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x115f19870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x115f19ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x115f1a150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x115f1a5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x115f1aa30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x115f1aea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x115f1b310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x115f1b780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x115f1bbf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x115f1c060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x115f1c4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x115f1c940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x115f1cdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x115f1d220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x115f1d690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x115f1db00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x115f1df70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x115f1e3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x115f1e850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x115f1ecc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x115f1f130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x115f1f5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x115f1fa10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x115f1fe80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x115f202f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x115f20760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x115f20bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x115f21040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x115f214b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x115f21920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x115f21d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x115f22200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x115f22670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x115f22ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x115f22f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x115f233c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x115f23830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x115f23ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x115f24110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x115f24580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x115f249f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x115f24e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x115f252d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x115f25740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x115f25bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x115f26020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x115f26490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x115f26900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x115f26d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x115f271e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x115f27650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x115f27ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x115f27f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x115f283a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x115f28810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x115f28c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x115f290f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x115f29560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x115f299d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x115f29e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x115f2a2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x115f2a720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x115f2ab90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x115f2b000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x115f2b470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x115f2b8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x115f2bd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x115f2c1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x115f2c630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x115f2caa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x115f2cf10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x115f2d380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x115f2d7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x115f2dc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x115f2e0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x115f2e540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x115f2e9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x115f2ee20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x115f2f290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x115f2f700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x115f2fb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x115f2ffe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x115f30450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x115f308c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x115f30d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x115f311a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x115f31610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x115f31a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x115f31ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x115f32360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x115f327d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x115f32c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x115f330b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x115f33520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x115f33990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x115f33e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x115f34270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x115f346e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x115f34b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x115f34fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x115f35430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x115f358a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x115f35d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x115f36180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x115f365f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x115f36a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x115f36ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x115f37340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x115f377b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x115f37c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x115f38090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x115f38500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x115f38970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x115f38de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x115f39250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x115f396c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x115f39b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x115f39fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x115f3a410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x115f3a880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x115f3acf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x115f3b160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x115f3b5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x115f3ba40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x115f3beb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x115f3c320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x115f3c790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x115f3cc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x115f3d070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x115f3d4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x115f3d950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x115f3ddc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x115f3e230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x115f3e6a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x115f3eb10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x115f3ef80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x115f3f3f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x115f3f860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x115f3fcd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x115f40140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x115f405b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x115f40b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x115f40fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x115f41420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x115f41f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x115f42230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x115f424f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x115f42960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x115f42dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x115f43240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x115f436b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x115f43b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x115f43f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x115f44400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x115f44870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x115f44ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x115f45150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x115f455c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x115f45a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x115f45ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x115f46310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x115f46780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x115f46bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x115f47060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x115f474d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x115f47940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x115f47db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x115f48220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x115f48690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x115f48b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x115f48f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x115f493e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x115f49850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x115f49cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x115f4a130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x115f4a5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x115f4aa10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x115f4ae80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x115f4b2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x115f4b760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x115f4bbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x115f4c040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x115f4c4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x115f4c920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x115f4cd90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x115f4d200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x115f4d670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x115f4dae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x115f4df50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x115f4e3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x115f4e830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x115f4eca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x115f4f110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x115f4f580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x115f4f9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x115f4fe60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x115f502d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x115f50740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x115f50bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x115f51020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x115f51490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x115f51900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x115f51d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x115f521e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x115f52650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x115f52ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x115f52f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x115f533a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x115f53810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x115f53c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x115f540f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x115f54560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x115f549d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x115f54e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x115f552b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x115f55720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x115f55b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x115f56600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x115f56d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x115f57440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x115f57b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x115f57e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x115f58290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x115f58890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x115f58ea0 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 0
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x135608480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x135608bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x135609030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x1356094a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x135609910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x135609d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x13560a1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x13560a660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x135606d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x1356071c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x135607630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x13560ad70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x13560b890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x13560c040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x13560c850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x13560cf70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x13560d690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x13560ddb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x13560e4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x13560ec00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x13560f320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x13560fa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x135610160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x135610880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x135610fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x135611260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x135611520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x135611990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x135611e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x135612270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x1356126e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x135612c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x135613080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x135613340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x1356137b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x135613c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x135614090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x135614500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x135614970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x135614de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x135615250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x1356156c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x135615b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x135615fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x135616410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x135616880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x135616cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x135617160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x1356175d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x135617a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x135617eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x135618320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x135618790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x135618c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x135619070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x1356194e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x135619a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x135619f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x13561a3c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x13561a830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x13561aca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x13561b110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x13561b580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x13561b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x13561be60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x13561c2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x13561c740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x13561cbb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x13561d020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x13561d490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x13561d900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x13561dd70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x13561e1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x13561e650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x13561eac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x13561ef30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x13561f3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x13561f810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x13561fc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x1356200f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x135620560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x1356209d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x135620e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x1356212b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x135621720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x135621b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x135622000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x135622470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x1356228e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x135622d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x1356231c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x135623630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x135623aa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x135623f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x135624380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x1356247f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x135624c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x1356250d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x135625540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x1356259b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x135625e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x135626290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x135626700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x135626b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x135626fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x135627450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x1356278c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x135627d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x1356281a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x135628610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x135628a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x135628ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x135629360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x1356297d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x135629c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x13562a0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x13562a520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x13562a990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x13562ae00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x13562b270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x13562b6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x13562bb50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x13562bfc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x13562c430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x13562c8a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x13562cd10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x13562d180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x13562d5f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x13562da60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x13562ded0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x13562e340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x13562e7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x13562ec20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x13562f090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x13562f500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x13562f970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x13562fde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x135630250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x1356306c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x135630b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x135630fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x135631410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x135631880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x135631cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x135632160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x1356325d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x135632a40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x135632eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x135633320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x135633790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x135633c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x135634070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x1356344e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x135634950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x135634dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x135635230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x1356356a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x135635b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x135635f80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x1356363f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x135636860 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x135636cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x135637140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x1356375b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x135637a20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x135637e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x135638300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x135638770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x135638be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x135639050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x1356394c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x135639930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x135639da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x13563a210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x13563a680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x13563aaf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x13563af60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x13563b3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x13563b840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x13563bcb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x13563c120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x13563c590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x13563ca00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x13563ce70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x13563d2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x13563d750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x13563dbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x13563e030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x13563e4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x13563e910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x13563ed80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x13563f1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x13563f660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x13563fad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x13563ff40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x1356403b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x135640820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x135640c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x135641100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x135641570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x1356419e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x135641e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x1356422c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x135642730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x135642ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x135643010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x135643480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x135643a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x135643e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x1356442f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x135644e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x135645100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x1356453c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x135645830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x135645ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x135646110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x135646580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x1356469f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x135646e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x1356472d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x135647740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x135647bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x135648020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x135648490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x135648900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x135648d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x1356491e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x135649650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x135649ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x135649f30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x13564a3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x13564a810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x13564ac80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x13564b0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x13564b560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x13564b9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x13564be40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x13564c2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x13564c720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x13564cb90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x13564d000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x13564d470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x13564d8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x13564dd50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x13564e6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x13564e980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x13564edf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x13564f260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x13564f6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x13564fb40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x13564ffb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x135650420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x135650890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x135650d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x135651170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x1356515e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x135651a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x135651ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x135652330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x1356527a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x135652c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x135653080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x1356534f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x135653960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x135653dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x135654240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x1356546b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x135654b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x135654f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x135655400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x135655870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x135655ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x135656150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x1356565c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x135656a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x135656ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x135657310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x135657780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x135657bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x135658060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x1356584d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x135658940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x135658db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x135659820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x135659f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x13565a660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x13565ad80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x13565b040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x13565b4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x13565bab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x13565c0c0 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 967
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have said something about the lazy

real	0m1.801s
user	0m0.295s
sys	0m0.297s
+ ./bin/llama-save-load-state --model ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf -ngl 99 -c 0 -fa
main: build = 4367 (91a3530d)
main: built with Apple clang version 16.0.0 (clang-1600.0.26.4) for arm64-apple-darwin24.1.0
llama_load_model_from_file: using device Metal (Apple M4) - 10922 MiB free
llama_model_loader: loaded meta data with 23 key-value pairs and 292 tensors from ../models-mnt/pythia/1.4B/ggml-model-q4_0.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = gptneox
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = 1.4B
llama_model_loader: - kv   3:                           general.finetune str              = 1.4B
llama_model_loader: - kv   4:                         general.size_label str              = 1.4B
llama_model_loader: - kv   5:                     gptneox.context_length u32              = 2048
llama_model_loader: - kv   6:                   gptneox.embedding_length u32              = 2048
llama_model_loader: - kv   7:                        gptneox.block_count u32              = 24
llama_model_loader: - kv   8:                gptneox.feed_forward_length u32              = 8192
llama_model_loader: - kv   9:               gptneox.rope.dimension_count u32              = 32
llama_model_loader: - kv  10:               gptneox.attention.head_count u32              = 16
llama_model_loader: - kv  11:              gptneox.use_parallel_residual bool             = true
llama_model_loader: - kv  12:       gptneox.attention.layer_norm_epsilon f32              = 0.000010
llama_model_loader: - kv  13:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  14:                         tokenizer.ggml.pre str              = olmo
llama_model_loader: - kv  15:                      tokenizer.ggml.tokens arr[str,50304]   = ["<|endoftext|>", "<|padding|>", "!",...
llama_model_loader: - kv  16:                  tokenizer.ggml.token_type arr[i32,50304]   = [3, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
llama_model_loader: - kv  17:                      tokenizer.ggml.merges arr[str,50009]   = ["Ġ Ġ", "Ġ t", "Ġ a", "h e", "i n...
llama_model_loader: - kv  18:                tokenizer.ggml.bos_token_id u32              = 0
llama_model_loader: - kv  19:                tokenizer.ggml.eos_token_id u32              = 0
llama_model_loader: - kv  20:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  21:               general.quantization_version u32              = 2
llama_model_loader: - kv  22:                          general.file_type u32              = 2
llama_model_loader: - type  f32:  194 tensors
llama_model_loader: - type q4_0:   97 tensors
llama_model_loader: - type q6_K:    1 tensors
llm_load_vocab: control token:      1 '<|padding|>' is not marked as EOG
llm_load_vocab: special tokens cache size = 25
llm_load_vocab: token to piece cache size = 0.2984 MB
llm_load_print_meta: format           = GGUF V3 (latest)
llm_load_print_meta: arch             = gptneox
llm_load_print_meta: vocab type       = BPE
llm_load_print_meta: n_vocab          = 50304
llm_load_print_meta: n_merges         = 50009
llm_load_print_meta: vocab_only       = 0
llm_load_print_meta: n_ctx_train      = 2048
llm_load_print_meta: n_embd           = 2048
llm_load_print_meta: n_layer          = 24
llm_load_print_meta: n_head           = 16
llm_load_print_meta: n_head_kv        = 16
llm_load_print_meta: n_rot            = 32
llm_load_print_meta: n_swa            = 0
llm_load_print_meta: n_embd_head_k    = 128
llm_load_print_meta: n_embd_head_v    = 128
llm_load_print_meta: n_gqa            = 1
llm_load_print_meta: n_embd_k_gqa     = 2048
llm_load_print_meta: n_embd_v_gqa     = 2048
llm_load_print_meta: f_norm_eps       = 1.0e-05
llm_load_print_meta: f_norm_rms_eps   = 0.0e+00
llm_load_print_meta: f_clamp_kqv      = 0.0e+00
llm_load_print_meta: f_max_alibi_bias = 0.0e+00
llm_load_print_meta: f_logit_scale    = 0.0e+00
llm_load_print_meta: n_ff             = 8192
llm_load_print_meta: n_expert         = 0
llm_load_print_meta: n_expert_used    = 0
llm_load_print_meta: causal attn      = 1
llm_load_print_meta: pooling type     = 0
llm_load_print_meta: rope type        = 2
llm_load_print_meta: rope scaling     = linear
llm_load_print_meta: freq_base_train  = 10000.0
llm_load_print_meta: freq_scale_train = 1
llm_load_print_meta: n_ctx_orig_yarn  = 2048
llm_load_print_meta: rope_finetuned   = unknown
llm_load_print_meta: ssm_d_conv       = 0
llm_load_print_meta: ssm_d_inner      = 0
llm_load_print_meta: ssm_d_state      = 0
llm_load_print_meta: ssm_dt_rank      = 0
llm_load_print_meta: ssm_dt_b_c_rms   = 0
llm_load_print_meta: model type       = 1.4B
llm_load_print_meta: model ftype      = Q4_0
llm_load_print_meta: model params     = 1.41 B
llm_load_print_meta: model size       = 786.31 MiB (4.66 BPW) 
llm_load_print_meta: general.name     = 1.4B
llm_load_print_meta: BOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOS token        = 0 '<|endoftext|>'
llm_load_print_meta: EOT token        = 0 '<|endoftext|>'
llm_load_print_meta: UNK token        = 0 '<|endoftext|>'
llm_load_print_meta: LF token         = 128 'Ä'
llm_load_print_meta: EOG token        = 0 '<|endoftext|>'
llm_load_print_meta: max token length = 1024
llm_load_tensors: tensor 'token_embd.weight' (q4_0) (and 0 others) cannot be used with preferred buffer type CPU_AARCH64, using CPU instead
ggml_backend_metal_log_allocated_size: allocated buffer, size =   786.34 MiB, (  786.42 / 10922.67)
llm_load_tensors: offloading 24 repeating layers to GPU
llm_load_tensors: offloading output layer to GPU
llm_load_tensors: offloaded 25/25 layers to GPU
llm_load_tensors: Metal_Mapped model buffer size =   786.33 MiB
llm_load_tensors:   CPU_Mapped model buffer size =    55.27 MiB
............................................................................
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x14600a1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x14600a8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x14600ae90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x14600b440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x14600b9f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x14600bfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x14600c550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x14600cb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x14600d0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x14600d5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x14600dab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x14600dfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x14600ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x14600f280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x14600fa90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x1460101b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x1460108d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x146010ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x146011710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x146011ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x146012600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x146012d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x146013440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x146013ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x146014400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x1460146c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x146014cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x146015940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x146015e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x146016140 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x1460165e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x1460168a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x146017130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x146017670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x146017930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x146017dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x146018270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x146018710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x146018bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x146019050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x1460194f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x146019990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x146019e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x14601a2d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x14601a590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x14601aba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x14601b1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x14601bad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x14601c0e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x14601c6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x14601cd00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x14601d310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x14601d920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x14601df30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x14601e720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x14601ebc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x14601f060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x14601f320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x14601f930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x146020120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x1460203e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x146020880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x146020d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x1460211c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x146021660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x146021b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x146021fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x146022440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x1460228e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x146022d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x146023220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x1460236c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x146023b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x1460240b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x146024600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x146024b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x1460250a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x1460255f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x146025b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x146026090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x1460265e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x146026b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x146027080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x1460275d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x146027b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x146028070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x1460285c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x146028b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x146029060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x1460295b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x146029b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x14602a050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x14602a5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x14602aaf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x14602b040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x14602b590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x14602bae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x14601b7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x14602bf50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x14602c700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x14602cc50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x14602d1a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x14602d6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x14602dc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x14602e190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x14602e6e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x14602ec30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x14602f180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x14602f6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x14602fc20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x146030170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x1460306c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x146030c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x1460310b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x146031550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x1460319f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x146031e90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x146032330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x1460327d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x146032c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x146033110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x1460335b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x146033a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x146033ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x146034390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x146034830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x146034cd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x146035170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x146035610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x146035ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x146035f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x1460363f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x146036890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x146036d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x1460371d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x146037670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x146037b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x146037fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x146038450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x1460388f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x146038d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x146039230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x1460396d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x146039b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x14603a010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x14603a4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x14603a950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x14603adf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x14603b290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x14603b730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x14603bbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x14603c070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x14603c510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x14603c9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x14603ce50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x14603d2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x14603d790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x14603dc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x14603e0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x14603e570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x14603ea10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x14603eeb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x14603f350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x14603f7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x14603fc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x146040130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x1460405d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x146040a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x146040f10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x1460413b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x146041850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x146041cf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x146042190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x146042630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x146042ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x146042f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x146043410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x1460438b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x146043d50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x1460441f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x146044690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x146044b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x146044fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x146045470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x146045910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x146045db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x146046250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x1460466f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x146046b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x146047030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x1460474d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x146047970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x146047e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x146048360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x1460488b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x146048e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x146049350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x146049610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x146049c20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x14604a230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x14604a840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x14604b030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x14604b4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x14604b790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x14604bda0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x14604c3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x14604cba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x14604d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x14604d4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x14604d980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x14604e130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x14604e680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x14604ebd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x14604f120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x14604f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x14604fbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x146050110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x146050660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x146050bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x146051100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x146051650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x146051ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x1460520f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x146052640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x146052b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x1460530e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x146053630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x146053b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x1460540d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x146054620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x146054b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x1460550c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x146055610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x146055b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x1460560b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x146056600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x146056b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x1460570a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x1460575f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x146057b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x146058090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x1460585e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x146058b30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x146059080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x1460595d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x146059b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x14605a070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x14605a5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x14605ab10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x14605b060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x14605b5b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x14605bb00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x14605c050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x14605c5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x14605caf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x14605d040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x14605d590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x14605dae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x14605e030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x14605e580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x14605ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x14605f020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x14605f570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x14605fac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x146060010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x146060560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x146060ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x146060f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x1460613f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x146061890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x146061d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x1460621d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x146062670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x146062b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x146062fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x146063450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x1460638f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x146063d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x146064230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x1460646d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x146064b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x146065010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x146065560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x146065c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x1460663a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x146066ac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x1460671e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x1460674a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x146067c90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x146067f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x146068560 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
0.00.095.174 I common_init_from_params: setting dry_penalty_last_n to ctx_size = 2048
0.00.095.177 W common_init_from_params: warming up the model with an empty run - please wait ... (--no-warmup to disable)
main : serialized state into 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x134f04dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x134f05240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x134f056b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x134f05b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x134f05f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x134f06400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x134f06870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x134f06ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x134f07150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x134f075c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x134f07a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x134f08120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x134f08c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x134f093f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x134f09c00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x134f0a320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x134f0aa40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x134f0b160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x134f0b880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x134f0bfb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x134f0c6d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x134f0cdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x134f0d510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x134f0dc30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x134f0e350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x134f0e610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x134f0e8d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x134f0ed40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x134f0f1b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x134f0f620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x134f0fa90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x134f0ffc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x134f10430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x134f106f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x134f10b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x134f10fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x134f11440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x134f118b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x134f11d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x134f12190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x134f12600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x134f12a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x134f12ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x134f13350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x134f137c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x134f13c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x134f140a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x134f14510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x134f14980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x134f14df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x134f15260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x134f156d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x134f15b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x134f15fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x134f16420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x134f16890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x134f16e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x134f17300 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x134f17770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x134f17be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x134f18050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x134f184c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x134f18930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x134f18da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x134f19210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x134f19680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x134f19af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x134f19f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x134f1a3d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x134f1a840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x134f1acb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x134f1b120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x134f1b590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x134f1ba00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x134f1be70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x134f1c2e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x134f1c750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x134f1cbc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x134f1d030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x134f1d4a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x134f1d910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x134f1dd80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x134f1e1f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x134f1e660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x134f1ead0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x134f1ef40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x134f1f3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x134f1f820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x134f1fc90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x134f20100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x134f20570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x134f209e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x134f20e50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x134f212c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x134f21730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x134f21ba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x134f22010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x134f22480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x134f228f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x134f22d60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x134f231d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x134f23640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x134f23ab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x134f23f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x134f24390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x134f24800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x134f24c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x134f250e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x134f25550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x134f259c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x134f25e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x134f262a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x134f26710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x134f26b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x134f26ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x134f27460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x134f278d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x134f27d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x134f281b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x134f28620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x134f28a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x134f28f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x134f29370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x134f297e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x134f29c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x134f2a0c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x134f2a530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x134f2a9a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x134f2ae10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x134f2b280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x134f2b6f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x134f2bb60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x134f2bfd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x134f2c440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x134f2c8b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x134f2cd20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x134f2d190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x134f2d600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x134f2da70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x134f2dee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x134f2e350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x134f2e7c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x134f2ec30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x134f2f0a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x134f2f510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x134f2f980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x134f2fdf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x134f30260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x134f306d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x134f30b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x134f30fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x134f31420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x134f31890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x134f31d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x134f32170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x134f325e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x134f32a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x134f32ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x134f33330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x134f337a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x134f33c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x134f34080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x134f344f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x134f34960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x134f34dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x134f35240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x134f356b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x134f35b20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x134f35f90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x134f36400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x134f36870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x134f36ce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x134f37150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x134f375c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x134f37a30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x134f37ea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x134f38310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x134f38780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x134f38bf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x134f39060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x134f394d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x134f39940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x134f39db0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x134f3a220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x134f3a690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x134f3ab00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x134f3af70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x134f3b3e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x134f3b850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x134f3bcc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x134f3c130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x134f3c5a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x134f3ca10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x134f3ce80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x134f3d2f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x134f3d760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x134f3dbd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x134f3e040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x134f3e4b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x134f3e920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x134f3ed90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x134f3f200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x134f3f670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x134f3fae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x134f3ff50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x134f403c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x134f40830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x134f40dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x134f41230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x134f416a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x134f421f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x134f424b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x134f42770 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x134f42be0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x134f43050 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x134f434c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x134f43930 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x134f43da0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x134f44210 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x134f44680 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x134f44af0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x134f44f60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x134f453d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x134f45840 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x134f45cb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x134f46120 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x134f46590 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x134f46a00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x134f46e70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x134f472e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x134f47750 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x134f47bc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x134f48030 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x134f484a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x134f48910 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x134f48d80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x134f491f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x134f49660 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x134f49ad0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x134f49f40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x134f4a3b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x134f4a820 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x134f4ac90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x134f4b100 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x134f4b570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x134f4b9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x134f4be50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x134f4c2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x134f4c730 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x134f4cba0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x134f4d010 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x134f4d480 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x134f4d8f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x134f4dd60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x134f4e1d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x134f4e640 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x134f4eab0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x134f4ef20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x134f4f390 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x134f4f800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x134f4fc70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x134f500e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x134f50550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x134f509c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x134f50e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x134f512a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x134f51710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x134f51b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x134f51ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x134f52460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x134f528d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x134f52d40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x134f531b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x134f53620 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x134f53a90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x134f53f00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x134f54370 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x134f547e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x134f54c50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x134f550c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x134f55530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x134f559a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x134f55e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x134f56880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x134f56fa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x134f576c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x134f57de0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x134f580a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x134f58510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x134f58b10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x134f59120 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
ggml_metal_free: deallocating
llama_new_context_with_model: n_seq_max     = 1
llama_new_context_with_model: n_ctx         = 2048
llama_new_context_with_model: n_ctx_per_seq = 2048
llama_new_context_with_model: n_batch       = 2048
llama_new_context_with_model: n_ubatch      = 512
llama_new_context_with_model: flash_attn    = 1
llama_new_context_with_model: freq_base     = 10000.0
llama_new_context_with_model: freq_scale    = 1
ggml_metal_init: allocating
ggml_metal_init: found device: Apple M4
ggml_metal_init: picking default device: Apple M4
ggml_metal_init: using embedded metal library
ggml_metal_init: GPU name:   Apple M4
ggml_metal_init: GPU family: MTLGPUFamilyApple9  (1009)
ggml_metal_init: GPU family: MTLGPUFamilyCommon3 (3003)
ggml_metal_init: GPU family: MTLGPUFamilyMetal3  (5001)
ggml_metal_init: simdgroup reduction   = true
ggml_metal_init: simdgroup matrix mul. = true
ggml_metal_init: has bfloat            = true
ggml_metal_init: use bfloat            = true
ggml_metal_init: hasUnifiedMemory      = true
ggml_metal_init: recommendedMaxWorkingSetSize  = 11453.25 MB
ggml_metal_init: loaded kernel_add                                    0x146024c70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_add_row                                0x1460250e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub                                    0x146025550 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sub_row                                0x1460259c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul                                    0x146025e30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_row                                0x1460262a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div                                    0x146026710 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_div_row                                0x146026b80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f32                             0x146026ff0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_f16                             0x146027460 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i32                             0x1460278d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_repeat_i16                             0x146027eb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale                                  0x1460287a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_scale_4                                0x146028f20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_clamp                                  0x146029700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_tanh                                   0x146029df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_relu                                   0x14602a4e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sigmoid                                0x14602abd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu                                   0x14602b2c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_4                                 0x14602bc40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick                             0x14602c330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_gelu_quick_4                           0x14602ca20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu                                   0x14602d110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_silu_4                                 0x14602d800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_elu                                    0x14602def0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16                           0x14602e360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f16_4                         0x14602e7d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32                           0x14602ec40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_soft_max_f32_4                         0x14602f0b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf                          0x14602f520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_diag_mask_inf_8                        0x14602f990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f32                           0x14602fe00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_f16                           0x146030270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_bf16                          0x146030530 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_0                          0x1460309a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_1                          0x146030e10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_0                          0x146031280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_1                          0x1460316f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q8_0                          0x146031b60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q2_K                          0x146031fd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q3_K                          0x146032440 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q4_K                          0x1460328b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q5_K                          0x146032d20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_q6_K                          0x146033190 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xxs                       0x146033600 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_xs                        0x146033a70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_xxs                       0x146033ee0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq3_s                         0x146034350 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq2_s                         0x1460347c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_s                         0x146034c30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq1_m                         0x1460350a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_nl                        0x146035510 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_iq4_xs                        0x146035980 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_get_rows_i32                           0x146035df0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rms_norm                               0x146036260 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_group_norm                             0x1460366d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_norm                                   0x146036b40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_conv_f32                           0x146036fb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_ssm_scan_f32                           0x146037420 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f32_f32                         0x146037890 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32                        0x146037d00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_1row                   0x146038170 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_f32_l4                     0x1460385e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_bf16_bf16                       0x146038a50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32                         0x146038ec0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_1row                    0x146039330 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f32_l4                      0x1460397a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_f16_f16                         0x146039c10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_0_f32                        0x14603a080 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_1_f32                        0x14603a4f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_0_f32                        0x14603a960 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_1_f32                        0x14603add0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q8_0_f32                        0x14603b240 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_2                0x14603b6b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_3                0x14603bb20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_4                0x14603bf90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_f16_f32_r1_5                0x14603c400 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_2               0x14603c870 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_3               0x14603cce0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_4               0x14603d150 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_0_f32_r1_5               0x14603d5c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_2               0x14603da30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_3               0x14603dea0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_4               0x14603e310 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_1_f32_r1_5               0x14603e780 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_2               0x14603ebf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_3               0x14603f060 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_4               0x14603f4d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_0_f32_r1_5               0x14603f940 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_2               0x14603fdb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_3               0x146040220 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_4               0x146040690 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_1_f32_r1_5               0x146040b00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_2               0x146040f70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_3               0x1460413e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_4               0x146041850 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q8_0_f32_r1_5               0x146041cc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_2               0x146042130 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_3               0x1460425a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_4               0x146042a10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q4_K_f32_r1_5               0x146042e80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_2               0x1460432f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_3               0x146043760 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_4               0x146043bd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q5_K_f32_r1_5               0x146044040 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_2               0x1460444b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_3               0x146044920 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_4               0x146044d90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_q6_K_f32_r1_5               0x146045200 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_2             0x146045670 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_3             0x146045ae0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_4             0x146045f50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_ext_iq4_nl_f32_r1_5             0x1460463c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q2_K_f32                        0x146046830 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q3_K_f32                        0x146046ca0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q4_K_f32                        0x146047110 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q5_K_f32                        0x146047580 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_q6_K_f32                        0x1460479f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xxs_f32                     0x146047e60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_xs_f32                      0x1460482d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_xxs_f32                     0x146048740 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq3_s_f32                       0x146048bb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq2_s_f32                       0x146049020 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_s_f32                       0x146049490 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq1_m_f32                       0x146049900 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_nl_f32                      0x146049d70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_iq4_xs_f32                      0x14604a1e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f32_f32                      0x14604a650 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_f16_f32                      0x14604aac0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_bf16_f32                     0x14604af30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_0_f32                     0x14604b3a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_1_f32                     0x14604b810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_0_f32                     0x14604bc80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_1_f32                     0x14604c0f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q8_0_f32                     0x14604c560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q2_K_f32                     0x14604c9d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q3_K_f32                     0x14604ce40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q4_K_f32                     0x14604d2b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q5_K_f32                     0x14604d720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_q6_K_f32                     0x14604db90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xxs_f32                  0x14604e000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_xs_f32                   0x14604e470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_xxs_f32                  0x14604e8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq3_s_f32                    0x14604ed50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq2_s_f32                    0x14604f1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_s_f32                    0x14604f630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq1_m_f32                    0x14604faa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_nl_f32                   0x14604ff10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mv_id_iq4_xs_f32                   0x146050380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f32_f32                         0x1460507f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_f16_f32                         0x146050c60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_bf16_f32                        0x1460510d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_0_f32                        0x146051540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_1_f32                        0x1460519b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_0_f32                        0x146051e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_1_f32                        0x146052290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q8_0_f32                        0x146052700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q2_K_f32                        0x146052b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q3_K_f32                        0x146052fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q4_K_f32                        0x146053450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q5_K_f32                        0x1460538c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_q6_K_f32                        0x146053d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xxs_f32                     0x1460541a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_xs_f32                      0x146054610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_xxs_f32                     0x146054a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq3_s_f32                       0x146054ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq2_s_f32                       0x146055360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_s_f32                       0x1460557d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq1_m_f32                       0x146055c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_nl_f32                      0x1460560b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_iq4_xs_f32                      0x146056520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f32_f32                      0x146056990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_f16_f32                      0x146056e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_bf16_f32                     0x146057270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_0_f32                     0x1460576e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_1_f32                     0x146057b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_0_f32                     0x146057fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_1_f32                     0x146058430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q8_0_f32                     0x1460588a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q2_K_f32                     0x146058d10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q3_K_f32                     0x146059180 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q4_K_f32                     0x1460595f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q5_K_f32                     0x146059a60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_q6_K_f32                     0x146059ed0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xxs_f32                  0x14605a340 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_xs_f32                   0x14605a7b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_xxs_f32                  0x14605ac20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq3_s_f32                    0x14605b090 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq2_s_f32                    0x14605b500 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_s_f32                    0x14605b970 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq1_m_f32                    0x14605bde0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_nl_f32                   0x14605c250 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_mul_mm_id_iq4_xs_f32                   0x14605c6c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f32                          0x14605cb30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_norm_f16                          0x14605cfa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f32                          0x14605d410 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_rope_neox_f16                          0x14605d880 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f16                             0x14605dcf0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_f32                             0x14605e160 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f16                         0x14605e5d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_im2col_ext_f32                         0x14605ea40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f32_f32              0x14605eeb0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_conv_transpose_1d_f16_f32              0x14605f320 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_upscale_f32                            0x14605f790 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_f32                                0x14605fc00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pad_reflect_1d_f32                     0x146060070 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_timestep_embedding_f32                 0x1460604e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_arange_f32                             0x146060950 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_asc                    0x146060dc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argsort_f32_i32_desc                   0x146061230 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_leaky_relu_f32                         0x1460619b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h64                 0x146061e20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h80                 0x146062290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h96                 0x146062700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h112                0x146062b70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h128                0x146062fe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_f16_h256                0x146063450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h64                0x1460638c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h80                0x146063d30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h96                0x1460641a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h112               0x146064610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h128               0x146064a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_bf16_h256               0x146064ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h64                0x146065360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h80                0x1460657d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h96                0x146065c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h112               0x1460660b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h128               0x146066520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_0_h256               0x146066990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h64                0x146066e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h80                0x146067270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h96                0x1460676e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h112               0x146067b50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h128               0x146067fc0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q4_1_h256               0x146068430 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h64                0x14600b280 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h80                0x14600ace0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h96                0x146009800 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h112               0x14600a380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h128               0x146017810 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_0_h256               0x146017c80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h64                0x1460180f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h80                0x146018560 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h96                0x1460189d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h112               0x146018e40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h128               0x1460192b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q5_1_h256               0x146019720 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h64                0x146019b90 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h80                0x14601a000 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h96                0x14601a470 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h112               0x14601a8e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h128               0x14601ad50 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_q8_0_h256               0x14601b1c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h128            0x14601b630 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h128           0x14601baa0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h128           0x14601bf10 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h128           0x14601c380 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h128           0x14601c7f0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h128           0x14601cc60 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h128           0x14601d0d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_f16_h256            0x14601d540 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_bf16_h256           0x14601d9b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_0_h256           0x14601de20 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q4_1_h256           0x14601e290 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_0_h256           0x14601e700 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q5_1_h256           0x14601eb70 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_flash_attn_ext_vec_q8_0_h256           0x14601efe0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_f32                                0x14601f450 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_set_i32                                0x14601f8c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f32                            0x14601fd30 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_f16                            0x1460201a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_bf16                           0x146020610 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f32                            0x146020a80 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f16_f16                            0x146020ef0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_f32                           0x146021360 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_bf16_bf16                          0x1460217d0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q8_0                           0x146021c40 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_0                           0x1460220b0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q4_1                           0x146022520 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_0                           0x146022990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_q5_1                           0x146022e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cpy_f32_iq4_nl                         0x146023270 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_concat                                 0x1460236e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqr                                    0x146023dd0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sqrt                                   0x1460244c0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sin                                    0x1460162a0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_cos                                    0x146016990 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_sum_rows                               0x146016e00 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_argmax                                 0x14600d570 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_avg_f32                        0x14600d9e0 | th_max = 1024 | th_width =   32
ggml_metal_init: loaded kernel_pool_2d_max_f32                        0x14600de50 | th_max = 1024 | th_width =   32
llama_kv_cache_init: kv_size = 2048, offload = 1, type_k = 'f16', type_v = 'f16', n_layer = 24
llama_kv_cache_init: layer 0: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 1: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 2: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 3: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 4: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 5: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 6: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 7: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 8: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 9: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 10: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 11: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 12: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 13: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 14: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 15: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 16: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 17: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 18: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 19: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 20: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 21: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 22: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init: layer 23: n_embd_k_gqa = 2048, n_embd_v_gqa = 2048
llama_kv_cache_init:      Metal KV buffer size =   384.00 MiB
llama_new_context_with_model: KV self size  =  384.00 MiB, K (f16):  192.00 MiB, V (f16):  192.00 MiB
llama_new_context_with_model:        CPU  output buffer size =     0.19 MiB
llama_new_context_with_model:      Metal compute buffer size =   102.25 MiB
llama_new_context_with_model:        CPU compute buffer size =     8.01 MiB
llama_new_context_with_model: graph nodes  = 872
llama_new_context_with_model: graph splits = 2
main : deserialized state from 988319 out of a maximum of 988319 bytes
main : seq 0 copied, 787052 bytes
main : kv cache cleared
main : seq 1 restored, 787052 bytes
ggml_metal_free: deallocating

main : success

first run: The quick brown fox jumps over the lazy Dog." "Maybe you should have done that little trick."


second run: The quick brown fox jumps over the lazy Dog." "Maybe you should have done that little trick."


single seq run: The quick brown fox jumps over the lazy Dog." "Maybe you should have done that little trick."

real	0m0.945s
user	0m0.243s
sys	0m0.152s
```
### ctest_with_model_debug

Runs ctest with model files in debug mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-debug
    Start 24: test-model-load-cancel
1/2 Test #24: test-model-load-cancel ...........   Passed    0.55 sec
    Start 25: test-autorelease
2/2 Test #25: test-autorelease .................   Passed    0.58 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   1.14 sec*proc (2 tests)

Total Test time (real) =   1.15 sec
        1.17 real         0.73 user         0.05 sys
```
### ctest_with_model_release

Runs ctest with model files in release mode
- status: 0
```
+ LLAMACPP_TEST_MODELFILE=/Users/ggml/mnt/llama.cpp/models/pythia/1.4B/ggml-model-f16.gguf
+ time ctest --output-on-failure -L model
Test project /Users/ggml/work/llama.cpp/build-ci-release
    Start 24: test-model-load-cancel
1/2 Test #24: test-model-load-cancel ...........   Passed    0.25 sec
    Start 25: test-autorelease
2/2 Test #25: test-autorelease .................   Passed    0.29 sec

100% tests passed, 0 tests failed out of 2

Label Time Summary:
model    =   0.53 sec*proc (2 tests)

Total Test time (real) =   0.54 sec
        0.55 real         0.15 user         0.04 sys
```
